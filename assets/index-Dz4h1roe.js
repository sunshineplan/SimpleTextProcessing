var XM=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var MY=XM((DY,Nu)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const $g=!1;var ZM=Array.isArray,QM=Array.prototype.indexOf,Ps=Array.prototype.includes,JM=Array.from,eI=Object.defineProperty,Es=Object.getOwnPropertyDescriptor,tI=Object.getOwnPropertyDescriptors,rI=Object.prototype,nI=Array.prototype,wE=Object.getPrototypeOf,ev=Object.isExtensible;const iI=()=>{};function oI(t){for(var e=0;e<t.length;e++)t[e]()}function vE(){var t,e,r=new Promise((n,i)=>{t=n,e=i});return{promise:r,resolve:t,reject:e}}const _t=2,oc=4,sc=8,yE=1<<24,fi=16,kn=32,No=64,jg=128,Vr=512,wt=1024,Ot=2048,fn=4096,xn=8192,ui=16384,_o=32768,xs=65536,tv=1<<17,km=1<<18,Do=1<<19,sI=1<<20,Oo=65536,zg=1<<21,Lm=1<<22,xi=1<<23,yu=Symbol("$state"),aI=Symbol("legacy props"),lI=Symbol(""),po=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"},uI=!!globalThis.document?.contentType&&globalThis.document.contentType.includes("xml"),cI=11;function hI(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function dI(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function fI(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function gI(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function mI(t){throw new Error("https://svelte.dev/e/effect_orphan")}function pI(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function wI(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function vI(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function yI(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function bI(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function SI(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const CI=1,RI=4,EI=8,TI=16,_I=1,OI=2,Rt=Symbol(),bE="http://www.w3.org/1999/xhtml";function MI(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function SE(t){return t===this.v}function II(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function HI(t){return!II(t,this.v)}let AI=!1,Er=null;function Ns(t){Er=t}function Fm(t,e=!1,r){Er={p:Er,i:!1,c:null,e:null,s:t,x:null,l:null}}function Vm(t){var e=Er,r=e.e;if(r!==null){e.e=null;for(var n of r)BE(n)}return e.i=!0,Er=e.p,{}}function CE(){return!0}let wo=[];function RE(){var t=wo;wo=[],oI(t)}function Co(t){if(wo.length===0&&!Fa){var e=wo;queueMicrotask(()=>{e===wo&&RE()})}wo.push(t)}function PI(){for(;wo.length>0;)RE()}function EE(t){var e=we;if(e===null)return fe.f|=xi,t;if((e.f&_o)===0&&(e.f&oc)===0)throw t;Oi(t,e)}function Oi(t,e){for(;e!==null;){if((e.f&jg)!==0){if((e.f&_o)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const xI=-7169;function rt(t,e){t.f=t.f&xI|e}function Wm(t){(t.f&Vr)!==0||t.deps===null?rt(t,wt):rt(t,fn)}function TE(t){if(t!==null)for(const e of t)(e.f&_t)===0||(e.f&Oo)===0||(e.f^=Oo,TE(e.deps))}function _E(t,e,r){(t.f&Ot)!==0?e.add(t):(t.f&fn)!==0&&r.add(t),TE(t.deps),rt(t,wt)}const Ol=new Set;let Pe=null,Ug=null,un=null,sr=[],ac=null,Yg=!1,Fa=!1;class Ni{current=new Map;previous=new Map;#t=new Set;#a=new Set;#e=0;#s=0;#n=null;#o=new Set;#r=new Set;#i=new Map;is_fork=!1;#l=!1;#c(){return this.is_fork||this.#s>0}skip_effect(e){this.#i.has(e)||this.#i.set(e,{d:[],m:[]})}unskip_effect(e){var r=this.#i.get(e);if(r){this.#i.delete(e);for(var n of r.d)rt(n,Ot),cn(n);for(n of r.m)rt(n,fn),cn(n)}}process(e){sr=[],this.apply();var r=[],n=[];for(const i of e)this.#u(i,r,n);if(this.#c()){this.#h(n),this.#h(r);for(const[i,o]of this.#i)HE(i,o)}else{for(const i of this.#t)i();this.#t.clear(),this.#e===0&&this.#f(),Ug=this,Pe=null,rv(n),rv(r),this.#o.clear(),this.#r.clear(),Ug=null,this.#n?.resolve()}un=null}#u(e,r,n){e.f^=wt;for(var i=e.first;i!==null;){var o=i.f,s=(o&(kn|No))!==0,a=s&&(o&wt)!==0,l=a||(o&xn)!==0||this.#i.has(i);if(!l&&i.fn!==null){s?i.f^=wt:(o&oc)!==0?r.push(i):il(i)&&((o&fi)!==0&&this.#r.add(i),ks(i));var u=i.first;if(u!==null){i=u;continue}}for(;i!==null;){var c=i.next;if(c!==null){i=c;break}i=i.parent}}}#h(e){for(var r=0;r<e.length;r+=1)_E(e[r],this.#o,this.#r)}capture(e,r){r!==Rt&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&xi)===0&&(this.current.set(e,e.v),un?.set(e,e.v))}activate(){Pe=this,this.apply()}deactivate(){Pe===this&&(Pe=null,un=null)}flush(){if(this.activate(),sr.length>0){if(OE(),Pe!==null&&Pe!==this)return}else this.#e===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#a)e(this);this.#a.clear()}#f(){if(Ol.size>1){this.previous.clear();var e=un,r=!0;for(const i of Ol){if(i===this){r=!1;continue}const o=[];for(const[a,l]of this.current){if(i.current.has(a))if(r&&l!==i.current.get(a))i.current.set(a,l);else continue;o.push(a)}if(o.length===0)continue;const s=[...i.current.keys()].filter(a=>!this.current.has(a));if(s.length>0){var n=sr;sr=[];const a=new Set,l=new Map;for(const u of o)ME(u,s,a,l);if(sr.length>0){Pe=i,i.apply();for(const u of sr)i.#u(u,[],[]);i.deactivate()}sr=n}}Pe=null,un=e}this.#i.clear(),Ol.delete(this)}increment(e){this.#e+=1,e&&(this.#s+=1)}decrement(e){this.#e-=1,e&&(this.#s-=1),!this.#l&&(this.#l=!0,Co(()=>{this.#l=!1,this.#c()?sr.length>0&&this.flush():this.revive()}))}revive(){for(const e of this.#o)this.#r.delete(e),rt(e,Ot),cn(e);for(const e of this.#r)rt(e,fn),cn(e);this.flush()}oncommit(e){this.#t.add(e)}ondiscard(e){this.#a.add(e)}settled(){return(this.#n??=vE()).promise}static ensure(){if(Pe===null){const e=Pe=new Ni;Ol.add(Pe),Fa||Co(()=>{Pe===e&&e.flush()})}return Pe}apply(){}}function NI(t){var e=Fa;Fa=!0;try{for(var r;;){if(PI(),sr.length===0&&(Pe?.flush(),sr.length===0))return ac=null,r;OE()}}finally{Fa=e}}function OE(){Yg=!0;var t=null;try{for(var e=0;sr.length>0;){var r=Ni.ensure();if(e++>1e3){var n,i;DI()}r.process(sr),Di.clear()}}finally{sr=[],Yg=!1,ac=null}}function DI(){try{pI()}catch(t){Oi(t,ac)}}let ri=null;function rv(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var n=t[r++];if((n.f&(ui|xn))===0&&il(n)&&(ri=new Set,ks(n),n.deps===null&&n.first===null&&n.nodes===null&&n.teardown===null&&n.ac===null&&jE(n),ri?.size>0)){Di.clear();for(const i of ri){if((i.f&(ui|xn))!==0)continue;const o=[i];let s=i.parent;for(;s!==null;)ri.has(s)&&(ri.delete(s),o.push(s)),s=s.parent;for(let a=o.length-1;a>=0;a--){const l=o[a];(l.f&(ui|xn))===0&&ks(l)}}ri.clear()}}ri=null}}function ME(t,e,r,n){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&_t)!==0?ME(i,e,r,n):(o&(Lm|fi))!==0&&(o&Ot)===0&&IE(i,e,n)&&(rt(i,Ot),cn(i))}}function IE(t,e,r){const n=r.get(t);if(n!==void 0)return n;if(t.deps!==null)for(const i of t.deps){if(Ps.call(e,i))return!0;if((i.f&_t)!==0&&IE(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function cn(t){var e=ac=t,r=e.b;if(r?.is_pending&&(t.f&(oc|sc|yE))!==0&&(t.f&_o)===0){r.defer_effect(t);return}for(;e.parent!==null;){e=e.parent;var n=e.f;if(Yg&&e===we&&(n&fi)!==0&&(n&km)===0&&(n&_o)!==0)return;if((n&(No|kn))!==0){if((n&wt)===0)return;e.f^=wt}}sr.push(e)}function HE(t,e){if(!((t.f&kn)!==0&&(t.f&wt)!==0)){(t.f&Ot)!==0?e.d.push(t):(t.f&fn)!==0&&e.m.push(t),rt(t,wt);for(var r=t.first;r!==null;)HE(r,e),r=r.next}}function kI(t){let e=0,r=lc(0),n;return()=>{jm()&&(ie(r),zm(()=>(e===0&&(n=ol(()=>t(()=>Va(r)))),e+=1,()=>{Co(()=>{e-=1,e===0&&(n?.(),n=void 0,Va(r))})})))}}var LI=xs|Do;function FI(t,e,r,n){new VI(t,e,r,n)}class VI{parent;is_pending=!1;transform_error;#t;#a=null;#e;#s;#n;#o=null;#r=null;#i=null;#l=null;#c=0;#u=0;#h=!1;#f=new Set;#g=new Set;#d=null;#y=kI(()=>(this.#d=lc(this.#c),()=>{this.#d=null}));constructor(e,r,n,i){this.#t=e,this.#e=r,this.#s=o=>{var s=we;s.b=this,s.f|=jg,n(o)},this.parent=we.b,this.transform_error=i??this.parent?.transform_error??(o=>o),this.#n=Um(()=>{this.#w()},LI)}#b(){try{this.#o=ni(()=>this.#s(this.#t))}catch(e){this.error(e)}}#S(e){const r=this.#e.failed;r&&(this.#i=ni(()=>{r(this.#t,()=>e,()=>()=>{})}))}#C(){const e=this.#e.pending;e&&(this.is_pending=!0,this.#r=ni(()=>e(this.#t)),Co(()=>{var r=this.#l=document.createDocumentFragment(),n=Ds();r.append(n),this.#o=this.#p(()=>(Ni.ensure(),ni(()=>this.#s(n)))),this.#u===0&&(this.#t.before(r),this.#l=null,Wa(this.#r,()=>{this.#r=null}),this.#m())}))}#w(){try{if(this.is_pending=this.has_pending_snippet(),this.#u=0,this.#c=0,this.#o=ni(()=>{this.#s(this.#t)}),this.#u>0){var e=this.#l=document.createDocumentFragment();YE(this.#o,e);const r=this.#e.pending;this.#r=ni(()=>r(this.#t))}else this.#m()}catch(r){this.error(r)}}#m(){this.is_pending=!1;for(const e of this.#f)rt(e,Ot),cn(e);for(const e of this.#g)rt(e,fn),cn(e);this.#f.clear(),this.#g.clear()}defer_effect(e){_E(e,this.#f,this.#g)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#e.pending}#p(e){var r=we,n=fe,i=Er;Nn(this.#n),Br(this.#n),Ns(this.#n.ctx);try{return e()}catch(o){return EE(o),null}finally{Nn(r),Br(n),Ns(i)}}#v(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#v(e);return}this.#u+=e,this.#u===0&&(this.#m(),this.#r&&Wa(this.#r,()=>{this.#r=null}),this.#l&&(this.#t.before(this.#l),this.#l=null))}update_pending_count(e){this.#v(e),this.#c+=e,!(!this.#d||this.#h)&&(this.#h=!0,Co(()=>{this.#h=!1,this.#d&&Du(this.#d,this.#c)}))}get_effect_pending(){return this.#y(),ie(this.#d)}error(e){var r=this.#e.onerror;let n=this.#e.failed;if(!r&&!n)throw e;this.#o&&(br(this.#o),this.#o=null),this.#r&&(br(this.#r),this.#r=null),this.#i&&(br(this.#i),this.#i=null);var i=!1,o=!1;const s=()=>{if(i){MI();return}i=!0,o&&SI(),this.#i!==null&&Wa(this.#i,()=>{this.#i=null}),this.#p(()=>{Ni.ensure(),this.#w()})},a=l=>{try{o=!0,r?.(l,s),o=!1}catch(u){Oi(u,this.#n&&this.#n.parent)}n&&(this.#i=this.#p(()=>{Ni.ensure();try{return ni(()=>{var u=we;u.b=this,u.f|=jg,n(this.#t,()=>l,()=>s)})}catch(u){return Oi(u,this.#n.parent),null}}))};Co(()=>{var l;try{l=this.transform_error(e)}catch(u){Oi(u,this.#n&&this.#n.parent);return}l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(a,u=>Oi(u,this.#n&&this.#n.parent)):a(l)})}}function WI(t,e,r,n){const i=Bm;var o=t.filter(h=>!h.settled);if(r.length===0&&o.length===0){n(e.map(i));return}var s=we,a=BI(),l=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(h=>h.promise)):null;function u(h){a();try{n(h)}catch(f){(s.f&ui)===0&&Oi(f,s)}qg()}if(r.length===0){l.then(()=>u(e.map(i)));return}function c(){a(),Promise.all(r.map(h=>jI(h))).then(h=>u([...e.map(i),...h])).catch(h=>Oi(h,s))}l?l.then(c):c()}function BI(){var t=we,e=fe,r=Er,n=Pe;return function(o=!0){Nn(t),Br(e),Ns(r),o&&n?.activate()}}function qg(t=!0){Nn(null),Br(null),Ns(null),t&&Pe?.deactivate()}function $I(){var t=we.b,e=Pe,r=t.is_rendered();return t.update_pending_count(1),e.increment(r),()=>{t.update_pending_count(-1),e.decrement(r)}}function Bm(t){var e=_t|Ot,r=fe!==null&&(fe.f&_t)!==0?fe:null;return we!==null&&(we.f|=Do),{ctx:Er,deps:null,effects:null,equals:SE,f:e,fn:t,reactions:null,rv:0,v:Rt,wv:0,parent:r??we,ac:null}}function jI(t,e,r){we===null&&dI();var i=void 0,o=lc(Rt),s=!fe,a=new Map;return rH(()=>{var l=vE();i=l.promise;try{Promise.resolve(t()).then(l.resolve,l.reject).finally(qg)}catch(f){l.reject(f),qg()}var u=Pe;if(s){var c=$I();a.get(u)?.reject(po),a.delete(u),a.set(u,l)}const h=(f,g=void 0)=>{if(u.activate(),g)g!==po&&(o.f|=xi,Du(o,g));else{(o.f&xi)!==0&&(o.f^=xi),Du(o,f);for(const[p,v]of a){if(a.delete(p),p===u)break;v.reject(po)}}c&&c()};l.promise.then(h,f=>h(null,f||"unknown"))}),WE(()=>{for(const l of a.values())l.reject(po)}),new Promise(l=>{function u(c){function h(){c===i?l(o):u(i)}c.then(h,h)}u(i)})}function zI(t){const e=Bm(t);return e.equals=HI,e}function UI(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)br(e[r])}}function YI(t){for(var e=t.parent;e!==null;){if((e.f&_t)===0)return(e.f&ui)===0?e:null;e=e.parent}return null}function $m(t){var e,r=we;Nn(YI(t));try{t.f&=~Oo,UI(t),e=XE(t)}finally{Nn(r)}return e}function AE(t){var e=$m(t);if(!t.equals(e)&&(t.wv=GE(),(!Pe?.is_fork||t.deps===null)&&(t.v=e,t.deps===null))){rt(t,wt);return}Fi||(un!==null?(jm()||Pe?.is_fork)&&un.set(t,e):Wm(t))}function qI(t){if(t.effects!==null)for(const e of t.effects)(e.teardown||e.ac)&&(e.teardown?.(),e.ac?.abort(po),e.teardown=iI,e.ac=null,Xa(e,0),Ym(e))}function PE(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&ks(e)}let Gg=new Set;const Di=new Map;let xE=!1;function lc(t,e){var r={f:0,v:t,reactions:null,equals:SE,rv:0,wv:0};return r}function Ge(t,e){const r=lc(t);return sH(r),r}function le(t,e,r=!1){fe!==null&&(!hn||(fe.f&tv)!==0)&&CE()&&(fe.f&(_t|fi|Lm|tv))!==0&&(Wr===null||!Ps.call(Wr,t))&&bI();let n=r?ys(e):e;return Du(t,n)}function Du(t,e){if(!t.equals(e)){var r=t.v;Fi?Di.set(t,e):Di.set(t,r),t.v=e;var n=Ni.ensure();if(n.capture(t,r),(t.f&_t)!==0){const i=t;(t.f&Ot)!==0&&$m(i),Wm(i)}t.wv=GE(),NE(t,Ot),we!==null&&(we.f&wt)!==0&&(we.f&(kn|No))===0&&(Dr===null?aH([t]):Dr.push(t)),!n.is_fork&&Gg.size>0&&!xE&&GI()}return e}function GI(){xE=!1;for(const t of Gg)(t.f&wt)!==0&&rt(t,fn),il(t)&&ks(t);Gg.clear()}function Va(t){le(t,t.v+1)}function NE(t,e){var r=t.reactions;if(r!==null)for(var n=r.length,i=0;i<n;i++){var o=r[i],s=o.f,a=(s&Ot)===0;if(a&&rt(o,e),(s&_t)!==0){var l=o;un?.delete(l),(s&Oo)===0&&(s&Vr&&(o.f|=Oo),NE(l,fn))}else a&&((s&fi)!==0&&ri!==null&&ri.add(o),cn(o))}}function ys(t){if(typeof t!="object"||t===null||yu in t)return t;const e=wE(t);if(e!==rI&&e!==nI)return t;var r=new Map,n=ZM(t),i=Ge(0),o=Ro,s=a=>{if(Ro===o)return a();var l=fe,u=Ro;Br(null),ov(o);var c=a();return Br(l),ov(u),c};return n&&r.set("length",Ge(t.length)),new Proxy(t,{defineProperty(a,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&vI();var c=r.get(l);return c===void 0?s(()=>{var h=Ge(u.value);return r.set(l,h),h}):le(c,u.value,!0),!0},deleteProperty(a,l){var u=r.get(l);if(u===void 0){if(l in a){const c=s(()=>Ge(Rt));r.set(l,c),Va(i)}}else le(u,Rt),Va(i);return!0},get(a,l,u){if(l===yu)return t;var c=r.get(l),h=l in a;if(c===void 0&&(!h||Es(a,l)?.writable)&&(c=s(()=>{var g=ys(h?a[l]:Rt),p=Ge(g);return p}),r.set(l,c)),c!==void 0){var f=ie(c);return f===Rt?void 0:f}return Reflect.get(a,l,u)},getOwnPropertyDescriptor(a,l){var u=Reflect.getOwnPropertyDescriptor(a,l);if(u&&"value"in u){var c=r.get(l);c&&(u.value=ie(c))}else if(u===void 0){var h=r.get(l),f=h?.v;if(h!==void 0&&f!==Rt)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return u},has(a,l){if(l===yu)return!0;var u=r.get(l),c=u!==void 0&&u.v!==Rt||Reflect.has(a,l);if(u!==void 0||we!==null&&(!c||Es(a,l)?.writable)){u===void 0&&(u=s(()=>{var f=c?ys(a[l]):Rt,g=Ge(f);return g}),r.set(l,u));var h=ie(u);if(h===Rt)return!1}return c},set(a,l,u,c){var h=r.get(l),f=l in a;if(n&&l==="length")for(var g=u;g<h.v;g+=1){var p=r.get(g+"");p!==void 0?le(p,Rt):g in a&&(p=s(()=>Ge(Rt)),r.set(g+"",p))}if(h===void 0)(!f||Es(a,l)?.writable)&&(h=s(()=>Ge(void 0)),le(h,ys(u)),r.set(l,h));else{f=h.v!==Rt;var v=s(()=>ys(u));le(h,v)}var y=Reflect.getOwnPropertyDescriptor(a,l);if(y?.set&&y.set.call(c,u),!f){if(n&&typeof l=="string"){var T=r.get("length"),R=Number(l);Number.isInteger(R)&&R>=T.v&&le(T,R+1)}Va(i)}return!0},ownKeys(a){ie(i);var l=Reflect.ownKeys(a).filter(h=>{var f=r.get(h);return f===void 0||f.v!==Rt});for(var[u,c]of r)c.v!==Rt&&!(u in a)&&l.push(u);return l},setPrototypeOf(){yI()}})}var Kg,DE,kE,LE;function KI(){if(Kg===void 0){Kg=window,DE=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;kE=Es(e,"firstChild").get,LE=Es(e,"nextSibling").get,ev(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),ev(r)&&(r.__t=void 0)}}function Ds(t=""){return document.createTextNode(t)}function ku(t){return kE.call(t)}function uc(t){return LE.call(t)}function vr(t,e){return ku(t)}function Xg(t,e=!1){{var r=ku(t);return r instanceof Comment&&r.data===""?uc(r):r}}function pt(t,e=1,r=!1){let n=t;for(;e--;)n=uc(n);return n}function XI(){return!1}function FE(t,e,r){return document.createElementNS(bE,t,void 0)}let nv=!1;function ZI(){nv||(nv=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function cc(t){var e=fe,r=we;Br(null),Nn(null);try{return t()}finally{Br(e),Nn(r)}}function VE(t,e,r,n=r){t.addEventListener(e,()=>cc(r));const i=t.__on_r;i?t.__on_r=()=>{i(),n(!0)}:t.__on_r=()=>n(!0),ZI()}function QI(t){we===null&&(fe===null&&mI(),gI()),Fi&&fI()}function JI(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function ji(t,e,r){var n=we;n!==null&&(n.f&xn)!==0&&(t|=xn);var i={ctx:Er,deps:null,nodes:null,f:t|Ot|Vr,first:null,fn:e,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{ks(i)}catch(a){throw br(i),a}else e!==null&&cn(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Do)===0&&(o=o.first,(t&fi)!==0&&(t&xs)!==0&&o!==null&&(o.f|=xs)),o!==null&&(o.parent=n,n!==null&&JI(o,n),fe!==null&&(fe.f&_t)!==0&&(t&No)===0)){var s=fe;(s.effects??=[]).push(o)}return i}function jm(){return fe!==null&&!hn}function WE(t){const e=ji(sc,null,!1);return rt(e,wt),e.teardown=t,e}function eH(t){QI();var e=we.f,r=!fe&&(e&kn)!==0&&(e&_o)===0;if(r){var n=Er;(n.e??=[]).push(t)}else return BE(t)}function BE(t){return ji(oc|sI,t,!1)}function tH(t){Ni.ensure();const e=ji(No|Do,t,!0);return(r={})=>new Promise(n=>{r.outro?Wa(e,()=>{br(e),n(void 0)}):(br(e),n(void 0))})}function rH(t){return ji(Lm|Do,t,!0)}function zm(t,e=0){return ji(sc|e,t,!0)}function Zg(t,e=[],r=[],n=[]){WI(n,e,r,i=>{ji(sc,()=>t(...i.map(ie)),!0)})}function Um(t,e=0){var r=ji(fi|e,t,!0);return r}function ni(t){return ji(kn|Do,t,!0)}function $E(t){var e=t.teardown;if(e!==null){const r=Fi,n=fe;iv(!0),Br(null);try{e.call(null)}finally{iv(r),Br(n)}}}function Ym(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&cc(()=>{i.abort(po)});var n=r.next;(r.f&No)!==0?r.parent=null:br(r,e),r=n}}function nH(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&kn)===0&&br(e),e=r}}function br(t,e=!0){var r=!1;(e||(t.f&km)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(iH(t.nodes.start,t.nodes.end),r=!0),Ym(t,e&&!r),Xa(t,0),rt(t,ui);var n=t.nodes&&t.nodes.t;if(n!==null)for(const o of n)o.stop();$E(t);var i=t.parent;i!==null&&i.first!==null&&jE(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function iH(t,e){for(;t!==null;){var r=t===e?null:uc(t);t.remove(),t=r}}function jE(t){var e=t.parent,r=t.prev,n=t.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function Wa(t,e,r=!0){var n=[];zE(t,n,!0);var i=()=>{r&&br(t),e&&e()},o=n.length;if(o>0){var s=()=>--o||i();for(var a of n)a.out(s)}else i()}function zE(t,e,r){if((t.f&xn)===0){t.f^=xn;var n=t.nodes&&t.nodes.t;if(n!==null)for(const a of n)(a.is_global||r)&&e.push(a);for(var i=t.first;i!==null;){var o=i.next,s=(i.f&xs)!==0||(i.f&kn)!==0&&(t.f&fi)!==0;zE(i,e,s?r:!1),i=o}}}function oH(t){UE(t,!0)}function UE(t,e){if((t.f&xn)!==0){t.f^=xn,(t.f&wt)===0&&(rt(t,Ot),cn(t));for(var r=t.first;r!==null;){var n=r.next,i=(r.f&xs)!==0||(r.f&kn)!==0;UE(r,i?e:!1),r=n}var o=t.nodes&&t.nodes.t;if(o!==null)for(const s of o)(s.is_global||e)&&s.in()}}function YE(t,e){if(t.nodes)for(var r=t.nodes.start,n=t.nodes.end;r!==null;){var i=r===n?null:uc(r);e.append(r),r=i}}let bu=!1,Fi=!1;function iv(t){Fi=t}let fe=null,hn=!1;function Br(t){fe=t}let we=null;function Nn(t){we=t}let Wr=null;function sH(t){fe!==null&&(Wr===null?Wr=[t]:Wr.push(t))}let ar=null,pr=0,Dr=null;function aH(t){Dr=t}let qE=1,vo=0,Ro=vo;function ov(t){Ro=t}function GE(){return++qE}function il(t){var e=t.f;if((e&Ot)!==0)return!0;if(e&_t&&(t.f&=~Oo),(e&fn)!==0){for(var r=t.deps,n=r.length,i=0;i<n;i++){var o=r[i];if(il(o)&&AE(o),o.wv>t.wv)return!0}(e&Vr)!==0&&un===null&&rt(t,wt)}return!1}function KE(t,e,r=!0){var n=t.reactions;if(n!==null&&!(Wr!==null&&Ps.call(Wr,t)))for(var i=0;i<n.length;i++){var o=n[i];(o.f&_t)!==0?KE(o,e,!1):e===o&&(r?rt(o,Ot):(o.f&wt)!==0&&rt(o,fn),cn(o))}}function XE(t){var e=ar,r=pr,n=Dr,i=fe,o=Wr,s=Er,a=hn,l=Ro,u=t.f;ar=null,pr=0,Dr=null,fe=(u&(kn|No))===0?t:null,Wr=null,Ns(t.ctx),hn=!1,Ro=++vo,t.ac!==null&&(cc(()=>{t.ac.abort(po)}),t.ac=null);try{t.f|=zg;var c=t.fn,h=c();t.f|=_o;var f=t.deps,g=Pe?.is_fork;if(ar!==null){var p;if(g||Xa(t,pr),f!==null&&pr>0)for(f.length=pr+ar.length,p=0;p<ar.length;p++)f[pr+p]=ar[p];else t.deps=f=ar;if(jm()&&(t.f&Vr)!==0)for(p=pr;p<f.length;p++)(f[p].reactions??=[]).push(t)}else!g&&f!==null&&pr<f.length&&(Xa(t,pr),f.length=pr);if(CE()&&Dr!==null&&!hn&&f!==null&&(t.f&(_t|fn|Ot))===0)for(p=0;p<Dr.length;p++)KE(Dr[p],t);if(i!==null&&i!==t){if(vo++,i.deps!==null)for(let v=0;v<r;v+=1)i.deps[v].rv=vo;if(e!==null)for(const v of e)v.rv=vo;Dr!==null&&(n===null?n=Dr:n.push(...Dr))}return(t.f&xi)!==0&&(t.f^=xi),h}catch(v){return EE(v)}finally{t.f^=zg,ar=e,pr=r,Dr=n,fe=i,Wr=o,Ns(s),hn=a,Ro=l}}function lH(t,e){let r=e.reactions;if(r!==null){var n=QM.call(r,t);if(n!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[n]=r[i],r.pop())}}if(r===null&&(e.f&_t)!==0&&(ar===null||!Ps.call(ar,e))){var o=e;(o.f&Vr)!==0&&(o.f^=Vr,o.f&=~Oo),Wm(o),qI(o),Xa(o,0)}}function Xa(t,e){var r=t.deps;if(r!==null)for(var n=e;n<r.length;n++)lH(t,r[n])}function ks(t){var e=t.f;if((e&ui)===0){rt(t,wt);var r=we,n=bu;we=t,bu=!0;try{(e&(fi|yE))!==0?nH(t):Ym(t),$E(t);var i=XE(t);t.teardown=typeof i=="function"?i:null,t.wv=qE;var o;$g&&AI&&(t.f&Ot)!==0&&t.deps}finally{bu=n,we=r}}}async function uH(){await Promise.resolve(),NI()}function ie(t){var e=t.f,r=(e&_t)!==0;if(fe!==null&&!hn){var n=we!==null&&(we.f&ui)!==0;if(!n&&(Wr===null||!Ps.call(Wr,t))){var i=fe.deps;if((fe.f&zg)!==0)t.rv<vo&&(t.rv=vo,ar===null&&i!==null&&i[pr]===t?pr++:ar===null?ar=[t]:ar.push(t));else{(fe.deps??=[]).push(t);var o=t.reactions;o===null?t.reactions=[fe]:Ps.call(o,fe)||o.push(fe)}}}if(Fi&&Di.has(t))return Di.get(t);if(r){var s=t;if(Fi){var a=s.v;return((s.f&wt)===0&&s.reactions!==null||QE(s))&&(a=$m(s)),Di.set(s,a),a}var l=(s.f&Vr)===0&&!hn&&fe!==null&&(bu||(fe.f&Vr)!==0),u=(s.f&_o)===0;il(s)&&(l&&(s.f|=Vr),AE(s)),l&&!u&&(PE(s),ZE(s))}if(un?.has(t))return un.get(t);if((t.f&xi)!==0)throw t.v;return t.v}function ZE(t){if(t.f|=Vr,t.deps!==null)for(const e of t.deps)(e.reactions??=[]).push(t),(e.f&_t)!==0&&(e.f&Vr)===0&&(PE(e),ZE(e))}function QE(t){if(t.v===Rt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Di.has(e)||(e.f&_t)!==0&&QE(e))return!0;return!1}function ol(t){var e=hn;try{return hn=!0,t()}finally{hn=e}}const cH=["touchstart","touchmove"];function hH(t){return cH.includes(t)}const Pa=Symbol("events"),JE=new Set,Qg=new Set;function dH(t,e,r,n={}){function i(o){if(n.capture||Jg.call(e,o),!o.cancelBubble)return cc(()=>r?.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Co(()=>{e.addEventListener(t,i,n)}):e.addEventListener(t,i,n),i}function sv(t,e,r,n,i){var o={capture:n,passive:i},s=dH(t,e,r,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&WE(()=>{e.removeEventListener(t,s,o)})}function ms(t,e,r){(e[Pa]??={})[t]=r}function eT(t){for(var e=0;e<t.length;e++)JE.add(t[e]);for(var r of Qg)r(t)}let av=null;function Jg(t){var e=this,r=e.ownerDocument,n=t.type,i=t.composedPath?.()||[],o=i[0]||t.target;av=t;var s=0,a=av===t&&t[Pa];if(a){var l=i.indexOf(a);if(l!==-1&&(e===document||e===window)){t[Pa]=e;return}var u=i.indexOf(e);if(u===-1)return;l<=u&&(s=l)}if(o=i[s]||t.target,o!==e){eI(t,"currentTarget",{configurable:!0,get(){return o||r}});var c=fe,h=we;Br(null),Nn(null);try{for(var f,g=[];o!==null;){var p=o.assignedSlot||o.parentNode||o.host||null;try{var v=o[Pa]?.[n];v!=null&&(!o.disabled||t.target===o)&&v.call(o,t)}catch(y){f?g.push(y):f=y}if(t.cancelBubble||p===e||p===null)break;o=p}if(f){for(let y of g)queueMicrotask(()=>{throw y});throw f}}finally{t[Pa]=e,delete t.currentTarget,Br(c),Nn(h)}}}const fH=globalThis?.window?.trustedTypes&&globalThis.window.trustedTypes.createPolicy("svelte-trusted-html",{createHTML:t=>t});function gH(t){return fH?.createHTML(t)??t}function mH(t){var e=FE("template");return e.innerHTML=gH(t.replaceAll("<!>","<!---->")),e.content}const pH=uI?"script":"SCRIPT";function em(t,e){var r=we;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function hc(t,e){var r=(e&_I)!==0,n=(e&OI)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=mH(o?t:"<!>"+t),r||(i=ku(i)));var s=n||DE?document.importNode(i,!0):i.cloneNode(!0);if(r){var a=ku(s),l=s.lastChild;em(a,l)}else em(s,s);return s}}function wH(t){return()=>vH(t())}function vH(t){const e=t.nodeType===cI,r=t.nodeName===pH?[t]:t.querySelectorAll("script"),n=we;for(const o of r){const s=FE("script");for(var i of o.attributes)s.setAttribute(i.name,i.value);s.textContent=o.textContent,(e?t.firstChild===o:t===o)&&(n.nodes.start=s),(e?t.lastChild===o:t===o)&&(n.nodes.end=s),o.replaceWith(s)}return t}function yH(){var t=document.createDocumentFragment(),e=document.createComment(""),r=Ds();return t.append(e,r),em(e,r),t}function Ba(t,e){t!==null&&t.before(e)}function eh(t,e){var r=e==null?"":typeof e=="object"?`${e}`:e;r!==(t.__t??=t.nodeValue)&&(t.__t=r,t.nodeValue=`${r}`)}function bH(t,e){return SH(t,e)}const Ml=new Map;function SH(t,{target:e,anchor:r,props:n={},events:i,context:o,intro:s=!0,transformError:a}){KI();var l=void 0,u=tH(()=>{var c=r??e.appendChild(Ds());FI(c,{pending:()=>{}},g=>{Fm({});var p=Er;o&&(p.c=o),i&&(n.$$events=i),l=t(g,n)||{},Vm()},a);var h=new Set,f=g=>{for(var p=0;p<g.length;p++){var v=g[p];if(!h.has(v)){h.add(v);var y=hH(v);for(const _ of[e,document]){var T=Ml.get(_);T===void 0&&(T=new Map,Ml.set(_,T));var R=T.get(v);R===void 0?(_.addEventListener(v,Jg,{passive:y}),T.set(v,1)):T.set(v,R+1)}}}};return f(JM(JE)),Qg.add(f),()=>{for(var g of h)for(const y of[e,document]){var p=Ml.get(y),v=p.get(g);--v==0?(y.removeEventListener(g,Jg),p.delete(g),p.size===0&&Ml.delete(y)):p.set(g,v)}Qg.delete(f),c!==r&&c.parentNode?.removeChild(c)}});return CH.set(l,u),l}let CH=new WeakMap;class RH{anchor;#t=new Map;#a=new Map;#e=new Map;#s=new Set;#n=!0;constructor(e,r=!0){this.anchor=e,this.#n=r}#o=()=>{var e=Pe;if(this.#t.has(e)){var r=this.#t.get(e),n=this.#a.get(r);if(n)oH(n),this.#s.delete(r);else{var i=this.#e.get(r);i&&(this.#a.set(r,i.effect),this.#e.delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),n=i.effect)}for(const[o,s]of this.#t){if(this.#t.delete(o),o===e)break;const a=this.#e.get(s);a&&(br(a.effect),this.#e.delete(s))}for(const[o,s]of this.#a){if(o===r||this.#s.has(o))continue;const a=()=>{if(Array.from(this.#t.values()).includes(o)){var u=document.createDocumentFragment();YE(s,u),u.append(Ds()),this.#e.set(o,{effect:s,fragment:u})}else br(s);this.#s.delete(o),this.#a.delete(o)};this.#n||!n?(this.#s.add(o),Wa(s,a,!1)):a()}}};#r=e=>{this.#t.delete(e);const r=Array.from(this.#t.values());for(const[n,i]of this.#e)r.includes(n)||(br(i.effect),this.#e.delete(n))};ensure(e,r){var n=Pe,i=XI();if(r&&!this.#a.has(e)&&!this.#e.has(e))if(i){var o=document.createDocumentFragment(),s=Ds();o.append(s),this.#e.set(e,{effect:ni(()=>r(s)),fragment:o})}else this.#a.set(e,ni(()=>r(this.anchor)));if(this.#t.set(n,e),i){for(const[a,l]of this.#a)a===e?n.unskip_effect(l):n.skip_effect(l);for(const[a,l]of this.#e)a===e?n.unskip_effect(l.effect):n.skip_effect(l.effect);n.oncommit(this.#o),n.ondiscard(this.#r)}else this.#o()}}function EH(t,e,r=!1){var n=new RH(t),i=r?xs:0;function o(s,a){n.ensure(s,a)}Um(()=>{var s=!1;e((a,l=0)=>{s=!0,o(l,a)}),s||o(!1,null)},i)}function TH(t,e){var r;r=document.head.appendChild(Ds()),Um(()=>e(r),km|Do)}const _H=Symbol("is custom element"),OH=Symbol("is html");function lv(t,e){var r=tT(t);r.checked!==(r.checked=e??void 0)&&(t.checked=e)}function Gi(t,e,r,n){var i=tT(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[lI]=r),r==null?t.removeAttribute(e):typeof r!="string"&&MH(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function tT(t){return t.__attributes??={[_H]:t.nodeName.includes("-"),[OH]:t.namespaceURI===bE}}var uv=new Map;function MH(t){var e=t.getAttribute("is")||t.nodeName,r=uv.get(e);if(r)return r;uv.set(e,r=[]);for(var n,i=t,o=Element.prototype;o!==i;){n=tI(i);for(var s in n)n[s].set&&r.push(s);i=wE(i)}return r}function IH(t,e,r=e){var n=new WeakSet;VE(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=th(t)?rh(o):o,r(o),Pe!==null&&n.add(Pe),await uH(),o!==(o=e())){var s=t.selectionStart,a=t.selectionEnd,l=t.value.length;if(t.value=o??"",a!==null){var u=t.value.length;s===a&&a===l&&u>l?(t.selectionStart=u,t.selectionEnd=u):(t.selectionStart=s,t.selectionEnd=Math.min(a,u))}}}),ol(e)==null&&t.value&&(r(th(t)?rh(t.value):t.value),Pe!==null&&n.add(Pe)),zm(()=>{var i=e();if(t===document.activeElement){var o=Ug??Pe;if(n.has(o))return}th(t)&&i===rh(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function cv(t,e,r=e){VE(t,"change",n=>{var i=n?t.defaultChecked:t.checked;r(i)}),ol(e)==null&&r(t.checked),zm(()=>{var n=e();t.checked=!!n})}function th(t){var e=t.type;return e==="number"||e==="range"}function rh(t){return t===""?null:+t}let Il=!1;function HH(t){var e=Il;try{return Il=!1,[t(),Il]}finally{Il=e}}function nh(t,e,r,n){var i=(r&EI)!==0,o=(r&TI)!==0,s=n,a=!0,l=()=>(a&&(a=!1,s=o?ol(n):n),s),u;if(i){var c=yu in t||aI in t;u=Es(t,e)?.set??(c&&e in t?R=>t[e]=R:void 0)}var h,f=!1;i?[h,f]=HH(()=>t[e]):h=t[e],h===void 0&&n!==void 0&&(h=l(),u&&(wI(),u(h)));var g;if(g=()=>{var R=t[e];return R===void 0?l():(a=!0,R)},(r&RI)===0)return g;if(u){var p=t.$$legacy;return(function(R,_){return arguments.length>0?((!_||p||f)&&u(_?g():R),R):g()})}var v=!1,y=((r&CI)!==0?Bm:zI)(()=>(v=!1,g()));i&&ie(y);var T=we;return(function(R,_){if(arguments.length>0){const b=_?ie(y):i?ys(R):R;return le(y,b),v=!0,s!==void 0&&(s=b),R}return Fi&&v||(T.f&ui)!==0?y.v:ie(y)})}function AH(t){Er===null&&hI(),eH(()=>{const e=ol(t);if(typeof e=="function")return e})}const PH="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(PH);var hv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dv={},ea,fv;function it(){if(fv)return ea;fv=1;var t=function(e){return e&&e.Math===Math&&e};return ea=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof hv=="object"&&hv)||t(typeof ea=="object"&&ea)||(function(){return this})()||Function("return this")(),ea}var ih={},oh,gv;function ct(){return gv||(gv=1,oh=function(t){try{return!!t()}catch{return!0}}),oh}var sh,mv;function zr(){if(mv)return sh;mv=1;var t=ct();return sh=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),sh}var ah,pv;function dc(){if(pv)return ah;pv=1;var t=ct();return ah=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),ah}var lh,wv;function vt(){if(wv)return lh;wv=1;var t=dc(),e=Function.prototype.call;return lh=t?e.bind(e):function(){return e.apply(e,arguments)},lh}var uh={},vv;function xH(){if(vv)return uh;vv=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return uh.f=r?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,uh}var ch,yv;function fc(){return yv||(yv=1,ch=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),ch}var hh,bv;function ot(){if(bv)return hh;bv=1;var t=dc(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return hh=t?n:function(i){return function(){return r.apply(i,arguments)}},hh}var dh,Sv;function ko(){if(Sv)return dh;Sv=1;var t=ot(),e=t({}.toString),r=t("".slice);return dh=function(n){return r(e(n),8,-1)},dh}var fh,Cv;function NH(){if(Cv)return fh;Cv=1;var t=ot(),e=ct(),r=ko(),n=Object,i=t("".split);return fh=e(function(){return!n("z").propertyIsEnumerable(0)})?function(o){return r(o)==="String"?i(o,""):n(o)}:n,fh}var gh,Rv;function qm(){return Rv||(Rv=1,gh=function(t){return t==null}),gh}var mh,Ev;function sl(){if(Ev)return mh;Ev=1;var t=qm(),e=TypeError;return mh=function(r){if(t(r))throw new e("Can't call method on "+r);return r},mh}var ph,Tv;function al(){if(Tv)return ph;Tv=1;var t=NH(),e=sl();return ph=function(r){return t(e(r))},ph}var wh,_v;function ht(){if(_v)return wh;_v=1;var t=typeof document=="object"&&document.all;return wh=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},wh}var vh,Ov;function Ur(){if(Ov)return vh;Ov=1;var t=ht();return vh=function(e){return typeof e=="object"?e!==null:t(e)},vh}var yh,Mv;function Bs(){if(Mv)return yh;Mv=1;var t=it(),e=ht(),r=function(n){return e(n)?n:void 0};return yh=function(n,i){return arguments.length<2?r(t[n]):t[n]&&t[n][i]},yh}var bh,Iv;function ll(){if(Iv)return bh;Iv=1;var t=ot();return bh=t({}.isPrototypeOf),bh}var Sh,Hv;function gc(){if(Hv)return Sh;Hv=1;var t=it(),e=t.navigator,r=e&&e.userAgent;return Sh=r?String(r):"",Sh}var Ch,Av;function DH(){if(Av)return Ch;Av=1;var t=it(),e=gc(),r=t.process,n=t.Deno,i=r&&r.versions||n&&n.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),Ch=a,Ch}var Rh,Pv;function Gm(){if(Pv)return Rh;Pv=1;var t=DH(),e=ct(),r=it(),n=r.String;return Rh=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!n(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Rh}var Eh,xv;function rT(){if(xv)return Eh;xv=1;var t=Gm();return Eh=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Eh}var Th,Nv;function Km(){if(Nv)return Th;Nv=1;var t=Bs(),e=ht(),r=ll(),n=rT(),i=Object;return Th=n?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&r(s.prototype,i(o))},Th}var _h,Dv;function mc(){if(Dv)return _h;Dv=1;var t=String;return _h=function(e){try{return t(e)}catch{return"Object"}},_h}var Oh,kv;function Tr(){if(kv)return Oh;kv=1;var t=ht(),e=mc(),r=TypeError;return Oh=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")},Oh}var Mh,Lv;function ul(){if(Lv)return Mh;Lv=1;var t=Tr(),e=qm();return Mh=function(r,n){var i=r[n];return e(i)?void 0:t(i)},Mh}var Ih,Fv;function kH(){if(Fv)return Ih;Fv=1;var t=vt(),e=ht(),r=Ur(),n=TypeError;return Ih=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!r(a=t(s,i))||e(s=i.valueOf)&&!r(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!r(a=t(s,i)))return a;throw new n("Can't convert object to primitive value")},Ih}var Hh={exports:{}},Ah,Vv;function Lo(){return Vv||(Vv=1,Ah=!1),Ah}var Ph,Wv;function Xm(){if(Wv)return Ph;Wv=1;var t=it(),e=Object.defineProperty;return Ph=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch{t[r]=n}return n},Ph}var Bv;function Zm(){if(Bv)return Hh.exports;Bv=1;var t=Lo(),e=it(),r=Xm(),n="__core-js_shared__",i=Hh.exports=e[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.43.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Hh.exports}var xh,$v;function nT(){if($v)return xh;$v=1;var t=Zm();return xh=function(e,r){return t[e]||(t[e]=r||{})},xh}var Nh,jv;function $s(){if(jv)return Nh;jv=1;var t=sl(),e=Object;return Nh=function(r){return e(t(r))},Nh}var Dh,zv;function Yr(){if(zv)return Dh;zv=1;var t=ot(),e=$s(),r=t({}.hasOwnProperty);return Dh=Object.hasOwn||function(i,o){return r(e(i),o)},Dh}var kh,Uv;function iT(){if(Uv)return kh;Uv=1;var t=ot(),e=0,r=Math.random(),n=t(1.1.toString);return kh=function(i){return"Symbol("+(i===void 0?"":i)+")_"+n(++e+r,36)},kh}var Lh,Yv;function pn(){if(Yv)return Lh;Yv=1;var t=it(),e=nT(),r=Yr(),n=iT(),i=Gm(),o=rT(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||n;return Lh=function(u){return r(a,u)||(a[u]=i&&r(s,u)?s[u]:l("Symbol."+u)),a[u]},Lh}var Fh,qv;function LH(){if(qv)return Fh;qv=1;var t=vt(),e=Ur(),r=Km(),n=ul(),i=kH(),o=pn(),s=TypeError,a=o("toPrimitive");return Fh=function(l,u){if(!e(l)||r(l))return l;var c=n(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||r(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},Fh}var Vh,Gv;function oT(){if(Gv)return Vh;Gv=1;var t=LH(),e=Km();return Vh=function(r){var n=t(r,"string");return e(n)?n:n+""},Vh}var Wh,Kv;function Qm(){if(Kv)return Wh;Kv=1;var t=it(),e=Ur(),r=t.document,n=e(r)&&e(r.createElement);return Wh=function(i){return n?r.createElement(i):{}},Wh}var Bh,Xv;function sT(){if(Xv)return Bh;Xv=1;var t=zr(),e=ct(),r=Qm();return Bh=!t&&!e(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7}),Bh}var Zv;function aT(){if(Zv)return ih;Zv=1;var t=zr(),e=vt(),r=xH(),n=fc(),i=al(),o=oT(),s=Yr(),a=sT(),l=Object.getOwnPropertyDescriptor;return ih.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return n(!e(r.f,c,h),c[h])},ih}var $h={},jh,Qv;function lT(){if(Qv)return jh;Qv=1;var t=zr(),e=ct();return jh=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),jh}var zh,Jv;function yt(){if(Jv)return zh;Jv=1;var t=Ur(),e=String,r=TypeError;return zh=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")},zh}var ey;function zi(){if(ey)return $h;ey=1;var t=zr(),e=sT(),r=lT(),n=yt(),i=oT(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return $h.f=t?r?function(f,g,p){if(n(f),g=i(g),n(p),typeof f=="function"&&g==="prototype"&&"value"in p&&c in p&&!p[c]){var v=a(f,g);v&&v[c]&&(f[g]=p.value,p={configurable:u in p?p[u]:v[u],enumerable:l in p?p[l]:v[l],writable:!1})}return s(f,g,p)}:s:function(f,g,p){if(n(f),g=i(g),n(p),e)try{return s(f,g,p)}catch{}if("get"in p||"set"in p)throw new o("Accessors not supported");return"value"in p&&(f[g]=p.value),f},$h}var Uh,ty;function js(){if(ty)return Uh;ty=1;var t=zr(),e=zi(),r=fc();return Uh=t?function(n,i,o){return e.f(n,i,r(1,o))}:function(n,i,o){return n[i]=o,n},Uh}var Yh={exports:{}},qh,ry;function FH(){if(ry)return qh;ry=1;var t=zr(),e=Yr(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,i=e(r,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&n(r,"name").configurable);return qh={EXISTS:i,PROPER:o,CONFIGURABLE:s},qh}var Gh,ny;function VH(){if(ny)return Gh;ny=1;var t=ot(),e=ht(),r=Zm(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(i){return n(i)}),Gh=r.inspectSource,Gh}var Kh,iy;function WH(){if(iy)return Kh;iy=1;var t=it(),e=ht(),r=t.WeakMap;return Kh=e(r)&&/native code/.test(String(r)),Kh}var Xh,oy;function Jm(){if(oy)return Xh;oy=1;var t=nT(),e=iT(),r=t("keys");return Xh=function(n){return r[n]||(r[n]=e(n))},Xh}var Zh,sy;function ep(){return sy||(sy=1,Zh={}),Zh}var Qh,ay;function uT(){if(ay)return Qh;ay=1;var t=WH(),e=it(),r=Ur(),n=js(),i=Yr(),o=Zm(),s=Jm(),a=ep(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,f,g,p=function(R){return g(R)?f(R):h(R,{})},v=function(R){return function(_){var b;if(!r(_)||(b=f(_)).type!==R)throw new u("Incompatible receiver, "+R+" required");return b}};if(t||o.state){var y=o.state||(o.state=new c);y.get=y.get,y.has=y.has,y.set=y.set,h=function(R,_){if(y.has(R))throw new u(l);return _.facade=R,y.set(R,_),_},f=function(R){return y.get(R)||{}},g=function(R){return y.has(R)}}else{var T=s("state");a[T]=!0,h=function(R,_){if(i(R,T))throw new u(l);return _.facade=R,n(R,T,_),_},f=function(R){return i(R,T)?R[T]:{}},g=function(R){return i(R,T)}}return Qh={set:h,get:f,has:g,enforce:p,getterFor:v},Qh}var ly;function cT(){if(ly)return Yh.exports;ly=1;var t=ot(),e=ct(),r=ht(),n=Yr(),i=zr(),o=FH().CONFIGURABLE,s=VH(),a=uT(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,f=t("".slice),g=t("".replace),p=t([].join),v=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),y=String(String).split("String"),T=Yh.exports=function(R,_,b){f(c(_),0,7)==="Symbol("&&(_="["+g(c(_),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),b&&b.getter&&(_="get "+_),b&&b.setter&&(_="set "+_),(!n(R,"name")||o&&R.name!==_)&&(i?h(R,"name",{value:_,configurable:!0}):R.name=_),v&&b&&n(b,"arity")&&R.length!==b.arity&&h(R,"length",{value:b.arity});try{b&&n(b,"constructor")&&b.constructor?i&&h(R,"prototype",{writable:!1}):R.prototype&&(R.prototype=void 0)}catch{}var M=l(R);return n(M,"source")||(M.source=p(y,typeof _=="string"?_:"")),R};return Function.prototype.toString=T(function(){return r(this)&&u(this).source||s(this)},"toString"),Yh.exports}var Jh,uy;function tp(){if(uy)return Jh;uy=1;var t=ht(),e=zi(),r=cT(),n=Xm();return Jh=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&r(s,u,a),a.global)l?i[o]=s:n(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},Jh}var ed={},td,cy;function BH(){if(cy)return td;cy=1;var t=Math.ceil,e=Math.floor;return td=Math.trunc||function(n){var i=+n;return(i>0?e:t)(i)},td}var rd,hy;function cl(){if(hy)return rd;hy=1;var t=BH();return rd=function(e){var r=+e;return r!==r||r===0?0:t(r)},rd}var nd,dy;function $H(){if(dy)return nd;dy=1;var t=cl(),e=Math.max,r=Math.min;return nd=function(n,i){var o=t(n);return o<0?e(o+i,0):r(o,i)},nd}var id,fy;function jH(){if(fy)return id;fy=1;var t=cl(),e=Math.min;return id=function(r){var n=t(r);return n>0?e(n,9007199254740991):0},id}var od,gy;function zs(){if(gy)return od;gy=1;var t=jH();return od=function(e){return t(e.length)},od}var sd,my;function zH(){if(my)return sd;my=1;var t=al(),e=$H(),r=zs(),n=function(i){return function(o,s,a){var l=t(o),u=r(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return sd={includes:n(!0),indexOf:n(!1)},sd}var ad,py;function hT(){if(py)return ad;py=1;var t=ot(),e=Yr(),r=al(),n=zH().indexOf,i=ep(),o=t([].push);return ad=function(s,a){var l=r(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~n(c,h)||o(c,h));return c},ad}var ld,wy;function rp(){return wy||(wy=1,ld=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),ld}var vy;function UH(){if(vy)return ed;vy=1;var t=hT(),e=rp(),r=e.concat("length","prototype");return ed.f=Object.getOwnPropertyNames||function(i){return t(i,r)},ed}var ud={},yy;function YH(){return yy||(yy=1,ud.f=Object.getOwnPropertySymbols),ud}var cd,by;function qH(){if(by)return cd;by=1;var t=Bs(),e=ot(),r=UH(),n=YH(),i=yt(),o=e([].concat);return cd=t("Reflect","ownKeys")||function(a){var l=r.f(i(a)),u=n.f;return u?o(l,u(a)):l},cd}var hd,Sy;function dT(){if(Sy)return hd;Sy=1;var t=Yr(),e=qH(),r=aT(),n=zi();return hd=function(i,o,s){for(var a=e(o),l=n.f,u=r.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},hd}var dd,Cy;function GH(){if(Cy)return dd;Cy=1;var t=ct(),e=ht(),r=/#|\.prototype\./,n=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=n.normalize=function(l){return String(l).replace(r,".").toLowerCase()},o=n.data={},s=n.NATIVE="N",a=n.POLYFILL="P";return dd=n,dd}var fd,Ry;function De(){if(Ry)return fd;Ry=1;var t=it(),e=aT().f,r=js(),n=tp(),i=Xm(),o=dT(),s=GH();return fd=function(a,l){var u=a.target,c=a.global,h=a.stat,f,g,p,v,y,T;if(c?g=t:h?g=t[u]||i(u,{}):g=t[u]&&t[u].prototype,g)for(p in l){if(y=l[p],a.dontCallGetSet?(T=e(g,p),v=T&&T.value):v=g[p],f=s(c?p:u+(h?".":"#")+p,a.forced),!f&&v!==void 0){if(typeof y==typeof v)continue;o(y,v)}(a.sham||v&&v.sham)&&r(y,"sham",!0),n(g,p,y,a)}},fd}var gd,Ey;function hl(){if(Ey)return gd;Ey=1;var t=dc(),e=Function.prototype,r=e.apply,n=e.call;return gd=typeof Reflect=="object"&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),gd}var md,Ty;function fT(){if(Ty)return md;Ty=1;var t=ot(),e=Tr();return md=function(r,n,i){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[i]))}catch{}},md}var pd,_y;function KH(){if(_y)return pd;_y=1;var t=Ur();return pd=function(e){return t(e)||e===null},pd}var wd,Oy;function XH(){if(Oy)return wd;Oy=1;var t=KH(),e=String,r=TypeError;return wd=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")},wd}var vd,My;function gT(){if(My)return vd;My=1;var t=fT(),e=Ur(),r=sl(),n=XH();return vd=Object.setPrototypeOf||("__proto__"in{}?(function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return r(l),n(u),e(l)&&(i?s(l,u):l.__proto__=u),l}})():void 0),vd}var yd,Iy;function ZH(){if(Iy)return yd;Iy=1;var t=zi().f;return yd=function(e,r,n){n in e||t(e,n,{configurable:!0,get:function(){return r[n]},set:function(i){r[n]=i}})},yd}var bd,Hy;function QH(){if(Hy)return bd;Hy=1;var t=ht(),e=Ur(),r=gT();return bd=function(n,i,o){var s,a;return r&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&r(n,a),n},bd}var Sd,Ay;function JH(){if(Ay)return Sd;Ay=1;var t=pn(),e=t("toStringTag"),r={};return r[e]="z",Sd=String(r)==="[object z]",Sd}var Cd,Py;function mT(){if(Py)return Cd;Py=1;var t=JH(),e=ht(),r=ko(),n=pn(),i=n("toStringTag"),o=Object,s=r((function(){return arguments})())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return Cd=t?r:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?r(u):(h=r(u))==="Object"&&e(u.callee)?"Arguments":h},Cd}var Rd,xy;function pc(){if(xy)return Rd;xy=1;var t=mT(),e=String;return Rd=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(r)},Rd}var Ed,Ny;function eA(){if(Ny)return Ed;Ny=1;var t=pc();return Ed=function(e,r){return e===void 0?arguments.length<2?"":r:t(e)},Ed}var Td,Dy;function tA(){if(Dy)return Td;Dy=1;var t=Ur(),e=js();return Td=function(r,n){t(n)&&"cause"in n&&e(r,"cause",n.cause)},Td}var _d,ky;function rA(){if(ky)return _d;ky=1;var t=ot(),e=Error,r=t("".replace),n=(function(s){return String(new e(s).stack)})("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(n);return _d=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=r(s,i,"");return s},_d}var Od,Ly;function nA(){if(Ly)return Od;Ly=1;var t=ct(),e=fc();return Od=!t(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",e(1,7)),r.stack!==7):!0}),Od}var Md,Fy;function iA(){if(Fy)return Md;Fy=1;var t=js(),e=rA(),r=nA(),n=Error.captureStackTrace;return Md=function(i,o,s,a){r&&(n?n(i,o):t(i,"stack",e(s,a)))},Md}var Id,Vy;function oA(){if(Vy)return Id;Vy=1;var t=Bs(),e=Yr(),r=js(),n=ll(),i=gT(),o=dT(),s=ZH(),a=QH(),l=eA(),u=tA(),c=iA(),h=zr(),f=Lo();return Id=function(g,p,v,y){var T="stackTraceLimit",R=y?2:1,_=g.split("."),b=_[_.length-1],M=t.apply(null,_);if(M){var P=M.prototype;if(!f&&e(P,"cause")&&delete P.cause,!v)return M;var A=t("Error"),D=p(function(V,B){var q=l(y?B:V,void 0),L=y?new M(V):new M;return q!==void 0&&r(L,"message",q),c(L,D,L.stack,2),this&&n(P,this)&&a(L,this,D),arguments.length>R&&u(L,arguments[R]),L});if(D.prototype=P,b!=="Error"?i?i(D,A):o(D,A,{name:!0}):h&&T in M&&(s(D,M,T),s(D,M,"prepareStackTrace")),o(D,M),!f)try{P.name!==b&&r(P,"name",b),P.constructor=D}catch{}return D}},Id}var Wy;function sA(){if(Wy)return dv;Wy=1;var t=De(),e=it(),r=hl(),n=oA(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=n(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=n(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return r(u,this,arguments)}}),a("EvalError",function(u){return function(h){return r(u,this,arguments)}}),a("RangeError",function(u){return function(h){return r(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return r(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return r(u,this,arguments)}}),a("TypeError",function(u){return function(h){return r(u,this,arguments)}}),a("URIError",function(u){return function(h){return r(u,this,arguments)}}),l("CompileError",function(u){return function(h){return r(u,this,arguments)}}),l("LinkError",function(u){return function(h){return r(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return r(u,this,arguments)}}),dv}sA();var By={},Hd,$y;function pT(){if($y)return Hd;$y=1;var t=ko();return Hd=Array.isArray||function(r){return t(r)==="Array"},Hd}var Ad,jy;function wT(){if(jy)return Ad;jy=1;var t=zr(),e=pT(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=t&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}})();return Ad=i?function(o,s){if(e(o)&&!n(o,"length").writable)throw new r("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},Ad}var Pd,zy;function vT(){if(zy)return Pd;zy=1;var t=TypeError,e=9007199254740991;return Pd=function(r){if(r>e)throw t("Maximum allowed index exceeded");return r},Pd}var Uy;function aA(){if(Uy)return By;Uy=1;var t=De(),e=$s(),r=zs(),n=wT(),i=vT(),o=ct(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),f=r(h),g=arguments.length;i(f+g);for(var p=0;p<g;p++)h[f]=arguments[p],f++;return n(h,f),f}}),By}aA();var Yy={},xd,qy;function lA(){if(qy)return xd;qy=1;var t=ko(),e=ot();return xd=function(r){if(t(r)==="Function")return e(r)},xd}var Nd,Gy;function yT(){if(Gy)return Nd;Gy=1;var t=lA(),e=Tr(),r=dc(),n=t(t.bind);return Nd=function(i,o){return e(i),o===void 0?i:r?n(i,o):function(){return i.apply(o,arguments)}},Nd}var Dd,Ky;function bT(){return Ky||(Ky=1,Dd={}),Dd}var kd,Xy;function uA(){if(Xy)return kd;Xy=1;var t=pn(),e=bT(),r=t("iterator"),n=Array.prototype;return kd=function(i){return i!==void 0&&(e.Array===i||n[r]===i)},kd}var Ld,Zy;function ST(){if(Zy)return Ld;Zy=1;var t=mT(),e=ul(),r=qm(),n=bT(),i=pn(),o=i("iterator");return Ld=function(s){if(!r(s))return e(s,o)||e(s,"@@iterator")||n[t(s)]},Ld}var Fd,Qy;function cA(){if(Qy)return Fd;Qy=1;var t=vt(),e=Tr(),r=yt(),n=mc(),i=ST(),o=TypeError;return Fd=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return r(t(l,s));throw new o(n(s)+" is not iterable")},Fd}var Vd,Jy;function _r(){if(Jy)return Vd;Jy=1;var t=vt(),e=yt(),r=ul();return Vd=function(n,i,o){var s,a;e(n);try{if(s=r(n,"return"),!s){if(i==="throw")throw o;return o}s=t(s,n)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},Vd}var Wd,eb;function Us(){if(eb)return Wd;eb=1;var t=yT(),e=vt(),r=yt(),n=mc(),i=uA(),o=zs(),s=ll(),a=cA(),l=ST(),u=_r(),c=TypeError,h=function(g,p){this.stopped=g,this.result=p},f=h.prototype;return Wd=function(g,p,v){var y=v&&v.that,T=!!(v&&v.AS_ENTRIES),R=!!(v&&v.IS_RECORD),_=!!(v&&v.IS_ITERATOR),b=!!(v&&v.INTERRUPTED),M=t(p,y),P,A,D,V,B,q,L,ae=function(ee){return P&&u(P,"normal"),new h(!0,ee)},G=function(ee){return T?(r(ee),b?M(ee[0],ee[1],ae):M(ee[0],ee[1])):b?M(ee,ae):M(ee)};if(R)P=g.iterator;else if(_)P=g;else{if(A=l(g),!A)throw new c(n(g)+" is not iterable");if(i(A)){for(D=0,V=o(g);V>D;D++)if(B=G(g[D]),B&&s(f,B))return B;return new h(!1)}P=a(g,A)}for(q=R?g.next:P.next;!(L=e(q,P)).done;){try{B=G(L.value)}catch(ee){u(P,"throw",ee)}if(typeof B=="object"&&B&&s(f,B))return B}return new h(!1)},Wd}var Bd,tb;function CT(){if(tb)return Bd;tb=1;var t=zr(),e=zi(),r=fc();return Bd=function(n,i,o){t?e.f(n,i,r(0,o)):n[i]=o},Bd}var rb;function hA(){if(rb)return Yy;rb=1;var t=De(),e=Us(),r=CT();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){r(o,s,a)},{AS_ENTRIES:!0}),o}}),Yy}hA();var nb={},$d,ib;function Ln(){if(ib)return $d;ib=1;var t=ot(),e=Set.prototype;return $d={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},$d}var jd,ob;function Fo(){if(ob)return jd;ob=1;var t=Ln().has;return jd=function(e){return t(e),e},jd}var zd,sb;function Vo(){if(sb)return zd;sb=1;var t=vt();return zd=function(e,r,n){for(var i=n?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=r(s.value),a!==void 0)return a},zd}var Ud,ab;function dl(){if(ab)return Ud;ab=1;var t=ot(),e=Vo(),r=Ln(),n=r.Set,i=r.proto,o=t(i.forEach),s=t(i.keys),a=s(new n).next;return Ud=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},Ud}var Yd,lb;function np(){if(lb)return Yd;lb=1;var t=Ln(),e=dl(),r=t.Set,n=t.add;return Yd=function(i){var o=new r;return e(i,function(s){n(o,s)}),o},Yd}var qd,ub;function fl(){if(ub)return qd;ub=1;var t=fT(),e=Ln();return qd=t(e.proto,"size","get")||function(r){return r.size},qd}var Gd,cb;function Ui(){return cb||(cb=1,Gd=function(t){return{iterator:t,next:t.next,done:!1}}),Gd}var Kd,hb;function Wo(){if(hb)return Kd;hb=1;var t=Tr(),e=yt(),r=vt(),n=cl(),i=Ui(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(r(this.keys,this.set)))},includes:function(c){return r(this.has,this.set,c)}},Kd=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var f=n(h);if(f<0)throw new s(o);return new u(c,f)},Kd}var Xd,db;function dA(){if(db)return Xd;db=1;var t=Fo(),e=Ln(),r=np(),n=fl(),i=Wo(),o=dl(),s=Vo(),a=e.has,l=e.remove;return Xd=function(c){var h=t(this),f=i(c),g=r(h);return n(h)<=f.size?o(h,function(p){f.includes(p)&&l(g,p)}):s(f.getIterator(),function(p){a(g,p)&&l(g,p)}),g},Xd}var Zd,fb;function Bo(){if(fb)return Zd;fb=1;var t=Bs(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return Zd=function(n,i){var o=t("Set");try{new o()[n](e(0));try{return new o()[n](e(-1)),!1}catch{if(!i)return!0;try{return new o()[n](r(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[n](r(1/0)))}}}catch{return!1}},Zd}var gb;function fA(){if(gb)return nb;gb=1;var t=De(),e=dA(),r=ct(),n=Bo(),i=!n("difference",function(s){return s.size===0}),o=i||r(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),nb}fA();var mb={},Qd,pb;function gA(){if(pb)return Qd;pb=1;var t=Fo(),e=Ln(),r=fl(),n=Wo(),i=dl(),o=Vo(),s=e.Set,a=e.add,l=e.has;return Qd=function(c){var h=t(this),f=n(c),g=new s;return r(h)>f.size?o(f.getIterator(),function(p){l(h,p)&&a(g,p)}):i(h,function(p){f.includes(p)&&a(g,p)}),g},Qd}var wb;function mA(){if(wb)return mb;wb=1;var t=De(),e=ct(),r=gA(),n=Bo(),i=!n("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:r}),mb}mA();var vb={},Jd,yb;function pA(){if(yb)return Jd;yb=1;var t=Fo(),e=Ln().has,r=fl(),n=Wo(),i=dl(),o=Vo(),s=_r();return Jd=function(l){var u=t(this),c=n(l);if(r(u)<=c.size)return i(u,function(f){if(c.includes(f))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(f){if(e(u,f))return s(h,"normal",!1)})!==!1},Jd}var bb;function wA(){if(bb)return vb;bb=1;var t=De(),e=pA(),r=Bo(),n=!r("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),vb}wA();var Sb={},ef,Cb;function vA(){if(Cb)return ef;Cb=1;var t=Fo(),e=fl(),r=dl(),n=Wo();return ef=function(o){var s=t(this),a=n(o);return e(s)>a.size?!1:r(s,function(l){if(!a.includes(l))return!1},!0)!==!1},ef}var Rb;function yA(){if(Rb)return Sb;Rb=1;var t=De(),e=vA(),r=Bo(),n=!r("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),Sb}yA();var Eb={},tf,Tb;function bA(){if(Tb)return tf;Tb=1;var t=Fo(),e=Ln().has,r=fl(),n=Wo(),i=Vo(),o=_r();return tf=function(a){var l=t(this),u=n(a);if(r(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},tf}var _b;function SA(){if(_b)return Eb;_b=1;var t=De(),e=bA(),r=Bo(),n=!r("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),Eb}SA();var Ob={},rf,Mb;function CA(){if(Mb)return rf;Mb=1;var t=Fo(),e=Ln(),r=np(),n=Wo(),i=Vo(),o=e.add,s=e.has,a=e.remove;return rf=function(u){var c=t(this),h=n(u).getIterator(),f=r(c);return i(h,function(g){s(c,g)?a(f,g):o(f,g)}),f},rf}var nf,Ib;function RT(){return Ib||(Ib=1,nf=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size!==1||n.values().next().value!==4}catch{return!1}}),nf}var Hb;function RA(){if(Hb)return Ob;Hb=1;var t=De(),e=CA(),r=RT(),n=Bo(),i=!n("symmetricDifference")||!r("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),Ob}RA();var Ab={},of,Pb;function EA(){if(Pb)return of;Pb=1;var t=Fo(),e=Ln().add,r=np(),n=Wo(),i=Vo();return of=function(s){var a=t(this),l=n(s).getIterator(),u=r(a);return i(l,function(c){e(u,c)}),u},of}var xb;function TA(){if(xb)return Ab;xb=1;var t=De(),e=EA(),r=RT(),n=Bo(),i=!n("union")||!r("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),Ab}TA();var Nb={},Db={},sf,kb;function _A(){if(kb)return sf;kb=1;var t=ll(),e=TypeError;return sf=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")},sf}var af,Lb;function OA(){if(Lb)return af;Lb=1;var t=ct();return af=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),af}var lf,Fb;function ET(){if(Fb)return lf;Fb=1;var t=Yr(),e=ht(),r=$s(),n=Jm(),i=OA(),o=n("IE_PROTO"),s=Object,a=s.prototype;return lf=i?s.getPrototypeOf:function(l){var u=r(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},lf}var uf,Vb;function MA(){if(Vb)return uf;Vb=1;var t=cT(),e=zi();return uf=function(r,n,i){return i.get&&t(i.get,n,{getter:!0}),i.set&&t(i.set,n,{setter:!0}),e.f(r,n,i)},uf}var cf={},hf,Wb;function IA(){if(Wb)return hf;Wb=1;var t=hT(),e=rp();return hf=Object.keys||function(n){return t(n,e)},hf}var Bb;function HA(){if(Bb)return cf;Bb=1;var t=zr(),e=lT(),r=zi(),n=yt(),i=al(),o=IA();return cf.f=t&&!e?Object.defineProperties:function(a,l){n(a);for(var u=i(l),c=o(l),h=c.length,f=0,g;h>f;)r.f(a,g=c[f++],u[g]);return a},cf}var df,$b;function TT(){if($b)return df;$b=1;var t=Bs();return df=t("document","documentElement"),df}var ff,jb;function ip(){if(jb)return ff;jb=1;var t=yt(),e=HA(),r=rp(),n=ep(),i=TT(),o=Qm(),s=Jm(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),f=function(){},g=function(R){return l+c+a+R+l+"/"+c+a},p=function(R){R.write(g("")),R.close();var _=R.parentWindow.Object;return R=null,_},v=function(){var R=o("iframe"),_="java"+c+":",b;return R.style.display="none",i.appendChild(R),R.src=String(_),b=R.contentWindow.document,b.open(),b.write(g("document.F=Object")),b.close(),b.F},y,T=function(){try{y=new ActiveXObject("htmlfile")}catch{}T=typeof document<"u"?document.domain&&y?p(y):v():p(y);for(var R=r.length;R--;)delete T[u][r[R]];return T()};return n[h]=!0,ff=Object.create||function(_,b){var M;return _!==null?(f[u]=t(_),M=new f,f[u]=null,M[h]=_):M=T(),b===void 0?M:e.f(M,b)},ff}var gf,zb;function _T(){if(zb)return gf;zb=1;var t=ct(),e=ht(),r=Ur(),n=ip(),i=ET(),o=tp(),s=pn(),a=Lo(),l=s("iterator"),u=!1,c,h,f;[].keys&&(f=[].keys(),"next"in f?(h=i(i(f)),h!==Object.prototype&&(c=h)):u=!0);var g=!r(c)||t(function(){var p={};return c[l].call(p)!==p});return g?c={}:a&&(c=n(c)),e(c[l])||o(c,l,function(){return this}),gf={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},gf}var Ub;function AA(){if(Ub)return Db;Ub=1;var t=De(),e=it(),r=_A(),n=yt(),i=ht(),o=ET(),s=MA(),a=CT(),l=ct(),u=Yr(),c=pn(),h=_T().IteratorPrototype,f=zr(),g=Lo(),p="constructor",v="Iterator",y=c("toStringTag"),T=TypeError,R=e[v],_=g||!i(R)||R.prototype!==h||!l(function(){R({})}),b=function(){if(r(this,h),o(this)===h)throw new T("Abstract class Iterator not directly constructable")},M=function(P,A){f?s(h,P,{configurable:!0,get:function(){return A},set:function(D){if(n(this),this===h)throw new T("You can't redefine this property");u(this,P)?this[P]=D:a(this,P,D)}}):h[P]=A};return u(h,y)||M(y,v),(_||!u(h,p)||h[p]===Object)&&M(p,b),b.prototype=h,t({global:!0,constructor:!0,forced:_},{Iterator:b}),Db}var Yb;function PA(){return Yb||(Yb=1,AA()),Nb}PA();var qb={},Gb={},mf,Kb;function xA(){if(Kb)return mf;Kb=1;var t=tp();return mf=function(e,r,n){for(var i in r)t(e,i,r[i],n);return e},mf}var pf,Xb;function NA(){return Xb||(Xb=1,pf=function(t,e){return{value:t,done:e}}),pf}var wf,Zb;function DA(){if(Zb)return wf;Zb=1;var t=_r();return wf=function(e,r,n){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{n=t(e[i].iterator,r,n)}catch(o){r="throw",n=o}if(r==="throw")throw n;return n},wf}var vf,Qb;function OT(){if(Qb)return vf;Qb=1;var t=vt(),e=ip(),r=js(),n=xA(),i=pn(),o=uT(),s=ul(),a=_T().IteratorPrototype,l=NA(),u=_r(),c=DA(),h=i("toStringTag"),f="IteratorHelper",g="WrapForValidIterator",p="normal",v="throw",y=o.set,T=function(b){var M=o.getterFor(b?g:f);return n(e(a),{next:function(){var A=M(this);if(b)return A.nextHandler();if(A.done)return l(void 0,!0);try{var D=A.nextHandler();return A.returnHandlerResult?D:l(D,A.done)}catch(V){throw A.done=!0,V}},return:function(){var P=M(this),A=P.iterator;if(P.done=!0,b){var D=s(A,"return");return D?t(D,A):l(void 0,!0)}if(P.inner)try{u(P.inner.iterator,p)}catch(V){return u(A,v,V)}if(P.openIters)try{c(P.openIters,p)}catch(V){return u(A,v,V)}return A&&u(A,p),l(void 0,!0)}})},R=T(!0),_=T(!1);return r(_,h,"Iterator Helper"),vf=function(b,M,P){var A=function(V,B){B?(B.iterator=V.iterator,B.next=V.next):B=V,B.type=M?g:f,B.returnHandlerResult=!!P,B.nextHandler=b,B.counter=0,B.done=!1,y(this,B)};return A.prototype=M?R:_,A},vf}var yf,Jb;function MT(){if(Jb)return yf;Jb=1;var t=yt(),e=_r();return yf=function(r,n,i,o){try{return o?n(t(i)[0],i[1]):n(i)}catch(s){e(r,"throw",s)}},yf}var bf,eS;function IT(){return eS||(eS=1,bf=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}}),bf}var Sf,tS;function $o(){if(tS)return Sf;tS=1;var t=it();return Sf=function(e,r){var n=t.Iterator,i=n&&n.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof r||(s=!1)}if(!s)return o},Sf}var rS;function kA(){if(rS)return Gb;rS=1;var t=De(),e=vt(),r=Tr(),n=yt(),i=Ui(),o=OT(),s=MT(),a=Lo(),l=_r(),u=IT(),c=$o(),h=!a&&!u("filter",function(){}),f=!a&&!h&&c("filter",TypeError),g=a||h||f,p=o(function(){for(var v=this.iterator,y=this.predicate,T=this.next,R,_,b;;){if(R=n(e(T,v)),_=this.done=!!R.done,_)return;if(b=R.value,s(v,y,[b,this.counter++],!0))return b}});return t({target:"Iterator",proto:!0,real:!0,forced:g},{filter:function(y){n(this);try{r(y)}catch(T){l(this,"throw",T)}return f?e(f,this,y):new p(i(this),{predicate:y})}}),Gb}var nS;function LA(){return nS||(nS=1,kA()),qb}LA();var iS={},oS={},sS;function FA(){if(sS)return oS;sS=1;var t=De(),e=vt(),r=Us(),n=Tr(),i=yt(),o=Ui(),s=_r(),a=$o(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),f=0;r(h,function(g){c(g,f++)},{IS_RECORD:!0})}}),oS}var aS;function VA(){return aS||(aS=1,FA()),iS}VA();var lS={},uS={},cS;function WA(){if(cS)return uS;cS=1;var t=De(),e=vt(),r=Tr(),n=yt(),i=Ui(),o=OT(),s=MT(),a=_r(),l=IT(),u=$o(),c=Lo(),h=!c&&!l("map",function(){}),f=!c&&!h&&u("map",TypeError),g=c||h||f,p=o(function(){var v=this.iterator,y=n(e(this.next,v)),T=this.done=!!y.done;if(!T)return s(v,this.mapper,[y.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:g},{map:function(y){n(this);try{r(y)}catch(T){a(this,"throw",T)}return f?e(f,this,y):new p(i(this),{mapper:y})}}),uS}var hS;function BA(){return hS||(hS=1,WA()),lS}BA();var dS={},fS={},Cf,gS;function op(){if(gS)return Cf;gS=1;var t=ot();return Cf=t([].slice),Cf}var Rf,mS;function HT(){if(mS)return Rf;mS=1;var t=TypeError;return Rf=function(e,r){if(e<r)throw new t("Not enough arguments");return e},Rf}var Ef,pS;function $A(){if(pS)return Ef;pS=1;var t=gc();return Ef=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),Ef}var Tf,wS;function AT(){if(wS)return Tf;wS=1;var t=it(),e=gc(),r=ko(),n=function(i){return e.slice(0,i.length)===i};return Tf=(function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"})(),Tf}var _f,vS;function jA(){if(vS)return _f;vS=1;var t=AT();return _f=t==="NODE",_f}var Of,yS;function PT(){if(yS)return Of;yS=1;var t=it(),e=hl(),r=yT(),n=ht(),i=Yr(),o=ct(),s=TT(),a=op(),l=Qm(),u=HT(),c=$A(),h=jA(),f=t.setImmediate,g=t.clearImmediate,p=t.process,v=t.Dispatch,y=t.Function,T=t.MessageChannel,R=t.String,_=0,b={},M="onreadystatechange",P,A,D,V;o(function(){P=t.location});var B=function(G){if(i(b,G)){var ee=b[G];delete b[G],ee()}},q=function(G){return function(){B(G)}},L=function(G){B(G.data)},ae=function(G){t.postMessage(R(G),P.protocol+"//"+P.host)};return(!f||!g)&&(f=function(ee){u(arguments.length,1);var st=n(ee)?ee:y(ee),Re=a(arguments,1);return b[++_]=function(){e(st,void 0,Re)},A(_),_},g=function(ee){delete b[ee]},h?A=function(G){p.nextTick(q(G))}:v&&v.now?A=function(G){v.now(q(G))}:T&&!c?(D=new T,V=D.port2,D.port1.onmessage=L,A=r(V.postMessage,V)):t.addEventListener&&n(t.postMessage)&&!t.importScripts&&P&&P.protocol!=="file:"&&!o(ae)?(A=ae,t.addEventListener("message",L,!1)):M in l("script")?A=function(G){s.appendChild(l("script"))[M]=function(){s.removeChild(this),B(G)}}:A=function(G){setTimeout(q(G),0)}),Of={set:f,clear:g},Of}var bS;function zA(){if(bS)return fS;bS=1;var t=De(),e=it(),r=PT().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==r},{clearImmediate:r}),fS}var SS={},Mf,CS;function UA(){if(CS)return Mf;CS=1;var t=it(),e=hl(),r=ht(),n=AT(),i=gc(),o=op(),s=HT(),a=t.Function,l=/MSIE .\./.test(i)||n==="BUN"&&(function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")})();return Mf=function(u,c){var h=c?2:1;return l?function(f,g){var p=s(arguments.length,1)>h,v=r(f)?f:a(f),y=p?o(arguments,h):[],T=p?function(){e(v,this,y)}:v;return c?u(T,g):u(T)}:u},Mf}var RS;function YA(){if(RS)return SS;RS=1;var t=De(),e=it(),r=PT().set,n=UA(),i=e.setImmediate?n(r,!1):r;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),SS}var ES;function qA(){return ES||(ES=1,zA(),YA()),dS}qA();const{entries:xT,setPrototypeOf:TS,isFrozen:GA,getPrototypeOf:KA,getOwnPropertyDescriptor:XA}=Object;let{freeze:Yt,seal:$r,create:NT}=Object,{apply:tm,construct:rm}=typeof Reflect<"u"&&Reflect;Yt||(Yt=function(e){return e});$r||($r=function(e){return e});tm||(tm=function(e,r,n){return e.apply(r,n)});rm||(rm=function(e,r){return new e(...r)});const Hl=qt(Array.prototype.forEach),ZA=qt(Array.prototype.lastIndexOf),_S=qt(Array.prototype.pop),ta=qt(Array.prototype.push),QA=qt(Array.prototype.splice),Su=qt(String.prototype.toLowerCase),If=qt(String.prototype.toString),OS=qt(String.prototype.match),ra=qt(String.prototype.replace),JA=qt(String.prototype.indexOf),eP=qt(String.prototype.trim),on=qt(Object.prototype.hasOwnProperty),Vt=qt(RegExp.prototype.test),na=tP(TypeError);function qt(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return tm(t,e,n)}}function tP(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return rm(t,r)}}function ce(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Su;TS&&TS(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const o=r(i);o!==i&&(GA(e)||(e[n]=o),i=o)}t[i]=!0}return t}function rP(t){for(let e=0;e<t.length;e++)on(t,e)||(t[e]=null);return t}function ti(t){const e=NT(null);for(const[r,n]of xT(t))on(t,r)&&(Array.isArray(n)?e[r]=rP(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=ti(n):e[r]=n);return e}function ia(t,e){for(;t!==null;){const n=XA(t,e);if(n){if(n.get)return qt(n.get);if(typeof n.value=="function")return qt(n.value)}t=KA(t)}function r(){return null}return r}const MS=Yt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Hf=Yt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Af=Yt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),nP=Yt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Pf=Yt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),iP=Yt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),IS=Yt(["#text"]),HS=Yt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),xf=Yt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),AS=Yt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Al=Yt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),oP=$r(/\{\{[\w\W]*|[\w\W]*\}\}/gm),sP=$r(/<%[\w\W]*|[\w\W]*%>/gm),aP=$r(/\$\{[\w\W]*/gm),lP=$r(/^data-[\-\w.\u00B7-\uFFFF]+$/),uP=$r(/^aria-[\-\w]+$/),DT=$r(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),cP=$r(/^(?:\w+script|data):/i),hP=$r(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),kT=$r(/^html$/i),dP=$r(/^[a-z][.\w]*(-[.\w]+)+$/i);var PS=Object.freeze({__proto__:null,ARIA_ATTR:uP,ATTR_WHITESPACE:hP,CUSTOM_ELEMENT:dP,DATA_ATTR:lP,DOCTYPE_NAME:kT,ERB_EXPR:sP,IS_ALLOWED_URI:DT,IS_SCRIPT_OR_DATA:cP,MUSTACHE_EXPR:oP,TMPLIT_EXPR:aP});const oa={element:1,text:3,progressingInstruction:7,comment:8,document:9},fP=function(){return typeof window>"u"?null:window},gP=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},xS=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function LT(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fP();const e=X=>LT(X);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==oa.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:f,trustedTypes:g}=t,p=l.prototype,v=ia(p,"cloneNode"),y=ia(p,"remove"),T=ia(p,"nextSibling"),R=ia(p,"childNodes"),_=ia(p,"parentNode");if(typeof s=="function"){const X=r.createElement("template");X.content&&X.content.ownerDocument&&(r=X.content.ownerDocument)}let b,M="";const{implementation:P,createNodeIterator:A,createDocumentFragment:D,getElementsByTagName:V}=r,{importNode:B}=n;let q=xS();e.isSupported=typeof xT=="function"&&typeof _=="function"&&P&&P.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:L,ERB_EXPR:ae,TMPLIT_EXPR:G,DATA_ATTR:ee,ARIA_ATTR:st,IS_SCRIPT_OR_DATA:Re,ATTR_WHITESPACE:Ee,CUSTOM_ELEMENT:$e}=PS;let{IS_ALLOWED_URI:Fe}=PS,Ie=null;const Kr=ce({},[...MS,...Hf,...Af,...Pf,...IS]);let Te=null;const Gt=ce({},[...HS,...xf,...AS,...Al]);let d=Object.seal(NT(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),m=null,w=null,C=!0,S=!0,O=!1,H=!0,x=!1,j=!0,F=!1,I=!1,Q=!1,te=!1,de=!1,Ze=!1,Mt=!0,bt=!1;const kt="user-content-";let Ne=!0,Ue=!1,St={},Lt=null;const $n=ce({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let jn=null;const Ft=ce({},["audio","video","img","source","image","track"]);let gt=null;const Mr=ce({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),yn="http://www.w3.org/1998/Math/MathML",Xr="http://www.w3.org/2000/svg",Ir="http://www.w3.org/1999/xhtml";let zn=Ir,qi=!1,hr=null;const qo=ce({},[yn,Xr,Ir],If);let Zr=ce({},["mi","mo","mn","ms","mtext"]),bn=ce({},["annotation-xml"]);const Qs=ce({},["title","style","font","a","script"]);let It=null;const dr=["application/xhtml+xml","text/html"],_l="text/html";let Qe=null,Go=null;const qM=r.createElement("form"),$w=function(E){return E instanceof RegExp||E instanceof Function},Zc=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Go&&Go===E)){if((!E||typeof E!="object")&&(E={}),E=ti(E),It=dr.indexOf(E.PARSER_MEDIA_TYPE)===-1?_l:E.PARSER_MEDIA_TYPE,Qe=It==="application/xhtml+xml"?If:Su,Ie=on(E,"ALLOWED_TAGS")?ce({},E.ALLOWED_TAGS,Qe):Kr,Te=on(E,"ALLOWED_ATTR")?ce({},E.ALLOWED_ATTR,Qe):Gt,hr=on(E,"ALLOWED_NAMESPACES")?ce({},E.ALLOWED_NAMESPACES,If):qo,gt=on(E,"ADD_URI_SAFE_ATTR")?ce(ti(Mr),E.ADD_URI_SAFE_ATTR,Qe):Mr,jn=on(E,"ADD_DATA_URI_TAGS")?ce(ti(Ft),E.ADD_DATA_URI_TAGS,Qe):Ft,Lt=on(E,"FORBID_CONTENTS")?ce({},E.FORBID_CONTENTS,Qe):$n,m=on(E,"FORBID_TAGS")?ce({},E.FORBID_TAGS,Qe):ti({}),w=on(E,"FORBID_ATTR")?ce({},E.FORBID_ATTR,Qe):ti({}),St=on(E,"USE_PROFILES")?E.USE_PROFILES:!1,C=E.ALLOW_ARIA_ATTR!==!1,S=E.ALLOW_DATA_ATTR!==!1,O=E.ALLOW_UNKNOWN_PROTOCOLS||!1,H=E.ALLOW_SELF_CLOSE_IN_ATTR!==!1,x=E.SAFE_FOR_TEMPLATES||!1,j=E.SAFE_FOR_XML!==!1,F=E.WHOLE_DOCUMENT||!1,te=E.RETURN_DOM||!1,de=E.RETURN_DOM_FRAGMENT||!1,Ze=E.RETURN_TRUSTED_TYPE||!1,Q=E.FORCE_BODY||!1,Mt=E.SANITIZE_DOM!==!1,bt=E.SANITIZE_NAMED_PROPS||!1,Ne=E.KEEP_CONTENT!==!1,Ue=E.IN_PLACE||!1,Fe=E.ALLOWED_URI_REGEXP||DT,zn=E.NAMESPACE||Ir,Zr=E.MATHML_TEXT_INTEGRATION_POINTS||Zr,bn=E.HTML_INTEGRATION_POINTS||bn,d=E.CUSTOM_ELEMENT_HANDLING||{},E.CUSTOM_ELEMENT_HANDLING&&$w(E.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(d.tagNameCheck=E.CUSTOM_ELEMENT_HANDLING.tagNameCheck),E.CUSTOM_ELEMENT_HANDLING&&$w(E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(d.attributeNameCheck=E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),E.CUSTOM_ELEMENT_HANDLING&&typeof E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(d.allowCustomizedBuiltInElements=E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),x&&(S=!1),de&&(te=!0),St&&(Ie=ce({},IS),Te=[],St.html===!0&&(ce(Ie,MS),ce(Te,HS)),St.svg===!0&&(ce(Ie,Hf),ce(Te,xf),ce(Te,Al)),St.svgFilters===!0&&(ce(Ie,Af),ce(Te,xf),ce(Te,Al)),St.mathMl===!0&&(ce(Ie,Pf),ce(Te,AS),ce(Te,Al))),E.ADD_TAGS&&(Ie===Kr&&(Ie=ti(Ie)),ce(Ie,E.ADD_TAGS,Qe)),E.ADD_ATTR&&(Te===Gt&&(Te=ti(Te)),ce(Te,E.ADD_ATTR,Qe)),E.ADD_URI_SAFE_ATTR&&ce(gt,E.ADD_URI_SAFE_ATTR,Qe),E.FORBID_CONTENTS&&(Lt===$n&&(Lt=ti(Lt)),ce(Lt,E.FORBID_CONTENTS,Qe)),Ne&&(Ie["#text"]=!0),F&&ce(Ie,["html","head","body"]),Ie.table&&(ce(Ie,["tbody"]),delete m.tbody),E.TRUSTED_TYPES_POLICY){if(typeof E.TRUSTED_TYPES_POLICY.createHTML!="function")throw na('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof E.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw na('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');b=E.TRUSTED_TYPES_POLICY,M=b.createHTML("")}else b===void 0&&(b=gP(g,i)),b!==null&&typeof M=="string"&&(M=b.createHTML(""));Yt&&Yt(E),Go=E}},jw=ce({},[...Hf,...Af,...nP]),zw=ce({},[...Pf,...iP]),GM=function(E){let k=_(E);(!k||!k.tagName)&&(k={namespaceURI:zn,tagName:"template"});const Y=Su(E.tagName),Ve=Su(k.tagName);return hr[E.namespaceURI]?E.namespaceURI===Xr?k.namespaceURI===Ir?Y==="svg":k.namespaceURI===yn?Y==="svg"&&(Ve==="annotation-xml"||Zr[Ve]):!!jw[Y]:E.namespaceURI===yn?k.namespaceURI===Ir?Y==="math":k.namespaceURI===Xr?Y==="math"&&bn[Ve]:!!zw[Y]:E.namespaceURI===Ir?k.namespaceURI===Xr&&!bn[Ve]||k.namespaceURI===yn&&!Zr[Ve]?!1:!zw[Y]&&(Qs[Y]||!jw[Y]):!!(It==="application/xhtml+xml"&&hr[E.namespaceURI]):!1},Sn=function(E){ta(e.removed,{element:E});try{_(E).removeChild(E)}catch{y(E)}},Ko=function(E,k){try{ta(e.removed,{attribute:k.getAttributeNode(E),from:k})}catch{ta(e.removed,{attribute:null,from:k})}if(k.removeAttribute(E),E==="is")if(te||de)try{Sn(k)}catch{}else try{k.setAttribute(E,"")}catch{}},Uw=function(E){let k=null,Y=null;if(Q)E="<remove></remove>"+E;else{const dt=OS(E,/^[\r\n\t ]+/);Y=dt&&dt[0]}It==="application/xhtml+xml"&&zn===Ir&&(E='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+E+"</body></html>");const Ve=b?b.createHTML(E):E;if(zn===Ir)try{k=new f().parseFromString(Ve,It)}catch{}if(!k||!k.documentElement){k=P.createDocument(zn,"template",null);try{k.documentElement.innerHTML=qi?M:Ve}catch{}}const Ht=k.body||k.documentElement;return E&&Y&&Ht.insertBefore(r.createTextNode(Y),Ht.childNodes[0]||null),zn===Ir?V.call(k,F?"html":"body")[0]:F?k.documentElement:Ht},Yw=function(E){return A.call(E.ownerDocument||E,E,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Qc=function(E){return E instanceof h&&(typeof E.nodeName!="string"||typeof E.textContent!="string"||typeof E.removeChild!="function"||!(E.attributes instanceof c)||typeof E.removeAttribute!="function"||typeof E.setAttribute!="function"||typeof E.namespaceURI!="string"||typeof E.insertBefore!="function"||typeof E.hasChildNodes!="function")},qw=function(E){return typeof a=="function"&&E instanceof a};function Un(X,E,k){Hl(X,Y=>{Y.call(e,E,k,Go)})}const Gw=function(E){let k=null;if(Un(q.beforeSanitizeElements,E,null),Qc(E))return Sn(E),!0;const Y=Qe(E.nodeName);if(Un(q.uponSanitizeElement,E,{tagName:Y,allowedTags:Ie}),j&&E.hasChildNodes()&&!qw(E.firstElementChild)&&Vt(/<[/\w!]/g,E.innerHTML)&&Vt(/<[/\w!]/g,E.textContent)||E.nodeType===oa.progressingInstruction||j&&E.nodeType===oa.comment&&Vt(/<[/\w]/g,E.data))return Sn(E),!0;if(!Ie[Y]||m[Y]){if(!m[Y]&&Xw(Y)&&(d.tagNameCheck instanceof RegExp&&Vt(d.tagNameCheck,Y)||d.tagNameCheck instanceof Function&&d.tagNameCheck(Y)))return!1;if(Ne&&!Lt[Y]){const Ve=_(E)||E.parentNode,Ht=R(E)||E.childNodes;if(Ht&&Ve){const dt=Ht.length;for(let Kt=dt-1;Kt>=0;--Kt){const Yn=v(Ht[Kt],!0);Yn.__removalCount=(E.__removalCount||0)+1,Ve.insertBefore(Yn,T(E))}}}return Sn(E),!0}return E instanceof l&&!GM(E)||(Y==="noscript"||Y==="noembed"||Y==="noframes")&&Vt(/<\/no(script|embed|frames)/i,E.innerHTML)?(Sn(E),!0):(x&&E.nodeType===oa.text&&(k=E.textContent,Hl([L,ae,G],Ve=>{k=ra(k,Ve," ")}),E.textContent!==k&&(ta(e.removed,{element:E.cloneNode()}),E.textContent=k)),Un(q.afterSanitizeElements,E,null),!1)},Kw=function(E,k,Y){if(Mt&&(k==="id"||k==="name")&&(Y in r||Y in qM))return!1;if(!(S&&!w[k]&&Vt(ee,k))){if(!(C&&Vt(st,k))){if(!Te[k]||w[k]){if(!(Xw(E)&&(d.tagNameCheck instanceof RegExp&&Vt(d.tagNameCheck,E)||d.tagNameCheck instanceof Function&&d.tagNameCheck(E))&&(d.attributeNameCheck instanceof RegExp&&Vt(d.attributeNameCheck,k)||d.attributeNameCheck instanceof Function&&d.attributeNameCheck(k))||k==="is"&&d.allowCustomizedBuiltInElements&&(d.tagNameCheck instanceof RegExp&&Vt(d.tagNameCheck,Y)||d.tagNameCheck instanceof Function&&d.tagNameCheck(Y))))return!1}else if(!gt[k]){if(!Vt(Fe,ra(Y,Ee,""))){if(!((k==="src"||k==="xlink:href"||k==="href")&&E!=="script"&&JA(Y,"data:")===0&&jn[E])){if(!(O&&!Vt(Re,ra(Y,Ee,"")))){if(Y)return!1}}}}}}return!0},Xw=function(E){return E!=="annotation-xml"&&OS(E,$e)},Zw=function(E){Un(q.beforeSanitizeAttributes,E,null);const{attributes:k}=E;if(!k||Qc(E))return;const Y={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Te,forceKeepAttr:void 0};let Ve=k.length;for(;Ve--;){const Ht=k[Ve],{name:dt,namespaceURI:Kt,value:Yn}=Ht,Js=Qe(dt),Jc=Yn;let At=dt==="value"?Jc:eP(Jc);if(Y.attrName=Js,Y.attrValue=At,Y.keepAttr=!0,Y.forceKeepAttr=void 0,Un(q.uponSanitizeAttribute,E,Y),At=Y.attrValue,bt&&(Js==="id"||Js==="name")&&(Ko(dt,E),At=kt+At),j&&Vt(/((--!?|])>)|<\/(style|title)/i,At)){Ko(dt,E);continue}if(Y.forceKeepAttr)continue;if(!Y.keepAttr){Ko(dt,E);continue}if(!H&&Vt(/\/>/i,At)){Ko(dt,E);continue}x&&Hl([L,ae,G],Jw=>{At=ra(At,Jw," ")});const Qw=Qe(E.nodeName);if(!Kw(Qw,Js,At)){Ko(dt,E);continue}if(b&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!Kt)switch(g.getAttributeType(Qw,Js)){case"TrustedHTML":{At=b.createHTML(At);break}case"TrustedScriptURL":{At=b.createScriptURL(At);break}}if(At!==Jc)try{Kt?E.setAttributeNS(Kt,dt,At):E.setAttribute(dt,At),Qc(E)?Sn(E):_S(e.removed)}catch{Ko(dt,E)}}Un(q.afterSanitizeAttributes,E,null)},KM=function X(E){let k=null;const Y=Yw(E);for(Un(q.beforeSanitizeShadowDOM,E,null);k=Y.nextNode();)Un(q.uponSanitizeShadowNode,k,null),Gw(k),Zw(k),k.content instanceof o&&X(k.content);Un(q.afterSanitizeShadowDOM,E,null)};return e.sanitize=function(X){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k=null,Y=null,Ve=null,Ht=null;if(qi=!X,qi&&(X="<!-->"),typeof X!="string"&&!qw(X))if(typeof X.toString=="function"){if(X=X.toString(),typeof X!="string")throw na("dirty is not a string, aborting")}else throw na("toString is not a function");if(!e.isSupported)return X;if(I||Zc(E),e.removed=[],typeof X=="string"&&(Ue=!1),Ue){if(X.nodeName){const Yn=Qe(X.nodeName);if(!Ie[Yn]||m[Yn])throw na("root node is forbidden and cannot be sanitized in-place")}}else if(X instanceof a)k=Uw("<!---->"),Y=k.ownerDocument.importNode(X,!0),Y.nodeType===oa.element&&Y.nodeName==="BODY"||Y.nodeName==="HTML"?k=Y:k.appendChild(Y);else{if(!te&&!x&&!F&&X.indexOf("<")===-1)return b&&Ze?b.createHTML(X):X;if(k=Uw(X),!k)return te?null:Ze?M:""}k&&Q&&Sn(k.firstChild);const dt=Yw(Ue?X:k);for(;Ve=dt.nextNode();)Gw(Ve),Zw(Ve),Ve.content instanceof o&&KM(Ve.content);if(Ue)return X;if(te){if(de)for(Ht=D.call(k.ownerDocument);k.firstChild;)Ht.appendChild(k.firstChild);else Ht=k;return(Te.shadowroot||Te.shadowrootmode)&&(Ht=B.call(n,Ht,!0)),Ht}let Kt=F?k.outerHTML:k.innerHTML;return F&&Ie["!doctype"]&&k.ownerDocument&&k.ownerDocument.doctype&&k.ownerDocument.doctype.name&&Vt(kT,k.ownerDocument.doctype.name)&&(Kt="<!DOCTYPE "+k.ownerDocument.doctype.name+`>
`+Kt),x&&Hl([L,ae,G],Yn=>{Kt=ra(Kt,Yn," ")}),b&&Ze?b.createHTML(Kt):Kt},e.setConfig=function(){let X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Zc(X),I=!0},e.clearConfig=function(){Go=null,I=!1},e.isValidAttribute=function(X,E,k){Go||Zc({});const Y=Qe(X),Ve=Qe(E);return Kw(Y,Ve,k)},e.addHook=function(X,E){typeof E=="function"&&ta(q[X],E)},e.removeHook=function(X,E){if(E!==void 0){const k=ZA(q[X],E);return k===-1?void 0:QA(q[X],k,1)[0]}return _S(q[X])},e.removeHooks=function(X){q[X]=[]},e.removeAllHooks=function(){q=xS()},e}var mP=LT();var FT;function W(){return FT.apply(null,arguments)}function pP(t){FT=t}function gn(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Eo(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function ve(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function sp(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(ve(t,e))return!1;return!0}function tr(t){return t===void 0}function di(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function gl(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function VT(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function Mi(t,e){for(var r in e)ve(e,r)&&(t[r]=e[r]);return ve(e,"toString")&&(t.toString=e.toString),ve(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Fn(t,e,r,n){return l_(t,e,r,n,!0).utc()}function wP(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function oe(t){return t._pf==null&&(t._pf=wP()),t._pf}var nm;Array.prototype.some?nm=Array.prototype.some:nm=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function ap(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=oe(t),r=nm.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function wc(t){var e=Fn(NaN);return t!=null?Mi(oe(e),t):oe(e).userInvalidated=!0,e}var NS=W.momentProperties=[],Nf=!1;function lp(t,e){var r,n,i,o=NS.length;if(tr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),tr(e._i)||(t._i=e._i),tr(e._f)||(t._f=e._f),tr(e._l)||(t._l=e._l),tr(e._strict)||(t._strict=e._strict),tr(e._tzm)||(t._tzm=e._tzm),tr(e._isUTC)||(t._isUTC=e._isUTC),tr(e._offset)||(t._offset=e._offset),tr(e._pf)||(t._pf=oe(e)),tr(e._locale)||(t._locale=e._locale),o>0)for(r=0;r<o;r++)n=NS[r],i=e[n],tr(i)||(t[n]=i);return t}function ml(t){lp(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Nf===!1&&(Nf=!0,W.updateOffset(this),Nf=!1)}function mn(t){return t instanceof ml||t!=null&&t._isAMomentObject!=null}function WT(t){W.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function qr(t,e){var r=!0;return Mi(function(){if(W.deprecationHandler!=null&&W.deprecationHandler(null,t),r){var n=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])ve(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}WT(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var DS={};function BT(t,e){W.deprecationHandler!=null&&W.deprecationHandler(t,e),DS[t]||(WT(e),DS[t]=!0)}W.suppressDeprecationWarnings=!1;W.deprecationHandler=null;function Vn(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function vP(t){var e,r;for(r in t)ve(t,r)&&(e=t[r],Vn(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function im(t,e){var r=Mi({},t),n;for(n in e)ve(e,n)&&(Eo(t[n])&&Eo(e[n])?(r[n]={},Mi(r[n],t[n]),Mi(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)ve(t,n)&&!ve(e,n)&&Eo(t[n])&&(r[n]=Mi({},r[n]));return r}function up(t){t!=null&&this.set(t)}var om;Object.keys?om=Object.keys:om=function(t){var e,r=[];for(e in t)ve(t,e)&&r.push(e);return r};var yP={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function bP(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return Vn(n)?n.call(e,r):n}function Dn(t,e,r){var n=""+Math.abs(t),i=e-n.length,o=t>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var cp=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Pl=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Df={},Ts={};function Z(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(Ts[t]=i),e&&(Ts[e[0]]=function(){return Dn(i.apply(this,arguments),e[1],e[2])}),r&&(Ts[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function SP(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function CP(t){var e=t.match(cp),r,n;for(r=0,n=e.length;r<n;r++)Ts[e[r]]?e[r]=Ts[e[r]]:e[r]=SP(e[r]);return function(i){var o="",s;for(s=0;s<n;s++)o+=Vn(e[s])?e[s].call(i,t):e[s];return o}}function Cu(t,e){return t.isValid()?(e=$T(e,t.localeData()),Df[e]=Df[e]||CP(e),Df[e](t)):t.localeData().invalidDate()}function $T(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(Pl.lastIndex=0;r>=0&&Pl.test(t);)t=t.replace(Pl,n),Pl.lastIndex=0,r-=1;return t}var RP={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function EP(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(cp).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var TP="Invalid date";function _P(){return this._invalidDate}var OP="%d",MP=/\d{1,2}/;function IP(t){return this._ordinal.replace("%d",t)}var HP={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function AP(t,e,r,n){var i=this._relativeTime[r];return Vn(i)?i(t,e,r,n):i.replace(/%d/i,t)}function PP(t,e){var r=this._relativeTime[t>0?"future":"past"];return Vn(r)?r(e):r.replace(/%s/i,e)}var kS={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Gr(t){return typeof t=="string"?kS[t]||kS[t.toLowerCase()]:void 0}function hp(t){var e={},r,n;for(n in t)ve(t,n)&&(r=Gr(n),r&&(e[r]=t[n]));return e}var xP={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function NP(t){var e=[],r;for(r in t)ve(t,r)&&e.push({unit:r,priority:xP[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var jT=/\d/,Or=/\d\d/,zT=/\d{3}/,dp=/\d{4}/,vc=/[+-]?\d{6}/,Le=/\d\d?/,UT=/\d\d\d\d?/,YT=/\d\d\d\d\d\d?/,yc=/\d{1,3}/,fp=/\d{1,4}/,bc=/[+-]?\d{1,6}/,Ys=/\d+/,Sc=/[+-]?\d+/,DP=/Z|[+-]\d\d:?\d\d/gi,Cc=/Z|[+-]\d\d(?::?\d\d)?/gi,kP=/[+-]?\d+(\.\d{1,3})?/,pl=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,qs=/^[1-9]\d?/,gp=/^([1-9]\d|\d)/,Lu;Lu={};function $(t,e,r){Lu[t]=Vn(e)?e:function(n,i){return n&&r?r:e}}function LP(t,e){return ve(Lu,t)?Lu[t](e._strict,e._locale):new RegExp(FP(t))}function FP(t){return ci(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,o){return r||n||i||o}))}function ci(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Lr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function he(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Lr(e)),r}var sm={};function xe(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),di(e)&&(n=function(o,s){s[e]=he(o)}),i=t.length,r=0;r<i;r++)sm[t[r]]=n}function wl(t,e){xe(t,function(r,n,i,o){i._w=i._w||{},e(r,i._w,i,o)})}function VP(t,e,r){e!=null&&ve(sm,t)&&sm[t](e,r._a,r,t)}function Rc(t){return t%4===0&&t%100!==0||t%400===0}var Dt=0,ai=1,An=2,ft=3,dn=4,li=5,yo=6,WP=7,BP=8;Z("Y",0,0,function(){var t=this.year();return t<=9999?Dn(t,4):"+"+t});Z(0,["YY",2],0,function(){return this.year()%100});Z(0,["YYYY",4],0,"year");Z(0,["YYYYY",5],0,"year");Z(0,["YYYYYY",6,!0],0,"year");$("Y",Sc);$("YY",Le,Or);$("YYYY",fp,dp);$("YYYYY",bc,vc);$("YYYYYY",bc,vc);xe(["YYYYY","YYYYYY"],Dt);xe("YYYY",function(t,e){e[Dt]=t.length===2?W.parseTwoDigitYear(t):he(t)});xe("YY",function(t,e){e[Dt]=W.parseTwoDigitYear(t)});xe("Y",function(t,e){e[Dt]=parseInt(t,10)});function $a(t){return Rc(t)?366:365}W.parseTwoDigitYear=function(t){return he(t)+(he(t)>68?1900:2e3)};var qT=Gs("FullYear",!0);function $P(){return Rc(this.year())}function Gs(t,e){return function(r){return r!=null?(GT(this,t,r),W.updateOffset(this,e),this):Za(this,t)}}function Za(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function GT(t,e,r){var n,i,o,s,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}o=r,s=t.month(),a=t.date(),a=a===29&&s===1&&!Rc(o)?28:a,i?n.setUTCFullYear(o,s,a):n.setFullYear(o,s,a)}}function jP(t){return t=Gr(t),Vn(this[t])?this[t]():this}function zP(t,e){if(typeof t=="object"){t=hp(t);var r=NP(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=Gr(t),Vn(this[t]))return this[t](e);return this}function UP(t,e){return(t%e+e)%e}var tt;Array.prototype.indexOf?tt=Array.prototype.indexOf:tt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function mp(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=UP(e,12);return t+=(e-r)/12,r===1?Rc(t)?29:28:31-r%7%2}Z("M",["MM",2],"Mo",function(){return this.month()+1});Z("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Z("MMMM",0,0,function(t){return this.localeData().months(this,t)});$("M",Le,qs);$("MM",Le,Or);$("MMM",function(t,e){return e.monthsShortRegex(t)});$("MMMM",function(t,e){return e.monthsRegex(t)});xe(["M","MM"],function(t,e){e[ai]=he(t)-1});xe(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[ai]=i:oe(r).invalidMonth=t});var YP="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),KT="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),XT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,qP=pl,GP=pl;function KP(t,e){return t?gn(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||XT).test(e)?"format":"standalone"][t.month()]:gn(this._months)?this._months:this._months.standalone}function XP(t,e){return t?gn(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[XT.test(e)?"format":"standalone"][t.month()]:gn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ZP(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=Fn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?e==="MMM"?(i=tt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=tt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=tt.call(this._shortMonthsParse,s),i!==-1?i:(i=tt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=tt.call(this._longMonthsParse,s),i!==-1?i:(i=tt.call(this._shortMonthsParse,s),i!==-1?i:null))}function QP(t,e,r){var n,i,o;if(this._monthsParseExact)return ZP.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Fn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function ZT(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=he(e);else if(e=t.localeData().monthsParse(e),!di(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,mp(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function QT(t){return t!=null?(ZT(this,t),W.updateOffset(this,!0),this):Za(this,"Month")}function JP(){return mp(this.year(),this.month())}function ex(t){return this._monthsParseExact?(ve(this,"_monthsRegex")||JT.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(ve(this,"_monthsShortRegex")||(this._monthsShortRegex=qP),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function tx(t){return this._monthsParseExact?(ve(this,"_monthsRegex")||JT.call(this),t?this._monthsStrictRegex:this._monthsRegex):(ve(this,"_monthsRegex")||(this._monthsRegex=GP),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function JT(){function t(l,u){return u.length-l.length}var e=[],r=[],n=[],i,o,s,a;for(i=0;i<12;i++)o=Fn([2e3,i]),s=ci(this.monthsShort(o,"")),a=ci(this.months(o,"")),e.push(s),r.push(a),n.push(a),n.push(s);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function rx(t,e,r,n,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,o,s),a}function Qa(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Fu(t,e,r){var n=7+e-r,i=(7+Qa(t,0,n).getUTCDay()-e)%7;return-i+n-1}function e_(t,e,r,n,i){var o=(7+r-n)%7,s=Fu(t,n,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=$a(l)+a):a>$a(t)?(l=t+1,u=a-$a(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Ja(t,e,r){var n=Fu(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+hi(s,e,r)):i>hi(t.year(),e,r)?(o=i-hi(t.year(),e,r),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function hi(t,e,r){var n=Fu(t,e,r),i=Fu(t+1,e,r);return($a(t)-n+i)/7}Z("w",["ww",2],"wo","week");Z("W",["WW",2],"Wo","isoWeek");$("w",Le,qs);$("ww",Le,Or);$("W",Le,qs);$("WW",Le,Or);wl(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=he(t)});function nx(t){return Ja(t,this._week.dow,this._week.doy).week}var ix={dow:0,doy:6};function ox(){return this._week.dow}function sx(){return this._week.doy}function ax(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function lx(t){var e=Ja(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Z("d",0,"do","day");Z("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Z("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Z("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Z("e",0,0,"weekday");Z("E",0,0,"isoWeekday");$("d",Le);$("e",Le);$("E",Le);$("dd",function(t,e){return e.weekdaysMinRegex(t)});$("ddd",function(t,e){return e.weekdaysShortRegex(t)});$("dddd",function(t,e){return e.weekdaysRegex(t)});wl(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:oe(r).invalidWeekday=t});wl(["d","e","E"],function(t,e,r,n){e[n]=he(t)});function ux(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function cx(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function pp(t,e){return t.slice(e,7).concat(t.slice(0,e))}var hx="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),t_="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),dx="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),fx=pl,gx=pl,mx=pl;function px(t,e){var r=gn(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?pp(r,this._week.dow):t?r[t.day()]:r}function wx(t){return t===!0?pp(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function vx(t){return t===!0?pp(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function yx(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=Fn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?e==="dddd"?(i=tt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=tt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=tt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=tt.call(this._weekdaysParse,s),i!==-1||(i=tt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=tt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=tt.call(this._shortWeekdaysParse,s),i!==-1||(i=tt.call(this._weekdaysParse,s),i!==-1)?i:(i=tt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=tt.call(this._minWeekdaysParse,s),i!==-1||(i=tt.call(this._weekdaysParse,s),i!==-1)?i:(i=tt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function bx(t,e,r){var n,i,o;if(this._weekdaysParseExact)return yx.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Fn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function Sx(t){if(!this.isValid())return t!=null?this:NaN;var e=Za(this,"Day");return t!=null?(t=ux(t,this.localeData()),this.add(t-e,"d")):e}function Cx(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function Rx(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=cx(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function Ex(t){return this._weekdaysParseExact?(ve(this,"_weekdaysRegex")||wp.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(ve(this,"_weekdaysRegex")||(this._weekdaysRegex=fx),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function Tx(t){return this._weekdaysParseExact?(ve(this,"_weekdaysRegex")||wp.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(ve(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=gx),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function _x(t){return this._weekdaysParseExact?(ve(this,"_weekdaysRegex")||wp.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(ve(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=mx),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function wp(){function t(c,h){return h.length-c.length}var e=[],r=[],n=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Fn([2e3,1]).day(o),a=ci(this.weekdaysMin(s,"")),l=ci(this.weekdaysShort(s,"")),u=ci(this.weekdays(s,"")),e.push(a),r.push(l),n.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function vp(){return this.hours()%12||12}function Ox(){return this.hours()||24}Z("H",["HH",2],0,"hour");Z("h",["hh",2],0,vp);Z("k",["kk",2],0,Ox);Z("hmm",0,0,function(){return""+vp.apply(this)+Dn(this.minutes(),2)});Z("hmmss",0,0,function(){return""+vp.apply(this)+Dn(this.minutes(),2)+Dn(this.seconds(),2)});Z("Hmm",0,0,function(){return""+this.hours()+Dn(this.minutes(),2)});Z("Hmmss",0,0,function(){return""+this.hours()+Dn(this.minutes(),2)+Dn(this.seconds(),2)});function r_(t,e){Z(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}r_("a",!0);r_("A",!1);function n_(t,e){return e._meridiemParse}$("a",n_);$("A",n_);$("H",Le,gp);$("h",Le,qs);$("k",Le,qs);$("HH",Le,Or);$("hh",Le,Or);$("kk",Le,Or);$("hmm",UT);$("hmmss",YT);$("Hmm",UT);$("Hmmss",YT);xe(["H","HH"],ft);xe(["k","kk"],function(t,e,r){var n=he(t);e[ft]=n===24?0:n});xe(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});xe(["h","hh"],function(t,e,r){e[ft]=he(t),oe(r).bigHour=!0});xe("hmm",function(t,e,r){var n=t.length-2;e[ft]=he(t.substr(0,n)),e[dn]=he(t.substr(n)),oe(r).bigHour=!0});xe("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[ft]=he(t.substr(0,n)),e[dn]=he(t.substr(n,2)),e[li]=he(t.substr(i)),oe(r).bigHour=!0});xe("Hmm",function(t,e,r){var n=t.length-2;e[ft]=he(t.substr(0,n)),e[dn]=he(t.substr(n))});xe("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[ft]=he(t.substr(0,n)),e[dn]=he(t.substr(n,2)),e[li]=he(t.substr(i))});function Mx(t){return(t+"").toLowerCase().charAt(0)==="p"}var Ix=/[ap]\.?m?\.?/i,Hx=Gs("Hours",!0);function Ax(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var i_={calendar:yP,longDateFormat:RP,invalidDate:TP,ordinal:OP,dayOfMonthOrdinalParse:MP,relativeTime:HP,months:YP,monthsShort:KT,week:ix,weekdays:hx,weekdaysMin:dx,weekdaysShort:t_,meridiemParse:Ix},Be={},sa={},el;function Px(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function LS(t){return t&&t.toLowerCase().replace("_","-")}function xx(t){for(var e=0,r,n,i,o;e<t.length;){for(o=LS(t[e]).split("-"),r=o.length,n=LS(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=Ec(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&Px(o,n)>=r-1)break;r--}e++}return el}function Nx(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Ec(t){var e=null,r;if(Be[t]===void 0&&typeof Nu<"u"&&Nu&&Nu.exports&&Nx(t))try{e=el._abbr,r=require,r("./locale/"+t),ki(e)}catch{Be[t]=null}return Be[t]}function ki(t,e){var r;return t&&(tr(e)?r=gi(t):r=yp(t,e),r?el=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),el._abbr}function yp(t,e){if(e!==null){var r,n=i_;if(e.abbr=t,Be[t]!=null)BT("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Be[t]._config;else if(e.parentLocale!=null)if(Be[e.parentLocale]!=null)n=Be[e.parentLocale]._config;else if(r=Ec(e.parentLocale),r!=null)n=r._config;else return sa[e.parentLocale]||(sa[e.parentLocale]=[]),sa[e.parentLocale].push({name:t,config:e}),null;return Be[t]=new up(im(n,e)),sa[t]&&sa[t].forEach(function(i){yp(i.name,i.config)}),ki(t),Be[t]}else return delete Be[t],null}function Dx(t,e){if(e!=null){var r,n,i=i_;Be[t]!=null&&Be[t].parentLocale!=null?Be[t].set(im(Be[t]._config,e)):(n=Ec(t),n!=null&&(i=n._config),e=im(i,e),n==null&&(e.abbr=t),r=new up(e),r.parentLocale=Be[t],Be[t]=r),ki(t)}else Be[t]!=null&&(Be[t].parentLocale!=null?(Be[t]=Be[t].parentLocale,t===ki()&&ki(t)):Be[t]!=null&&delete Be[t]);return Be[t]}function gi(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return el;if(!gn(t)){if(e=Ec(t),e)return e;t=[t]}return xx(t)}function kx(){return om(Be)}function bp(t){var e,r=t._a;return r&&oe(t).overflow===-2&&(e=r[ai]<0||r[ai]>11?ai:r[An]<1||r[An]>mp(r[Dt],r[ai])?An:r[ft]<0||r[ft]>24||r[ft]===24&&(r[dn]!==0||r[li]!==0||r[yo]!==0)?ft:r[dn]<0||r[dn]>59?dn:r[li]<0||r[li]>59?li:r[yo]<0||r[yo]>999?yo:-1,oe(t)._overflowDayOfYear&&(e<Dt||e>An)&&(e=An),oe(t)._overflowWeeks&&e===-1&&(e=WP),oe(t)._overflowWeekday&&e===-1&&(e=BP),oe(t).overflow=e),t}var Lx=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Fx=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Vx=/Z|[+-]\d\d(?::?\d\d)?/,xl=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],kf=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Wx=/^\/?Date\((-?\d+)/i,Bx=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,$x={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function o_(t){var e,r,n=t._i,i=Lx.exec(n)||Fx.exec(n),o,s,a,l,u=xl.length,c=kf.length;if(i){for(oe(t).iso=!0,e=0,r=u;e<r;e++)if(xl[e][1].exec(i[1])){s=xl[e][0],o=xl[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,r=c;e<r;e++)if(kf[e][1].exec(i[3])){a=(i[2]||" ")+kf[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(Vx.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),Cp(t)}else t._isValid=!1}function jx(t,e,r,n,i,o){var s=[zx(t),KT.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function zx(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function Ux(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Yx(t,e,r){if(t){var n=t_.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return oe(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function qx(t,e,r){if(t)return $x[t];if(e)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function s_(t){var e=Bx.exec(Ux(t._i)),r;if(e){if(r=jx(e[4],e[3],e[2],e[5],e[6],e[7]),!Yx(e[1],r,t))return;t._a=r,t._tzm=qx(e[8],e[9],e[10]),t._d=Qa.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),oe(t).rfc2822=!0}else t._isValid=!1}function Gx(t){var e=Wx.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(o_(t),t._isValid===!1)delete t._isValid;else return;if(s_(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:W.createFromInputFallback(t)}W.createFromInputFallback=qr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function ps(t,e,r){return t??e??r}function Kx(t){var e=new Date(W.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Sp(t){var e,r,n=[],i,o,s;if(!t._d){for(i=Kx(t),t._w&&t._a[An]==null&&t._a[ai]==null&&Xx(t),t._dayOfYear!=null&&(s=ps(t._a[Dt],i[Dt]),(t._dayOfYear>$a(s)||t._dayOfYear===0)&&(oe(t)._overflowDayOfYear=!0),r=Qa(s,0,t._dayOfYear),t._a[ai]=r.getUTCMonth(),t._a[An]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[ft]===24&&t._a[dn]===0&&t._a[li]===0&&t._a[yo]===0&&(t._nextDay=!0,t._a[ft]=0),t._d=(t._useUTC?Qa:rx).apply(null,n),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[ft]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(oe(t).weekdayMismatch=!0)}}function Xx(t){var e,r,n,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,r=ps(e.GG,t._a[Dt],Ja(ke(),1,4).year),n=ps(e.W,1),i=ps(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Ja(ke(),o,s),r=ps(e.gg,t._a[Dt],u.year),n=ps(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),n<1||n>hi(r,o,s)?oe(t)._overflowWeeks=!0:l!=null?oe(t)._overflowWeekday=!0:(a=e_(r,n,i,o,s),t._a[Dt]=a.year,t._dayOfYear=a.dayOfYear)}W.ISO_8601=function(){};W.RFC_2822=function(){};function Cp(t){if(t._f===W.ISO_8601){o_(t);return}if(t._f===W.RFC_2822){s_(t);return}t._a=[],oe(t).empty=!0;var e=""+t._i,r,n,i,o,s,a=e.length,l=0,u,c;for(i=$T(t._f,t._locale).match(cp)||[],c=i.length,r=0;r<c;r++)o=i[r],n=(e.match(LP(o,t))||[])[0],n&&(s=e.substr(0,e.indexOf(n)),s.length>0&&oe(t).unusedInput.push(s),e=e.slice(e.indexOf(n)+n.length),l+=n.length),Ts[o]?(n?oe(t).empty=!1:oe(t).unusedTokens.push(o),VP(o,n,t)):t._strict&&!n&&oe(t).unusedTokens.push(o);oe(t).charsLeftOver=a-l,e.length>0&&oe(t).unusedInput.push(e),t._a[ft]<=12&&oe(t).bigHour===!0&&t._a[ft]>0&&(oe(t).bigHour=void 0),oe(t).parsedDateParts=t._a.slice(0),oe(t).meridiem=t._meridiem,t._a[ft]=Zx(t._locale,t._a[ft],t._meridiem),u=oe(t).era,u!==null&&(t._a[Dt]=t._locale.erasConvertYear(u,t._a[Dt])),Sp(t),bp(t)}function Zx(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function Qx(t){var e,r,n,i,o,s,a=!1,l=t._f.length;if(l===0){oe(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=lp({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],Cp(e),ap(e)&&(s=!0),o+=oe(e).charsLeftOver,o+=oe(e).unusedTokens.length*10,oe(e).score=o,a?o<n&&(n=o,r=e):(n==null||o<n||s)&&(n=o,r=e,s&&(a=!0));Mi(t,r||e)}function Jx(t){if(!t._d){var e=hp(t._i),r=e.day===void 0?e.date:e.day;t._a=VT([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),Sp(t)}}function e1(t){var e=new ml(bp(a_(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function a_(t){var e=t._i,r=t._f;return t._locale=t._locale||gi(t._l),e===null||r===void 0&&e===""?wc({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),mn(e)?new ml(bp(e)):(gl(e)?t._d=e:gn(r)?Qx(t):r?Cp(t):t1(t),ap(t)||(t._d=null),t))}function t1(t){var e=t._i;tr(e)?t._d=new Date(W.now()):gl(e)?t._d=new Date(e.valueOf()):typeof e=="string"?Gx(t):gn(e)?(t._a=VT(e.slice(0),function(r){return parseInt(r,10)}),Sp(t)):Eo(e)?Jx(t):di(e)?t._d=new Date(e):W.createFromInputFallback(t)}function l_(t,e,r,n,i){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Eo(t)&&sp(t)||gn(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=t,o._f=e,o._strict=n,e1(o)}function ke(t,e,r,n){return l_(t,e,r,n,!1)}var r1=qr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=ke.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:wc()}),n1=qr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=ke.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:wc()});function u_(t,e){var r,n;if(e.length===1&&gn(e[0])&&(e=e[0]),!e.length)return ke();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function i1(){var t=[].slice.call(arguments,0);return u_("isBefore",t)}function o1(){var t=[].slice.call(arguments,0);return u_("isAfter",t)}var s1=function(){return Date.now?Date.now():+new Date},aa=["year","quarter","month","week","day","hour","minute","second","millisecond"];function a1(t){var e,r=!1,n,i=aa.length;for(e in t)if(ve(t,e)&&!(tt.call(aa,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[aa[n]]){if(r)return!1;parseFloat(t[aa[n]])!==he(t[aa[n]])&&(r=!0)}return!0}function l1(){return this._isValid}function u1(){return wn(NaN)}function Tc(t){var e=hp(t),r=e.year||0,n=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=a1(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=gi(),this._bubble()}function Ru(t){return t instanceof Tc}function am(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function c1(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<n;s++)he(t[s])!==he(e[s])&&o++;return o+i}function c_(t,e){Z(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Dn(~~(r/60),2)+e+Dn(~~r%60,2)})}c_("Z",":");c_("ZZ","");$("Z",Cc);$("ZZ",Cc);xe(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=Rp(Cc,t)});var h1=/([\+\-]|\d\d)/gi;function Rp(t,e){var r=(e||"").match(t),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(h1)||["-",0,0],o=+(i[1]*60)+he(i[2]),o===0?0:i[0]==="+"?o:-o)}function Ep(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(mn(t)||gl(t)?t.valueOf():ke(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),W.updateOffset(r,!1),r):ke(t).local()}function lm(t){return-Math.round(t._d.getTimezoneOffset())}W.updateOffset=function(){};function d1(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=Rp(Cc,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=lm(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?f_(this,wn(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,W.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:lm(this)}function f1(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function g1(t){return this.utcOffset(0,t)}function m1(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(lm(this),"m")),this}function p1(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=Rp(DP,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function w1(t){return this.isValid()?(t=t?ke(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function v1(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function y1(){if(!tr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return lp(t,this),t=a_(t),t._a?(e=t._isUTC?Fn(t._a):ke(t._a),this._isDSTShifted=this.isValid()&&c1(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function b1(){return this.isValid()?!this._isUTC:!1}function S1(){return this.isValid()?this._isUTC:!1}function h_(){return this.isValid()?this._isUTC&&this._offset===0:!1}var C1=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,R1=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function wn(t,e){var r=t,n=null,i,o,s;return Ru(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:di(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=C1.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:he(n[An])*i,h:he(n[ft])*i,m:he(n[dn])*i,s:he(n[li])*i,ms:he(am(n[yo]*1e3))*i}):(n=R1.exec(t))?(i=n[1]==="-"?-1:1,r={y:Ki(n[2],i),M:Ki(n[3],i),w:Ki(n[4],i),d:Ki(n[5],i),h:Ki(n[6],i),m:Ki(n[7],i),s:Ki(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(s=E1(ke(r.from),ke(r.to)),r={},r.ms=s.milliseconds,r.M=s.months),o=new Tc(r),Ru(t)&&ve(t,"_locale")&&(o._locale=t._locale),Ru(t)&&ve(t,"_isValid")&&(o._isValid=t._isValid),o}wn.fn=Tc.prototype;wn.invalid=u1;function Ki(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function FS(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function E1(t,e){var r;return t.isValid()&&e.isValid()?(e=Ep(e,t),t.isBefore(e)?r=FS(t,e):(r=FS(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function d_(t,e){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(BT(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=wn(r,n),f_(this,i,t),this}}function f_(t,e,r,n){var i=e._milliseconds,o=am(e._days),s=am(e._months);t.isValid()&&(n=n??!0,s&&ZT(t,Za(t,"Month")+s*r),o&&GT(t,"Date",Za(t,"Date")+o*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&W.updateOffset(t,o||s))}var T1=d_(1,"add"),_1=d_(-1,"subtract");function g_(t){return typeof t=="string"||t instanceof String}function O1(t){return mn(t)||gl(t)||g_(t)||di(t)||I1(t)||M1(t)||t===null||t===void 0}function M1(t){var e=Eo(t)&&!sp(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=n.length;for(i=0;i<s;i+=1)o=n[i],r=r||ve(t,o);return e&&r}function I1(t){var e=gn(t),r=!1;return e&&(r=t.filter(function(n){return!di(n)&&g_(t)}).length===0),e&&r}function H1(t){var e=Eo(t)&&!sp(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||ve(t,o);return e&&r}function A1(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function P1(t,e){arguments.length===1&&(arguments[0]?O1(arguments[0])?(t=arguments[0],e=void 0):H1(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||ke(),n=Ep(r,this).startOf("day"),i=W.calendarFormat(this,n)||"sameElse",o=e&&(Vn(e[i])?e[i].call(this,r):e[i]);return this.format(o||this.localeData().calendar(i,this,ke(r)))}function x1(){return new ml(this)}function N1(t,e){var r=mn(t)?t:ke(t);return this.isValid()&&r.isValid()?(e=Gr(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function D1(t,e){var r=mn(t)?t:ke(t);return this.isValid()&&r.isValid()?(e=Gr(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function k1(t,e,r,n){var i=mn(t)?t:ke(t),o=mn(e)?e:ke(e);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function L1(t,e){var r=mn(t)?t:ke(t),n;return this.isValid()&&r.isValid()?(e=Gr(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function F1(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function V1(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function W1(t,e,r){var n,i,o;if(!this.isValid())return NaN;if(n=Ep(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=Gr(e),e){case"year":o=Eu(this,n)/12;break;case"month":o=Eu(this,n);break;case"quarter":o=Eu(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Lr(o)}function Eu(t,e){if(t.date()<e.date())return-Eu(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,o;return e-n<0?(i=t.clone().add(r-1,"months"),o=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),o=(e-n)/(i-n)),-(r+o)||0}W.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";W.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function B1(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function $1(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?Cu(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Vn(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Cu(r,"Z")):Cu(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function j1(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(r+n+i+o)}function z1(t){t||(t=this.isUtc()?W.defaultFormatUtc:W.defaultFormat);var e=Cu(this,t);return this.localeData().postformat(e)}function U1(t,e){return this.isValid()&&(mn(t)&&t.isValid()||ke(t).isValid())?wn({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Y1(t){return this.from(ke(),t)}function q1(t,e){return this.isValid()&&(mn(t)&&t.isValid()||ke(t).isValid())?wn({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function G1(t){return this.to(ke(),t)}function m_(t){var e;return t===void 0?this._locale._abbr:(e=gi(t),e!=null&&(this._locale=e),this)}var p_=qr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function w_(){return this._locale}var Vu=1e3,_s=60*Vu,Wu=60*_s,v_=(365*400+97)*24*Wu;function Os(t,e){return(t%e+e)%e}function y_(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-v_:new Date(t,e,r).valueOf()}function b_(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-v_:Date.UTC(t,e,r)}function K1(t){var e,r;if(t=Gr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?b_:y_,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Os(e+(this._isUTC?0:this.utcOffset()*_s),Wu);break;case"minute":e=this._d.valueOf(),e-=Os(e,_s);break;case"second":e=this._d.valueOf(),e-=Os(e,Vu);break}return this._d.setTime(e),W.updateOffset(this,!0),this}function X1(t){var e,r;if(t=Gr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?b_:y_,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Wu-Os(e+(this._isUTC?0:this.utcOffset()*_s),Wu)-1;break;case"minute":e=this._d.valueOf(),e+=_s-Os(e,_s)-1;break;case"second":e=this._d.valueOf(),e+=Vu-Os(e,Vu)-1;break}return this._d.setTime(e),W.updateOffset(this,!0),this}function Z1(){return this._d.valueOf()-(this._offset||0)*6e4}function Q1(){return Math.floor(this.valueOf()/1e3)}function J1(){return new Date(this.valueOf())}function eN(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function tN(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function rN(){return this.isValid()?this.toISOString():null}function nN(){return ap(this)}function iN(){return Mi({},oe(this))}function oN(){return oe(this).overflow}function sN(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Z("N",0,0,"eraAbbr");Z("NN",0,0,"eraAbbr");Z("NNN",0,0,"eraAbbr");Z("NNNN",0,0,"eraName");Z("NNNNN",0,0,"eraNarrow");Z("y",["y",1],"yo","eraYear");Z("y",["yy",2],0,"eraYear");Z("y",["yyy",3],0,"eraYear");Z("y",["yyyy",4],0,"eraYear");$("N",Tp);$("NN",Tp);$("NNN",Tp);$("NNNN",wN);$("NNNNN",vN);xe(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?oe(r).era=i:oe(r).invalidEra=t});$("y",Ys);$("yy",Ys);$("yyy",Ys);$("yyyy",Ys);$("yo",yN);xe(["y","yy","yyy","yyyy"],Dt);xe(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[Dt]=r._locale.eraYearOrdinalParse(t,i):e[Dt]=parseInt(t,10)});function aN(t,e){var r,n,i,o=this._eras||gi("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=W(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=W(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function lN(t,e,r){var n,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),n=0,i=o.length;n<i;++n)if(s=o[n].name.toUpperCase(),a=o[n].abbr.toUpperCase(),l=o[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[n];break;case"NNNN":if(s===t)return o[n];break;case"NNNNN":if(l===t)return o[n];break}else if([s,a,l].indexOf(t)>=0)return o[n]}function uN(t,e){var r=t.since<=t.until?1:-1;return e===void 0?W(t.since).year():W(t.since).year()+(e-t.offset)*r}function cN(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function hN(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function dN(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function fN(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-W(i[t].since).year())*r+i[t].offset;return this.year()}function gN(t){return ve(this,"_erasNameRegex")||_p.call(this),t?this._erasNameRegex:this._erasRegex}function mN(t){return ve(this,"_erasAbbrRegex")||_p.call(this),t?this._erasAbbrRegex:this._erasRegex}function pN(t){return ve(this,"_erasNarrowRegex")||_p.call(this),t?this._erasNarrowRegex:this._erasRegex}function Tp(t,e){return e.erasAbbrRegex(t)}function wN(t,e){return e.erasNameRegex(t)}function vN(t,e){return e.erasNarrowRegex(t)}function yN(t,e){return e._eraYearOrdinalRegex||Ys}function _p(){var t=[],e=[],r=[],n=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=ci(u[i].name),a=ci(u[i].abbr),l=ci(u[i].narrow),e.push(s),t.push(a),r.push(l),n.push(s),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Z(0,["gg",2],0,function(){return this.weekYear()%100});Z(0,["GG",2],0,function(){return this.isoWeekYear()%100});function _c(t,e){Z(0,[t,t.length],0,e)}_c("gggg","weekYear");_c("ggggg","weekYear");_c("GGGG","isoWeekYear");_c("GGGGG","isoWeekYear");$("G",Sc);$("g",Sc);$("GG",Le,Or);$("gg",Le,Or);$("GGGG",fp,dp);$("gggg",fp,dp);$("GGGGG",bc,vc);$("ggggg",bc,vc);wl(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=he(t)});wl(["gg","GG"],function(t,e,r,n){e[n]=W.parseTwoDigitYear(t)});function bN(t){return S_.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function SN(t){return S_.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function CN(){return hi(this.year(),1,4)}function RN(){return hi(this.isoWeekYear(),1,4)}function EN(){var t=this.localeData()._week;return hi(this.year(),t.dow,t.doy)}function TN(){var t=this.localeData()._week;return hi(this.weekYear(),t.dow,t.doy)}function S_(t,e,r,n,i){var o;return t==null?Ja(this,n,i).year:(o=hi(t,n,i),e>o&&(e=o),_N.call(this,t,e,r,n,i))}function _N(t,e,r,n,i){var o=e_(t,e,r,n,i),s=Qa(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Z("Q",0,"Qo","quarter");$("Q",jT);xe("Q",function(t,e){e[ai]=(he(t)-1)*3});function ON(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Z("D",["DD",2],"Do","date");$("D",Le,qs);$("DD",Le,Or);$("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});xe(["D","DD"],An);xe("Do",function(t,e){e[An]=he(t.match(Le)[0])});var C_=Gs("Date",!0);Z("DDD",["DDDD",3],"DDDo","dayOfYear");$("DDD",yc);$("DDDD",zT);xe(["DDD","DDDD"],function(t,e,r){r._dayOfYear=he(t)});function MN(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Z("m",["mm",2],0,"minute");$("m",Le,gp);$("mm",Le,Or);xe(["m","mm"],dn);var IN=Gs("Minutes",!1);Z("s",["ss",2],0,"second");$("s",Le,gp);$("ss",Le,Or);xe(["s","ss"],li);var HN=Gs("Seconds",!1);Z("S",0,0,function(){return~~(this.millisecond()/100)});Z(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Z(0,["SSS",3],0,"millisecond");Z(0,["SSSS",4],0,function(){return this.millisecond()*10});Z(0,["SSSSS",5],0,function(){return this.millisecond()*100});Z(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Z(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Z(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Z(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});$("S",yc,jT);$("SS",yc,Or);$("SSS",yc,zT);var Ii,R_;for(Ii="SSSS";Ii.length<=9;Ii+="S")$(Ii,Ys);function AN(t,e){e[yo]=he(("0."+t)*1e3)}for(Ii="S";Ii.length<=9;Ii+="S")xe(Ii,AN);R_=Gs("Milliseconds",!1);Z("z",0,0,"zoneAbbr");Z("zz",0,0,"zoneName");function PN(){return this._isUTC?"UTC":""}function xN(){return this._isUTC?"Coordinated Universal Time":""}var N=ml.prototype;N.add=T1;N.calendar=P1;N.clone=x1;N.diff=W1;N.endOf=X1;N.format=z1;N.from=U1;N.fromNow=Y1;N.to=q1;N.toNow=G1;N.get=jP;N.invalidAt=oN;N.isAfter=N1;N.isBefore=D1;N.isBetween=k1;N.isSame=L1;N.isSameOrAfter=F1;N.isSameOrBefore=V1;N.isValid=nN;N.lang=p_;N.locale=m_;N.localeData=w_;N.max=n1;N.min=r1;N.parsingFlags=iN;N.set=zP;N.startOf=K1;N.subtract=_1;N.toArray=eN;N.toObject=tN;N.toDate=J1;N.toISOString=$1;N.inspect=j1;typeof Symbol<"u"&&Symbol.for!=null&&(N[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});N.toJSON=rN;N.toString=B1;N.unix=Q1;N.valueOf=Z1;N.creationData=sN;N.eraName=cN;N.eraNarrow=hN;N.eraAbbr=dN;N.eraYear=fN;N.year=qT;N.isLeapYear=$P;N.weekYear=bN;N.isoWeekYear=SN;N.quarter=N.quarters=ON;N.month=QT;N.daysInMonth=JP;N.week=N.weeks=ax;N.isoWeek=N.isoWeeks=lx;N.weeksInYear=EN;N.weeksInWeekYear=TN;N.isoWeeksInYear=CN;N.isoWeeksInISOWeekYear=RN;N.date=C_;N.day=N.days=Sx;N.weekday=Cx;N.isoWeekday=Rx;N.dayOfYear=MN;N.hour=N.hours=Hx;N.minute=N.minutes=IN;N.second=N.seconds=HN;N.millisecond=N.milliseconds=R_;N.utcOffset=d1;N.utc=g1;N.local=m1;N.parseZone=p1;N.hasAlignedHourOffset=w1;N.isDST=v1;N.isLocal=b1;N.isUtcOffset=S1;N.isUtc=h_;N.isUTC=h_;N.zoneAbbr=PN;N.zoneName=xN;N.dates=qr("dates accessor is deprecated. Use date instead.",C_);N.months=qr("months accessor is deprecated. Use month instead",QT);N.years=qr("years accessor is deprecated. Use year instead",qT);N.zone=qr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",f1);N.isDSTShifted=qr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",y1);function NN(t){return ke(t*1e3)}function DN(){return ke.apply(null,arguments).parseZone()}function E_(t){return t}var ye=up.prototype;ye.calendar=bP;ye.longDateFormat=EP;ye.invalidDate=_P;ye.ordinal=IP;ye.preparse=E_;ye.postformat=E_;ye.relativeTime=AP;ye.pastFuture=PP;ye.set=vP;ye.eras=aN;ye.erasParse=lN;ye.erasConvertYear=uN;ye.erasAbbrRegex=mN;ye.erasNameRegex=gN;ye.erasNarrowRegex=pN;ye.months=KP;ye.monthsShort=XP;ye.monthsParse=QP;ye.monthsRegex=tx;ye.monthsShortRegex=ex;ye.week=nx;ye.firstDayOfYear=sx;ye.firstDayOfWeek=ox;ye.weekdays=px;ye.weekdaysMin=vx;ye.weekdaysShort=wx;ye.weekdaysParse=bx;ye.weekdaysRegex=Ex;ye.weekdaysShortRegex=Tx;ye.weekdaysMinRegex=_x;ye.isPM=Mx;ye.meridiem=Ax;function Bu(t,e,r,n){var i=gi(),o=Fn().set(n,e);return i[r](o,t)}function T_(t,e,r){if(di(t)&&(e=t,t=void 0),t=t||"",e!=null)return Bu(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=Bu(t,n,r,"month");return i}function Op(t,e,r,n){typeof t=="boolean"?(di(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,di(e)&&(r=e,e=void 0),e=e||"");var i=gi(),o=t?i._week.dow:0,s,a=[];if(r!=null)return Bu(e,(r+o)%7,n,"day");for(s=0;s<7;s++)a[s]=Bu(e,(s+o)%7,n,"day");return a}function kN(t,e){return T_(t,e,"months")}function LN(t,e){return T_(t,e,"monthsShort")}function FN(t,e,r){return Op(t,e,r,"weekdays")}function VN(t,e,r){return Op(t,e,r,"weekdaysShort")}function WN(t,e,r){return Op(t,e,r,"weekdaysMin")}ki("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=he(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});W.lang=qr("moment.lang is deprecated. Use moment.locale instead.",ki);W.langData=qr("moment.langData is deprecated. Use moment.localeData instead.",gi);var qn=Math.abs;function BN(){var t=this._data;return this._milliseconds=qn(this._milliseconds),this._days=qn(this._days),this._months=qn(this._months),t.milliseconds=qn(t.milliseconds),t.seconds=qn(t.seconds),t.minutes=qn(t.minutes),t.hours=qn(t.hours),t.months=qn(t.months),t.years=qn(t.years),this}function __(t,e,r,n){var i=wn(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function $N(t,e){return __(this,t,e,1)}function jN(t,e){return __(this,t,e,-1)}function VS(t){return t<0?Math.floor(t):Math.ceil(t)}function zN(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,o,s,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=VS(um(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Lr(t/1e3),n.seconds=i%60,o=Lr(i/60),n.minutes=o%60,s=Lr(o/60),n.hours=s%24,e+=Lr(s/24),l=Lr(O_(e)),r+=l,e-=VS(um(l)),a=Lr(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function O_(t){return t*4800/146097}function um(t){return t*146097/4800}function UN(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=Gr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+O_(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(um(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function mi(t){return function(){return this.as(t)}}var M_=mi("ms"),YN=mi("s"),qN=mi("m"),GN=mi("h"),KN=mi("d"),XN=mi("w"),ZN=mi("M"),QN=mi("Q"),JN=mi("y"),eD=M_;function tD(){return wn(this)}function rD(t){return t=Gr(t),this.isValid()?this[t+"s"]():NaN}function jo(t){return function(){return this.isValid()?this._data[t]:NaN}}var nD=jo("milliseconds"),iD=jo("seconds"),oD=jo("minutes"),sD=jo("hours"),aD=jo("days"),lD=jo("months"),uD=jo("years");function cD(){return Lr(this.days()/7)}var ii=Math.round,bs={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function hD(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function dD(t,e,r,n){var i=wn(t).abs(),o=ii(i.as("s")),s=ii(i.as("m")),a=ii(i.as("h")),l=ii(i.as("d")),u=ii(i.as("M")),c=ii(i.as("w")),h=ii(i.as("y")),f=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||s<=1&&["m"]||s<r.m&&["mm",s]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(f=f||c<=1&&["w"]||c<r.w&&["ww",c]),f=f||u<=1&&["M"]||u<r.M&&["MM",u]||h<=1&&["y"]||["yy",h],f[2]=e,f[3]=+t>0,f[4]=n,hD.apply(null,f)}function fD(t){return t===void 0?ii:typeof t=="function"?(ii=t,!0):!1}function gD(t,e){return bs[t]===void 0?!1:e===void 0?bs[t]:(bs[t]=e,t==="s"&&(bs.ss=e-1),!0)}function mD(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=bs,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},bs,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),o=dD(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Lf=Math.abs;function Xo(t){return(t>0)-(t<0)||+t}function Oc(){if(!this.isValid())return this.localeData().invalidDate();var t=Lf(this._milliseconds)/1e3,e=Lf(this._days),r=Lf(this._months),n,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(n=Lr(t/60),i=Lr(n/60),t%=60,n%=60,o=Lr(r/12),r%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Xo(this._months)!==Xo(a)?"-":"",c=Xo(this._days)!==Xo(a)?"-":"",h=Xo(this._milliseconds)!==Xo(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(r?u+r+"M":"")+(e?c+e+"D":"")+(i||n||t?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(t?h+s+"S":"")):"P0D"}var ge=Tc.prototype;ge.isValid=l1;ge.abs=BN;ge.add=$N;ge.subtract=jN;ge.as=UN;ge.asMilliseconds=M_;ge.asSeconds=YN;ge.asMinutes=qN;ge.asHours=GN;ge.asDays=KN;ge.asWeeks=XN;ge.asMonths=ZN;ge.asQuarters=QN;ge.asYears=JN;ge.valueOf=eD;ge._bubble=zN;ge.clone=tD;ge.get=rD;ge.milliseconds=nD;ge.seconds=iD;ge.minutes=oD;ge.hours=sD;ge.days=aD;ge.weeks=cD;ge.months=lD;ge.years=uD;ge.humanize=mD;ge.toISOString=Oc;ge.toString=Oc;ge.toJSON=Oc;ge.locale=m_;ge.localeData=w_;ge.toIsoString=qr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Oc);ge.lang=p_;Z("X",0,0,"unix");Z("x",0,0,"valueOf");$("x",Sc);$("X",kP);xe("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});xe("x",function(t,e,r){r._d=new Date(he(t))});W.version="2.30.1";pP(ke);W.fn=N;W.min=i1;W.max=o1;W.now=s1;W.utc=Fn;W.unix=NN;W.months=kN;W.isDate=gl;W.locale=ki;W.invalid=wc;W.duration=wn;W.isMoment=mn;W.weekdays=FN;W.parseZone=DN;W.localeData=gi;W.isDuration=Ru;W.monthsShort=LN;W.weekdaysMin=WN;W.defineLocale=yp;W.updateLocale=Dx;W.locales=kx;W.weekdaysShort=VN;W.normalizeUnits=Gr;W.relativeTimeRounding=fD;W.relativeTimeThreshold=gD;W.calendarFormat=A1;W.prototype=N;W.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var WS={},BS={},$S;function pD(){if($S)return BS;$S=1;var t=De(),e=Us(),r=Tr(),n=yt(),i=Ui(),o=_r(),s=$o(),a=hl(),l=ct(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(g){n(this);try{r(g)}catch(R){o(this,"throw",R)}var p=arguments.length<2,v=p?void 0:arguments[1];if(h)return a(h,this,p?[g]:[g,v]);var y=i(this),T=0;if(e(y,function(R){p?(p=!1,v=R):v=g(v,R,T),T++},{IS_RECORD:!0}),p)throw new u("Reduce of empty iterator with no initial value");return v}}),BS}var jS;function wD(){return jS||(jS=1,pD()),WS}wD();function vD(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function zS(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function Ff(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function zo(t,e,r,n){let i=-1,o=t,s=r;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Mp(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(s+=1,o[s]=a),r+=1}return o}function Vi(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];s+=1,o[s]=e(a,r,n),r+=1}return o}function z(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function US(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let o=n;return z(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function YS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function Sr(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return zo(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return o+l+u},"").trim()}function Ip(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ue(t){return typeof t<"u"}function zt(t){return typeof t>"u"}function Mo(t){return t===null||t===""||zt(t)}function yD(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const xa="length",ja=t=>parseInt(t,16),qS=t=>parseInt(t,10),$u=(t,e,r)=>t.substr(e,r),za=t=>t.codePointAt(0)-65,cm=t=>`${t}`.replace(/\-/g,""),bD=t=>ja($u(cm(t),ja("12"),za("F")))/(ja($u(cm(t),za("B"),~~![][xa]))||9),SD=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let GS=!1;const KS={invalid:()=>Sr`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Sr`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Sr`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},XS={invalid:()=>Sr`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Sr`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Sr`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function CD(t,e){const r=!Mo(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.2.0";let o,s="invalid",a="invalid";t=cm(t||"");const l=RD(t);if(r||n||l)if(l){const u=W("25/11/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=bD(t);o=W((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else n?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(SD()&&(s="valid",a="valid"),!GS&&s!=="valid"&&(KS[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](KS[s]({keyValidityDate:o,hotVersion:i})),GS=!0),a!=="valid"&&e&&XS[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=XS[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function RD(t){let e=[][xa],r=e;if(t[xa]!==za("Z"))return!1;for(let n="",i="B<H4P+".split(""),o=za(i.shift());o;o=za(i.shift()||"A"))--o<""[xa]?r=r|(qS(`${qS(ja(n)+(ja($u(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=$u(t,o,o?i[xa]===1?9:8:6);return r===e}function Mc(t){return t[0].toUpperCase()+t.substr(1)}function I_(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function ED(t){if(typeof t!="string")return!1;try{const e=JSON.parse(t);return typeof e=="object"&&e!==null}catch{return!1}}function TD(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function H_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function A_(t,e){return mP.sanitize(t,e)}const Uo=t=>["tabindex",t],_D=()=>["role","treegrid"],Hi=()=>["role","presentation"],OD=()=>["role","gridcell"],MD=()=>["role","gridcell button"],ID=()=>["role","rowheader"],P_=()=>["role","rowgroup"],HD=()=>["role","columnheader"],x_=()=>["role","row"],AD=()=>["role","menu"],PD=()=>["role","menuitem"],xD=()=>["role","menuitemcheckbox"],ND=()=>["scope","col"],DD=()=>["scope","row"],ju=t=>["aria-label",t],kD=()=>["aria-hidden","true"],LD=function(){return["aria-disabled",arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0]},FD=()=>["aria-multiselectable","true"],N_=t=>["aria-rowcount",t],Ic=t=>["aria-colcount",t],D_=t=>["aria-rowindex",t],Hp=t=>["aria-colindex",t],Tu=t=>["aria-expanded",t],ZS=()=>["aria-readonly","true"],QS=()=>["aria-invalid","true"],VD=t=>["aria-checked",t],k_=()=>["aria-selected","true"];var JS={},Vf,eC;function WD(){if(eC)return Vf;eC=1;var t=ot(),e=pT(),r=ht(),n=ko(),i=pc(),o=t([].push);return Vf=function(s){if(r(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||n(c)==="Number"||n(c)==="String")&&o(l,i(c))}var h=l.length,f=!0;return function(g,p){if(f)return f=!1,p;if(e(this))return p;for(var v=0;v<h;v++)if(l[v]===g)return p}}},Vf}var tC;function BD(){if(tC)return JS;tC=1;var t=De(),e=Bs(),r=hl(),n=vt(),i=ot(),o=ct(),s=ht(),a=Km(),l=op(),u=WD(),c=Gm(),h=String,f=e("JSON","stringify"),g=i(/./.exec),p=i("".charAt),v=i("".charCodeAt),y=i("".replace),T=i(1.1.toString),R=/[\uD800-\uDFFF]/g,_=/^[\uD800-\uDBFF]$/,b=/^[\uDC00-\uDFFF]$/,M=!c||o(function(){var V=e("Symbol")("stringify detection");return f([V])!=="[null]"||f({a:V})!=="{}"||f(Object(V))!=="{}"}),P=o(function(){return f("\uDF06\uD834")!=='"\\udf06\\ud834"'||f("\uDEAD")!=='"\\udead"'}),A=function(V,B){var q=l(arguments),L=u(B);if(!(!s(L)&&(V===void 0||a(V))))return q[1]=function(ae,G){if(s(L)&&(G=n(L,this,h(ae),G)),!a(G))return G},r(f,null,q)},D=function(V,B,q){var L=p(q,B-1),ae=p(q,B+1);return g(_,V)&&!g(b,ae)||g(b,V)&&!g(_,L)?"\\u"+T(v(V,0),16):V};return f&&t({target:"JSON",stat:!0,arity:3,forced:M||P},{stringify:function(B,q,L){var ae=l(arguments),G=r(M?A:f,null,ae);return P&&typeof G=="string"?y(G,R,D):G}}),JS}BD();function tl(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Me(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=tl(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[tl(r[0])]:e[n]=[]:e[n]=null)})),e}function $D(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Wi(t,e,r){const n=Array.isArray(r);return Me(e,(i,o)=>{(n===!1||r.includes(o))&&(t[o]=i)}),t}function L_(t,e){Me(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),L_(t[n],e[n])):t[n]=e[n]})}function Bi(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Ke(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return z(r,i=>{t.MIXINS.push(i.MIXIN_NAME),Me(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const f=`_${c}`,g=p=>{let v=p;return(Array.isArray(v)||nt(v))&&(v=Bi(v)),v};return function(){return this[f]===void 0&&(this[f]=g(h)),this[f]}},l=function(c){const h=`_${c}`;return function(f){this[h]=f}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function F_(t,e){return JSON.stringify(t)===JSON.stringify(e)}function nt(t){return Object.prototype.toString.call(t)==="[object Object]"}function pi(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function Me(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function hm(t,e){const r=e.split(".");let n=t;return Me(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function Wf(t,e,r){if(typeof e!="string")return;const n=e.split(".");let i=t;n.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==n.length-1?(jr(i,o)||(i[o]={}),i=i[o]):i[o]=r)})}function Ap(t){if(!nt(t))return 0;const e=function(r){let n=0;return nt(r)?Me(r,(i,o)=>{o!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function yr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function jr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function _u(t,e){if(typeof t!="object"||t===null)return e;if(typeof e!="object"||e===null)return t;const r={};return Object.keys(e).forEach(n=>{typeof e[n]=="object"&&e[n]!==null&&!Array.isArray(e[n])?r[n]=_u(t[n],e[n]):r[n]=jr(t,n)&&t[n]!==void 0?t[n]:e[n]}),Object.keys(t).forEach(n=>{jr(r,n)||(r[n]=t[n])}),r}function dm(t){return window.requestAnimationFrame(t)}function rC(t){window.cancelAnimationFrame(t)}function jD(){return"ontouchstart"in window}function zD(){return typeof window<"u"}const kr=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},Yi={chrome:kr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:kr(t=>/CriOS/.test(t)),edge:kr(t=>/Edge/.test(t)),edgeWebKit:kr(t=>/EdgiOS/.test(t)),firefox:kr(t=>/Firefox/.test(t)),firefoxWebKit:kr(t=>/FxiOS/.test(t)),mobile:kr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:kr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},vl={mac:kr(t=>/^Mac/.test(t)),win:kr(t=>/^Win/.test(t)),linux:kr(t=>/^Linux/.test(t)),ios:kr(t=>/iPhone|iPad|iPod/i.test(t))};function UD(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Me(Yi,r=>{let{test:n}=r;n(t,e)})}function YD(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Me(vl,e=>{let{test:r}=e;r(t)})}zD()&&(UD(),YD());function qD(){return Yi.chrome.value}function GD(){return Yi.chromeWebKit.value}function Bf(){return Yi.firefox.value}function KD(){return Yi.firefoxWebKit.value}function Pp(){return Yi.safari.value}function XD(){return Yi.edge.value}function Ai(){return Yi.mobile.value}function V_(){return vl.ios.value}function xp(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&vl.mac.value}function nC(){return vl.win.value}function iC(){return vl.mac.value}function ZD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function Ou(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function QD(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Io(t){return QD(t)&&t.parent}function W_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==r;){const{nodeType:s,nodeName:a}=o;if(s===n&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Nl(t,e,r){const n=[];let i=t;for(;i&&(i=W_(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=n.length;return o?n[o-1]:null}function JD(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(o=>e.test(o));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function Ms(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function ek(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function Xi(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function B_(t){return!t||!t.length?[]:t.filter(e=>!!e)}function $_(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&r.push(i),!o})),{regexFree:n,regexes:r}}function me(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function K(t,e){typeof e=="string"&&(e=e.split(" ")),e=B_(e),e.length>0&&t.classList.add(...e)}function Oe(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=$_(e,!0);r=B_(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Ce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function yl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=$_(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function j_(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)j_(e[r])}}function Ls(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const tk=/(<(.*)>|&(.*);)/;function z_(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;tk.test(e)?t.innerHTML=r?A_(e):e:bl(t,e)}function bl(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Ls(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Fs(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Fs(n.host.impl);if(n.host)return Fs(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function rk(t){const r=t.ownerDocument.defaultView;let n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function Fr(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,s+=r.pageYOffset||n.scrollTop),{left:o,top:s}}function U_(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Np(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Dp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?U_(e):t.scrollTop}function Y_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Np(e):t.scrollLeft}function zu(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=r.getComputedStyle(i),n.includes(o)||n.includes(s)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(o))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(o)))return i;i=i.parentNode}return r}function nk(t){return t.scrollHeight-t.clientHeight}function ik(t){return t.scrollWidth-t.clientWidth}function Uu(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return n;n=n.parentNode}return r}function oC(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function lr(t){return t.offsetWidth}function ur(t){return t.getBoundingClientRect().height}function Ua(t){return t.clientHeight||t.innerHeight}function q_(t){return t.clientWidth||t.innerWidth}function ok(t){return t.selectionStart?t.selectionStart:0}function sC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function G_(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=o}}}let $f;function sk(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");Pp()&&!Ai()&&!xp()&&r.classList.add("htScrollbarSafariTest"),r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.getBoundingClientRect().width;r.style.overflow="scroll";let i=e.getBoundingClientRect().width;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),parseFloat((n-i).toFixed(3))}function Ut(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return $f===void 0&&($f=sk(t)),$f}function ak(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function lk(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function kp(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function Hc(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Mu(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function K_(t){return Mu(t)&&t.hasAttribute("data-hot-input")===!1}function uk(t,e){new IntersectionObserver((n,i)=>{n.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function X_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),o=n.defaultView.getSelection();Ce(t,"contenteditable",!0),r&&Ce(t,...kD()),e&&K(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function Z_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&Oe(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function ck(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;X_(t,r),e(),Z_(t,r)}function To(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}function Se(t){return typeof t=="function"}function Q_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,s)},e),n}return i}function hk(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,r.concat(s))}}function fm(t,e,r,n,i,o,s,a){return ue(a)?t.call(e,r,n,i,o,s,a):ue(s)?t.call(e,r,n,i,o,s):ue(o)?t.call(e,r,n,i,o):ue(i)?t.call(e,r,n,i):ue(n)?t.call(e,r,n):ue(r)?t.call(e,r):t.call(e)}const J={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Bf()?182:174,AUDIO_MUTE:Bf()?181:173,AUDIO_UP:Bf()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},dk=[J.ALT,J.ARROW_DOWN,J.ARROW_LEFT,J.ARROW_RIGHT,J.ARROW_UP,J.AUDIO_DOWN,J.AUDIO_MUTE,J.AUDIO_UP,J.BACKSPACE,J.CAPS_LOCK,J.DELETE,J.END,J.ENTER,J.ESCAPE,J.F1,J.F2,J.F3,J.F4,J.F5,J.F6,J.F7,J.F8,J.F9,J.F10,J.F11,J.F12,J.F13,J.F14,J.F15,J.F16,J.F17,J.F18,J.F19,J.HOME,J.INSERT,J.MEDIA_NEXT,J.MEDIA_PLAY_PAUSE,J.MEDIA_PREV,J.MEDIA_STOP,J.NULL,J.NUM_LOCK,J.PAGE_DOWN,J.PAGE_UP,J.PAUSE,J.SCROLL_LOCK,J.SHIFT,J.TAB];function fk(t){return dk.includes(t)}function gk(t){return[J.CONTROL,J.COMMAND_LEFT,J.COMMAND_RIGHT,J.COMMAND_FIREFOX].includes(t)}function mk(t,e){const r=e.split("|");let n=!1;return z(r,i=>{if(t===J[i])return n=!0,!1}),n}function Ac(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function ho(t){return t.isImmediatePropagationEnabled===!1}function Yu(t){return t.button===2}function J_(t){return t.button===0}function Cr(){ue(console)&&console.warn(...arguments)}function pk(t){ue(console)&&console.warn(`Deprecated: ${t}`)}function wk(){ue(console)&&console.error(...arguments)}const fo=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceCacheUpdate","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceCacheUpdate","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","beforeEmptyDataStateShow","afterEmptyDataStateShow","beforeEmptyDataStateHide","afterEmptyDataStateHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],jf=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),zf=new Map([[]]);var aC={},Uf,lC;function vk(){if(lC)return Uf;lC=1;var t=zs();return Uf=function(e,r,n){for(var i=0,o=arguments.length>2?n:t(r),s=new e(o);o>i;)s[i]=r[i++];return s},Uf}var Yf,uC;function yk(){if(uC)return Yf;uC=1;var t=it();return Yf=function(e,r){var n=t[e],i=n&&n.prototype;return i&&i[r]},Yf}var qf,cC;function Lp(){if(cC)return qf;cC=1;var t=pn(),e=ip(),r=zi().f,n=t("unscopables"),i=Array.prototype;return i[n]===void 0&&r(i,n,{configurable:!0,value:e(null)}),qf=function(o){i[n][o]=!0},qf}var hC;function bk(){if(hC)return aC;hC=1;var t=De(),e=ot(),r=Tr(),n=al(),i=vk(),o=yk(),s=Lp(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&r(c);var h=n(this),f=i(a,h);return l(f,c)}}),s("toSorted"),aC}bk();var dC={},fC={},gC;function Sk(){if(gC)return fC;gC=1;var t=De(),e=vt(),r=Us(),n=Tr(),i=yt(),o=Ui(),s=_r(),a=$o(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),f=0;return r(h,function(g,p){if(c(g,f++))return p(g)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),fC}var mC;function Ck(){return mC||(mC=1,Sk()),dC}Ck();function Rk(t,e){e0(t,e),e.add(t)}function Gf(t,e,r){e0(t,e),e.set(t,r)}function e0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pC(t,e,r){return t.set(qu(t,e),r),r}function Ct(t,e){return t.get(qu(t,e))}function qu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Ek=100;var mr=new WeakMap,ws=new WeakMap,Kf=new WeakMap,Xf=new WeakSet;class wC{constructor(){Rk(this,Xf),Gf(this,mr,new Map),Gf(this,ws,new Map),Gf(this,Kf,new Set),fo.forEach(e=>qu(Xf,this,vC).call(this,e))}getHooks(e){var r;return(r=Ct(mr,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Ct(mr,this).has(e)||(qu(Xf,this,vC).call(this,e),fo.push(e));const i=Ct(mr,this).get(e),o=i.find(c=>c.callback===r);if(o){o.skip===!0&&(o.skip=!1);return}const s=Number.isInteger(n.orderIndex)?n.orderIndex:0,a=!!n.runOnce,l=!!n.initialHook;let u=!1;if(l){const c=i.find(h=>h.initialHook);c&&(c.callback=r,u=!0)}if(!u){i.push({callback:r,orderIndex:s,runOnce:a,initialHook:l,skip:!1});let c=Ct(Kf,this).has(e);!c&&s!==0&&(c=!0,Ct(Kf,this).add(e)),c&&i.length>1&&Ct(mr,this).set(e,i.toSorted((h,f)=>h.orderIndex-f.orderIndex))}}has(e){return Ct(mr,this).has(e)&&Ct(mr,this).get(e).length>0}remove(e,r){if(!Ct(mr,this).has(e))return!1;const n=Ct(mr,this).get(e),i=n.find(o=>o.callback===r);if(i){let o=Ct(ws,this).get(e);return i.skip=!0,o+=1,o>Ek&&(Ct(mr,this).set(e,n.filter(s=>!s.skip)),o=0),Ct(ws,this).set(e,o),!0}return!1}destroy(){Ct(mr,this).clear(),Ct(ws,this).clear(),pC(mr,this,null),pC(ws,this,null)}}function vC(t){Ct(mr,this).set(t,[]),Ct(ws,this).set(t,0)}function Tk(t,e,r){return(e=_k(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _k(t){var e=Ok(t,"string");return typeof e=="symbol"?e:e+""}function Ok(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Mk=Sr`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class pe{constructor(){Tk(this,"globalBucket",new wC)}static getSingleton(){return Hk()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new wC),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?z(r,o=>this.add(e,o,n)):(jf.has(e)&&Cr(H_(Mk,{hookName:e,removedInVersion:jf.get(e)})),zf.has(e)&&Cr(zf.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?z(r,o=>this.once(e,o,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?z(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,o,s,a,l){{const u=this.getBucket().getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=fm(u[h].callback,e,n,i,o,s,a,l);f!==void 0&&(n=f),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=fm(u[h].callback,e,n,i,o,s,a,l);f!==void 0&&(n=f),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback,e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||fo.push(e)}deregister(e){this.isRegistered(e)&&fo.splice(fo.indexOf(e),1)}isDeprecated(e){return zf.has(e)||jf.has(e)}isRegistered(e){return fo.indexOf(e)>=0}getRegistered(){return fo}}const Ik=new pe;function Hk(){return Ik}const bo=new Map;function Yo(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";bo.has(t)||bo.set(t,new Map);const e=bo.get(t);function r(l,u){e.set(l,u)}function n(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){bo.delete(t),e.clear()}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:s,clear:a}}function Ak(t,e){var r;return bo==null||(r=bo.get(t.guid))===null||r===void 0?void 0:r.get(e)}const gm=new WeakMap,{register:Pk,getItem:t0,hasItem:r0}=Yo("editors");function xk(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},pe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function Nk(t,e){let r;if(typeof t=="function")gm.get(t)||n0(null,t),r=gm.get(t);else if(typeof t=="string")r=t0(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function yC(t){if(typeof t=="function")return t;if(!r0(t))throw Error(`No registered editor found under "${t}" name`);return t0(t).getConstructor()}function n0(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new xk(e);typeof t=="string"&&Pk(t,r),gm.set(e,r)}function Dk(t,e,r){return(e=kk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kk(t){var e=Lk(t,"string");return typeof e=="symbol"?e:e+""}function Lk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $i{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Dk(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){n.call(this,Fk(s))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(r,o,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===r&&s.element===e){if(n&&n!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const o={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;n.createEvent?(s=n.createEvent("MouseEvents"),s.initMouseEvent(r,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,n.body.parentNode)):s=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${r}`,s)}}function Fk(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Ac(this)},t}function Vk(t,e){Wk(t,e),e.add(t)}function Wk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zi(t,e,r){return(e=Bk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bk(t){var e=$k(t,"string");return typeof e=="symbol"?e:e+""}function $k(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Dl=new WeakSet;class mm{constructor(e,r,n){Vk(this,Dl),Zi(this,"hot",void 0),Zi(this,"tableMeta",void 0),Zi(this,"selection",void 0),Zi(this,"eventManager",void 0),Zi(this,"destroyed",!1),Zi(this,"activeEditor",void 0),Zi(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new $i(e),this.hot.addHook("afterDocumentKeyDown",i=>Zf(Dl,this,bC).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>Zf(Dl,this,bC).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>Zf(Dl,this,jk).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,o=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let s=n,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=Nk(u,this.hot),this.activeEditor.prepare(n,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeActive();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeActive();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(n))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function bC(t){const e=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!e||e.highlight.isHeader()||ho(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!fk(r)&&!gk(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function jk(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const SC=new WeakMap;mm.getInstance=function(t,e,r){let n=SC.get(t);return n||(n=new mm(t,e,r),SC.set(t,n)),n};var CC={},Qf,RC;function zk(){if(RC)return Qf;RC=1;var t=Ur(),e=ko(),r=pn(),n=r("match");return Qf=function(i){var o;return t(i)&&((o=i[n])!==void 0?!!o:e(i)==="RegExp")},Qf}var Jf,EC;function Uk(){if(EC)return Jf;EC=1;var t=it(),e=ct(),r=t.RegExp,n=!e(function(){var i=!0;try{r(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(f,g){Object.defineProperty(o,f,{get:function(){return s+=g,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(o);return h!==a||s!==a});return Jf={correct:n},Jf}var eg,TC;function Yk(){if(TC)return eg;TC=1;var t=yt();return eg=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r},eg}var tg,_C;function qk(){if(_C)return tg;_C=1;var t=vt(),e=Yr(),r=ll(),n=Uk(),i=Yk(),o=RegExp.prototype;return tg=n.correct?function(s){return s.flags}:function(s){return!n.correct&&r(o,s)&&!e(s,"flags")?t(i,s):s.flags},tg}var rg,OC;function Gk(){if(OC)return rg;OC=1;var t=ot(),e=$s(),r=Math.floor,n=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return rg=function(l,u,c,h,f,g){var p=c+l.length,v=h.length,y=a;return f!==void 0&&(f=e(f),y=s),i(g,y,function(T,R){var _;switch(n(R,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,p);case"<":_=f[o(R,1,-1)];break;default:var b=+R;if(b===0)return T;if(b>v){var M=r(b/10);return M===0?T:M<=v?h[M-1]===void 0?n(R,1):h[M-1]+n(R,1):T}_=h[b-1]}return _===void 0?"":_})},rg}var MC;function Kk(){if(MC)return CC;MC=1;var t=De(),e=vt(),r=ot(),n=sl(),i=ht(),o=Ur(),s=zk(),a=pc(),l=ul(),u=qk(),c=Gk(),h=pn(),f=Lo(),g=h("replace"),p=TypeError,v=r("".indexOf),y=r("".replace),T=r("".slice),R=Math.max;return t({target:"String",proto:!0},{replaceAll:function(b,M){var P=n(this),A,D,V,B,q,L,ae,G,ee,st,Re=0,Ee="";if(o(b)){if(A=s(b),A&&(D=a(n(u(b))),!~v(D,"g")))throw new p("`.replaceAll` does not allow non-global regexes");if(V=l(b,g),V)return e(V,b,P,M);if(f&&A)return y(a(P),b,M)}for(B=a(P),q=a(b),L=i(M),L||(M=a(M)),ae=q.length,G=R(1,ae),ee=v(B,q);ee!==-1;)st=L?a(M(q,ee,B)):c(q,B,ee,[],void 0,M),Ee+=T(B,Re,ee)+st,Re=ee+ae,ee=ee+G>B.length?-1:v(B,q,ee+G);return Re<B.length&&(Ee+=T(B,Re)),Ee}}),CC}Kk();const i0={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Xk=new RegExp(Object.keys(i0).map(t=>`(${t})`).join("|"),"gi");function Zk(t){return(t&&t.nodeName||"")==="TABLE"}function IC(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,h=e?1:0;for(let f=0;f<o;f+=1){const g=e&&f===0,p=[];for(let y=0;y<s;y+=1){const T=!g&&r&&y===0;let R="";if(g)R=`<th>${t.getColHeader(y-c)}</th>`;else if(T)R=`<th>${t.getRowHeader(f-h)}</th>`;else{const _=i[f][y],{hidden:b,rowspan:M,colspan:P}=t.getCellMeta(f-h,y-c);if(!b){const A=[];if(M&&A.push(`rowspan="${M}"`),P&&A.push(`colspan="${P}"`),Mo(_))R=`<td ${A.join(" ")}></td>`;else{const D=_.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");R=`<td ${A.join(" ")}>${D}</td>`}}}p.push(R)}const v=["<tr>",...p,"</tr>"].join("");g?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function HC(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],o=i.length,s=[];n===0&&r.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Mo(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}r.push("<tr>",...s,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function AC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let o=t;if(typeof o=="string"){const _=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,b=>{const M=b.match(/<td\b[^>]*?>/g)[0],P=/<p.*?>/g,A=b.substring(M.length,b.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(P,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${M}${A}</td>`});i.insertAdjacentHTML("afterbegin",`${_}`),o=i.querySelector("table")}if(!o||!Zk(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((_,b)=>_+b.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let f=!1,g=0,p=0;if(o.tHead){const _=Array.from(o.tHead.rows).filter(b=>{const M=b.querySelector("td")!==null;return M&&h.push(b),!M});g=_.length,f=g>0,g>1?r.nestedHeaders=Array.from(_).reduce((b,M)=>{const P=Array.from(M.cells).reduce((A,D,V)=>{if(a&&V===0)return A;const{colSpan:B,innerHTML:q}=D,L=B>1?{label:q,colspan:B}:q;return A.push(L),A},[]);return b.push(P),b},[]):f&&(r.colHeaders=Array.from(_[0].children).reduce((b,M,P)=>(a&&P===0||b.push(M.innerHTML),b),[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((_,b)=>(_.push(...Array.from(b.rows)),_),[]),...c];p=v.length;const y=new Array(p);for(let _=0;_<p;_++)y[_]=new Array(u);const T=[],R=[];for(let _=0;_<p;_++){const b=v[_],M=Array.from(b.cells),P=M.length;for(let A=0;A<P;A++){const D=M[A],{nodeName:V,innerHTML:B,rowSpan:q,colSpan:L}=D,ae=y[_].findIndex(G=>G===void 0);if(V==="TD"){if(q>1||L>1){for(let Re=_;Re<_+q;Re++)if(Re<p)for(let Ee=ae;Ee<ae+L;Ee++)y[Re][Ee]=null;const ee=D.getAttribute("style");ee&&ee.includes("mso-ignore:colspan")||T.push({col:ae,row:_,rowspan:q,colspan:L})}let G="";s&&/excel/gi.test(s.content)?G=B.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):G=B.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[_][ae]=G.replace(Xk,ee=>i0[ee])}else R.push(B)}}return T.length&&(r.mergeCells=T),R.length&&(r.rowHeaders=R),y.length&&(r.data=y),r}function Qk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Et(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function PC(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function Jk(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ae(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}function Is(t){return Number.isInteger(t)&&t>=0}const pm="asc",eL="desc",xC=new Map([[pm,[-1,1]],[eL,[1,-1]]]),tL=t=>`The priority '${t}' is already declared in a map.`,rL=t=>`The priority '${t}' is not a number.`;function nL(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=Se(t)?t:tL,e=Se(e)?e:rL;function n(o,s){if(!Qk(o))throw new Error(e(o));if(r.has(o))throw new Error(t(o));r.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pm;const[s,a]=xC.get(o)||xC.get(pm);return[...r].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:n,getItems:i}}const iL=t=>`The id '${t}' is already declared in a map.`;function Sl(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Se(t)?t:iL;function r(c,h){if(u(c))throw new Error(t(c));e.set(c,h)}function n(c){return e.delete(c)}function i(){e.clear()}function o(c){const[h]=a().find(f=>{let[g,p]=f;return c===p?g:!1})||[null];return h}function s(c){return e.get(c)}function a(){return[...e]}function l(){return[...e.values()]}function u(c){return e.has(c)}return{addItem:r,clear:i,getId:o,getItem:s,getItems:a,getValues:l,hasItem:u,removeItem:n}}const oL=t=>`'${t}' value is already declared in a unique set.`;function sL(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Se(t)?t:oL;function r(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const Fp=t=>`There is already registered "${t}" plugin.`,aL=t=>`There is already registered plugin on priority "${t}".`,lL=t=>`The priority "${t}" is not a number.`,o0=nL({errorPriorityExists:aL,errorPriorityNaN:lL}),s0=sL({errorItemExists:Fp}),wm=Sl({errorIdExists:Fp});function a0(){return[...o0.getItems(),...s0.getItems()]}function Vp(t){const e=Mc(t);return wm.getItem(e)}function uL(t){return!!Vp(t)}function ng(t,e,r){[t,e,r]=hL(t,e,r),Vp(t)===void 0&&cL(t,e,r)}function cL(t,e,r){const n=Mc(t);if(wm.hasItem(n))throw new Error(Fp(n));r===void 0?s0.addItem(n):o0.addItem(r,n),wm.addItem(n,e)}function hL(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:dL,getItem:fL,hasItem:l0}=Yo("renderers");function NC(t){if(typeof t=="function")return t;if(!l0(t))throw Error(`No registered renderer found under "${t}" name`);return fL(t)}function gL(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),dL(t,e)}const{register:mL,getItem:pL,hasItem:u0}=Yo("validators");function wL(t){if(typeof t=="function")return t;if(!u0(t))throw Error(`No registered validator found under "${t}" name`);return pL(t)}function vL(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),mL(t,e)}var DC={},kC;function yL(){if(kC)return DC;kC=1;var t=De(),e=$s(),r=zs(),n=cl(),i=Lp();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=r(a),u=n(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),DC}yL();var LC={},FC;function bL(){if(FC)return LC;FC=1;var t=De(),e=ot(),r=sl(),n=cl(),i=pc(),o=ct(),s=e("".charAt),a=o(function(){return"ð ®·".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(r(this)),h=c.length,f=n(u),g=f>=0?f:h+f;return g<0||g>=h?void 0:s(c,g)}}),LC}bL();function la(t,e,r){return(e=SL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SL(t){var e=CL(t,"string");return typeof e=="symbol"?e:e+""}function CL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RL{constructor(){la(this,"count",0),la(this,"startColumn",null),la(this,"endColumn",null),la(this,"startPosition",null),la(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=r,a=i>0?o+1:o;n>=i&&n+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const p=u[this.endColumn]+c-u[this.startColumn-1];if(p<=i&&(this.startColumn-=1),p>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i,f=n+i-h,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);f<-1*o||n>u.at(-1)||-1*n-i>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function ua(t,e,r){return(e=EL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EL(t){var e=TL(t,"string");return typeof e=="symbol"?e:e+""}function TL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _L{constructor(){ua(this,"count",0),ua(this,"startRow",null),ua(this,"endRow",null),ua(this,"startPosition",null),ua(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=r;n>=i&&n+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const f=l[this.endRow]+u-l[this.startRow-1];if(f<=i-o&&(this.startRow-=1),f>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const c=n+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ca(t,e,r){return(e=OL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OL(t){var e=ML(t,"string");return typeof e=="symbol"?e:e+""}function ML(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class c0{constructor(){ca(this,"count",0),ca(this,"startColumn",null),ca(this,"endColumn",null),ca(this,"startPosition",null),ca(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o}=r;n<=i&&(this.startColumn=e);const s=i>0?o+1:o;n>=i&&n<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,g>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i;n+i-h<-1*o||n>u.at(-1)+c||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function ha(t,e,r){return(e=IL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IL(t){var e=HL(t,"string");return typeof e=="symbol"?e:e+""}function HL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h0{constructor(){ha(this,"count",0),ha(this,"startRow",null),ha(this,"endRow",null),ha(this,"startPosition",null),ha(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o}=r;n<=i&&(this.startRow=e),n>=i&&n<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-o<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function da(t,e,r){return(e=AL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AL(t){var e=PL(t,"string");return typeof e=="symbol"?e:e+""}function PL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xL{constructor(){da(this,"count",0),da(this,"startColumn",0),da(this,"endColumn",0),da(this,"startPosition",0),da(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function fa(t,e,r){return(e=NL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NL(t){var e=DL(t,"string");return typeof e=="symbol"?e:e+""}function DL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kL{constructor(){fa(this,"count",0),fa(this,"startRow",0),fa(this,"endRow",0),fa(this,"startPosition",0),fa(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function VC(t,e,r){return(e=LL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LL(t){var e=FL(t,"string");return typeof e=="symbol"?e:e+""}function FL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VL extends c0{constructor(){super(...arguments),VC(this,"columnStartOffset",0),VC(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof n=="function"){const s=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=o[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function WC(t,e,r){return(e=WL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WL(t){var e=BL(t,"string");return typeof e=="symbol"?e:e+""}function BL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $L extends h0{constructor(){super(...arguments),WC(this,"rowStartOffset",0),WC(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof n=="function"){const s=this.startRow,a=this.endRow;n(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=o[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function BC(t,e,r){return(e=jL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jL(t){var e=zL(t,"string");return typeof e=="symbol"?e:e+""}function zL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class d0{constructor(e){BC(this,"calculationTypes",[]),BC(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Qr(t,e,r){return(e=UL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UL(t){var e=YL(t,"string");return typeof e=="symbol"?e:e+""}function YL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Wp=50;class qL extends d0{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(r),Qr(this,"viewportWidth",0),Qr(this,"scrollOffset",0),Qr(this,"zeroBasedScrollOffset",0),Qr(this,"totalColumns",0),Qr(this,"columnWidthFn",null),Qr(this,"columnWidth",0),Qr(this,"overrideFn",null),Qr(this,"inlineStartOffset",0),Qr(this,"totalCalculatedWidth",0),Qr(this,"startPositions",[]),Qr(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?Wp:r}}function Hr(t,e,r){return(e=GL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GL(t){var e=KL(t,"string");return typeof e=="symbol"?e:e+""}function KL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XL extends d0{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(r),Hr(this,"viewportHeight",0),Hr(this,"scrollOffset",0),Hr(this,"zeroBasedScrollOffset",0),Hr(this,"totalRows",0),Hr(this,"rowHeightFn",null),Hr(this,"rowHeight",0),Hr(this,"overrideFn",null),Hr(this,"horizontalScrollbarHeight",0),Hr(this,"innerViewportHeight",0),Hr(this,"totalCalculatedHeight",0),Hr(this,"startPositions",[]),Hr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function ZL(t,e,r){QL(t,e),e.set(t,r)}function QL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $C(t,e,r){return(e=JL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JL(t){var e=eF(t,"string");return typeof e=="symbol"?e:e+""}function eF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zo(t,e){return t.get(f0(t,e))}function jC(t,e,r){return t.set(f0(t,e),r),r}function f0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Gn=new WeakMap;class Ho{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;$C(this,"row",null),$C(this,"col",null),ZL(this,Gn,!1),jC(Gn,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Zo(Gn,this)}isSouthEastOf(e){return this.row>=e.row&&(Zo(Gn,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Zo(Gn,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Zo(Gn,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Zo(Gn,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof Ho&&jC(Gn,this,e.isRtl()),this}clone(){return new Ho(this.row,this.col,Zo(Gn,this))}toObject(){return{row:this.row,col:this.col}}}function tF(t,e,r){rF(t,e),e.set(t,r)}function rF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ig(t,e,r){return(e=nF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nF(t){var e=iF(t,"string");return typeof e=="symbol"?e:e+""}function iF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ar(t,e){return t.get(g0(t,e))}function oF(t,e,r){return t.set(g0(t,e),r),r}function g0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Xt=new WeakMap;class Cl{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;ig(this,"highlight",null),ig(this,"from",null),ig(this,"to",null),tF(this,Xt,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),oF(Xt,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=r&&o.row>=r&&i.col<=n&&o.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,s.row),u=Math.min(n.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),f=this._createCellCoords(l,u),g=this._createCellCoords(c,h);return this.from=f,this.to=g,this.setDirection(o),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Ar(Xt,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Ar(Xt,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Ar(Xt,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Ar(Xt,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Ar(Xt,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Ar(Xt,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Ar(Xt,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Ar(Xt,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Ho))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(Ar(Xt,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(Ar(Xt,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&n.push(this._createCellCoords(i,o));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)e.row===i&&e.col===o?n.push(e):r.row===i&&r.col===o?n.push(r):n.push(this._createCellCoords(i,o));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let o=r.col;o<=n.col;o++)if(e(i,o)===!1)return}clone(){return new Cl(this.highlight,this.from,this.to,Ar(Xt,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Ho(e,r,Ar(Xt,this))}}function Cn(t,e,r){sF(t,e),e.set(t,r)}function sF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U(t,e){return t.get(m0(t,e))}function vi(t,e,r){return t.set(m0(t,e),r),r}function m0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Pr=new WeakMap,og=new WeakMap,mt=new WeakMap,Qo=new WeakMap,kl=new WeakMap,Jr=new WeakMap,sg=new WeakMap,ga=new WeakMap,Qi=new WeakMap,Rn=new WeakMap;let p0=class{constructor(e,r,n,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Cn(this,Pr,void 0),Cn(this,og,void 0),Cn(this,mt,void 0),Cn(this,Qo,void 0),Cn(this,kl,void 0),Cn(this,Jr,void 0),Cn(this,sg,void 0),Cn(this,ga,void 0),Cn(this,Qi,[null,null]),Cn(this,Rn,[null,null]),vi(Pr,this,n),vi(og,this,r),vi(mt,this,o),vi(Qo,this,s),vi(kl,this,a),vi(Jr,this,i),vi(sg,this,e),this.registerEvents()}registerEvents(){U(Jr,this).addEventListener(U(mt,this).holder,"contextmenu",n=>this.onContextMenu(n)),U(Jr,this).addEventListener(U(mt,this).TABLE,"mouseover",n=>this.onMouseOver(n)),U(Jr,this).addEventListener(U(mt,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{U(Jr,this).addEventListener(U(mt,this).holder,"touchstart",n=>this.onTouchStart(n)),U(Jr,this).addEventListener(U(mt,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),U(Jr,this).addEventListener(U(mt,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||U(Pr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,U(Pr,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{U(Jr,this).addEventListener(U(mt,this).holder,"mouseup",n=>this.onMouseUp(n)),U(Jr,this).addEventListener(U(mt,this).holder,"mousedown",n=>this.onMouseDown(n))};Ai()?e():(jD()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(U(ga,this)&&n){const[i,o]=[n.row,U(ga,this).from.row],[s,a]=[n.col,U(ga,this).from.col];return i===o&&s===a}return!1}parentCell(e){const r={},n=U(mt,this).TABLE,i=Nl(e,["TD","TH"],n);return i?(r.coords=U(mt,this).getCoords(i),r.TD=i):me(e,"wtBorder")&&me(e,"current")?(r.coords=U(Qo,this).getFocusSelection().cellRange.highlight,r.TD=U(mt,this).getCell(r.coords)):me(e,"wtBorder")&&me(e,"area")&&U(Qo,this).getAreaSelection().cellRange&&(r.coords=U(Qo,this).getAreaSelection().cellRange.to,r.TD=U(mt,this).getCell(r.coords)),r}onMouseDown(e){const r=U(og,this).rootDocument.activeElement,n=hk(ZD,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const o=this.parentCell(i);me(i,"corner")?U(Pr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&U(Pr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(U(Rn,this)[0]=o.TD,clearTimeout(U(Qi,this)[0]),U(Qi,this)[0]=setTimeout(()=>{U(Rn,this)[0]=null},1e3))}onContextMenu(e){if(U(Pr,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!U(Pr,this).has("onCellMouseOver"))return;const r=U(mt,this).TABLE,n=Nl(e.target,["TD","TH"],r),i=U(kl,this)||this;n&&n!==i.lastMouseOver&&Ms(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,U(mt,this).getCoords(n),n))}onMouseOut(e){if(!U(Pr,this).has("onCellMouseOut"))return;const r=U(mt,this).TABLE,n=Nl(e.target,["TD","TH"],r),i=Nl(e.relatedTarget,["TD","TH"],r),o=U(kl,this)||this;n&&n!==i&&Ms(n,r)&&(this.callListener("onCellMouseOut",e,U(mt,this).getCoords(n),n),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&U(Pr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===U(Rn,this)[0]&&r.TD===U(Rn,this)[1]?(me(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),U(Rn,this)[0]=null,U(Rn,this)[1]=null):r.TD===U(Rn,this)[0]&&(U(Rn,this)[1]=r.TD,clearTimeout(U(Qi,this)[1]),U(Qi,this)[1]=setTimeout(()=>{U(Rn,this)[1]=null},500)))}onTouchStart(e){vi(ga,this,U(Qo,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,o=ue(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&U(Pr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];V_()&&(GD()||KD())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const o=U(Pr,this).getSettingPure(e);o&&o(r,n,i,U(sg,this).call(this))}destroy(){clearTimeout(U(Qi,this)[0]),clearTimeout(U(Qi,this)[1]),U(Jr,this).destroy()}};function ag(t,e,r){return(e=aF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aF(t){var e=lF(t,"string");return typeof e=="symbol"?e:e+""}function lF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uF{constructor(e,r,n){ag(this,"offset",void 0),ag(this,"total",void 0),ag(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function lg(t,e,r){return(e=cF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cF(t){var e=hF(t,"string");return typeof e=="symbol"?e:e+""}function hF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dF{constructor(e,r,n){lg(this,"offset",void 0),lg(this,"total",void 0),lg(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Ll(t,e,r){return(e=fF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fF(t){var e=gF(t,"string");return typeof e=="symbol"?e:e+""}function gF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mF{constructor(){Ll(this,"currentSize",0),Ll(this,"nextSize",0),Ll(this,"currentOffset",0),Ll(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const pF=0,zC=1,vm=2;function ug(t,e,r){return(e=wF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wF(t){var e=vF(t,"string");return typeof e=="symbol"?e:e+""}function vF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yF{constructor(){ug(this,"size",new mF),ug(this,"workingSpace",pF),ug(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=zC,e.workingSpace=vm,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=vm,e.workingSpace=zC,this.sharedSize=e.getViewSize()}}var UC={},cg,YC;function bF(){if(YC)return cg;YC=1;var t=mc(),e=TypeError;return cg=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))},cg}var qC;function SF(){if(qC)return UC;qC=1;var t=De(),e=$s(),r=zs(),n=wT(),i=bF(),o=vT(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),f=r(h),g=arguments.length;if(g){o(f+g);for(var p=f;p--;){var v=p+g;p in h?h[v]=h[p]:i(h,v)}for(var y=0;y<g;y++)h[y]=arguments[y]}return n(h,f+g)}}),UC}SF();function CF(t,e,r){return(e=RF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RF(t){var e=EF(t,"string");return typeof e=="symbol"?e:e+""}function EF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GC{constructor(e,r){CF(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function TF(t,e,r){return(e=_F(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _F(t){var e=OF(t,"string");return typeof e=="symbol"?e:e+""}function OF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MF{constructor(e){TF(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new GC(o,r),l=new GC(s,n),u=[];for(let c=0;c<i;c++){const h=a.get(c),f=l.get(c);if(f===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(vm)?u.push(["append",f]):u.push(["prepend",f]);else if(f>h)a.has(f)&&(a.remove(f),n<=a.length&&(i-=1)),u.push(["replace",f,h]);else if(f<h){const g=a.prepend(f);u.push(["insert_before",f,h,g])}else u.push(["none",f])}return u}}function Jo(t,e,r){return(e=IF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IF(t){var e=HF(t,"string");return typeof e=="symbol"?e:e+""}function HF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w0{constructor(e,r){Jo(this,"rootNode",void 0),Jo(this,"nodesPool",void 0),Jo(this,"sizeSet",new yF),Jo(this,"collectedNodes",[]),Jo(this,"viewDiffer",new MF(this.sizeSet)),Jo(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(o)),r.removeChild(this.nodesPool(s));break;case"replace":r.replaceChild(a,this.nodesPool(o));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class v0 extends w0{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function KC(t,e,r){return(e=AF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AF(t){var e=PF(t,"string");return typeof e=="symbol"?e:e+""}function PF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xF{constructor(e){KC(this,"nodeType",void 0),KC(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function ma(t,e,r){return(e=NF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NF(t){var e=DF(t,"string");return typeof e=="symbol"?e:e+""}function DF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rl{constructor(e,r){ma(this,"nodesPool",null),ma(this,"nodeType",void 0),ma(this,"rootNode",void 0),ma(this,"table",null),ma(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new xF(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function XC(t,e,r){return(e=kF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kF(t){var e=LF(t,"string");return typeof e=="symbol"?e:e+""}function LF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FF extends Rl{constructor(){super("TH"),XC(this,"orderViews",new WeakMap),XC(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new v0(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(n).setOffset(0).start();for(let h=n-1;h>=0;h--){u.render();const f=u.getCurrentNode();f.className="",f.removeAttribute("style"),yl(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ce(f,[ID(),DD(),Hp(h+1),Uo(-1)]),r[h](a,f,h)}u.end()}}}class VF extends Rl{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Ls(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ce(this.rootNode,[P_()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&Ce(s,[x_(),D_(r+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),yl(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ce(u,[Hp(a+1+this.table.rowHeadersCount),Uo(-1),HD(),...a>=0?[ND()]:[MD(),ju("Select whole grid")]]),n[r](l,u,r)}}}}let ZC=!1;class WF extends Rl{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!ZC&&e>1e3&&(ZC=!0,Cr(Sr`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+r].style.width=`${s}px`}const n=this.rootNode.firstChild;n&&K(n,"rowHeader")}}function BF(t,e,r){return(e=$F(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $F(t){var e=jF(t,"string");return typeof e=="symbol"?e:e+""}function jF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const es={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let QC=!1;class zF extends Rl{constructor(e){super("TR",e),BF(this,"orderView",void 0),this.orderView=new w0(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!QC&&e>1e3&&(QC=!0,Cr(Sr`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ce(this.rootNode,[P_()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;Ce(o,[x_(),D_(s+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(s+1)%2===0?me(o,es.rowEven)||(Oe(o,es.rowOdd),K(o,es.rowEven)):me(o,es.rowOdd)||(Oe(o,es.rowEven),K(o,es.rowOdd))}this.orderView.end()}}function JC(t,e,r){return(e=UF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UF(t){var e=YF(t,"string");return typeof e=="symbol"?e:e+""}function YF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qF extends Rl{constructor(){super("TD"),JC(this,"orderViews",new WeakMap),JC(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new v0(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(r).setOffset(0).start();for(let f=0;f<r;f++){c.render();const g=this.table.renderedColumnToSource(f),p=c.getCurrentNode();if(me(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),yl(p,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,g,p),this.table.isAriaEnabled()){var o,s;Ce(p,[...p.hasAttribute("role")?[]:[OD()],Uo(-1),Hp(g+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function at(t,e,r){return(e=GF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GF(t){var e=KF(t,"string");return typeof e=="symbol"?e:e+""}function KF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XF{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};at(this,"rootNode",void 0),at(this,"rootDocument",void 0),at(this,"rowHeaders",null),at(this,"columnHeaders",null),at(this,"colGroup",null),at(this,"rows",null),at(this,"cells",null),at(this,"rowFilter",null),at(this,"columnFilter",null),at(this,"rowUtils",null),at(this,"columnUtils",null),at(this,"rowsToRender",0),at(this,"columnsToRender",0),at(this,"rowHeaderFunctions",[]),at(this,"rowHeadersCount",0),at(this,"columnHeaderFunctions",[]),at(this,"columnHeadersCount",0),at(this,"cellRenderer",void 0),at(this,"activeOverlayName",void 0),at(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(n),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class ZF{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new XF(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new FF,columnHeaders:new VF(r),colGroup:new WF(n),rows:new zF(i),cells:new qF}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function hg(t,e,r){return(e=QF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QF(t){var e=JF(t,"string");return typeof e=="symbol"?e:e+""}function JF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eV{constructor(e,r){hg(this,"dataAccessObject",void 0),hg(this,"wtSettings",void 0),hg(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<n;o++){let s=Array.isArray(r)?r[o]:r;s=s??i,this.headerWidths.set(o,s)}}}}function eR(t,e,r){return(e=tV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tV(t){var e=rV(t,"string");return typeof e=="symbol"?e:e+""}function rV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nV{constructor(e,r){eR(this,"dataAccessObject",void 0),eR(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function En(t,e,r){return(e=iV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iV(t){var e=oV(t,"string");return typeof e=="symbol"?e:e+""}function oV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ks{constructor(e,r,n,i,o){En(this,"wtSettings",null),En(this,"domBindings",void 0),En(this,"TBODY",null),En(this,"THEAD",null),En(this,"COLGROUP",null),En(this,"hasTableHeight",!0),En(this,"hasTableWidth",!0),En(this,"isTableVisible",!1),En(this,"tableOffset",0),En(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,j_(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new nV(this.dataAccessObject,this.wtSettings),this.columnUtils=new eV(this.dataAccessObject,this.wtSettings),this.tableRenderer=new ZF({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!me(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ce(n,[Hi()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!me(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ce(n,[Hi()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!me(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",this.isMaster&&Ce(n,[Uo(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ce(n.parentNode,[Hi()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ce(n,[Hi()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,o=r.getSetting("totalRows"),s=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,u=r.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Fr(this.holder),h=i.createCalculators(h),l&&!r.getSetting("fixedColumnsStart"))){const g=n.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,p!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Fr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=Math.max(this.getFirstRenderedRow(),0),p=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new dF(g,o,c),this.columnFilter=new uF(p,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),v=y.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Pn)||this.is(Li))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Pn))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Pn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let f=!1;return this.isMaster&&(f=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(f=n.bottomOverlay.resetFixedPosition()||f),f=n.inlineStartOverlay.resetFixedPosition()||f,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),f?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,o=this.getColumnHeaderHeight(n),s=this.getColumnHeader(r,n),s&&(a=Ua(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(n[o]){if(!r[o]||r[o].childNodes.length===0)return;r[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Pn))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const o=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[o]&&(r.oversizedRows[o]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const o=this.getRow(r);if(!o&&r>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var o;r=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[n];o&&r.push(o)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a?.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o?.childNodes[i];s&&r.push(s)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=W_(r,["TD","TH"])),r===null)return null;const n=r.parentNode;if(!n)return null;const i=n.parentNode;let o=ek(n),s=r.cellIndex;Xi(xo,r,this.wtRootElement)||Xi(Ao,r,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Xi(Li,r,this.wtRootElement)||Xi(Pn,r,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),Xi(xo,r,this.wtRootElement)||Xi(Po,r,this.wtRootElement)||Xi(Li,r,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=this.wtSettings.getSetting("stylesHandler"),n=e*r.getDefaultRowHeight(),i=Ua(this.TBODY)-1,o=r.areCellsBorderBox(),s=o?ur:Ua,a=o?0:1,l=o?1:0;let u,c,h,f,g;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),f=this.getTrForRow(h),g=f.querySelector("th");const p=h===0?l:0;g?c=s(g):c=s(f)-a,(!u&&r.getDefaultRowHeight()<c-p||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return lr(this.TABLE)}getHeight(){return ur(this.TABLE)}getTotalWidth(){const e=lr(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=ur(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Fs(this.TABLE)}_modifyRowHeaderWidth(e){let r=Se(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const sV="stickyRowsBottom",Bp={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};pi(Bp,"MIXIN_NAME",sV,{writable:!1,enumerable:!1});const aV="stickyColumnsStart",Pc={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};pi(Pc,"MIXIN_NAME",aV,{writable:!1,enumerable:!1});class $p extends Ks{constructor(e,r,n,i){super(e,r,n,i,Li)}}Ke($p,Bp);Ke($p,Pc);const Ao="top",Pn="bottom",Po="inline_start",xo="top_inline_start_corner",Li="bottom_inline_start_corner",y0=[Ao,Pn,Po,xo,Li],lV=new Map([[Ao,`ht_clone_${Ao}`],[Pn,`ht_clone_${Pn}`],[Po,`ht_clone_${Po} ht_clone_left`],[xo,`ht_clone_${xo} ht_clone_top_left_corner`],[Li,`ht_clone_${Li} ht_clone_bottom_left_corner`]]);function uV(t,e){cV(t,e),e.add(t)}function cV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hV(t,e,r){return(e=dV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dV(t){var e=fV(t,"string");return typeof e=="symbol"?e:e+""}function fV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var pa=new WeakSet;class gV{constructor(e){uV(this,pa),hV(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),o=this.scrollViewportVertically(e.row,n);return i||o}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const o=yr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),h}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const o=yr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=r==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let f=!1;return(u&&(e<c||e>h)||!u)&&(f=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():r==="bottom")),f}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Fl(pa,this,rR).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Fl(pa,this,rR).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Fl(pa,this,tR).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Fl(pa,this,tR).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function tR(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(r.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=n.TABLE.getBoundingClientRect(),f=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-f)}else l=Fr(n.wtRootElement).left;const u=Math.abs(Y_(s,s));if(l>u){const c=q_(s);let h=i.getRowHeaderWidth();for(let f=1;f<=o;f++)if(h+=r.sumCellSizes(f-1,f),l+h-u>=c){t=f-2;break}}}return t}function rR(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Fr(r.wtRootElement),a=Dp(o,o);if(s.top>a){const l=Ua(o);let u=n.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function xr(t,e,r){return(e=mV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mV(t){var e=pV(t,"string");return typeof e=="symbol"?e:e+""}function pV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jp{get eventManager(){return new $i(this)}constructor(e,r){xr(this,"wtTable",void 0),xr(this,"wtScroll",void 0),xr(this,"wtViewport",void 0),xr(this,"wtOverlays",void 0),xr(this,"selectionManager",void 0),xr(this,"wtEvent",void 0),xr(this,"guid",`wt_${I_()}`),xr(this,"drawInterrupted",!1),xr(this,"drawn",!1),xr(this,"activeOverlayName","master"),xr(this,"domBindings",void 0),xr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new gV(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){bl(n,e[r])}])}}createCellCoords(e,r){return new Ho(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new Cl(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||rk(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function nR(t,e,r){return(e=wV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wV(t){var e=vV(t,"string");return typeof e=="symbol"?e:e+""}function vV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yV extends jp{constructor(e,r,n){super(e,r),nR(this,"cloneSource",void 0),nR(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new p0(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function bV(t,e,r){return(e=SV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SV(t){var e=CV(t,"string");return typeof e=="symbol"?e:e+""}function CV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class El{constructor(e,r,n,i,o){bV(this,"wtSettings",null),pi(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Uu(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Uu(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=zu(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){Cr(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),s=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!r)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Ut())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:n.start+s,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=s.horizontal-o.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(y0.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=n.createElement("div"),s=n.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${lV.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,r.getSetting("ariaTags")&&Ce(o,[Hi()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Ao||u==="vertical"&&this.type===Po?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=zu(e.TABLE),new yV(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,o=e.parentNode.style;[n,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class RV extends El{constructor(e,r,n,i,o,s){super(e,r,Li,n,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new $p(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${o}px`,r.style.bottom=`${s}px`}else Hc(r),this.repositionOverlay();let n=ur(this.clone.wtTable.TABLE);const i=lr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=Ut(n)),i.style.bottom=`${o}px`}}const EV="calculatedColumns",xc={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};pi(xc,"MIXIN_NAME",EV,{writable:!1,enumerable:!1});class zp extends Ks{constructor(e,r,n,i){super(e,r,n,i,Pn)}}Ke(zp,Bp);Ke(zp,xc);function TV(t,e,r){return(e=_V(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _V(t){var e=OV(t,"string");return typeof e=="symbol"?e:e+""}function OV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MV extends El{constructor(e,r,n,i){super(e,r,Pn,n,i),TV(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new zp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=Ut(n)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(Np(r),top),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<r;){const l=n.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=Ut(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=ur(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;r&&o.offsetHeight!==o.clientHeight&&(s=Ut(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=s,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Dp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((n||r===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=me(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(K(s,"innerBorderBottom"),o=!a):(Oe(s,"innerBorderBottom"),o=a)}return o}}const IV="calculatedRows",Up={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};pi(Up,"MIXIN_NAME",IV,{writable:!1,enumerable:!1});class Yp extends Ks{constructor(e,r,n,i){super(e,r,n,i,Po)}}Ke(Yp,Up);Ke(Yp,Pc);const HV="localHooks",Wn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},removeLocalHook(t,e){if(this._localHooks[t]){const r=this._localHooks[t].indexOf(e);r>-1&&this._localHooks[t].splice(r,1)}return this},runLocalHooks(t,e,r,n,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)fm(this._localHooks[t][l],this,e,r,n,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};pi(Wn,"MIXIN_NAME",HV,{writable:!1,enumerable:!1});let b0=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};Ke(b0,Wn);const AV="active-header",S0="header",qp="area",Gu="focus",PV="fill",xV="row",NV="column",DV="custom-selection",Gp=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var iR={},oR;function kV(){if(oR)return iR;oR=1;var t=Lp();return t("flat"),iR}kV();function LV(t,e){C0(t,e),e.add(t)}function sR(t,e,r){C0(t,e),e.set(t,r)}function C0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function je(t,e){return t.get(Ya(t,e))}function aR(t,e,r){return t.set(Ya(t,e),r),r}function Ya(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var rn=new WeakMap,Pt=new WeakMap,Vl=new WeakSet;class FV{constructor(){LV(this,Vl),sR(this,rn,void 0),sR(this,Pt,void 0)}setActiveOverlay(e){return aR(Pt,this,e),this}setActiveSelection(e){return aR(rn,this,e),this}scan(){const e=je(rn,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,o]=je(rn,this).getCorners(),{wtTable:s}=je(Pt,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<n||h>o)){for(let f=-l;f<0;f++){if(f<r||f>i)continue;const g=f+l;let p=s.getColumnHeader(h,g);const v=je(Pt,this).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:je(rn,this).settings.selectionType,columnCursor:u,selectionWidth:o-n+1});v!==null&&(v!==h&&(p=s.getColumnHeader(v,g)),e(p))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,o]=je(rn,this).getCorners(),{wtTable:s}=je(Pt,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<r||h>i)){for(let f=-l;f<0;f++){if(f<n||f>o)continue;const g=f+l;let p=s.getRowHeader(h,g);const v=je(Pt,this).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:je(rn,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});v!==null&&(v!==h&&(p=s.getRowHeader(v,g)),e(p))}u+=1}}}scanCellsRange(e){const{wtTable:r}=je(Pt,this);Ya(Vl,this,VV).call(this,(n,i)=>{const o=r.getCell(je(Pt,this).createCellCoords(n,i)),s=je(Pt,this).getSetting("onAfterDrawSelection",n,i,je(rn,this).settings.layerLevel);typeof s=="string"&&K(o,s),e(o)})}scanRowsInCellsRange(e){const[r,,n]=je(rn,this).getCorners(),{wtTable:i}=je(Pt,this);Ya(Vl,this,lR).call(this,(o,s)=>{if(o>=r&&o<=n){const a=i.getCell(je(Pt,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=je(rn,this).getCorners(),{wtTable:i}=je(Pt,this);Ya(Vl,this,lR).call(this,(o,s)=>{if(s>=r&&s<=n){const a=i.getCell(je(Pt,this).createCellCoords(o,s));e(a)}})}}function VV(t){let[e,r,n,i]=je(rn,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:o}=je(Pt,this),s=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),s){if(r=Math.max(r,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),n=Math.min(n,o.getLastRenderedRow()),i<r||n<e)return}else{const a=o.getCell(je(Pt,this).createCellCoords(e,r));if(!To(a))return}for(let a=e;a<=n;a+=1)for(let l=r;l<=i;l+=1)t(a,l)}function lR(t){const{wtTable:e}=je(Pt,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<n;s+=1)t(o,e.columnFilter.renderedToSource(s))}}const uR="ht-border-style-",WV="-vertical",BV="-horizontal";class cR{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Gp(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ac(e);const n=this,i=this.wot.rootDocument.body,o=r.getBoundingClientRect();r.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],u=r.createElement("div"),c=f=>this.settings[l]&&this.settings[l][f]?this.settings[l][f]:e.border[f];u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style;const h=c("style");h?(["start","end"].includes(l)?u.className+=` ${uR}${h}${WV}`:u.className+=` ${uR}${h}${BV}`,i.setProperty("--ht-custom-border-size",`${c("width")}px`),i.setProperty("--ht-custom-border-color",c("color"))):i.backgroundColor=c("color"),i.height=`${c("width")}px`,i.width=`${c("width")}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ai()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=r.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:r}=this.wot,n=r.getSetting("stylesHandler"),i=n.getCSSVariableValue("cell-mobile-handle-size"),o=n.getCSSVariableValue("cell-mobile-handle-border-radius"),s=n.getCSSVariableValue("cell-mobile-handle-background-color"),a=n.getCSSVariableValue("cell-mobile-handle-border-width"),l=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};Me(h,(g,p)=>{this.selectionHandles.styles.bottomHitArea[p]=g,this.selectionHandles.styles.topHitArea[p]=g});const f=n.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};Me(f,(g,p)=>{this.selectionHandles.styles.bottom[p]=g,this.selectionHandles.styles.top[p]=g}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:f}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),p=parseInt(u.width,10),v=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),T=this.wot.wtTable.getHeight();u.top=`${parseInt(n-p-1,10)}px`,u[l]=`${parseInt(i-p-1,10)}px`,c.top=`${parseInt(n-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const R=Math.min(parseInt(i+o,10),y-p-g*2),_=Math.min(parseInt(i+o-v/4,10),y-v-g*2);h[l]=`${R}px`,f[l]=`${_}px`;const b=Math.min(parseInt(n+s,10),T-p-g*2),M=Math.min(parseInt(n+s-v/4,10),T-v-g*2);h.top=`${b}px`,f.top=`${M}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,r)?(h.display="none",f.display="none"):(h.display="block",f.display="block")):(u.display="none",h.display="none",c.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,o]=e;if(r<0&&i<0||n<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=r!==i||n!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),f=s.getLastRenderedRow(),g=s.getFirstRenderedColumn(),p=s.getLastRenderedColumn();if(g<0&&p<0||h<0&&f<0){this.disappear();return}let v;if(u){if(n=Math.max(n,g),o=Math.min(o,p),r=Math.max(r,h),i=Math.min(i,f),o<n||i<r){this.disappear();return}v=s.getCell(this.wot.createCellCoords(r,n))}else if(v=s.getCell(this.wot.createCellCoords(r,n)),!To(v)){this.disappear();return}const y=u?s.getCell(this.wot.createCellCoords(i,o)):v,T=Fr(v),R=u?Fr(y):T,_=Fr(s.TABLE),b=T.top,M=T.left,P=this.wot.wtSettings.getSetting("rtlMode");let A=0,D=0;if(P){const Ee=lr(s.TABLE),$e=lr(v),Fe=l.innerWidth-_.left-Ee;D=M+$e-R.left,A=l.innerWidth-M-$e-Fe-1}else D=R.left+lr(y)-M,A=M-_.left-1;if(this.isEntireColumnSelected(r,i)){const Ee=r,$e=this.getDimensionsFromHeader("columns",n,o,Ee,_);let Fe=null;$e&&([Fe,A,D]=$e),Fe&&(v=Fe)}let V=b-_.top-1,B=R.top+ur(y)-b;if(this.isEntireRowSelected(n,o)){const Ee=n,$e=this.getDimensionsFromHeader("rows",r,i,Ee,_);let Fe=null;$e&&([Fe,V,B]=$e),Fe&&(v=Fe)}const q=l.getComputedStyle(v);parseInt(q.borderTopWidth,10)>0&&(V+=1,B=B>0?B-1:0),parseInt(q[P?"borderRightWidth":"borderLeftWidth"],10)>0&&(A+=1,D=D>0?D-1:0);const L=P?"right":"left",ae=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${V}px`,this.topStyle[L]=`${A}px`,this.topStyle.width=`${D+ae}px`,this.topStyle.display="block",this.startStyle.top=`${V}px`,this.startStyle[L]=`${A}px`,this.startStyle.height=`${B+ae}px`,this.startStyle.display="block",this.bottomStyle.top=`${V+B-parseInt(this.bottomStyle.height,10)+ae}px`,this.bottomStyle[L]=`${A}px`,this.bottomStyle.width=`${D+ae}px`,this.bottomStyle.display="block",this.endStyle.top=`${V}px`,this.endStyle[L]=`${A+D-parseInt(this.endStyle.width,10)+ae}px`,this.endStyle.height=`${B+ae}px`,this.endStyle.display="block";let G=this.settings.border.cornerVisible;G=typeof G=="function"?G(this.settings.layerLevel):G;const ee=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[st,Re]=[i,o];if(ee&&Array.isArray(ee)&&([,,st,Re]=ee),Ai()||!G||this.isPartRange(st,Re))this.cornerStyle.display="none";else{this.cornerStyle.top=`${V+B+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[L]=`${A+D+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Ee=Uu(s.TABLE);const $e=Ee===l;$e&&(Ee=a.documentElement);const Fe=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Ie=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),Kr=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const Te=$e?y.getBoundingClientRect().left:y.offsetLeft;let Gt=!1,d=0;if(P?(d=Te-parseInt(this.cornerDefaultStyle.width,10)/2,Gt=d<0):(d=Te+lr(y)+parseInt(this.cornerDefaultStyle.width,10)/2,Gt=d>=q_(Ee)),Gt){const m=Math.floor(A+D+this.cornerCenterPointOffset-Ie-Fe);c?(this.cornerStyle[L]=`${m}px`,this.cornerStyle[P?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[L]=`${m-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&($e?y.getBoundingClientRect().top:y.offsetTop)+ur(y)+parseInt(this.cornerDefaultStyle.height,10)/2>=Ua(Ee)){const m=Math.floor(V+B+this.cornerCenterPointOffset-Kr-Fe);c?(this.cornerStyle.top=`${m}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${m-1}px`}this.cornerStyle.display="block"}Ai()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,V,A,D,B)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,f=null,g=null,p=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return ur(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return lr(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(p=l(r,y-i),v=l(n,y-i),!p||!v)return!1;const T=Fr(p),R=Fr(v);return p&&v&&(h=T[g]-o[g]-1,f=R[g]+u(v)-T[g]),[p,h,f]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?K(this[e],"hidden"):(me(this[e],"hidden")&&Oe(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?K(this[e],"hidden"):Oe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ai()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function $V(t,e){R0(t,e),e.add(t)}function ts(t,e,r){R0(t,e),e.set(t,r)}function R0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function se(t,e){return t.get(Kp(t,e))}function hR(t,e,r){return t.set(Kp(t,e),r),r}function Kp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var xt=new WeakMap,rr=new WeakMap,dg=new WeakMap,Na=new WeakMap,fg=new WeakMap,Ji=new WeakMap,dR=new WeakSet;class jV{constructor(e){$V(this,dR),ts(this,xt,void 0),ts(this,rr,void 0),ts(this,dg,new FV),ts(this,Na,new WeakMap),ts(this,fg,new WeakSet),ts(this,Ji,new Map),hR(rr,this,e)}setActiveOverlay(e){return hR(xt,this,e),se(dg,this).setActiveOverlay(se(xt,this)),se(Na,this).has(se(xt,this))||se(Na,this).set(se(xt,this),new Set),this}getFocusSelection(){return se(rr,this)!==null?se(rr,this).getFocus():null}getAreaSelection(){return se(rr,this)!==null?se(rr,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(se(Ji,this).has(e)){const n=se(Ji,this).get(e);if(n.has(se(xt,this)))return n.get(se(xt,this));const i=new cR(se(xt,this),e.settings);return n.set(se(xt,this),i),i}const r=new cR(se(xt,this),e.settings);return se(Ji,this).set(e,new Map([[se(xt,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=se(Ji,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){se(Ji,this).get(e).forEach(r=>r.destroy()),se(Ji,this).delete(e)}render(e){if(se(rr,this)===null)return;e&&Kp(dR,this,zV).call(this);const r=Array.from(se(rr,this)),n=new Map,i=new Map;for(let o=0;o<r.length;o++){const s=r[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;se(fg,this).has(s)||(se(fg,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h?.disappear();continue}a&&se(dg,this).setActiveSelection(s).scan().forEach(p=>{if(n.has(p)){const v=n.get(p);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else n.set(p,new Map([[a,1]]));l&&(i.has(p)||i.set(p,[]),p.nodeName==="TH"&&i.get(p).push(...l))});const f=s.getCorners();se(xt,this).getSetting("onBeforeDrawBorders",f,c),h?.appear(f)}n.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(f,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>se(Na,this).get(se(xt,this)).add(u)),K(s,l),s.nodeName==="TD"&&Array.isArray((a=se(rr,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Ce(s,se(rr,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Ce(o,[...i.get(o)])})}}function zV(){const t=se(Na,this).get(se(xt,this)),e=se(xt,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const o=se(xt,this).wtTable.TABLE.querySelectorAll(`.${r}`);let s=[];Array.isArray((n=se(rr,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(s=se(rr,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=se(rr,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...se(rr,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)Oe(o[a],r),yl(o[a],s)}),t.clear()}class UV extends El{constructor(e,r,n,i){super(e,r,Po,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Yp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),kp(n,`${o}px`,"0px")):(o=this.getScrollPosition(),Hc(n));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){const o=r.scrollX;r.scrollTo(e,U_(r)),n=o!==r.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,n=o!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<r;)o+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(u-=Ut(n)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=lr(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=Gp(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!me(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(r){const h=this.wot.wtTable.getColumnWidth(e),f=this.wot.wtViewport.getViewportWidth();h>f&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(c=Ut(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,ik(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(Y_(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),s=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";s?Oe(n,"emptyRows"):K(n,"emptyRows");let l=!1;if(!a){if(o&&!i.length)K(n,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=me(n,"innerBorderInlineStart");e?(K(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(Oe(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const YV="stickyRowsTop",Xp={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};pi(Xp,"MIXIN_NAME",YV,{writable:!1,enumerable:!1});class Zp extends Ks{constructor(e,r,n,i){super(e,r,n,i,xo)}}Ke(Zp,Xp);Ke(Zp,Pc);function fR(t,e,r){return(e=qV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qV(t){var e=GV(t,"string");return typeof e=="symbol"?e:e+""}function GV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KV extends El{constructor(e,r,n,i,o,s){super(e,r,xo,n,i),fR(this,"topOverlay",void 0),fR(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Zp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();kp(e,`${i}px`,`${o}px`)}else Hc(e);let r=ur(this.clone.wtTable.TABLE);const n=lr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class Qp extends Ks{constructor(e,r,n,i){super(e,r,n,i,Ao)}}Ke(Qp,Xp);Ke(Qp,xc);function XV(t,e,r){return(e=ZV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZV(t){var e=QV(t,"string");return typeof e=="symbol"?e:e+""}function QV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JV extends El{constructor(e,r,n,i){super(e,r,Ao,n,i),XV(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Qp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),kp(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Hc(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(Np(r),e),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<r;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?n:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=Ut(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=ur(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=Gp(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,s=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!me(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(r){const f=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();f>g&&(r=!1)}if(r&&s.offsetHeight!==s.clientHeight&&(h=Ut(this.domBindings.rootDocument)),r){const f=i.getSetting("fixedRowsBottom"),g=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(g-f,g),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,nk(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Dp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,o=n.getSetting("totalColumns"),s=n.getSetting("preventOverflow")==="horizontal";o?Oe(i,"emptyColumns"):K(i,"emptyColumns");let a=!1;if(!r&&!s){const l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=n.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=me(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(K(i,"innerBorderTop"),a=!h):(Oe(i,"innerBorderTop"),a=h)}}return a}}function Wl(t,e,r){eW(t,e),e.set(t,r)}function eW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kn(t,e,r){return(e=tW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tW(t){var e=rW(t,"string");return typeof e=="symbol"?e:e+""}function rW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eo(t,e,r){return t.set(E0(t,e),r),r}function Xn(t,e){return t.get(E0(t,e))}function E0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var rs=new WeakMap,Bl=new WeakMap,ns=new WeakMap,$l=new WeakMap;class nW{constructor(e,r,n,i,o,s){Kn(this,"wot",null),Wl(this,rs,[]),Kn(this,"topOverlay",null),Kn(this,"bottomOverlay",null),Kn(this,"inlineStartOverlay",null),Kn(this,"topInlineStartCornerOverlay",null),Kn(this,"bottomInlineStartCornerOverlay",null),Kn(this,"browserLineHeight",void 0),Kn(this,"wtSettings",null),Wl(this,Bl,!1),Wl(this,ns,0),Wl(this,$l,null),Kn(this,"resizeObserver",new ResizeObserver(c=>{dm(()=>{!Array.isArray(c)||!c.length||(eo(ns,this,Xn(ns,this)+1),Xn(ns,this)===300&&(Cr("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Xn($l,this)!==null&&clearTimeout(Xn($l,this)),eo($l,this,setTimeout(()=>{eo(ns,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Ut(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:zu(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...Xn(rs,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),o=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new JV(...e),this.bottomOverlay=new MV(...e),this.inlineStartOverlay=new UV(...e),this.topInlineStartCornerOverlay=new KV(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new RV(...e,this.bottomOverlay,this.inlineStartOverlay),eo(rs,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){eo(Bl,this,Xn(rs,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),Xn(rs,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Xn(rs,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=r.devicePixelRatio&&r.devicePixelRatio>1,s=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!qD())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",f=>this.onCloneWheel(f,a),l)});let c;this.eventManager.addEventListener(r,"resize",()=>{dm(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{eo(ns,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==r&&o!==r&&!e.target.contains(i)||n!==r&&o!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){if(e.ctrlKey)return;const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==n&&s!==n&&!s.contains(o),l=i!==n&&s!==n&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=mk(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),o=this.scrollHorizontally(n);return i||o}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Xn(Bl,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),eo(Bl,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=zu(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight(),u=this.wtSettings.getSetting("externalRowCalculator")?0:1,c=l+this.topOverlay.sumCellSizes(0,s)+u,h=a+this.inlineStartOverlay.sumCellSizes(0,o),g=r.hider.style,p=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,c-r.holder.clientHeight),v=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,h-r.holder.clientWidth),y=p()?1:0,T=v()?1:0;g.width=`${h+T}px`,g.height=`${c+y}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return z(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];z(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function gR(t,e,r){return(e=iW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iW(t){var e=oW(t,"string");return typeof e=="symbol"?e:e+""}function oW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sW{constructor(e){gR(this,"settings",{}),gR(this,"defaults",Object.freeze(this.getDefaults())),Me(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);bl(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,r){return r===void 0?Me(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,o){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,o):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Jp extends Ks{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Uu(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=oC(e,"height",r),o=oC(e,"overflow",r),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(o)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?n.insertBefore(f,e.nextElementSibling):n.appendChild(f);const g=parseInt(r.getComputedStyle(f).height,10);n.removeChild(f),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Fs(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",o=e.getSetting("columnHeaders").length;if(o&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);r.hasOversizedColumnHeadersMarked[n]=!0}}}Ke(Jp,Up);Ke(Jp,xc);class aW{constructor(e,r,n,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new kL:new $L],["fullyVisible",()=>new _L],["partiallyVisible",()=>new h0]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new xL:new VL],["fullyVisible",()=>new RL],["partiallyVisible",()=>new c0]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=ur(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const i=this.domBindings.rootDocument.documentElement;return i.scrollWidth>i.clientWidth}const{hider:e}=this.wtTable,r=e.offsetWidth,n=this.hasVerticalScroll()?Ut():0;return r>this.getWorkspaceWidth()-n}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return Fr(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=ur(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=r.length;i<o;i++)n?(this.rowHeaderWidth+=lr(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),c=r.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),n.holder.clientHeight===n.holder.offsetHeight?o=0:o=Ut(this.domBindings.rootDocument),new XL({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:r.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>n.getRowHeight(h),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=r.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=Ut(this.domBindings.rootDocument)),new qL({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const o=n.getResultsFor("fullyVisible"),s=n.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o,s)}if(e&&!r.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible"),s=i.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o,s)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,r){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:i}=e;const{startRow:o,endRow:s}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(o)&&!this.wtTable.isRowAfterRenderedRows(s))return!0;n=o,i=s}const{startRow:a,endRow:l,rowStartOffset:u,rowEndOffset:c}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,f=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(f)&&f>0?(n=Math.max(0,n-Math.min(u,f)),i=Math.min(h,i+Math.min(c,f))):f==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),n<a||n===a&&n>0?!1:!(i>l||i===l&&i<h)}areAllProposedVisibleColumnsAlreadyRendered(e,r){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:i}=e;const{startColumn:o,endColumn:s}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(o)&&!this.wtTable.isColumnAfterRenderedColumns(s))return!0;n=o,i=s}const{startColumn:a,endColumn:l,columnStartOffset:u,columnEndOffset:c}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,f=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(f)&&f>0?(n=Math.max(0,n-Math.min(u,f)),i=Math.min(h,i+Math.min(c,f))):f==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),n<a||n===a&&n>0?!1:!(i>l||i===l&&i<h)}resetHasOversizedColumnHeadersMarked(){Me(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class lW extends jp{constructor(e,r){super(e,new sW(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new Jp(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new aW(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new jV(this.wtSettings.getSetting("selections")),this.wtEvent=new p0(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new nW(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];Me(e,(i,o)=>{this.wtSettings.getSetting(o).length&&n.push(i),r.push(i)}),Oe(this.wtTable.wtRootElement.parentNode,r),K(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!y0.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class ew{constructor(e){e instanceof jp?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new ew(r);return()=>n},this._wot=new lW(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,o){return this._wot.wtSettings.getSetting(e,r,n,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function mR(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),f=r||n&&h;i.row<0&&i.col>=0&&!s.column?f&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?f&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?f&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function uW(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(o(u-1,r.col)):s&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}function pR(t){let{isLeftClick:e,selection:r,cellRangeMapper:n}=t;if(!e||r.settings.selectionMode!=="multiple")return;const i=r.getSelectedRange(),o=i.clone().map(a=>n.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!r.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),r.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),r.refresh())}}const cW=new Map([["touchstart",mR],["touchend",pR],["mousedown",mR],["mouseover",uW],["mouseup",pR]]);function gg(t,e){cW.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:J_(t)||t.type==="touchstart",isRightClick:Yu(t),...e})}const T0=new WeakMap,tw=Symbol("rootInstance");function hW(t){T0.set(t,!0)}function dW(t){return t===tw}function Mn(t){return T0.has(t)}function fW(t,e){_0(t,e),e.add(t)}function yi(t,e,r){_0(t,e),e.set(t,r)}function _0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bi(t,e,r){return(e=gW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gW(t){var e=mW(t,"string");return typeof e=="symbol"?e:e+""}function mW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Je(t,e){return t.get(Hs(t,e))}function Zt(t,e,r){return t.set(Hs(t,e),r),r}function Hs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var mg=new WeakMap,jl=new WeakMap,zl=new WeakMap,Zn=new WeakMap,en=new WeakMap,pg=new WeakMap,wg=new WeakMap,is=new WeakMap,Da=new WeakSet;class pW{constructor(e){fW(this,Da),bi(this,"hot",void 0),bi(this,"eventManager",void 0),bi(this,"settings",void 0),bi(this,"THEAD",void 0),bi(this,"TBODY",void 0),bi(this,"_wt",void 0),bi(this,"activeWt",void 0),yi(this,mg,0),yi(this,jl,0),bi(this,"postponedAdjustElementsSize",!1),yi(this,zl,!1),yi(this,Zn,void 0),yi(this,en,void 0),yi(this,pg,0),yi(this,wg,0),yi(this,is,null),this.hot=e,this.eventManager=new $i(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),Hs(Da,this,vW).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),K(e,"handsontable"),Zt(en,this,r.createElement("TABLE")),K(Je(en,this),"htCore"),this.hot.getSettings().tableClassName&&K(Je(en,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ce(Je(en,this),[Hi()]),Ce(e,[_D(),N_(-1),Ic(this.hot.countCols()),FD()])),this.THEAD=r.createElement("THEAD"),Je(en,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),Je(en,this).appendChild(this.TBODY),this.hot.table=Je(en,this),this.hot.container.insertBefore(Je(en,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:e,rootElement:r,rootDocument:n,selection:i,rootWindow:o}=this.hot,s=n.documentElement;this.eventManager.addEventListener(r,"mousedown",l=>{Zt(zl,this,!0),this.isTextSelectionAllowed(l.target)||(sC(o),l.preventDefault(),o.focus())}),this.eventManager.addEventListener(r,"mouseup",()=>{Zt(zl,this,!1)}),this.eventManager.addEventListener(r,"mousemove",l=>{Je(zl,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&sC(o),l.preventDefault())}),this.eventManager.addEventListener(s,"keyup",l=>{i.isInProgress()&&!l.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",l=>{i.isInProgress()&&J_(l)&&i.finish(),Zt(Zn,this,!1);const u=K_(n.activeElement);Mu(n.activeElement)&&!u||(u||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!(e??r).contains(l.target)&&!Yu(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",l=>{i.isInProgress()&&Yu(l)&&(i.finish(),Zt(Zn,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),Zt(Zn,this,!1)}),this.eventManager.addEventListener(s,"mousedown",l=>{const u=l.target,c=l.x||l.clientX,h=l.y||l.clientY;let f=l.target;if(Je(Zn,this)||!r||!this.hot.view)return;const{holder:g}=this._wt.wtTable;if(f===g){const v=Ut(n);if(n.elementFromPoint(c+v,h)!==g||n.elementFromPoint(c,h+v)!==g)return}else for(;f!==s;){if(f===null){if(l.isTargetWebComponent)break;return}if(f===r)return;f=f.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=Io(o);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=Io(a);this.eventManager.addEventListener(Je(en,this),"selectstart",l=>{this.settings.fragmentSelection||Mu(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const o=n.getNearestNotHiddenIndex(e,r),s=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return r<0?a=s+1:r>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&K(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Oe(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Je(en,this),isDataViewInstance:()=>Mn(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Zt(jl,this,o.length),this.hot.getSettings().ariaTags&&Hs(Da,this,O0).call(this)===this.hot.countCols()&&Hs(Da,this,wW).call(this,Je(jl,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Zt(mg,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,f=u;Array.isArray(c)&&([h,f]=c);const g=this.hot.getCellMeta(h,f),p=this.hot.colToProp(f);let v=this.hot.getDataAtRowProp(h,p);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,g)),this.hot.runHooks("beforeRenderer",a,l,u,p,v,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,p,v,g),this.hot.runHooks("afterRenderer",a,l,u,p,v,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Fs(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Zt(Zn,this,!0),Zt(is,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!ho(o)&&(gg(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Zt(Zn,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!ho(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!ho(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!ho(o)&&(Je(Zn,this)&&(!Je(is,this)||Je(is,this).x!==o.clientX||Je(is,this).y!==o.clientY)&&gg(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,Zt(is,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(ho(o)||this.hot.isDestroyed)&&(gg(o,{coords:u,selection:this.hot.selection,cellRangeMapper:Ak(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,f=o>=0?u.getVisualFromRenderableIndex(o):o,g=this.hot.runHooks("modifyGetCellCoords",f,h,a,l);if(Array.isArray(g)){const[p,v,y,T]=g;return[p>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(p,1)):p,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y,T>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(T,-1)):T]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[f,g]=h;return[f>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,1)):f,g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new ew(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var r,n;if(Mu(e))return!0;const i=Ms(e,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&i)return!0;const o=(r=(n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingleCell())!==null&&r!==void 0?r:!1;return!!(this.settings.fragmentSelection==="cell"&&o&&i||!this.settings.fragmentSelection&&this.isCellEdited()&&o)}isMouseDown(){return Je(Zn,this)}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!me(n,"relative")){Ls(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,o=n.createElement("div"),s=n.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),r.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(r.firstChild){const s=r.firstChild;me(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,n,i),s.className="",K(s,["relative",...o()])):(Ls(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Ce(a,...Hi()),Ce(l,...Hi())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=r;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(me(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(r):me(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(r))),o>-1?z_(e,n(r,i)):(bl(e,"Â "),K(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){Zt(pg,this,e),Zt(wg,this,r)}getLastSize(){return{width:Je(pg,this),height:Je(wg,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Je(mg,this)}getRowHeadersCount(){return Je(jl,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getTableScrollPosition(){return{left:this._wt.wtTable.holder.scrollLeft,top:this._wt.wtTable.holder.scrollTop}}setTableScrollPosition(e){this._wt.wtTable.holder.scrollLeft=e.left,this._wt.wtTable.holder.scrollTop=e.top}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function O0(){return parseInt(this.hot.rootElement.getAttribute(Ic()[0]),10)}function wW(t){const e=Hs(Da,this,O0).call(this)+t;Ce(this.hot.rootElement,...Ic(e))}function vW(){const t=this.hot.rootElement;this.hasVerticalScroll()?K(t,"htHasScrollY"):Oe(t,"htHasScrollY"),this.isVerticallyScrollableByWindow()?K(t,"htVerticallyScrollableByWindow"):Oe(t,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?K(t,"htHasScrollX"):Oe(t,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?K(t,"htHorizontallyScrollableByWindow"):Oe(t,"htHorizontallyScrollableByWindow")}var wR={},vR={},yR;function yW(){if(yR)return vR;yR=1;var t=De(),e=vt(),r=Us(),n=Tr(),i=yt(),o=Ui(),s=_r(),a=$o(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),f=0;return!r(h,function(g,p){if(!c(g,f++))return p()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),vR}var bR;function bW(){return bR||(bR=1,yW()),wR}bW();const SW="ABCDEFGHIJKLMNOPQRSTUVWXYZ",SR=SW.length;function CW(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%SR,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/SR,10);return r}function M0(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&nt(t[0])&&(e=Ap(t[0]))),e}function wa(t,e,r){return(e=RW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RW(t){var e=EW(t,"string");return typeof e=="symbol"?e:e+""}function EW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TW{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];wa(this,"hot",void 0),wa(this,"data",void 0),wa(this,"dataType","array"),wa(this,"colToProp",()=>{}),wa(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return z(this.data,(n,i)=>{const o=this.getAtCell(i,e);r.push(o)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=r===void 0&&n===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):Et(r,n,u=>{l[u-r]=this.getAtPhysicalCell(e,u,a)});else if(nt(a)||Se(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;Et(0,c,h=>{const f=this.colToProp(h);if(h>=(r||0)&&h<=(n||c)&&!Number.isInteger(f)){const g=this.getAtPhysicalCell(e,f,a);i?l.push(g):s?Wf(l,f,g):l[f]=g}})}else Me(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Wf(l,c,h):l[c]=h});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=yr(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:Wf(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?hm(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const o=yr(i);this.hot.runHooks("modifySourceData",e,r,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||r===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,r.row),s=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const u=[];return Et(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,n):this.getAtRow(c,s,l,n))}),u}getCopyable(e,r){const n=this.propToCol(r);return this.hot.getCellMeta(e,n).copyable?this.getAtCell(this.hot.toPhysicalRow(e),n):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return M0(this.data)}destroy(){this.data=null,this.hot=null}}var CR={},RR={},ER;function _W(){if(ER)return RR;ER=1;var t=De(),e=vt(),r=Us(),n=Tr(),i=yt(),o=Ui(),s=_r(),a=$o(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),f=0;return r(h,function(g,p){if(c(g,f++))return p()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),RR}var TR;function OW(){return TR||(TR=1,_W()),CR}OW();function _R(t,e,r){return(e=MW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MW(t){var e=IW(t,"string");return typeof e=="symbol"?e:e+""}function IW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_R(this,"indexedValues",[]),_R(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Se(this.initValueOrFn)?Et(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):Et(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Ke(Tl,Wn);function I0(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((o,s)=>Se(n)?n(o,s):n),...i===void 0?[]:t.slice(i)]}function H0(t,e){return Mp(t,(r,n)=>e.includes(n)===!1)}class Nc extends Tl{insert(e,r){this.indexedValues=I0(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=H0(this.indexedValues,e),super.remove(e)}}class A0 extends Nc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return zo(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function P0(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function Ku(t,e){return Mp(t,r=>e.includes(r)===!1)}function x0(t,e){return Vi(t,r=>r-e.filter(n=>n<r).length)}function N0(t,e){const r=e[0],n=e.length;return Vi(t,i=>i>=r?i+n:i)}function HW(t,e,r){return(e=AW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AW(t){var e=PW(t,"string");return typeof e=="symbol"?e:e+""}function PW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xW extends Tl{constructor(){super(...arguments),HW(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Ku(this.orderOfIndexes,[e]),Se(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=I0(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=N0(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=H0(this.indexedValues,e),this.orderOfIndexes=Ku(this.orderOfIndexes,e),this.orderOfIndexes=x0(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class D0 extends Nc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return zo(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}class NW extends Tl{constructor(){super(e=>e)}insert(e,r){const n=N0(this.indexedValues,r);this.indexedValues=P0(n,e,r),super.insert(e,r)}remove(e){const r=Ku(this.indexedValues,e);this.indexedValues=x0(r,e),super.remove(e)}}const OR=new Map([["hiding",A0],["index",Tl],["linkedPhysicalIndexToValue",xW],["physicalIndexToValue",Nc],["trimming",D0]]);function DW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!OR.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(OR.get(t))(e)}function kW(t,e,r){return(e=LW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LW(t){var e=FW(t,"string");return typeof e=="symbol"?e:e+""}function FW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rw{constructor(){kW(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);ue(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return zt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}Ke(rw,Wn);function vg(t,e,r){return(e=VW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VW(t){var e=WW(t,"string");return typeof e=="symbol"?e:e+""}function WW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MR extends rw{constructor(e,r){super(),vg(this,"mergedValuesCache",[]),vg(this,"aggregationFunction",void 0),vg(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=Vi(this.get(),o=>o.getValues()),n=[],i=ue(r[0])&&r[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(r[a][o]);n.push(s)}return Vi(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return ue(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function BW(t,e,r){$W(t,e),e.set(t,r)}function $W(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jW(t,e,r){return t.set(k0(t,e),r),r}function zW(t,e){return t.get(k0(t,e))}function k0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var yg=new WeakMap;class L0{constructor(){BW(this,yg,[])}subscribe(e){return this.addLocalHook("change",e),this._write(zW(yg,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){jW(yg,this,e)}}Ke(L0,Wn);function IR(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function va(t,e,r){UW(t,e),e.set(t,r)}function UW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nr(t,e){return t.get(F0(t,e))}function Ul(t,e,r){return t.set(F0(t,e),r),r}function F0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yl=new WeakMap,ya=new WeakMap,ql=new WeakMap,Gl=new WeakMap,Kl=new WeakMap;class YW{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};va(this,Yl,new Set),va(this,ya,[]),va(this,ql,[]),va(this,Gl,!1),va(this,Kl,!1),Ul(Kl,this,e??!1)}createObserver(){const e=new L0;return Nr(Yl,this).add(e),e.addLocalHook("unsubscribe",()=>{Nr(Yl,this).delete(e)}),e._writeInitialChanges(IR(Nr(ya,this),Nr(ql,this))),e}emit(e){let r=Nr(ql,this);(!Nr(Gl,this)||Nr(ya,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(Nr(Kl,this)):Ul(ya,this,new Array(e.length).fill(Nr(Kl,this))),Nr(Gl,this)||(Ul(Gl,this,!0),r=Nr(ya,this)));const n=IR(r,e);Nr(Yl,this).forEach(i=>i._write(n)),Ul(ql,this,e)}}function Wt(t,e,r){return(e=qW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qW(t){var e=GW(t,"string");return typeof e=="symbol"?e:e+""}function GW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ym{constructor(){Wt(this,"indexesSequence",new NW),Wt(this,"trimmingMapsCollection",new MR(e=>e.some(r=>r===!0),!1)),Wt(this,"hidingMapsCollection",new MR(e=>e.some(r=>r===!0),!1)),Wt(this,"variousMapsCollection",new rw),Wt(this,"hidingChangesObservable",new YW({initialIndexValue:!1})),Wt(this,"notTrimmedIndexesCache",[]),Wt(this,"notHiddenIndexesCache",[]),Wt(this,"isBatched",!1),Wt(this,"indexesSequenceChanged",!1),Wt(this,"indexesChangeSource",void 0),Wt(this,"trimmedIndexesChanged",!1),Wt(this,"hiddenIndexesChanged",!1),Wt(this,"renderablePhysicalIndexesCache",[]),Wt(this,"fromPhysicalToVisualIndexesCache",new Map),Wt(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,DW(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof D0?this.trimmingMapsCollection.register(e,r):r instanceof A0?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return ue(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return ue(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return ue(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return ue(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return r>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=Vi(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Ku(this.getIndexesSequence(),n),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(r+o<i){const u=a[r];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(P0(s,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=ue(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=Vi(new Array(r).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=n==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}Ke(ym,Wn);function KW(t,e){return Me(e,(r,n)=>{zt(t[n])&&(t[n]=r)}),t}function V0(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function W0(t){ue(t)&&wk(Sr`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function XW(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}function B0(t,e){return Array.isArray(t)?t.map(r=>B0(r,e)):H_(t,e)}const{register:ZW,getValues:QW}=Yo("phraseFormatters");function $0(t,e){ZW(t,e)}function JW(){return QW()}$0("pluralize",XW);$0("substitute",B0);const nw="Common:",j0=`${nw}ok`,z0=`${nw}cancel`,U0="ContextMenu:items",re=U0,iw=`${re}.noItems`,ow=`${re}.insertRowAbove`,sw=`${re}.insertRowBelow`,aw=`${re}.insertColumnOnTheLeft`,lw=`${re}.insertColumnOnTheRight`,uw=`${re}.removeRow`,cw=`${re}.removeColumn`,hw=`${re}.undo`,dw=`${re}.redo`,Xu=`${re}.readOnly`,fw=`${re}.clearColumn`,gw=`${re}.copy`,mw=`${re}.copyWithHeaders`,pw=`${re}.copyWithGroupHeaders`,ww=`${re}.copyHeadersOnly`,vw=`${re}.cut`,Y0=`${re}.freezeColumn`,q0=`${re}.unfreezeColumn`,G0=`${re}.mergeCells`,K0=`${re}.unmergeCells`,X0=`${re}.addComment`,Z0=`${re}.editComment`,Q0=`${re}.removeComment`,J0=`${re}.readOnlyComment`,yw=`${re}.align`,bw=`${re}.align.left`,Sw=`${re}.align.center`,Cw=`${re}.align.right`,Rw=`${re}.align.justify`,Ew=`${re}.align.top`,Tw=`${re}.align.middle`,_w=`${re}.align.bottom`,eO=`${re}.borders`,tO=`${re}.borders.top`,rO=`${re}.borders.right`,nO=`${re}.borders.bottom`,iO=`${re}.borders.left`,oO=`${re}.borders.remove`,sO=`${re}.nestedHeaders.insertChildRow`,aO=`${re}.nestedHeaders.detachFromParent`,lO=`${re}.hideColumn`,uO=`${re}.showColumn`,cO=`${re}.hideRow`,hO=`${re}.showRow`,cr="Filters:",Xe=`${cr}conditions`,dO=`${Xe}.none`,fO=`${Xe}.isEmpty`,gO=`${Xe}.isNotEmpty`,mO=`${Xe}.isEqualTo`,pO=`${Xe}.isNotEqualTo`,wO=`${Xe}.beginsWith`,vO=`${Xe}.endsWith`,yO=`${Xe}.contains`,bO=`${Xe}.doesNotContain`,eB=`${Xe}.byValue`,SO=`${Xe}.greaterThan`,CO=`${Xe}.greaterThanOrEqualTo`,RO=`${Xe}.lessThan`,EO=`${Xe}.lessThanOrEqualTo`,TO=`${Xe}.isBetween`,_O=`${Xe}.isNotBetween`,OO=`${Xe}.after`,MO=`${Xe}.before`,IO=`${Xe}.today`,HO=`${Xe}.tomorrow`,AO=`${Xe}.yesterday`,PO=`${cr}labels.filterByCondition`,xO=`${cr}labels.filterByValue`,NO=`${cr}labels.conjunction`,DO=`${cr}labels.disjunction`,kO=`${cr}values.blankCells`,LO=`${cr}buttons.selectAll`,FO=`${cr}buttons.clear`,VO=`${cr}buttons.ok`,WO=`${cr}buttons.cancel`,BO=`${cr}buttons.placeholder.search`,$O=`${cr}buttons.placeholder.value`,jO=`${cr}buttons.placeholder.secondValue`,Bn="Pagination:",zO=`${Bn}section.pagination`,UO=`${Bn}.pageSize.auto`,YO=`${Bn}section.pageSize`,qO=`${Bn}section.counter`,GO=`${Bn}section.navigation`,KO=`${Bn}firstPage`,XO=`${Bn}prevPage`,ZO=`${Bn}nextPage`,QO=`${Bn}lastPage`,Ow="CheckboxRenderer:",JO=`${Ow}checked`,eM=`${Ow}unchecked`,tM="Loading:",rM=`${tM}title`,Xs="EmptyDataState:",nM=`${Xs}title`,iM=`${Xs}description`,oM=`${Xs}title.filters`,sM=`${Xs}description.filters`,aM=`${Xs}buttons.filters.reset`,tB=Object.freeze(Object.defineProperty({__proto__:null,CANCEL:z0,CHECKBOX_CHECKED:JO,CHECKBOX_RENDERER_NAMESPACE:Ow,CHECKBOX_UNCHECKED:eM,COMMON_NAMESPACE:nw,CONTEXTMENU_ITEMS_ADD_COMMENT:X0,CONTEXTMENU_ITEMS_ALIGNMENT:yw,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:_w,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Sw,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:Rw,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:bw,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:Tw,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:Cw,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:Ew,CONTEXTMENU_ITEMS_BORDERS:eO,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:nO,CONTEXTMENU_ITEMS_BORDERS_LEFT:iO,CONTEXTMENU_ITEMS_BORDERS_RIGHT:rO,CONTEXTMENU_ITEMS_BORDERS_TOP:tO,CONTEXTMENU_ITEMS_CLEAR_COLUMN:fw,CONTEXTMENU_ITEMS_COPY:gw,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:ww,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:pw,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:mw,CONTEXTMENU_ITEMS_CUT:vw,CONTEXTMENU_ITEMS_EDIT_COMMENT:Z0,CONTEXTMENU_ITEMS_FREEZE_COLUMN:Y0,CONTEXTMENU_ITEMS_HIDE_COLUMN:lO,CONTEXTMENU_ITEMS_HIDE_ROW:cO,CONTEXTMENU_ITEMS_INSERT_LEFT:aw,CONTEXTMENU_ITEMS_INSERT_RIGHT:lw,CONTEXTMENU_ITEMS_MERGE_CELLS:G0,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:aO,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:sO,CONTEXTMENU_ITEMS_NO_ITEMS:iw,CONTEXTMENU_ITEMS_READ_ONLY:Xu,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:J0,CONTEXTMENU_ITEMS_REDO:dw,CONTEXTMENU_ITEMS_REMOVE_BORDERS:oO,CONTEXTMENU_ITEMS_REMOVE_COLUMN:cw,CONTEXTMENU_ITEMS_REMOVE_COMMENT:Q0,CONTEXTMENU_ITEMS_REMOVE_ROW:uw,CONTEXTMENU_ITEMS_ROW_ABOVE:ow,CONTEXTMENU_ITEMS_ROW_BELOW:sw,CONTEXTMENU_ITEMS_SHOW_COLUMN:uO,CONTEXTMENU_ITEMS_SHOW_ROW:hO,CONTEXTMENU_ITEMS_UNDO:hw,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:q0,CONTEXTMENU_ITEMS_UNMERGE_CELLS:K0,CONTEXT_MENU_ITEMS_NAMESPACE:U0,EMPTY_DATA_STATE_BUTTONS_FILTERS_RESET:aM,EMPTY_DATA_STATE_DESCRIPTION:iM,EMPTY_DATA_STATE_DESCRIPTION_FILTERS:sM,EMPTY_DATA_STATE_NAMESPACE:Xs,EMPTY_DATA_STATE_TITLE:nM,EMPTY_DATA_STATE_TITLE_FILTERS:oM,FILTERS_BUTTONS_CANCEL:WO,FILTERS_BUTTONS_CLEAR:FO,FILTERS_BUTTONS_OK:VO,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:BO,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:jO,FILTERS_BUTTONS_PLACEHOLDER_VALUE:$O,FILTERS_BUTTONS_SELECT_ALL:LO,FILTERS_CONDITIONS_AFTER:OO,FILTERS_CONDITIONS_BEFORE:MO,FILTERS_CONDITIONS_BEGINS_WITH:wO,FILTERS_CONDITIONS_BETWEEN:TO,FILTERS_CONDITIONS_BY_VALUE:eB,FILTERS_CONDITIONS_CONTAINS:yO,FILTERS_CONDITIONS_EMPTY:fO,FILTERS_CONDITIONS_ENDS_WITH:vO,FILTERS_CONDITIONS_EQUAL:mO,FILTERS_CONDITIONS_GREATER_THAN:SO,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:CO,FILTERS_CONDITIONS_LESS_THAN:RO,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:EO,FILTERS_CONDITIONS_NAMESPACE:Xe,FILTERS_CONDITIONS_NONE:dO,FILTERS_CONDITIONS_NOT_BETWEEN:_O,FILTERS_CONDITIONS_NOT_CONTAIN:bO,FILTERS_CONDITIONS_NOT_EMPTY:gO,FILTERS_CONDITIONS_NOT_EQUAL:pO,FILTERS_CONDITIONS_TODAY:IO,FILTERS_CONDITIONS_TOMORROW:HO,FILTERS_CONDITIONS_YESTERDAY:AO,FILTERS_DIVS_FILTER_BY_CONDITION:PO,FILTERS_DIVS_FILTER_BY_VALUE:xO,FILTERS_LABELS_CONJUNCTION:NO,FILTERS_LABELS_DISJUNCTION:DO,FILTERS_NAMESPACE:cr,FILTERS_VALUES_BLANK_CELLS:kO,LOADING_NAMESPACE:tM,LOADING_TITLE:rM,OK:j0,PAGINATION_COUNTER_SECTION:qO,PAGINATION_FIRST_PAGE:KO,PAGINATION_LAST_PAGE:QO,PAGINATION_NAMESPACE:Bn,PAGINATION_NAV_SECTION:GO,PAGINATION_NEXT_PAGE:ZO,PAGINATION_PAGE_SIZE_AUTO:UO,PAGINATION_PAGE_SIZE_SECTION:YO,PAGINATION_PREV_PAGE:XO,PAGINATION_SECTION:zO},Symbol.toStringTag,{value:"Module"}));const lM={languageCode:"en-US",[j0]:"OK",[z0]:"Cancel",[iw]:"No available options",[ow]:"Insert row above",[sw]:"Insert row below",[aw]:"Insert column left",[lw]:"Insert column right",[uw]:["Remove row","Remove rows"],[cw]:["Remove column","Remove columns"],[hw]:"Undo",[dw]:"Redo",[Xu]:"Read only",[fw]:"Clear column",[yw]:"Alignment",[bw]:"Left",[Sw]:"Center",[Cw]:"Right",[Rw]:"Justify",[Ew]:"Top",[Tw]:"Middle",[_w]:"Bottom",[Y0]:"Freeze column",[q0]:"Unfreeze column",[eO]:"Borders",[tO]:"Top",[rO]:"Right",[nO]:"Bottom",[iO]:"Left",[oO]:"Remove border(s)",[X0]:"Add comment",[Z0]:"Edit comment",[Q0]:"Delete comment",[J0]:"Read-only comment",[G0]:"Merge cells",[K0]:"Unmerge cells",[gw]:"Copy",[mw]:["Copy with header","Copy with headers"],[pw]:["Copy with group header","Copy with group headers"],[ww]:["Copy header only","Copy headers only"],[vw]:"Cut",[sO]:"Insert child row",[aO]:"Detach from parent",[lO]:["Hide column","Hide columns"],[uO]:["Show column","Show columns"],[cO]:["Hide row","Hide rows"],[hO]:["Show row","Show rows"],[dO]:"None",[fO]:"Is empty",[gO]:"Is not empty",[mO]:"Is equal to",[pO]:"Is not equal to",[wO]:"Begins with",[vO]:"Ends with",[yO]:"Contains",[bO]:"Does not contain",[SO]:"Greater than",[CO]:"Greater than or equal to",[RO]:"Less than",[EO]:"Less than or equal to",[TO]:"Is between",[_O]:"Is not between",[OO]:"After",[MO]:"Before",[IO]:"Today",[HO]:"Tomorrow",[AO]:"Yesterday",[kO]:"Blank cells",[PO]:"Filter by condition",[xO]:"Filter by value",[NO]:"And",[DO]:"Or",[LO]:"Select all",[FO]:"Clear",[VO]:"OK",[WO]:"Cancel",[BO]:"Search",[$O]:"Value",[jO]:"Second value",[zO]:"Pagination",[YO]:"Page size",[UO]:"Auto",[qO]:"[start] - [end] of [total]",[GO]:"Page [currentPage] of [totalPages]",[KO]:"Go to first page",[XO]:"Go to previous page",[ZO]:"Go to next page",[QO]:"Go to last page",[JO]:"Checked",[eM]:"Unchecked",[rM]:"Loading...",[nM]:"No data available",[iM]:"Thereâs nothing to display yet.",[oM]:"No results found",[sM]:"It looks like your current filters are hiding all results.",[aM]:"Reset filters"},rB=tB,bm=lM.languageCode,{register:nB,getItem:uM,hasItem:iB,getValues:oB}=Yo("languagesDictionaries");cM(lM);function cM(t,e){let r=t,n=e;return nt(t)&&(n=t,r=n.languageCode),sB(r,n),nB(r,Bi(n)),Bi(n)}function sB(t,e){t!==bm&&KW(e,uM(bm))}function hM(t){return Mw(t)?Bi(uM(t)):null}function Mw(t){return iB(t)}function aB(){return oB()}function dM(t,e,r){const n=hM(t);if(n===null)return null;const i=n[e];if(zt(i))return null;const o=lB(i,r);return Array.isArray(o)?o[0]:o}function lB(t,e){return JW().reduce((r,n)=>n(r,e),t)}function uB(t){let e=V0(t);return Mw(e)||(e=bm,W0(t)),e}function cB(t,e,r){return(e=hB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hB(t){var e=dB(t,"string");return typeof e=="symbol"?e:e+""}function dB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wi extends b0{constructor(e,r){super(e,null),cB(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),o=this.getNearestNotHiddenCoords(n,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=r,o=n),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(r,n,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function bg(t){let{activeHeaderClassName:e,...r}=t;return new wi({className:e,...r,selectionType:AV})}function fB(t){let{areaCornerVisible:e,...r}=t;return new wi({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:qp})}function gB(t){let{...e}=t;return new wi({className:"highlight",...e,selectionType:qp})}function mB(t){let{columnClassName:e,...r}=t;return new wi({className:e,...r,selectionType:NV})}function pB(t){let{cellCornerVisible:e,...r}=t;return new wi({className:"current",headerAttributes:[k_()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:Gu})}function wB(t){let{border:e,visualCellRange:r,...n}=t;return new wi({...e,...n,selectionType:DV},r)}function vB(t){let{...e}=t;return new wi({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:PV})}function HR(t){let{headerClassName:e,...r}=t;return new wi({className:e,...r,selectionType:S0})}function yB(t){let{rowClassName:e,...r}=t;return new wi({className:e,...r,selectionType:xV})}function bB(t,e){SB(t,e),e.add(t)}function SB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qt(t,e,r){return(e=CB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CB(t){var e=RB(t,"string");return typeof e=="symbol"?e:e+""}function RB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Tn=new WeakSet;class EB{constructor(e){bB(this,Tn),Qt(this,"options",void 0),Qt(this,"layerLevel",0),Qt(this,"focus",void 0),Qt(this,"fill",void 0),Qt(this,"layeredAreas",new Map),Qt(this,"areas",new Map),Qt(this,"rowHeaders",new Map),Qt(this,"columnHeaders",new Map),Qt(this,"activeRowHeaders",new Map),Qt(this,"activeColumnHeaders",new Map),Qt(this,"activeCornerHeaders",new Map),Qt(this,"rowHighlights",new Map),Qt(this,"columnHighlights",new Map),Qt(this,"customSelections",[]),this.options=e,this.focus=pB(e),this.fill=vB(e)}isEnabledFor(e,r){let n=e;e===Gu&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Qn(Tn,this,Jn).call(this,this.layeredAreas,fB)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Qn(Tn,this,Jn).call(this,this.areas,gB)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Qn(Tn,this,Jn).call(this,this.rowHeaders,HR)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Qn(Tn,this,Jn).call(this,this.columnHeaders,HR)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Qn(Tn,this,Jn).call(this,this.activeRowHeaders,bg)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Qn(Tn,this,Jn).call(this,this.activeColumnHeaders,bg)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Qn(Tn,this,Jn).call(this,this.activeCornerHeaders,bg)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Qn(Tn,this,Jn).call(this,this.rowHighlights,yB)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Qn(Tn,this,Jn).call(this,this.columnHighlights,mB)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(wB({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),z(this.areas.values(),e=>{e.clear()}),z(this.layeredAreas.values(),e=>{e.clear()}),z(this.rowHeaders.values(),e=>{e.clear()}),z(this.columnHeaders.values(),e=>{e.clear()}),z(this.activeRowHeaders.values(),e=>{e.clear()}),z(this.activeColumnHeaders.values(),e=>{e.clear()}),z(this.activeCornerHeaders.values(),e=>{e.clear()}),z(this.rowHighlights.values(),e=>{e.clear()}),z(this.columnHighlights.values(),e=>{e.clear()})}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Jn(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function AR(t,e,r){return(e=TB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TB(t){var e=_B(t,"string");return typeof e=="symbol"?e:e+""}function _B(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Iw{constructor(e){AR(this,"ranges",[]),AR(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((n,i)=>n.includes(e)&&r(n,i))}findAll(e){const r=[];return this.ranges.forEach((n,i)=>{n.isEqual(e)&&r.push({range:n,layer:i})}),r}remove(e){return this.ranges=this.ranges.filter(r=>!e.some(n=>n.isEqual(r))),this}removeLayers(e){return this.ranges=this.ranges.filter((r,n)=>!e.includes(n)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new Iw(this.createCellRange);return e.ranges=this.ranges.map(r=>r.clone()),e}map(e){return this.ranges=this.ranges.map((r,n)=>e(r,n)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function OB(t,e){fM(t,e),e.add(t)}function MB(t,e,r){return(e=IB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IB(t){var e=HB(t,"string");return typeof e=="symbol"?e:e+""}function HB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sg(t,e,r){fM(t,e),e.set(t,r)}function fM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ut(t,e){return t.get(be(t,e))}function Ss(t,e,r){return t.set(be(t,e),r),r}function be(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var oi=new WeakMap,go=new WeakMap,Rr=new WeakMap,_e=new WeakSet;class Hw{constructor(e,r){OB(this,_e),Sg(this,oi,void 0),Sg(this,go,0),Sg(this,Rr,{x:0,y:0}),MB(this,"tableApi",void 0),Ss(oi,this,e),this.tableApi=r}setActiveLayerIndex(e){Ss(go,this,e)}getCurrentSelection(){return ut(oi,this).peekByIndex(ut(go,this))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Ss(Rr,this,this.calculateOffset());const i=this.tableApi.createCellCoords(e,r);let o=this.getCurrentSelection().highlight;const s=this.tableApi.visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){let{width:u,height:c}=be(_e,this,Sm).call(this);const{row:h,col:f}=be(_e,this,DR).call(this,o),g=this.tableApi.fixedRowsBottom(),p=this.tableApi.minSpareRows(),v=this.tableApi.minSpareCols(),y=this.tableApi.autoWrapRow(),T=this.tableApi.autoWrapCol(),R=this.tableApi.createCellCoords(h+i.row,f+i.col);if(R.row>=c){const M=yr(n&&p>0&&g===0),P=R.col+1,A=P>=u,D=this.tableApi.createCellCoords(R.row-c,A?P-u:P);if(this.runLocalHooks("beforeColumnWrap",M,be(_e,this,os).call(this,D),A),M.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(T){if(this.shouldSwitchSelectionLayer()&&A&&ut(oi,this).size()>1){be(_e,this,PR).call(this);const V=be(_e,this,Xl).call(this,"forward");V!==null&&D.assign(V)}R.assign(D)}}else if(R.row<0){const M=yr(T),P=R.col-1,A=P<0,D=this.tableApi.createCellCoords(c+R.row,A?u+P:P);if(this.runLocalHooks("beforeColumnWrap",M,be(_e,this,os).call(this,D),A),T){if(this.shouldSwitchSelectionLayer()&&A&&ut(oi,this).size()>1){be(_e,this,xR).call(this);const V=be(_e,this,Xl).call(this,"backward");V!==null&&D.assign(V)}R.assign(D)}}if({width:u,height:c}=be(_e,this,Sm).call(this),R.col>=u){const M=yr(n&&v>0),P=R.row+1,A=P>=c,D=this.tableApi.createCellCoords(A?P-c:P,R.col-u);if(this.runLocalHooks("beforeRowWrap",M,be(_e,this,os).call(this,D),A),M.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(y){if(this.shouldSwitchSelectionLayer()&&A&&ut(oi,this).size()>1){be(_e,this,PR).call(this);const V=be(_e,this,Xl).call(this,"forward");V!==null&&D.assign(V)}R.assign(D)}}else if(R.col<0){const M=yr(y),P=R.row-1,A=P<0,D=this.tableApi.createCellCoords(A?c+P:P,u+R.col);if(this.runLocalHooks("beforeRowWrap",M,be(_e,this,os).call(this,D),A),y){if(this.shouldSwitchSelectionLayer()&&A&&ut(oi,this).size()>1){be(_e,this,xR).call(this);const V=be(_e,this,Xl).call(this,"backward");V!==null&&D.assign(V)}R.assign(D)}}const{rowDir:_,colDir:b}=be(_e,this,NR).call(this,R);a=_,l=b,o=be(_e,this,os).call(this,R)}return this.runLocalHooks("afterTransformStart",o,a,l),{selectionLayer:ut(go,this),visualCoords:o}}transformEnd(e,r){Ss(Rr,this,this.calculateOffset());const n=this.tableApi.createCellCoords(e,r),i=this.getCurrentSelection(),o=this.tableApi.visualToRenderableCoords(i.highlight),s=be(_e,this,Iu).call(this,i.to.row,i.from.row),a=be(_e,this,Hu).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:f}=be(_e,this,DR).call(this,i.highlight),g=this.tableApi.createCellCoords(s+n.row,a+n.col),p=i.getTopStartCorner(),v=i.getTopEndCorner(),y=i.getBottomEndCorner();if(n.col<0&&a>=f&&g.col<f){const b=g.col-f;g.col=be(_e,this,Hu).call(this,p.col,v.col)+b}else if(n.col>0&&a<=f&&g.col>f){const b=be(_e,this,Hu).call(this,v.col,p.col),M=Math.max(g.col-b,1);g.col=b+M}if(n.row<0&&s>=h&&g.row<h){const b=g.row-h;g.row=be(_e,this,Iu).call(this,p.row,y.row)+b}else if(n.row>0&&s<=h&&g.row>h){const b=be(_e,this,Iu).call(this,y.row,p.row),M=Math.max(g.row-b,1);g.row=b+M}const{rowDir:T,colDir:R}=be(_e,this,NR).call(this,g);u=T,c=R;const _=be(_e,this,os).call(this,g);n.row===0&&n.col!==0?l.col=_.col:n.row!==0&&n.col===0?l.row=_.row:(l.row=_.row,l.col=_.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),{selectionLayer:ut(go,this),visualCoords:l}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function PR(){const t=ut(go,this)+1;this.setActiveLayerIndex(t>=ut(oi,this).size()?0:t),Ss(Rr,this,this.calculateOffset())}function xR(){const t=ut(go,this)-1;this.setActiveLayerIndex(t<0?ut(oi,this).size()-1:t),Ss(Rr,this,this.calculateOffset())}function NR(t){const{width:e,height:r}=be(_e,this,Sm).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function Sm(){return{width:ut(Rr,this).x+this.countRenderableColumns(),height:ut(Rr,this).y+this.countRenderableRows()}}function Xl(t){if(!["forward","backward"].includes(t))return null;const e=this.getCurrentSelection().getTopStartCorner(),r=this.getCurrentSelection().getBottomEndCorner(),[n,i,o,s]=t==="forward"?[e.row,r.row,e.col,r.col]:[r.row,e.row,r.col,e.col],a=be(_e,this,Iu).call(this,n,i),l=be(_e,this,Hu).call(this,o,s);return a===null||l===null?null:this.tableApi.createCellCoords(a,l)}function Iu(t,e){const r=this.tableApi.findFirstNonHiddenRenderableRow(t,e);return r===null?null:ut(Rr,this).y+r}function Hu(t,e){const r=this.tableApi.findFirstNonHiddenRenderableColumn(t,e);return r===null?null:ut(Rr,this).x+r}function DR(t){const{row:e,col:r}=this.tableApi.visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(ut(Rr,this).y+e,ut(Rr,this).x+r)}function os(t){const e=t.clone();return e.col=t.col-ut(Rr,this).x,e.row=t.row-ut(Rr,this).y,this.tableApi.renderableToVisualCoords(e)}Ke(Hw,Wn);class AB extends Hw{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class PB extends Hw{calculateOffset(){const e=this.getCurrentSelection(),{row:r,col:n}=e.getOuterTopStartCorner(),i=this.tableApi.countRenderableColumnsInRange(0,n-1),o=this.tableApi.countRenderableRowsInRange(0,r-1),s=e.highlight.isHeader(),a=s?Math.abs(n):0,l=s?Math.abs(r):0;return{x:n<0?a:-i,y:r<0?l:-o}}countRenderableRows(){const e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){const e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}const Dc=0,kc=1,gM=2,Aw=3,xB=[Aw,gM],NB=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Cg=Symbol("root"),kR=Symbol("child");function Lc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cg;if(e!==Cg&&e!==kR)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===Cg;let i=Dc;if(r){const o=t[0];t.length===0?i=kc:n&&o instanceof Cl?i=Aw:n&&Array.isArray(o)?i=Lc(o,kR):t.length>=2&&t.length<=4&&!t.some((a,l)=>!NB[l].includes(typeof a))&&(i=gM)}return i}function Pw(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!xB.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===Aw;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),zt(u)&&(u=a),zt(c)&&(c=l),!n){const p=a,v=l,y=u,T=c;a=Math.min(p,y),l=Math.min(v,T),u=Math.max(p,y),c=Math.max(v,T)}const h=s?o.highlight.clone():e(a,l),f=e(a,l),g=e(u,c);return r(h,f,g)}}function DB(t){const e=Lc(t.getSelected());if(e===Dc||e===kc)return[];const r=Pw(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;z(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.col,0),c=l.col-u+1;z(Array.from(new Array(c),(h,f)=>u+f),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return zo(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function kB(t){const e=Lc(t.getSelected());if(e===Dc||e===kc)return[];const r=Pw(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;z(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.row,0),c=l.row-u+1;z(Array.from(new Array(c),(h,f)=>u+f),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return zo(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function to(t,e,r){LB(t,e),e.set(t,r)}function LB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ro(t,e,r){return(e=FB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FB(t){var e=VB(t,"string");return typeof e=="symbol"?e:e+""}function VB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function We(t,e){return t.get(mM(t,e))}function fr(t,e,r){return t.set(mM(t,e),r),r}function mM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var gr=new WeakMap,ss=new WeakMap,Zl=new WeakMap,Si=new WeakMap,Ql=new WeakMap,ba=new WeakMap,Jl=new WeakMap;class pM{constructor(e,r){var n=this;ro(this,"settings",void 0),ro(this,"tableProps",void 0),ro(this,"inProgress",!1),ro(this,"selectedRange",new Iw((i,o,s)=>this.tableProps.createCellRange(i,o,s))),ro(this,"highlight",void 0),to(this,gr,void 0),to(this,ss,void 0),ro(this,"selectedByRowHeader",new Set),ro(this,"selectedByColumnHeader",new Set),to(this,Zl,!1),to(this,Si,!1),to(this,Ql,"unknown"),to(this,ba,-1),to(this,Jl,0),this.settings=e,this.tableProps=r,this.highlight=new EB({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[k_()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),fr(gr,this,new AB(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),fr(ss,this,new PB(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),We(gr,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformStart",...o)}),We(gr,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformStart",...o)}),We(gr,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformEnd",...o)}),We(gr,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformEnd",...o)}),We(gr,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertRowRequire",...o)}),We(gr,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertColRequire",...o)}),We(gr,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeRowWrap",...o)}),We(gr,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeColumnWrap",...o)}),We(ss,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformFocus",...o)}),We(ss,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(We(Jl,this))}getActiveSelectionLayerIndex(){return We(Jl,this)}setActiveSelectionLayerIndex(e){fr(Jl,this,e)}markSource(e){fr(Ql,this,e)}markEndSource(){fr(Ql,this,"unknown")}getSelectionSource(){return We(Ql,this)}setExpectedLayers(e){fr(ba,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,fr(ba,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=zt(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();fr(Si,this,!1),fr(Zl,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!o||o&&!s&&zt(r))&&(this.selectedRange.clear(),z(this.highlight.getAreas(),l=>{l.clear()}),z(this.highlight.getLayeredAreas(),l=>{l.clear()}),z(this.highlight.getRowHeaders(),l=>{l.clear()}),z(this.highlight.getColumnHeaders(),l=>{l.clear()}),z(this.highlight.getActiveRowHeaders(),l=>{l.clear()}),z(this.highlight.getActiveColumnHeaders(),l=>{l.clear()}),z(this.highlight.getActiveCornerHeaders(),l=>{l.clear()}),z(this.highlight.getRowHighlights(),l=>{l.clear()}),z(this.highlight.getColumnHighlights(),l=>{l.clear()})),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r);const n=e.clone(),i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((i>0||o>0)&&(i===0&&n.col<0&&!s||o===0&&n.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const a=this.getActiveSelectedRange();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),c=a.getVerticalDirection(),h=this.isMultiple();a.setTo(n),h&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),h&&(c!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}i>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,r),this.applyAndCommit(this.getActiveSelectedRange(),r);const l=We(ba,this)===-1||this.selectedRange.size()===We(ba,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),f.clear(),g.clear(),this.highlight.isEnabledFor(qp,e.highlight)&&(this.isMultiple()||r>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),r===1)){const p=this.selectedRange.peekByIndex(r-1);this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(p.from).commit().syncWith(p),this.highlight.createLayeredArea().add(p.from).commit().syncWith(p),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(S0,e.highlight)){if(!e.isSingleHeader()){const y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),T=this.tableProps.createCellCoords(e.to.row,-1),R=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),_=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),l.add(R).commit(),f.add(y).commit(),g.add(R).commit()):(a.add(y).add(T).commit(),l.add(R).add(_).commit(),f.add(y).add(T).commit(),g.add(R).add(_).commit())}const p=!We(Si,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),v=!We(Si,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());p&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),p&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r),We(gr,this).setActiveLayerIndex(r),We(ss,this).setActiveLayerIndex(r);const n=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Gu,n.highlight)&&i.add(n.highlight).commit().syncWith(n),this.inProgress||(fr(Zl,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{visualCoords:i}=We(gr,this).transformStart(e,r,n);this.setRangeStart(i)}transformEnd(e,r){const{visualCoords:n,selectionLayer:i}=We(gr,this).transformEnd(e,r);this.setRangeEnd(n,i)}transformFocus(e,r){const{selectionLayer:n,visualCoords:i}=We(ss,this).transformStart(e,r);this.setRangeFocus(i.normalize(),n)}shiftRows(e,r){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:r;this.getSelectedRange().pop();const f=this.tableProps.createCellCoords(Ae(i.row+h,c,a-1),i.col),g=this.tableProps.createCellCoords(Ae(o.row+r,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(f,!0,this.tableProps.createCellCoords(Ae(s.row+r,0,a-1),s.col)):this.setRangeStartOnly(f,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:r;this.getSelectedRange().pop();const f=this.tableProps.createCellCoords(i.row,Ae(i.col+h,c,a-1)),g=this.tableProps.createCellCoords(o.row,Ae(o.col+r,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(f,!0,this.tableProps.createCellCoords(s.row,Ae(s.col+r,0,a-1))):this.setRangeStartOnly(f,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const r=yr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}isFocusSelectionChanged(){return this.isSelected()&&We(Zl,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,c=r?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getActiveSelectedRange())===null||e===void 0?void 0:e.highlight;const{focusPosition:f,disableHeadersHighlight:g}=i;f&&Number.isInteger(f?.row)&&Number.isInteger(f?.col)&&(h=this.tableProps.createCellCoords(Ae(f.row,u,o-1),Ae(f.col,c,s-1)));const p=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.runLocalHooks("beforeSelectAll",p,v,h),this.setRangeStartOnly(p,void 0,h),fr(Si,this,g),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.runLocalHooks("afterSelectAll",p,v,h),this.finish()}selectCells(e){var r=this;const n=Lc(e);if(n===kc)return!1;if(n===Dc)throw new Error(Sr`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Pw(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),z(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof r=="string"?this.tableProps.propToCol(r):r,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),f=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(f){let g=0,p=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(g=Ae(n.row,u,s-1),p=Ae(n.col,Math.min(i,o),Math.max(i,o))):(g=Ae(n,u,s-1),p=i);const v=this.tableProps.createCellCoords(g,p),y=l===0?0:Ae(v.row,u,-1),T=s-1,R=this.tableProps.createCellCoords(y,i),_=this.tableProps.createCellCoords(T,o);this.runLocalHooks("beforeSelectColumns",R,_,v),this.setRangeStartOnly(R,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(_),this.runLocalHooks("afterSelectColumns",R,_,v),this.finish()}return f}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,f=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(h=Ae(n.row,Math.min(e,r),Math.max(e,r)),f=Ae(n.col,a,o-1)):(h=e,f=Ae(n,a,o-1));const g=this.tableProps.createCellCoords(h,f),p=s===0?0:Ae(g.col,a,-1),v=o-1,y=this.tableProps.createCellCoords(e,p),T=this.tableProps.createCellCoords(r,v);this.runLocalHooks("beforeSelectRows",y,T,g),this.setRangeStartOnly(y,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectRows",y,T,g),this.finish()}return c}importSelection(e){let{ranges:r,activeRange:n,activeSelectionLayer:i,selectedByRowHeader:o,selectedByColumnHeader:s,disableHeadersHighlight:a}=e;r.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!1,fr(Si,this,a),this.selectedByRowHeader=new Set(o),this.selectedByColumnHeader=new Set(s),this.setActiveSelectionLayerIndex(0),r.forEach((l,u)=>{this.selectedRange.push(l),this.applyAndCommit(l,u)}),this.setRangeFocus(n.highlight,i),fr(Si,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:We(Si,this)}}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(n.length),n.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=r-1;u.assign({row:Ae(u.row,this.settings.navigableHeaders?-1/0:0,c),col:Ae(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:Ae(a.row,-1/0,c),col:Ae(a.col,-1/0,h)}),l.assign({row:Ae(l.row,-1/0,c),col:Ae(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.getActiveSelectedRange();this.highlight.isEnabledFor(Gu,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),f.commit(),g.commit()}this.highlight.useLayerLevel(r)}}Ke(pM,Wn);const LR=/^(\r\n|\n\r|\r|\n)/,WB=/^[^\t\r\n]+/,FR=/^\t/;function BB(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(FR))t=t.replace(FR,""),r+=1,e[n][r]="";else if(t.match(LR))t=t.replace(LR,""),r=0,n+=1,e[n]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(WB);o=s?s[0]:"",t=t.slice(o.length)}e[n][r]=o}return e}function Zu(t){let e,r,n,i,o="",s;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(o+="	"),s=t[e][n],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==r-1&&(o+=`
`)}return o}function Rg(t,e){const{instance:r,visualRow:n,visualCol:i,valueSetter:o}=e;return Se(o)?o.call(r,t,n,i,e):t}function $B(t,e){const{instance:r,visualRow:n,visualCol:i,valueGetter:o}=e;return Se(o)?o.call(r,t,n,i,e):t}function no(t,e,r){return(e=jB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jB(t){var e=zB(t,"string");return typeof e=="symbol"?e:e+""}function zB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cs{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){no(this,"hot",void 0),no(this,"metaManager",void 0),no(this,"tableMeta",void 0),no(this,"dataSource",void 0),no(this,"duckSchema",void 0),no(this,"colToPropCache",void 0),no(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,o=0,s=!1;if(typeof r=="function"){const a=Ap(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=s?r(n):r[n];if(nt(a)){if(typeof a.data<"u"){const l=s?o:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return M0(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,o=n,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Me(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&ue(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(ue(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?tl(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,f=[];for(;a<r&&o+a<c;){let p=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?p=Bi(this.getSchema()):(p=[],Et(h-1,()=>p.push(null))):this.hot.dataType==="function"?p=this.tableMeta.dataSchema(l+a):(p={},L_(p,this.getSchema())),f.push(p),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,f);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===f.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(s,r)),this.hot.runHooks("afterCreateRow",g,a,n),{delta:a,startPhysicalIndex:s}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,r,n)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,f=i==="end"?Math.min(h+1,a):h;let g=0;for(let p=f;g<r&&l+g<s;p++){if(typeof c!="number"||c>=l+g)if(u>0)for(let v=0;v<u;v+=1)typeof o[v]>"u"&&(o[v]=[]),o[v].push(null);else o.push([null]);else for(let v=0;v<u;v++)o[v].splice(p,0,null);g+=1}return g>0&&(e==null?this.metaManager.createColumn(null,g):n!=="auto"&&this.metaManager.createColumn(f,r)),this.hot.columnIndexMapper.insertIndexes(c,g,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(f),g,n),this.refreshDuckSchema(),{delta:g,startPhysicalIndex:f}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const o=this.visualRowsToPhysical(i,r),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,n)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=ue(this.tableMeta.columns)||ue(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,r),s=o.slice(0).sort((h,f)=>f-h);if(this.hot.runHooks("beforeRemoveCol",i,r,o,n)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,f=this.hot.countSourceRows();h<f;h++)c[h].splice(o[0],r),h===0&&this.metaManager.removeColumn(o[0],r);else for(let h=0,f=this.hot.countSourceRows();h<f;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,o,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];zS(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return vD(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),o}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];zS(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),o}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const o=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>n.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const o=this.hot.runHooks("modifyRowData",n);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&jr(i,r))a=i[r];else if(s&&typeof r=="string"&&r.indexOf(".")>-1){let c=i;if(!c)return null;const h=r.split(".");for(let f=0,g=h.length;f<g;f++)if(c=c[h[f]],typeof c>"u")return null;a=c}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));const l=this.propToCol(r),u=this.hot.toPhysicalColumn(l);if(Is(n)&&Is(u)&&(a=$B(a,this.metaManager.getCellMeta(n,u,{visualRow:e,visualColumn:l,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const c=yr(a);this.hot.runHooks("modifyData",e,l,c,"get"),c.isTouched()&&(a=c.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let o=n,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=yr(o);this.hot.runHooks("modifyData",e,this.propToCol(r),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&jr(s,r))s[r]=o;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let u=s,c=0,h;const f=r.split(".");for(c=0,h=f.length-1;c<h;c++){if(f[c]==="__proto__"||f[c]==="constructor"||f[c]==="prototype")return;typeof u[f[c]]>"u"&&(u[f[c]]={}),u=u[f[c]]}u[f[c]]=o}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],o);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;s[r]=o}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let o=(n+e)%n,s=r,a;for(;o<n&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let o=(n+e)%n,s=r;for(;o<n&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,Cs.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=n===Cs.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),f=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(o=Math.min(e.row,r.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,r.col);s<=f&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,r){return Zu(this.getRange(e,r,Cs.DESTINATION_RENDERER))}getCopyableText(e,r){return Zu(this.getRange(e,r,Cs.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:UB,getItem:YB,hasItem:wM}=Yo("cellTypes");function qB(t){if(!wM(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return YB(t)}function GB(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&n0(t,r),n&&gL(t,n),i&&vL(t,i),UB(t,e)}function KB(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!jr(e,t)}function Fc(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?qB(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Me(e,(o,s)=>{t._automaticallyAssignedMetaProps.delete(s)}),!nt(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Me(n,(o,s)=>{if(KB(s,r)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Wi(t,i)}function XB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}$D(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function Au(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function eu(t){return t==null}const vM=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,emptyDataState:!1,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),Mo(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),Mo(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),F_(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRowHeights:void 0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function VR(t,e,r){return(e=ZB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZB(t){var e=QB(t,"string");return typeof e=="symbol"?e:e+""}function QB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JB(){return class{}}class e${constructor(e){VR(this,"metaCtor",JB()),VR(this,"meta",void 0),this.meta=this.metaCtor.prototype,Wi(this.meta,vM()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;Wi(this.meta,e),Fc(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function t$(t,e,r){return(e=r$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r$(t){var e=n$(t,"string");return typeof e=="symbol"?e:e+""}function n$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class i${constructor(e){t$(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){Wi(this.meta,e),Fc(this.meta,e,e)}}function tu(t,e,r){return(e=o$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o$(t){var e=s$(t,"string");return typeof e=="symbol"?e:e+""}function s$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qu{constructor(e){tu(this,"valueFactory",void 0),tu(this,"data",[]),tu(this,"index",[]),tu(this,"holes",new Set),this.valueFactory=e}obtain(e){Au(()=>Is(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Au(()=>Is(e)||eu(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let s=0;s<r;s++)n.push(i+s),this.data.push(void 0);const o=eu(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...n,...this.index.slice(o)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Au(()=>Is(e)||eu(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(eu(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const o=n[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function WR(t,e,r){return(e=a$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a$(t){var e=l$(t,"string");return typeof e=="symbol"?e:e+""}function l$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const u$=["data","width"];class c${constructor(e){WR(this,"globalMeta",void 0),WR(this,"metas",new Qu(()=>this._createMeta())),this.globalMeta=e,this.metas=new Qu(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);Wi(n,r),Fc(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return XB(this.globalMeta.getMetaConstructor(),u$).prototype}}function BR(t,e,r){return(e=h$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h$(t){var e=d$(t,"string");return typeof e=="symbol"?e:e+""}function d$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class f${constructor(e){BR(this,"columnMeta",void 0),BR(this,"metas",new Qu(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);Wi(i,n),Fc(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var o;const s=this.metas.obtain(e).obtain(r);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(n),s[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)ue(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){Au(()=>Is(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Qu(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class yM{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new e$(e),this.tableMeta=new i$(this.globalMeta),this.columnMeta=new c$(this.globalMeta),this.cellMeta=new f$(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){const i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Ke(yM,Wn);function $R(t,e,r,n){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=n,h=Mc(a),f=i.getSettings();Array.isArray(f.dataSchema)?i.dataType="array":Se(f.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new Cs(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const p=g.getSchema();t=[];let v,y=0,T=0;for(y=0,T=f.startRows;y<T;y++)if((i.dataType==="object"||i.dataType==="function")&&f.dataSchema)v=Bi(p),t.push(v);else if(i.dataType==="array")v=Bi(p[0]),t.push(v);else{v=[];for(let R=0,_=f.startCols;R<_;R++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),f.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),r(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.view.adjustElementsSize(),i.render()),i.getSettings().ariaTags&&Ce(i.rootElement,[N_(-1),Ic(i.countCols()+(i.view?i.countRowHeaders():0))])}function jR(t,e,r){return(e=g$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g$(t){var e=m$(t,"string");return typeof e=="symbol"?e:e+""}function m$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p${constructor(e){var r=this;jR(this,"metaManager",void 0),jR(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),pe.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=jr(e,"type")?e.type:null;let c=Se(e.cells)?e.cells(n,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function w$(t,e,r){v$(t,e),e.set(t,r)}function v$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eg(t,e,r){return(e=y$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y$(t){var e=b$(t,"string");return typeof e=="symbol"?e:e+""}function b$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function S$(t,e){return t.get(C$(t,e))}function C$(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var zR=new WeakMap;class R${constructor(e){Eg(this,"metaManager",void 0),Eg(this,"usageTracker",new Set),Eg(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),w$(this,zR,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(r,l,o),s&&this.installPropWatcher(i,l,o)):n&&(this.installPropWatcher(r,l,S$(zR,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,o,s),this[r]=o},enumerable:!0,configurable:!0})}}function E$(t,e){bM(t,e),e.add(t)}function UR(t,e,r){bM(t,e),e.set(t,r)}function bM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YR(t,e){return t.get(Vs(t,e))}function qR(t,e,r){return t.set(Vs(t,e),r),r}function Vs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Cm=new WeakMap,Rm=new WeakMap,qa=new WeakSet;class T${constructor(e){let{rowIndexMapper:r,columnIndexMapper:n}=e;E$(this,qa),UR(this,Cm,void 0),UR(this,Rm,void 0),qR(Cm,this,r),qR(Rm,this,n)}toRenderable(e){const r=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,i=Vs(qa,this,GR).call(this,e.from,r,n);if(i===null)return null;const o=Vs(qa,this,GR).call(this,e.to,-r,-n);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function GR(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const n=Vs(qa,this,KR).call(this,YR(Cm,this),t.row,e);if(n===null)return null;const i=Vs(qa,this,KR).call(this,YR(Rm,this),t.col,r);return i===null?null:t.clone().assign({row:n,col:i})}function KR(t,e,r){return e<0?e:t.getNearestNotHiddenIndex(e,r)}function Zs(t){To(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function Vc(t){const{selection:e,view:r}=t,n=t.getSelectedRangeActive(),i=e.getSelectionSource(),o=r.getFirstFullyVisibleColumn(),s=r.getLastFullyVisibleColumn(),a=n.getTopStartCorner().col,l=n.getBottomEndCorner().col,u=a<=o,c=l>=s,h=r.getFirstFullyVisibleRow(),f=r.getLastFullyVisibleRow(),g=n.getTopStartCorner().row,p=n.getBottomEndCorner().row,v=g<=h,y=p>=f;return{getComputedColumnTarget(T){return i==="mouse"||i==="keyboard"?T.col:u&&c?n.highlight.col:u?a:c?l:T.col},getComputedRowTarget(T){return i==="mouse"||i==="keyboard"?T.row:v&&y?n.highlight.row:v?g:y?p:T.row}}}function _$(t){return e=>{const r=Vc(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const n=!!t.getSettings().colHeaders;Zs(t.getCell(n?-1:0,r,!0))})}}function O$(){return()=>{}}function M$(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const r=t.getSelectedRangeActive();if(!r)return;const{row:n,col:i}=r.highlight;Zs(t.getCell(n,i,!0))})}}function I$(t){return e=>{const r=Vc(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;Zs(t.getCell(i,o,!0))})}}function H$(t){return e=>{const r=Vc(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;Zs(t.getCell(i,o,!0))})}}function A$(t){return e=>{const r=Vc(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const n=!!t.getSettings().rowHeaders;Zs(t.getCell(r,n?-1:0,!0))})}}function P$(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e,o=()=>{Zs(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&n>=0)t.scrollViewportTo({row:n},o);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},o)}}}function x$(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var o;if(r||n){r=!1;return}let s;e.isFocusSelectionChanged()?s=M$(t):e.isSelectedByCorner()?s=O$():e.isSelectedByRowHeader()?s=A$(t):e.isSelectedByColumnHeader()?s=_$(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=I$(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=P$(t):e.getSelectedRange().size()>1&&(s=H$(t)),(o=s)===null||o===void 0||o(i)}}}const N$=Object.freeze({INLINE:"inline",MODAL:"modal"}),So=Object.freeze({UNKNOWN:"unknown",CLICK:"click",TAB_FROM_ABOVE:"tab_from_above",TAB_FROM_BELOW:"tab_from_below"}),D$="grid";function k$(t,e){const r=XR(t,So.TAB_FROM_ABOVE),n=XR(t,So.TAB_FROM_BELOW);return e.prepend(r),e.append(n),{activate(){r.tabIndex=0,n.tabIndex=0},deactivate(){r.tabIndex=-1,n.tabIndex=-1},destroy(){r.remove(),n.remove()}}}function XR(t,e){const n=t.rootDocument.createElement("input");return n.type="text",n.name="htFocusCatcher",n.classList.add("htFocusCatcher"),n.dataset.htFocusSource=e,t.getSettings().ariaTags&&Ce(n,[ju("Focus catcher")]),n}function L$(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n={shortcutsContextName:D$,type:N$.INLINE,contains:g=>g===e||e.contains(g),runOnlyIf:()=>!0,...r},i=k$(t,e);return{getType:()=>n.type,hasContainerDetached:()=>!t.rootWrapperElement.contains(e),getShortcutsContextName:()=>n.shortcutsContextName,runOnlyIf:()=>n.runOnlyIf(),contains:g=>n.contains(g),activate:function(){var g;let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:So.UNKNOWN;(g=n.onActivate)===null||g===void 0||g.call(n,p)},deactivate:()=>{var g;(g=n.onDeactivate)===null||g===void 0||g.call(n)},activateFocusCatchers:()=>{i?.activate()},deactivateFocusCatchers:()=>{i?.deactivate()},enable:()=>{e.removeAttribute("inert")},disable:()=>{e.setAttribute("inert","true")},destroy:()=>{i?.destroy()}}}function F$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=!1;function n(c){if(!r){var h;(h=e.onFocus)===null||h===void 0||h.call(e,c)}}function i(c){var h;(h=e.onClick)===null||h===void 0||h.call(e,c)}function o(c){if(c.key==="Tab"){var h;(h=e.onTabKeyDown)===null||h===void 0||h.call(e,c)}}function s(){r=!0}function a(){r=!1}return{mount:()=>{let c=t;for(;c;){const{documentElement:h}=c.document;h.addEventListener("focusin",n),h.addEventListener("click",i),h.addEventListener("keydown",o),h.addEventListener("mousedown",s),h.addEventListener("mouseup",a),c=Io(c)}},unmount:()=>{let c=t;for(;c;){const{documentElement:h}=c.document;h.removeEventListener("focusin",n),h.removeEventListener("click",i),h.removeEventListener("keydown",o),h.removeEventListener("mousedown",s),h.removeEventListener("mouseup",a),c=Io(c)}}}}function V$(t){const e=Sl({errorIdExists:p=>`The "${p}" focus scope is already registered.`}),r=t.getShortcutManager();let n=null;function i(){return n?e.getId(n):null}function o(p,v){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e.hasItem(p))throw new Error(`Scope with id "${p}" already registered`);const T=L$(t,v,y);e.addItem(p,T),r.getOrCreateContext(T.getShortcutsContextName())}function s(p){if(!e.hasItem(p))throw new Error(`Scope with id "${p}" not found`);e.getItem(p).destroy(),e.removeItem(p)}function a(p){if(!e.hasItem(p))throw new Error(`Scope with id "${p}" not found`);u(e.getItem(p))}function l(p){if(!e.hasItem(p))throw new Error(`Scope with id "${p}" not found`);c(e.getItem(p))}function u(p){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:So.UNKNOWN;n!==p&&(n!==null&&c(n),n=p,n.activate(v),r.setActiveContextName(p.getShortcutsContextName()))}function c(p){h(),n===p&&(n=null,p.deactivate())}function h(){const p=e.getValues(),v=p.filter(y=>y.runOnlyIf()&&y.getType()==="modal");p.forEach(y=>{v.length>0&&v.includes(y)||v.length===0||y.hasContainerDetached()?y.enable():y.disable(),y===n?y.contains(t.rootDocument.activeElement)?y.deactivateFocusCatchers():y.activateFocusCatchers():y.runOnlyIf()?y.activateFocusCatchers():y.deactivateFocusCatchers()})}function f(p,v){if(!p.isConnected||!Fs(p))return;const y=e.getValues().filter(R=>R.runOnlyIf());let T=!1;y.forEach(R=>{!T&&R.contains(p)&&(T=!0,v!==So.UNKNOWN&&t.listen(),u(R,v))}),!T&&n&&(c(n),t.unlisten())}const g=F$(t.rootWindow,{onFocus:p=>{var v;f(p.target,(v=p.target.dataset.htFocusSource)!==null&&v!==void 0?v:So.UNKNOWN)},onClick:p=>{f(p.target,So.CLICK)},onTabKeyDown:()=>{h()}});return g.mount(),{getActiveScopeId:i,registerScope:o,unregisterScope:s,activateScope:p=>a(p),deactivateScope:p=>l(p),destroy:()=>g.unmount()}}function W$(t,e){SM(t,e),e.add(t)}function as(t,e,r){SM(t,e),e.set(t,r)}function SM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function He(t,e){return t.get(ln(t,e))}function mo(t,e,r){return t.set(ln(t,e),r),r}function ln(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const As=Object.freeze({CELL:"cell",MIXED:"mixed"});var qe=new WeakMap,ru=new WeakMap,nu=new WeakMap,iu=new WeakMap,ou=new WeakMap,Ju=new WeakMap,Hn=new WeakSet;class B${constructor(e){W$(this,Hn),as(this,qe,void 0),as(this,ru,void 0),as(this,nu,1),as(this,iu,null),as(this,ou,new Map),as(this,Ju,!1),mo(qe,this,e)}init(){var e=this;const r=He(qe,this).getSettings();mo(ru,this,r.imeFastEdit?As.MIXED:As.CELL),He(qe,this).addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return ln(Hn,e,U$).call(e,...i)}),He(qe,this).addHook("afterSelection",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return ln(Hn,e,ZR).call(e,...i)}),He(qe,this).addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return ln(Hn,e,ZR).call(e,...i)}),He(qe,this).addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return ln(Hn,e,j$).call(e,...i)}),He(qe,this).addHook("afterRender",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return ln(Hn,e,z$).call(e,...i)})}getFocusMode(){return He(ru,this)}setFocusMode(e){Object.values(As).includes(e)?mo(ru,this,e):Cr(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return He(nu,this)}setRefocusDelay(e){mo(nu,this,e)}setRefocusElementGetter(e){mo(iu,this,e)}getRefocusElement(){var e;return typeof He(iu,this)=="function"?He(iu,this).call(this):(e=He(qe,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,o;const s=(i=He(qe,this).getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=He(qe,this).runHooks("modifyFocusedElement",s.row,s.col,n);To(a)||(a=n),a&&!((o=He(qe,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?r(e):ln(Hn,this,xw).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:He(nu,this);if(He(qe,this).getSettings().imeFastEdit&&!((e=He(qe,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=He(qe,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),He(ou,this).has(r)||He(ou,this).set(r,Q_(()=>{if(!He(qe,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},r)),He(ou,this).get(r)()}}}function xw(t){var e;const r=(e=He(qe,this).getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||!He(qe,this).selection.isCellVisible(r)){t(null);return}const n=He(qe,this).getCell(r.row,r.col,!0);n===null?He(qe,this).addHookOnce("afterScroll",()=>{t(He(qe,this).getCell(r.row,r.col,!0))}):t(n)}function $$(){ln(Hn,this,xw).call(this,t=>{const{activeElement:e}=He(qe,this).rootDocument;e&&K_(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function j$(){ln(Hn,this,xw).call(this,t=>{this.getFocusMode()===As.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function ZR(){mo(Ju,this,!0)}function z$(){He(Ju,this)&&(mo(Ju,this,!1),ln(Hn,this,$$).call(this))}function U$(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?As.MIXED:As.CELL)}function Y$(t){return e=>{if(!e)return null;const{rowIndexMapper:r,columnIndexMapper:n}=t;if(r.isHidden(e.row)||n.isHidden(e.col))return null;const i=Em(t),o=Tm(t);return i===null||o===null?null:(e.row=Ae(e.row,i.row,o.row),e.col=Ae(e.col,i.col,o.col),e)}}function Em(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,o=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=r.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function Tm(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}const Ga="gridDefault",Nw="grid",ec="grid.tabNavigation",CM="editorManager.handlingEditor",q$="editor",G$={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},K$="hooksRefRegisterer",RM={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){z(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Me(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};pi(RM,"MIXIN_NAME",K$,{writable:!1,enumerable:!1});function tn(t,e,r){return(e=X$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function X$(t){var e=Z$(t,"string");return typeof e=="symbol"?e:e+""}function Z$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Q$="base",lt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Dw{static get EDITOR_TYPE(){return Q$}constructor(e){tn(this,"hot",void 0),tn(this,"state",lt.VIRGIN),tn(this,"_opened",!1),tn(this,"_fullEditMode",!1),tn(this,"_closeCallback",null),tn(this,"TD",null),tn(this,"row",null),tn(this,"col",null),tn(this,"prop",null),tn(this,"originalValue",null),tn(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,o,s){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:lt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,o,s;if(r){const l=this.hot.getSelectedRangeActive(),u=l.getTopStartCorner(),c=l.getBottomEndCorner();n=u.row,i=u.col,o=c.row,s=c.col}else[n,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,o,s,"edit")}beginEditing(e,r){if(this.state!==lt.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=lt.EDITING,this.isInFullEditMode()){const l=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,u=typeof e=="string"?e:Ip(l);this.setValue(u)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),n.view.scrollViewport(n._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,r,n){let i;if(n){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),n(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===lt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===lt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=lt.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=lt.FINISHED,this.discardEditor(s)}):(this.state=lt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=lt.FINISHED,this.discardEditor()}discardEditor(e){this.state===lt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=lt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=lt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===lt.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Fr(r),a=lr(r),l=Fr(this.hot.rootElement),u=lr(this.hot.rootElement),c=n.topOverlay.holder,h=n.inlineStartOverlay.holder,f=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,p=o.innerWidth-l.left-u,{wtTable:v}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,y=v.name,T=["master","inline_start"].includes(y)?f:0,R=["master","top","bottom"].includes(y)?g:0,_=s.top===l.top?0:1;let b=s.top-l.top-_-T,M=0;this.hot.isRtl()?M=o.innerWidth-s.left-a-p-1+R:M=s.left-l.left-1-R,["top","top_inline_start_corner"].includes(y)&&(b+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(M+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const P=this.hot.hasColHeaders(),A=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),D=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),B=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(P&&A<=0||A===B)&&(b+=1),D<=0&&(M+=1);const q=i.rowsRenderCalculator.startPosition,L=i.columnsRenderCalculator.startPosition,ae=Math.abs(n.inlineStartOverlay.getScrollPosition()),G=n.topOverlay.getScrollPosition(),ee=Ut(this.hot.rootDocument);let st=r.offsetTop;if(["inline_start","master"].includes(y)&&(st+=q-G),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:C,wtTable:S}=n.bottomOverlay.clone;st+=C.getWorkspaceHeight()-S.getHeight()-ee}let Re=r.offsetLeft;this.hot.isRtl()?(Re>=0?Re=v.getWidth()-r.offsetLeft:Re=Math.abs(Re),Re+=L-ae-a):["top","master","bottom"].includes(y)&&(Re+=L-ae);const Ee=o.getComputedStyle(this.TD),$e=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Fe=parseInt(Ee[$e],10)>0?0:1,Ie=parseInt(Ee.borderTopWidth,10)>0?0:1,Kr=lr(r)+Fe,Te=ur(r)+Ie,Gt=ak(c)?ee:0,d=lk(h)?ee:0,m=this.hot.view.maximumVisibleElementWidth(Re)-Gt+Fe,w=Math.max(this.hot.view.maximumVisibleElementHeight(st)-d+Ie,this.hot.stylesHandler.getDefaultRowHeight());return{top:b,start:M,height:Te,maxHeight:w,width:Kr,maxWidth:m}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}Ke(Dw,RM);const J$={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===lt.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},ej={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},tj={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},rj={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeActive();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},nj={name:"editorOpen",callback(t,e,r){const{selection:n}=t,i=t._getEditorManager(),o=t.getSelectedRange(),s=t.getSelectedRangeActive(),{highlight:a}=s;if((o.some(l=>n.isMultiple(l))||o.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const l=t.getSettings(),u=typeof l.enterMoves=="function"?l.enterMoves(e):l.enterMoves;r.includes("shift")?n.transformFocus(-u.row,-u.col):n.transformFocus(u.row,u.col);return}a.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),Ac(e))}};function ij(){return[G$,J$,ej,tj,rj,nj]}const oj={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},sj={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),o=r.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},aj={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},lj={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},uj={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}},cj={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},hj={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},dj={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},fj={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},gj={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},mj={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},pj={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}},wj={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},vj={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.max(n.row-t.countVisibleRows(),0),o=r.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function yj(){return[oj,sj,aj,lj,uj,cj,hj,dj,fj,gj,mj,pj,wj,vj]}const bj={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},Sj={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+n;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}},Cj={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-s.row,-s.col):r.transformStart(-s.row,-s.col),r.markEndSource()}},Rj={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(s.row,s.col):r.transformStart(s.row,s.col),r.markEndSource()}},Ej={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},Tj={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},_j={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}},Oj={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},Mj={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeActive().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},Ij={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeActive().highlight.row,o=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},Hj={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeActive().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},Aj={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeActive().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},Pj={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}},xj={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},Nj={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},Dj={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+n;o=o===0?-1:-o,i===-n?o=-1:i+o<n&&(o=-(i+n)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}};function kj(){return[bj,Sj,Cj,Rj,Ej,Tj,_j,Oj,Mj,Ij,Hj,Aj,Pj,xj,Nj,Dj]}const Lj={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},Fj={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeActive(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(r,n),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},Vj={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},Wj={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},Bj={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},$j={name:"tabNavigation",callback(t){const e={wrapped:!1,flipped:!1};let r=!1,n=!1;return t.addHook("afterSelection",(i,o,s,a,l)=>{r&&(e.wrapped&&e.flipped||n)&&(n=!1,l.value=!0)}),t.addHook("beforeRowWrap",(i,o,s)=>{e.wrapped=!0,e.flipped=s}),{before(){const{tabNavigation:i}=t.getSettings();r=!0,i||(n=!0)},after(i){const{tabNavigation:o,autoWrapRow:s}=t.getSettings();if(r=!1,!o||!t.selection.isSelected()||s&&e.wrapped&&e.flipped||!s&&e.wrapped)return e.wrapped=!1,e.flipped=!1,t.deselectCell(),!1;i.preventDefault()}}}},jj=[...ij(),...yj(),...kj(),Lj,Fj,Vj,Wj,Bj,$j];function EM(t){const e={};return jj.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function zj(t){const e=t.getShortcutManager().addContext(q$),r=EM(t),n={group:CM};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext(Nw),callback:(i,o)=>r.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>r.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function Uj(t){const e=t.getShortcutManager().addContext(Nw),r=EM(t),n={runOnlyIf:()=>{const{navigableHeaders:o}=t.getSettings();return ue(t.getSelected())&&(o||!o&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:Ga};e.addShortcuts([{keys:[["F2"]],callback:o=>r.editorFastOpen(o)},{keys:[["Enter"],["Enter","Shift"]],callback:(o,s)=>r.editorOpen(o,s)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:CM,runOnlyIf:()=>ue(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var o;return!((o=t.getSelectedRangeActive())!==null&&o!==void 0&&o.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var o;return(o=t.getSelectedRangeActive())===null||o===void 0?void 0:o.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var o,s;return!((o=t.getSelectedRangeActive())!==null&&o!==void 0&&o.highlight.isHeader())&&((s=t.getSelectedRangeActive())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:o=>r.moveCellSelectionInlineStart(o)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:o=>r.moveCellSelectionInlineEnd(o)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n);const i=r.tabNavigation();e.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Ga,group:ec,position:"before",callback:o=>i.before(o)},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Ga,group:ec,callback:o=>i.after(o),position:"after"}])}function Yj(t){[Uj,zj].forEach(e=>e(t))}function qj(t){var e;const r=Y$(t),n={wrapped:!1,flipped:!1};let i,o=!0,s=!1;t.addHook("afterSelection",()=>{if(o){var u;i=(u=t.getSelectedRangeActive())===null||u===void 0?void 0:u.highlight}}),t.addHook("beforeRowWrap",(u,c,h)=>{n.wrapped=!0,n.flipped=h}),t.addHook("beforeEmptyDataStateShow",()=>{s=!0}),t.addHook("beforeEmptyDataStateHide",()=>{s=!1}),t.getShortcutManager().getContext(Nw).addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Ga,group:ec,position:"before",callback(){const{tabNavigation:u}=t.getSettings();t.getSelectedRangeActive()&&!u&&(o=!1)}},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Ga,group:ec,callback(u){const{tabNavigation:c,autoWrapRow:h}=t.getSettings();o=!0,(!c||!t.selection.isSelected()||h&&n.wrapped&&n.flipped||!h&&n.wrapped)&&(h&&n.wrapped&&n.flipped&&(i=u.shiftKey?Em(t):Tm(t)),n.wrapped=!1,n.flipped=!1)},position:"after"}]);const l=(e=t.rootGridElement)!==null&&e!==void 0?e:t.rootElement;t.getFocusScopeManager().registerScope("grid",l,{contains:u=>l===u||l.contains(u)?!0:u.closest(".htMenu")!==null?!1:t.rootPortalElement.contains(u),runOnlyIf:()=>{const{navigableHeaders:u}=t.getSettings();return(s||!u)&&t.countRenderedRows()===0&&t.countRenderedCols()===0&&t.countRowHeaders()>0&&t.countColHeaders()>0?!1:!u&&t.countRenderedRows()>0&&t.countRenderedCols()>0||u&&(t.countRowHeaders()>0||t.countColHeaders()>0)},onActivate:u=>{if(u==="tab_from_above"){var c;const f=(c=r(i))!==null&&c!==void 0?c:Em(t);f&&t.runHooks("modifyFocusOnTabNavigation","from_above",f)!==!1&&t.selectCell(f.row,f.col)}else if(u==="tab_from_below"){var h;const f=(h=r(i))!==null&&h!==void 0?h:Tm(t);f&&t.runHooks("modifyFocusOnTabNavigation","from_below",f)!==!1&&t.selectCell(f.row,f.col)}}})}function Gj(t){[qj].forEach(e=>e(t))}const QR=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),su=t=>t.map(e=>{const r=e.toLowerCase();return QR.has(r)?QR.get(r):r}).sort().join("+"),Kj=t=>t.split("+"),JR=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Tg=t=>{let{which:e,key:r}=t;if(JR.has(e))return JR.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},TM=Symbol("shortcut-context");function _m(t){return nt(t)&&t.__kindOf===TM}const Xj=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const r=Sl({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:u,callback:c,group:h,runOnlyIf:f=()=>!0,captureCtrl:g=!1,preventDefault:p=!0,stopPropagation:v=!1,relativeToGroup:y,position:T,forwardToContext:R}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(zt(h))throw new Error("You need to define the shortcut's group.");if(Se(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(Sr`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const _={callback:c,group:h,runOnlyIf:f,captureCtrl:g,preventDefault:p,stopPropagation:v};ue(y)&&(_.relativeToGroup=y,_.position=T),_m(R)&&(_.forwardToContext=R),u.forEach(b=>{const M=su(b);if(r.hasItem(M)){const A=r.getItem(M);let D=A.findIndex(V=>V.group===y);D!==-1?T==="before"?D-=1:D+=1:D=A.length,A.splice(D,0,_)}else r.addItem(M,[_])})},i=function(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(h=>{Me(c,(f,g)=>{Object.prototype.hasOwnProperty.call(h,g)===!1&&(h[g]=c[g])}),n(h)})},o=u=>{const c=su(u);r.removeItem(c)};return{__kindOf:TM,scope:e,addShortcut:n,addShortcuts:i,getShortcuts:u=>{const c=su(u),h=r.getItem(c);return ue(h)?h.slice():[]},hasShortcut:u=>{const c=su(u);return r.hasItem(c)},removeShortcutsByKeys:o,removeShortcutsByGroup:u=>{r.getItems().forEach(h=>{let[f,g]=h;const p=g.filter(v=>v.group!==u);p.length===0?o(Kj(f)):(g.length=0,g.push(...p))})}}};function Zj(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Qj=["meta","alt","shift","control"],Sa=Zj(),Ca=[];let au=0;function Jj(t,e,r,n,i){const o=g=>Qj.includes(g),s=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return g.altKey&&v.push("alt"),p&&(g.ctrlKey||g.metaKey)?v.push("control/meta"):(g.ctrlKey&&v.push("control"),g.metaKey&&v.push("meta")),g.shiftKey&&v.push("shift"),v},a=g=>{if(e(g)===!1||r(g)===!1||g.keyCode===229||typeof g.key!="string"||ho(g))return;const v=Tg(g);let y=[];o(v)||(y=s(g));const T=[v].concat(y);!i(g,T)&&(iC()&&y.includes("meta")||!iC()&&y.includes("control"))&&i(g,[v].concat(s(g,!0))),n(g)},l=g=>{if(typeof g.key=="string"){const p=Tg(g);o(p)&&Sa.press(p)}},u=g=>{if(typeof g.key=="string"){const p=Tg(g);o(p)&&Sa.release(p)}},c=()=>{Sa.releaseAll()};return{mount:()=>{let g=t;for(au+=1;g;)au===1&&(g.document.documentElement.addEventListener("keydown",l),Ca.push({event:"keydown",listener:l}),g.document.documentElement.addEventListener("keyup",u),Ca.push({event:"keyup",listener:u})),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=Io(g)},unmount:()=>{let g=t;for(au-=1;g;){if(au===0){for(let p=0;p<Ca.length;p++){const{event:v,listener:y}=Ca[p];g.document.documentElement.removeEventListener(v,y)}Ca.length=0}g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=Io(g)}},isPressed:g=>Sa.isPressed(g),releasePressedKeys:()=>Sa.releaseAll()}}const ez=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const o=Sl({errorIdExists:y=>`The "${y}" context name is already registered.`});let s="grid";const a=function(y){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const R=Xj(y,T);return o.addItem(y,R),R},l=()=>s,u=y=>o.getItem(y),c=function(y){var T;let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";return(T=u(y))!==null&&T!==void 0?T:a(y,R)},h=y=>{if(!o.hasItem(y))throw new Error(Sr`You've tried to activate the "${y}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=y};let f=!1;const g=function(y,T){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const _=_m(R)?R:u(R);let b=!1;if(!_.hasShortcut(T))return b;const M=_.getShortcuts(T);for(let P=0;P<M.length;P++){const{callback:A,runOnlyIf:D,preventDefault:V,stopPropagation:B,captureCtrl:q,forwardToContext:L}=M[P];if(D(y)===!0){if(f=q,b=A(y,T)===!1,f=!1,V&&y.preventDefault(),B&&(Ac(y),y.stopPropagation()),b)break;L&&g(y,T,L)}}return b},v=Jj(e,y=>{const T=l(),R=_m(T)?T:u(T);return r(y,R.scope)},n,i,g);return v.mount(),{addContext:a,getActiveContextName:l,getContext:u,getOrCreateContext:c,setActiveContextName:h,isCtrlPressed:()=>!f&&(v.isPressed("control")||v.isPressed("meta")),releasePressedKeys:()=>v.releasePressedKeys(),destroy:()=>v.unmount()}};function eE(t){const{classNames:e}=JD(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function tz(t,e){_M(t,e),e.add(t)}function ei(t,e,r){_M(t,e),e.set(t,r)}function _M(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ze(t,e){return t.get(an(t,e))}function nr(t,e,r){return t.set(an(t,e),r),r}function an(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const tE=23;var _g=new WeakMap,_n=new WeakMap,tc=new WeakMap,kw=new WeakMap,Om=new WeakMap,_i=new WeakMap,ka=new WeakMap,rl=new WeakMap,Ra=new WeakMap,In=new WeakSet;class rz{constructor(e){let{hot:r,rootElement:n,rootDocument:i,onThemeChange:o=()=>{}}=e;tz(this,In),ei(this,_g,void 0),ei(this,_n,void 0),ei(this,tc,void 0),ei(this,kw,void 0),ei(this,Om,void 0),ei(this,_i,!0),ei(this,ka,{}),ei(this,rl,{}),ei(this,Ra,void 0),nr(_g,this,r),nr(tc,this,n),nr(Om,this,i),nr(Ra,this,o)}isClassicTheme(){return ze(_i,this)}getCSSVariableValue(e){var r;if(ze(_i,this))return null;if(ze(ka,this)[`--ht-${e}`])return ze(ka,this)[`--ht-${e}`];const n=(r=an(In,this,oz).call(this,`--ht-${e}`))!==null&&r!==void 0?r:an(In,this,OM).call(this,`--ht-${e}`);if(n!==null)return ze(ka,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=ze(rl,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(e){if(ze(_i,this))return tE;const r=an(In,this,nz).call(this);return r?e!==void 0&&e===ze(_g,this).view.getFirstRenderedVisibleRow()?r+1:r:tE}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){nr(_n,this,void 0),nr(_i,this,!0),ze(Ra,this).call(this,ze(_n,this)),an(In,this,Og).call(this);return}if(e&&e!==ze(_n,this)){if(!/ht-theme-.*/.test(e)){Cr(`Invalid theme name: ${e}. Please provide a valid theme name.`),nr(_n,this,void 0),nr(_i,this,!1),ze(Ra,this).call(this,ze(_n,this)),an(In,this,Og).call(this);return}ze(_n,this)&&an(In,this,sz).call(this),nr(_n,this,e),nr(_i,this,!1),ze(Ra,this).call(this,ze(_n,this)),an(In,this,Og).call(this)}}getThemeName(){return ze(_n,this)}}function nz(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function Og(){this.isClassicTheme()||nr(kw,this,getComputedStyle(ze(tc,this)));const t=an(In,this,iz).call(this,["box-sizing","border-bottom-width"]);ze(rl,this).td={...ze(rl,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function iz(t){const e=ze(Om,this),r=ze(tc,this),n=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),n.appendChild(i),r.appendChild(n);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),r.removeChild(n),u}function oz(t){const e=Math.ceil(parseFloat(an(In,this,OM).call(this,t)));return Number.isNaN(e)?null:e}function OM(t){const e=ze(kw,this).getPropertyValue(t);return e===""?null:e}function sz(){nr(rl,this,{}),nr(ka,this,{}),nr(_i,this,!0)}let si=null,Pu=0;function az(t){const e=t.ownerDocument;if(!si){si=e.createElement("div"),si.setAttribute("role","status"),si.setAttribute("aria-live","assertive"),si.setAttribute("aria-atomic","true");const r=si.style;r.position="absolute",r.width="1px",r.height="1px",r.margin="-1px",r.overflow="hidden",r.clipPath="rect(0 0 0 0)",r.whiteSpace="nowrap",t.appendChild(si)}Pu+=1}function lz(){Pu!==0&&(Pu===1&&(si.remove(),si=null),Pu-=1)}let Mg=null;const lu=new WeakSet,Ig=new Map;function MM(t,e){var r,n,i=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const a=new $i(s);let l,u,c,h,f,g,p=!0;const v={...e.initialState,...e};dW(o)&&hW(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=Mn(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Mn(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),K(this.rootElement,["ht-wrapper","handsontable"]),K(this.rootWrapperElement,"ht-root-wrapper"),K(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),K(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const y=(r=v?.layoutDirection)!==null&&r!==void 0?r:"inherit",T=["rtl","ltr"].includes(y)?y:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",T),(n=this.rootWrapperElement)===null||n===void 0||n.setAttribute("dir",T),this.isRtl=function(){return T==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},this.stylesHandler=new rz({hot:s,rootElement:s.rootElement,rootDocument:s.rootDocument,onThemeChange:d=>{Mn(this)&&(Oe(this.rootWrapperElement,/ht-theme-.*/g),Oe(this.rootPortalElement,/ht-theme-.*/g),d&&(K(this.rootWrapperElement,d),K(this.rootPortalElement,d),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||Cr(`The "${d}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),v.language=uB(v.language);const R=Object.fromEntries(Object.entries(v).filter(d=>{let[m]=d;return!(pe.getSingleton().isRegistered(m)||pe.getSingleton().isDeprecated(m))})),_=new yM(s,R,[p$,R$]),b=_.getTableMeta(),M=_.getGlobalMeta(),P=Sl();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${I_()}`,Ig.set(this.guid,this),this.columnIndexMapper=new ym,this.rowIndexMapper=new ym,this.columnIndexMapper.addLocalHook("indexesSequenceChange",d=>{s.runHooks("afterColumnSequenceChange",d)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",d=>{s.runHooks("afterRowSequenceChange",d)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",d=>{s.runHooks("beforeCompositionStart",d)}),u=new TW(s);const A=Yo(this.guid);A.register("cellRangeMapper",new T$({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const D=d=>{const{row:m,col:w}=d;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,w>=0?s.columnIndexMapper.getRenderableFromVisualIndex(w):w)},V=d=>{const{row:m,col:w}=d;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,w>=0?s.columnIndexMapper.getVisualFromRenderableIndex(w):w)},B=(d,m)=>{const w=m>d?1:-1,C=Math.min(d,m),S=Math.max(d,m),O=s.rowIndexMapper.getNearestNotHiddenIndex(d,w);return O===null||w===1&&O>S||w===-1&&O<C?null:O>=0?s.rowIndexMapper.getRenderableFromVisualIndex(O):O},q=(d,m)=>{const w=m>d?1:-1,C=Math.min(d,m),S=Math.max(d,m),O=s.columnIndexMapper.getNearestNotHiddenIndex(d,w);return O===null||w===1&&O>S||w===-1&&O<C?null:O>=0?s.columnIndexMapper.getRenderableFromVisualIndex(O):O};let L=new pM(b,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:d=>l.propToCol(d),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(d,m)=>s._createCellCoords(d,m),createCellRange:(d,m,w)=>s._createCellRange(d,m,w),visualToRenderableCoords:D,renderableToVisualCoords:V,findFirstNonHiddenRenderableRow:B,findFirstNonHiddenRenderableColumn:q,isDisabledCellSelection:(d,m)=>d<0||m<0?s.getSettings().disableVisualSelection:s.getCellMeta(d,m).disableVisualSelection});this.selection=L;const ae=d=>{let{hiddenIndexesChanged:m}=d;this.forceFullRender=!0,m&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",d=>{ae(d),this.runHooks("afterColumnSequenceCacheUpdate",d)}),this.rowIndexMapper.addLocalHook("cacheUpdated",d=>{ae(d),this.runHooks("afterRowSequenceCacheUpdate",d)}),this.selection.addLocalHook("afterSetRangeEnd",(d,m)=>{const w=yr(!1),C=this.selection.getSelectedRange(),{from:S,to:O}=C.current(),H=C.size()-1;this.runHooks("afterSelection",S.row,S.col,O.row,O.col,w,H),this.runHooks("afterSelectionByProp",S.row,s.colToProp(S.col),O.row,s.colToProp(O.col),w,H),m&&(!w.isTouched()||w.isTouched()&&!w.value)&&g.scrollTo(d);const x=L.isSelectedByRowHeader(),j=L.isSelectedByColumnHeader();x&&j?K(this.rootElement,["ht__selection--rows","ht__selection--columns"]):x?(Oe(this.rootElement,"ht__selection--columns"),K(this.rootElement,"ht__selection--rows")):j?(Oe(this.rootElement,"ht__selection--rows"),K(this.rootElement,"ht__selection--columns")):Oe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(L.getSelectionSource())||h.closeEditor(null),L.getSelectionSource()!=="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",d=>{this.runHooks("beforeSelectionFocusSet",d.row,d.col)}),this.selection.addLocalHook("afterSetFocus",d=>{const m=yr(!1);this.runHooks("afterSelectionFocusSet",d.row,d.col,m),(!m.isTouched()||m.isTouched()&&!m.value)&&g.scrollTo(d),h.closeEditor(),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",d=>{const m=d.length-1,{from:w,to:C}=d[m];this.runHooks("afterSelectionEnd",w.row,w.col,C.row,C.col,m),this.runHooks("afterSelectionEndByProp",w.row,s.colToProp(w.col),C.row,s.colToProp(C.col),m),L.getSelectionSource()==="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",d=>{const m=this.runHooks("afterIsMultipleSelection",d.value);d.value&&(d.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),s.view.render(),Oe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("afterSelectRows",...m)}).addLocalHook("beforeSelectAll",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("beforeSelectAll",...m)}).addLocalHook("afterSelectAll",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("afterSelectAll",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformFocus",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("modifyTransformFocus",...m)}).addLocalHook("afterModifyTransformFocus",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("afterModifyTransformFocus",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return i.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",d=>this.alter("insert_row_above",d,1,"auto")).addLocalHook("insertColRequire",d=>this.alter("insert_col_start",d,1,"auto")),c={alter(d,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,C=arguments.length>3?arguments[3]:void 0,S=arguments.length>4?arguments[4]:void 0;const O=H=>{if(H.length===0)return[];const x=[...H];return x.sort((F,I)=>{let[Q]=F,[te]=I;return Q===te?0:Q>te?1:-1}),zo(x,(F,I)=>{let[Q,te]=I;const de=F[F.length-1],[Ze,Mt]=de,bt=Ze+Mt;if(Q<=bt){const kt=Math.max(te-(bt-Q),0);de[1]+=kt}else F.push([Q,te]);return F},[x[0]])};switch(d){case"insert_row_below":case"insert_row_above":const H=s.countSourceRows();if(b.maxRows===H)return;const x=d==="insert_row_below"?"below":"above";m=m??(x==="below"?H:0);const{delta:j,startPhysicalIndex:F}=l.createRow(m,w,{source:C,mode:x});L.shiftRows(s.toVisualRow(F),j);break;case"insert_col_start":case"insert_col_end":const I=d==="insert_col_end"?"end":"start";m=m??(I==="end"?s.countSourceCols():0);const{delta:Q,startPhysicalIndex:te}=l.createCol(m,w,{source:C,mode:I});if(Q){if(Array.isArray(b.colHeaders)){const Mt=[s.toVisualColumn(te),0];Mt.length+=Q,Array.prototype.splice.apply(b.colHeaders,Mt)}L.shiftColumns(s.toVisualColumn(te),Q)}break;case"remove_row":const de=Mt=>{let bt=0;z(Mt,kt=>{let[Ne,Ue]=kt;const St=Mo(Ne)?s.countRows()-1:Math.max(Ne-bt,0);if(Number.isInteger(Ne)&&(Ne=Math.max(Ne-bt,0)),!l.removeRow(Ne,Ue,C))return;if(L.isSelected()){const{row:gt}=s.getSelectedRangeActive().highlight;gt>=Ne&&gt<=Ne+Ue-1&&h.closeEditor(!0)}const $n=s.countRows(),jn=b.fixedRowsTop;jn>=St+1&&(b.fixedRowsTop-=Math.min(Ue,jn-St));const Ft=b.fixedRowsBottom;if(Ft&&St>=$n-Ft&&(b.fixedRowsBottom-=Math.min(Ue,Ft)),$n===0)L.deselect();else if(C==="ContextMenu.removeRow"){const gt=L.getSelectedRange(),Mr=gt.pop();gt.clear().set(Mr.from).current().setTo(Mr.to),L.refresh()}else L.shiftRows(Ne,-Ue);bt+=Ue})};Array.isArray(m)?de(O(m)):de([[m,w]]);break;case"remove_col":const Ze=Mt=>{let bt=0;z(Mt,kt=>{let[Ne,Ue]=kt;const St=Mo(Ne)?s.countCols()-1:Math.max(Ne-bt,0);let Lt=s.toPhysicalColumn(St);if(Number.isInteger(Ne)&&(Ne=Math.max(Ne-bt,0)),!l.removeCol(Ne,Ue,C))return;if(L.isSelected()){const{col:gt}=s.getSelectedRangeActive().highlight;gt>=Ne&&gt<=Ne+Ue-1&&h.closeEditor(!0)}if(s.countCols()===0)L.deselect();else if(C==="ContextMenu.removeColumn"){const gt=L.getSelectedRange(),Mr=gt.pop();gt.clear().set(Mr.from).current().setTo(Mr.to),L.refresh()}else L.shiftColumns(Ne,-Ue);const Ft=b.fixedColumnsStart;Ft>=St+1&&(b.fixedColumnsStart-=Math.min(Ue,Ft-St)),Array.isArray(b.colHeaders)&&(typeof Lt>"u"&&(Lt=-1),b.colHeaders.splice(Lt,Ue)),bt+=Ue})};Array.isArray(m)?Ze(O(m)):Ze([[m,w]]);break;default:throw new Error(`There is no such action "${d}"`)}S||c.adjustRowsAndCols(),s.view.adjustElementsSize(),s.view.render()},adjustRowsAndCols(){const d=b.minRows,m=b.minSpareRows,w=b.minCols,C=b.minSpareCols;if(d){const S=s.countRows();S<d&&l.createRow(S,d-S,{source:"auto"})}if(m){const S=s.countEmptyRows(!0);if(S<m){const O=m-S,H=Math.min(O,b.maxRows-s.countSourceRows());l.createRow(s.countRows(),H,{source:"auto"})}}{let S;(w||C)&&(S=s.countEmptyCols(!0));let O=s.countCols();if(w&&!b.columns&&O<w){const H=w-O;S+=H,l.createCol(O,H,{source:"auto"})}if(C&&!b.columns&&s.dataType==="array"&&S<C){O=s.countCols();const H=C-S,x=Math.min(H,b.maxCols-O);l.createCol(O,x,{source:"auto"})}}},populateFromArray(d,m,w,C,S){let O,H,x,j;const F=[],I={},Q=[],te=d.row,de=d.col;if(H=m.length,H===0)return!1;let Ze=0,Mt=0;switch(nt(w)&&(Ze=w.col-de+1,Mt=w.row-te+1),S){case"shift_down":const kt=Ff(m),Ne=kt.length,Ue=Math.max(Ne,Ze),St=s.getData().slice(te),Lt=Ff(St).slice(de,de+Ue);for(x=0;x<Ue;x+=1)if(x<Ne){for(O=0,H=kt[x].length;O<Mt-H;O+=1)kt[x].push(kt[x][O%H]);x<Lt.length?Q.push(kt[x].concat(Lt[x])):Q.push(kt[x].concat(new Array(St.length).fill(null)))}else Q.push(kt[x%Ne].concat(Lt[x]));s.populateFromArray(te,de,Ff(Q));break;case"shift_right":const $n=m.length,jn=Math.max($n,Mt),Ft=s.getData().slice(te).map(hr=>hr.slice(de));for(O=0;O<jn;O+=1)if(O<$n){for(x=0,j=m[O].length;x<Ze-j;x+=1)m[O].push(m[O][x%j]);if(O<Ft.length)for(let hr=0;hr<Ft[O].length;hr+=1)m[O].push(Ft[O][hr]);else m[O].push(...new Array(Ft[0].length).fill(null))}else m.push(m[O%H].slice(0,jn).concat(Ft[O]));s.populateFromArray(te,de,m);break;case"overwrite":default:I.row=d.row,I.col=d.col;let gt=0,Mr=0,yn=!0,Xr;const Ir=function(qo){let Zr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const bn=m[qo%m.length];return Zr!==null?bn[Zr%bn.length]:bn},zn=m.length,qi=w?w.row-d.row+1:0;for(w?H=qi:H=Math.max(zn,qi),O=0;O<H&&!(w&&I.row>w.row&&qi>zn||!b.allowInsertRow&&I.row>s.countRows()-1||I.row>=b.maxRows);O++){const hr=O-gt,qo=Ir(hr).length,Zr=w?w.col-d.col+1:0;if(w?j=Zr:j=Math.max(qo,Zr),I.col=d.col,Xr=s.getCellMeta(I.row,I.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&Xr.skipRowOnPaste){gt+=1,I.row+=1,H+=1;continue}for(Mr=0,x=0;x<j;x++){var bt;if(w&&I.col>w.col&&Zr>qo||!b.allowInsertColumn&&I.col>s.countCols()-1||I.col>=b.maxCols)break;if(Xr=s.getCellMeta(I.row,I.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&Xr.skipColumnOnPaste){Mr+=1,I.col+=1,j+=1;continue}if(Xr.readOnly&&C!=="UndoRedo.undo"){I.col+=1;continue}const bn=x-Mr,Qs=!!Xr.valueSetter;let It=Ir(hr,bn),dr=(bt=s.getSourceDataAtCell(I.row,I.col))!==null&&bt!==void 0?bt:null;if(It!==null&&typeof It=="object"){if(Array.isArray(It)&&dr===null&&(dr=[]),!Qs&&(typeof dr!="object"||dr===null))yn=!1;else if(dr!==null){const _l=tl(Array.isArray(dr)?dr:dr[0]||dr),Qe=tl(Array.isArray(It)?It:It[0]||It);Qs||F_(_l,Qe)||Array.isArray(_l)&&Array.isArray(Qe)?It=Bi(It):yn=!1}}else!Qs&&dr!==null&&typeof dr=="object"&&(yn=!1);yn&&F.push([I.row,I.col,It]),yn=!0,I.col+=1}I.row+=1}s.setDataAtCell(F,null,null,C||"populateFromArray");break}}};function G(d){const m=V0(d);Mw(m)?(s.runHooks("beforeLanguageChange",m),M.language=m,s.runHooks("afterLanguageChange",m)):W0(d)}function ee(d,m){const w=d==="className"?s.rootElement:s.table;if(p)K(w,m);else{let C=[],S=[];M[d]&&(C=Array.isArray(M[d])?M[d]:YS(M[d])),m&&(S=Array.isArray(m)?m:YS(m));const O=US(C,S),H=US(S,C);O.length&&Oe(w,O),H.length&&K(w,H)}M[d]=m}this.init=function(){u.setData(b.data),s.runHooks("beforeInit"),(Ai()||xp())&&K(s.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new pW(this),h=mm.getInstance(s,b,L),g=x$(s),f.init(),Mn(this)&&(az(s.rootPortalElement),CD(v.licenseKey,this.rootWrapperElement)),s.runHooks("init"),this.render(),p&&s.rootElement.offsetParent===null&&uk(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.view.adjustElementsSize(),s.render()}),typeof p=="object"&&(s.runHooks("afterChange",p[0],p[1]),p=!1),s.runHooks("afterInit")};function st(){let d=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,d=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&d===!1&&(d=!0,this.onQueueEmpty(this.valid))}}}function Re(d,m,w){if(!d.length){w();return}const C=s.getActiveEditor(),S=new st;let O=!0;S.onQueueEmpty=()=>{C&&O&&C.cancelChanges(),w()};for(let H=d.length-1;H>=0;H--){const[x,j,,F]=d[H],I=l.propToCol(j);let Q;Number.isInteger(I)?Q=s.getCellMeta(x,I):Q={...Object.getPrototypeOf(b),...b},s.getCellValidator(Q)&&(S.addValidatorToQueue(),s.validateCell(F,Q,(function(te,de){return function(Ze){if(typeof Ze!="boolean")throw new Error("Validation error: result is not boolean");Ze===!1&&de.allowInvalid===!1&&(O=!1,d.splice(te,1),de.valid=!0),S.removeValidatorFormQueue()}})(H,Q),m))}S.checkIfQueueIsEmpty()}function Ee(d,m){for(let C=d.length-1;C>=0;C--){let S=!1;if(d[C]===null){d.splice(C,1);continue}if(!((d[C][2]===null||d[C][2]===void 0)&&(d[C][3]===null||d[C][3]===void 0))){if(b.allowInsertRow)for(;d[C][0]>s.countRows()-1;){const{delta:O}=l.createRow(void 0,void 0,{source:"auto"});if(O===0){S=!0;break}}if(s.dataType==="array"&&(!b.columns||b.columns.length===0)&&b.allowInsertColumn)for(;l.propToCol(d[C][1])>s.countCols()-1;){const{delta:O}=l.createCol(void 0,void 0,{source:"auto"});if(O===0){S=!0;break}}S||l.set(d[C][0],d[C][1],d[C][3])}}if(d.length>0){c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",d,m),h.closeEditor(),s.view.adjustElementsSize(),s.render(),h.prepareEditor(),s.runHooks("afterChange",d,m||"edit");const C=s.getActiveEditor();C&&ue(C.refreshValue)&&C.refreshValue()}else s.render()}this._createCellCoords=function(d,m){return s.view._wt.createCellCoords(d,m)},this._createCellRange=function(d,m,w){return s.view._wt.createCellRange(d,m,w)},this.validateCell=function(d,m,w,C){let S=s.getCellValidator(m);function O(H){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){w(H);return}const j=m.visualCol,F=m.visualRow,I=s.getCell(F,j,!0);if(I&&I.nodeName!=="TH"){const Q=s.rowIndexMapper.getRenderableFromVisualIndex(F),te=s.columnIndexMapper.getRenderableFromVisualIndex(j);s.view._wt.getSetting("cellRenderer",Q,te,I)}w(H)}yD(S)&&(S=(function(H){return function(x,j){j(H.test(x))}})(S)),Se(S)?(d=s.runHooks("beforeValidate",d,m.visualRow,m.prop,C),s._registerImmediate(()=>{S.call(m,d,H=>{s&&(H=s.runHooks("afterValidate",H,d,m.visualRow,m.prop,C),m.valid=H,O(H),s.runHooks("postAfterValidate",H,d,m.visualRow,m.prop,C))})})):s._registerImmediate(()=>{m.valid=!0,O(m.valid,!1)})};function $e(d,m,w){return Array.isArray(d)?d:[[d,m,w]]}function Fe(d,m){const w=s.runHooks("beforeChange",d,m||"edit"),C=d.filter(O=>O!==null);if(w===!1||C.length===0){var S;return(S=s.getActiveEditor())===null||S===void 0||S.cancelChanges(),[]}for(let O=C.length-1;O>=0;O--){const[H,x,,j]=C[O],F=l.propToCol(x);let I;Number.isInteger(F)?I=s.getCellMeta(H,F):I={...Object.getPrototypeOf(b),...b},C[O][3]=Rg(j,I)}return C}this.setDataAtCell=function(d,m,w,C){const S=$e(d,m,w),O=[];let H=C,x,j,F;for(x=0,j=S.length;x<j;x++){const[Q,te,de]=S[x];if(typeof S[x]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof te!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");te>=this.countCols()?F=te:F=l.colToProp(te),O.push([Q,F,u.getAtCell(this.toPhysicalRow(Q),te),de])}!H&&typeof d=="object"&&(H=m);const I=Fe(O,H);s.runHooks("afterSetDataAtCell",I,H),Re(I,H,()=>{Ee(I,H)})},this.setDataAtRowProp=function(d,m,w,C){const S=$e(d,m,w),O=[];let H=C,x,j;for(x=0,j=S.length;x<j;x++){const[I,Q,te]=S[x];O.push([I,Q,u.getAtCell(this.toPhysicalRow(I),Q),te])}!H&&typeof d=="object"&&(H=m);const F=Fe(O,C);s.runHooks("afterSetDataAtRowProp",F,H),Re(F,H,()=>{Ee(F,H)})},this.listen=function(){s&&!s.isListening()&&(Ig.forEach(d=>{s!==d&&d.unlisten()}),Mg=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Mg=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Mg===s.guid},this.destroyEditor=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(d),s.view.render(),m&&L.isSelected()&&h.prepareEditor()},this.populateFromArray=function(d,m,w,C,S,O,H){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const x=typeof C=="number"?s._createCellCoords(C,S):null;return c.populateFromArray(s._createCellCoords(d,m),w,x,O,H)},this.spliceCol=function(d,m,w){for(var C=arguments.length,S=new Array(C>3?C-3:0),O=3;O<C;O++)S[O-3]=arguments[O];return l.spliceCol(d,m,w,...S)},this.spliceRow=function(d,m,w){for(var C=arguments.length,S=new Array(C>3?C-3:0),O=3;O<C;O++)S[O-3]=arguments[O];return l.spliceRow(d,m,w,...S)},this.getSelected=function(){if(L.isSelected())return Vi(L.getSelectedRange(),d=>{let{from:m,to:w}=d;return[m.row,m.col,w.row,w.col]})},this.getSelectedLast=function(){const d=this.getSelected();let m;return d&&d.length>0&&(m=d[d.length-1]),m},this.getSelectedActive=function(){const d=this.getSelectedRangeActive();if(!d)return;const{from:m,to:w}=d;return[m.row,m.col,w.row,w.col]},this.getSelectedRange=function(){if(L.isSelected())return Array.from(L.getSelectedRange())},this.getSelectedRangeLast=function(){const d=this.getSelectedRange();let m;return d&&d.length>0&&(m=d[d.length-1]),m},this.getSelectedRangeActive=function(){return L.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return L.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(d){if(!L.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];z(L.getSelectedRange(),w=>{if(w.isSingleHeader())return;const C=w.getTopStartCorner(),S=w.getBottomEndCorner();Et(C.row,S.row,O=>{Et(C.col,S.col,H=>{this.getCellMeta(O,H).readOnly||m.push([O,H,null])})})}),m.length>0&&this.setDataAtCell(m,d)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const d=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(d,0),!this.isRenderSuspended()&&d===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(d){this.suspendRender();const m=d();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||d)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=d();return this.resumeExecution(m),w},this.batch=function(d){this.suspendRender(),this.suspendExecution();const m=d();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const d=s.view,{width:m,height:w}=d.getLastSize(),{width:C,height:S}=s.rootElement.getBoundingClientRect(),O=C!==m||S!==w;s.runHooks("beforeRefreshDimensions",{width:m,height:w},{width:C,height:S},O)!==!1&&((O||d._wt.wtOverlays.scrollableElement===s.rootWindow)&&(d.setLastSize(C,S),d.adjustElementsSize(),s.render()),s.runHooks("afterRefreshDimensions",{width:m,height:w},{width:C,height:S},O))},this.updateData=function(d,m){$R(d,w=>{l=w},w=>{l=w,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),L.refresh()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:_,firstRun:p})},this.loadData=function(d,m){$R(d,w=>{l=w},()=>{_.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),L.refresh(),p&&(p=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:_,firstRun:p})},this.getInitialColumnCount=function(){const d=b.columns;let m=0;if(Array.isArray(d))m=d.length;else if(Se(d))if(s.dataType==="array"){const w=this.countSourceCols();for(let C=0;C<w;C+=1)d(C)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=l.colToPropCache.length);else if(ue(b.dataSchema)){const w=l.getSchema();m=Array.isArray(w)?w.length:Ap(w)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(d,m,w,C){return zt(d)?l.getAll():l.getRange(s._createCellCoords(d,m),s._createCellCoords(w,C),l.DESTINATION_RENDERER)},this.getCopyableText=function(d,m,w,C){return l.getCopyableText(s._createCellCoords(d,m),s._createCellCoords(w,C))},this.getCopyableData=function(d,m){return l.getCopyable(d,l.colToProp(m))},this.getCopyableSourceData=function(d,m){return u.getCopyable(d,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(p?s.loadData:s.updateData).bind(this);let C=!1,S,O;if(ue(d.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ue(d.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ue(d.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');ue(d.rowHeights)&&ue(d.minRowHeights)&&Cr("Both `rowHeights` and `minRowHeights` are defined in your configuration. As one is the alias of the other, only one of them can be used at a time. `rowHeights` will be used as the row height configuration.");for(S in d)if(!(S==="data"||S==="language"))if(S==="className")ee("className",d.className);else if(S==="tableClassName"&&s.table)ee("tableClassName",d.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(pe.getSingleton().isRegistered(S)||pe.getSingleton().isDeprecated(S)){const I=d[S];Se(I)?(pe.getSingleton().addAsFixed(S,I,s),b[S]=I):Array.isArray(I)&&(pe.getSingleton().add(S,I,s),b[S]=I)}else!m&&jr(d,S)&&(M[S]=d[S]);if(m)s.useTheme(b.themeName||eE(s.rootContainer));else{const I=s.getCurrentThemeName();jr(d,"themeName")&&I!==d.themeName&&s.useTheme(d.themeName)}lu.has(s)&&s.stylesHandler.getThemeName()!==void 0&&lu.delete(s),Mn(s)&&!lu.has(s)&&s.stylesHandler.isClassicTheme()&&(pk("The stylesheet you are using is deprecated and will be removed in version 17.0. Please update your theme configuration to ensure compatibility with future releases."),lu.add(s)),d.data===void 0&&b.data===void 0?w(null,"updateSettings"):d.data!==void 0?w(d.data,"updateSettings"):d.columns!==void 0&&(l.createMap(),s.initIndexMappers()),!p&&d.language&&G(d.language);const H=s.countCols(),x=b.columns;if(x&&Se(x)&&(C=!0),(d.cell!==void 0||d.cells!==void 0||d.columns!==void 0)&&_.clearCache(),H>0)for(S=0,O=0;S<H;S++){if(x){const I=C?x(S):x[O];I&&_.updateColumnMeta(O,I)}O+=1}ue(d.cell)&&Me(d.cell,I=>{s.setCellMetaObject(I.row,I.col,I)}),s.runHooks("afterCellMetaReset");let j=s.rootElement.style.height;j!==""&&(j=parseInt(s.rootElement.style.height,10)),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style"));let F=d.height;if(typeof d.height<"u")if(Se(F)&&(F=F()),F=s.runHooks("beforeHeightChange",F),F===null){const I=s.rootElement.getAttribute("data-initialstyle");I&&(I.indexOf("height")>-1||I.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",I):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else F!==void 0&&(s.rootElement.style.height=isNaN(F)?`${F}`:`${F}px`,s.rootElement.style.overflow="hidden");if(typeof d.width<"u"){let I=d.width;Se(I)&&(I=I()),I=s.runHooks("beforeWidthChange",I),s.rootElement.style.width=isNaN(I)?`${I}`:`${I}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",d)),c.adjustRowsAndCols(),s.view&&!p&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!m&&s.view&&(j===""||F===""||F===void 0)&&j!==F&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const d=s.getSelectedRangeActive();if(b.getValue){if(Se(b.getValue))return b.getValue.call(s);if(d)return s.getData()[d.highlight.row][b.getValue]}else if(d)return s.getDataAtCell(d.highlight.row,d.highlight.col);return null},this.getSettings=function(){return b},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(d,m,w,C,S){c.alter(d,m,w,C,S)},this.getCell=function(d,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,C=m,S=d;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;C=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(d>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(d)))return null;S=this.rowIndexMapper.getRenderableFromVisualIndex(d)}return S===null||C===null||S===void 0||C===void 0?null:s.view.getCellAtCoords(s._createCellCoords(S,C),w)},this.getCoords=function(d){const m=this.view._wt.wtTable.getCoords(d);if(m===null)return null;const{row:w,col:C}=m;let S=w,O=C;return w>=0&&(S=this.rowIndexMapper.getVisualFromRenderableIndex(w)),C>=0&&(O=this.columnIndexMapper.getVisualFromRenderableIndex(C)),s._createCellCoords(S,O)},this.colToProp=function(d){return l.colToProp(d)},this.propToCol=function(d){return l.propToCol(d)},this.toVisualRow=d=>this.rowIndexMapper.getVisualFromPhysicalIndex(d),this.toVisualColumn=d=>this.columnIndexMapper.getVisualFromPhysicalIndex(d),this.toPhysicalRow=d=>this.rowIndexMapper.getPhysicalFromVisualIndex(d),this.toPhysicalColumn=d=>this.columnIndexMapper.getPhysicalFromVisualIndex(d),this.getDataAtCell=function(d,m){return l.get(d,l.colToProp(m))},this.getDataAtRowProp=function(d,m){return l.get(d,m)},this.getDataAtCol=function(d){const m=[],w=l.getRange(s._createCellCoords(0,d),s._createCellCoords(b.data.length-1,d),l.DESTINATION_RENDERER);for(let C=0;C<w.length;C+=1)for(let S=0;S<w[C].length;S+=1)m.push(w[C][S]);return m},this.getDataAtProp=function(d){const m=[],w=l.getRange(s._createCellCoords(0,l.propToCol(d)),s._createCellCoords(b.data.length-1,l.propToCol(d)),l.DESTINATION_RENDERER);for(let C=0;C<w.length;C+=1)for(let S=0;S<w[C].length;S+=1)m.push(w[C][S]);return m},this.getSourceData=function(d,m,w,C){let S;return d===void 0?S=u.getData():S=u.getByRange(s._createCellCoords(d,m),s._createCellCoords(w,C)),S},this.getSourceDataArray=function(d,m,w,C){let S;return d===void 0?S=u.getData(!0):S=u.getByRange(s._createCellCoords(d,m),s._createCellCoords(w,C),!0),S},this.getSourceDataAtCol=function(d){return u.getAtColumn(d)},this.setSourceDataAtCell=function(d,m,w,C){const S=$e(d,m,w),O=this.hasHook("afterSetSourceDataAtCell"),H=[],x=(F,I)=>{const Q=this.toVisualRow(F),te=this.toVisualColumn(I);return Number.isInteger(te)?this.getCellMeta(Q,te):{...Object.getPrototypeOf(b),...b}};O&&z(S,F=>{let[I,Q,te]=F;const de=Rg(te,x(I,Q));H.push([I,Q,u.getAtCell(I,Q),de])}),z(S,F=>{let[I,Q,te]=F;const de=Rg(te,x(I,Q));u.setAtCell(I,Q,de)}),O&&this.runHooks("afterSetSourceDataAtCell",H,C),this.render();const j=s.getActiveEditor();j&&ue(j.refreshValue)&&j.refreshValue()},this.getSourceDataAtRow=function(d){return u.getAtRow(d)},this.getSourceDataAtCell=function(d,m){return u.getAtCell(d,m)},this.getDataAtRow=function(d){return l.getRange(s._createCellCoords(d,0),s._createCellCoords(d,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(d,m,w,C){const S=d===void 0?[0,0,this.countRows(),this.countCols()]:[d,m,w,C],[O,H]=S;let[,,x,j]=S,F=null,I=null;x===void 0&&(x=O),j===void 0&&(j=H);let Q="mixed";return Et(Math.max(Math.min(O,x),0),Math.max(O,x),te=>{let de=!0;return Et(Math.max(Math.min(H,j),0),Math.max(H,j),Ze=>(I=this.getCellMeta(te,Ze).type,F?de=F===I:F=I,de)),Q=de?I:"mixed",de}),Q},this.removeCellMeta=function(d,m,w){const[C,S]=[this.toPhysicalRow(d),this.toPhysicalColumn(m)];let O=_.getCellMetaKeyValue(C,S,w);s.runHooks("beforeRemoveCellMeta",d,m,w,O)!==!1&&(_.removeCellMeta(C,S,w),s.runHooks("afterRemoveCellMeta",d,m,w,O)),O=null},this.spliceCellsMeta=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,C=new Array(w>2?w-2:0),S=2;S<w;S++)C[S-2]=arguments[S];if(C.length>0&&!Array.isArray(C[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&_.removeRow(this.toPhysicalRow(d),m),C.length>0&&z(C.reverse(),O=>{_.createRow(this.toPhysicalRow(d)),z(O,(H,x)=>this.setCellMetaObject(d,x,H))}),s.render()},this.setCellMetaObject=function(d,m,w){typeof w=="object"&&Me(w,(C,S)=>{this.setCellMeta(d,m,S,C)})},this.setCellMeta=function(d,m,w,C){if(s.runHooks("beforeSetCellMeta",d,m,w,C)===!1)return;let O=d,H=m;d<this.countRows()&&(O=this.toPhysicalRow(d)),m<this.countCols()&&(H=this.toPhysicalColumn(m)),_.setCellMeta(O,H,w,C),s.runHooks("afterSetCellMeta",d,m,w,C)},this.getCellsMeta=function(){return _.getCellsMeta()},this.getCellMeta=function(d,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},C=this.toPhysicalRow(d),S=this.toPhysicalColumn(m);return C===null&&(C=d),S===null&&(S=m),_.getCellMeta(C,S,{visualRow:d,visualColumn:m,...w})},this.getColumnMeta=function(d){return _.getColumnMeta(this.toPhysicalColumn(d))},this.getCellMetaAtRow=function(d){return _.getCellsMetaAtRow(d)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||b.columns)},this.getCellRenderer=function(d,m){const w=typeof d=="number"?s.getCellMeta(d,m).renderer:d.renderer;return typeof w=="string"?NC(w):zt(w)?NC("text"):w},this.getCellEditor=function(d,m){const w=typeof d=="number"?s.getCellMeta(d,m).editor:d.editor;return typeof w=="string"?yC(w):zt(w)?yC("text"):w},this.getCellValidator=function(d,m){const w=typeof d=="number"?s.getCellMeta(d,m).validator:d.validator;return typeof w=="string"?wL(w):w},this.validateCells=function(d){this._validateCells(d)},this.validateRows=function(d,m){if(!Array.isArray(d))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,d)},this.validateColumns=function(d,m){if(!Array.isArray(d))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,d)},this._validateCells=function(d,m,w){const C=new st;d&&(C.onQueueEmpty=d);let S=s.countRows()-1;for(;S>=0;){if(m!==void 0&&m.indexOf(S)===-1){S-=1;continue}let O=s.countCols()-1;for(;O>=0;){if(w!==void 0&&w.indexOf(O)===-1){O-=1;continue}C.addValidatorToQueue(),s.validateCell(s.getDataAtCell(S,O),s.getCellMeta(S,O),H=>{if(typeof H!="boolean")throw new Error("Validation error: result is not boolean");H===!1&&(C.valid=!1),C.removeValidatorFormQueue()},"validateCells"),O-=1}S-=1}C.checkIfQueueIsEmpty()},this.getRowHeader=function(d){let m=b.rowHeaders,w=d;return w!==void 0&&(w=s.runHooks("modifyRowHeader",w)),w===void 0?(m=[],Et(s.countRows()-1,C=>{m.push(s.getRowHeader(C))})):Array.isArray(m)&&m[w]!==void 0?m=m[w]:Se(m)?m=m(w):m&&typeof m!="string"&&typeof m!="number"&&(m=w+1),m},this.hasRowHeaders=function(){return!!b.rowHeaders},this.hasColHeaders=function(){if(b.colHeaders!==void 0&&b.colHeaders!==null)return!!b.colHeaders;for(let d=0,m=s.countCols();d<m;d++)if(s.getColHeader(d))return!0;return!1},this.getColHeader=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=s.runHooks("modifyColHeader",d);if(w===void 0){const x=[],j=s.countCols();for(let F=0;F<j;F++)x.push(s.getColHeader(F));return x}let C=b.colHeaders;const S=function(x){const j=[],F=s.countCols();let I=0;for(;I<F;I++)Se(b.columns)&&b.columns(I)&&j.push(I);return j[x]},O=s.toPhysicalColumn(w),H=S(O);return b.colHeaders===!1?C=null:b.columns&&Se(b.columns)&&b.columns(H)&&b.columns(H).title?C=b.columns(H).title:b.columns&&b.columns[O]&&b.columns[O].title?C=b.columns[O].title:Array.isArray(b.colHeaders)&&b.colHeaders[O]!==void 0?C=b.colHeaders[O]:Se(b.colHeaders)?C=b.colHeaders(O):b.colHeaders&&typeof b.colHeaders!="string"&&typeof b.colHeaders!="number"&&(C=CW(w)),C=s.runHooks("modifyColumnHeaderValue",C,d,m),C},this._getColWidthFromSettings=function(d){let m;if(d>=0&&(m=s.getCellMeta(0,d).width),(m===void 0||m===b.width)&&(m=b.colWidths),m!=null){switch(typeof m){case"object":m=m[d];break;case"function":m=m(d);break}typeof m=="string"&&(m=Number.parseInt(m,10))}return m},this.getColWidth=function(d,m){let w=s._getColWidthFromSettings(d);return w=s.runHooks("modifyColWidth",w,d,m),w===void 0&&(w=Wp),w},this._getRowHeightFromSettings=function(d){var m;const w=s.stylesHandler.getDefaultRowHeight(d);let C=(m=b.rowHeights)!==null&&m!==void 0?m:b.minRowHeights;if(C!=null){switch(typeof C){case"object":C=C[d];break;case"function":C=C(d);break}typeof C=="string"&&(C=Number.parseInt(C,10))}return C!=null&&C<w?w:C},this.getRowHeight=function(d,m){let w=s._getRowHeightFromSettings(d);return w=s.runHooks("modifyRowHeight",w,d,m),w},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const d=b.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(d,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return PC(s.countRows()-1,w=>{if(s.isEmptyRow(w))m+=1;else if(d===!0)return!1}),m},this.countEmptyCols=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return PC(s.countCols()-1,w=>{if(s.isEmptyCol(w))m+=1;else if(d===!0)return!1}),m},this.isEmptyRow=function(d){return b.isEmptyRow.call(s,d)},this.isEmptyCol=function(d){return b.isEmptyCol.call(s,d)},this.selectCell=function(d,m,w,C){let S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return zt(d)||zt(m)?!1:this.selectCells([[d,m,w,C]],S,O)},this.selectCells=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&g.suspend();const C=L.selectCells(d);return C&&w&&s.listen(),g.resume(),C},this.selectColumns=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,w=arguments.length>2?arguments[2]:void 0;return L.selectColumns(d,m,w)},this.selectRows=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,w=arguments.length>2?arguments[2]:void 0;return L.selectRows(d,m,w)},this.deselectCell=function(){L.deselect()},this.selectAll=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,w=arguments.length>2?arguments[2]:void 0;g.skipNextScrollCycle(),L.selectAll(d,m,w)};const Ie=(d,m)=>d.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(d,m){if(typeof d=="number"){var w;d={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(w=arguments[4])!==null&&w!==void 0?w:!0}}const{row:C,col:S,considerHiddenIndexes:O}=d??{};let H=C,x=S;if(Se(m)&&this.addHookOnce("afterScroll",m),O===void 0||O){const Q=Number.isInteger(C)&&C>=0,te=Number.isInteger(S)&&S>=0,de=Q?Ie(this.rowIndexMapper,C):void 0,Ze=te?Ie(this.columnIndexMapper,S):void 0;if(de===null||Ze===null)return!1;H=Q?s.rowIndexMapper.getRenderableFromVisualIndex(de):C,x=te?s.columnIndexMapper.getRenderableFromVisualIndex(Ze):S}const j=Number.isInteger(H),F=Number.isInteger(x);let I=!1;return j&&H>=0&&F&&x>=0?I=s.view.scrollViewport(s._createCellCoords(H,x),d.horizontalSnap,d.verticalSnap):j&&H>=0&&(F&&x<0||!F)?I=s.view.scrollViewportVertically(H,d.verticalSnap):F&&x>=0&&(j&&H<0||!j)&&(I=s.view.scrollViewportHorizontally(x,d.horizontalSnap)),Se(m)&&(I?this.view.render():(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m()))),I},this.scrollToFocusedCell=function(d){if(!this.selection.isSelected())return!1;Se(d)&&this.addHookOnce("afterScroll",d);const{highlight:m}=this.getSelectedRangeActive(),w=this.scrollViewportTo(m.toObject());return w?this.view.render():Se(d)&&(this.removeHook("afterScroll",d),this._registerMicrotask(()=>d())),w},this.destroy=function(){s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,Mn(this)&&(lz(),this.getFocusScopeManager().destroy()),this.getShortcutManager().destroy(),A.clear(),_.clearCache(),Ig.delete(this.guid),a.destroy(),h&&h.destroy(),s.rootContainer&&Ls(s.rootContainer),s.rootPortalElement&&s.rootPortalElement.remove(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),P.getItems().forEach(d=>{let[,m]=d;m.destroy()}),P.clear(),s.runHooks("afterDestroy")},!0),pe.getSingleton().destroy(s),Me(s,(d,m,w)=>{Se(d)?w[m]=Kr(m):m!=="guid"&&(w[m]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,L=null,h=null,s=null};function Kr(d){return()=>{throw new Error(`The "${d}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(d){return P.getItem(Mc(d))},this.getPluginName=function(d){return d===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:P.getId(d)},this.getInstance=function(){return s},this.addHook=function(d,m,w){pe.getSingleton().add(d,m,s,w)},this.hasHook=function(d){return pe.getSingleton().has(d,s)||pe.getSingleton().has(d)},this.addHookOnce=function(d,m,w){pe.getSingleton().once(d,m,s,w)},this.removeHook=function(d,m){pe.getSingleton().remove(d,m,s)},this.runHooks=function(d,m,w,C,S,O,H){return pe.getSingleton().run(s,d,m,w,C,S,O,H)},this.getTranslatedPhrase=function(d,m){return dM(b.language,d,m)},this.toHTML=()=>IC(this),this.toTableElement=()=>{const d=this.rootDocument.createElement("div");return d.insertAdjacentHTML("afterbegin",IC(this)),d.firstElementChild},this.timeouts=[],this.useTheme=d=>{const m=!!p;this.stylesHandler.useTheme(d);const w=this.stylesHandler.getThemeName();m||(s.render(),s.scrollViewportTo(0,0),eE(this.rootContainer)&&(Oe(this.rootContainer,/ht-theme-.*/g),w&&K(this.rootContainer,w))),this.runHooks("afterSetTheme",w,m)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=d;typeof w=="function"&&(w=setTimeout(w,m)),this.timeouts.push(w)},this._clearTimeouts=function(){z(this.timeouts,d=>{clearTimeout(d)})},this.immediates=[],this._registerImmediate=function(d){this.immediates.push(setImmediate(d))},this._clearImmediates=function(){z(this.immediates,d=>{clearImmediate(d)})},this._registerMicrotask=function(d){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||d()})},this._getEditorManager=function(){return h};const Te=ez({handleEvent(){return s.isListening()},beforeKeyDown:d=>this.runHooks("beforeKeyDown",d),afterKeyDown:d=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",d)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",d=>{d.ctrlKey===!1&&d.metaKey===!1&&Te.releasePressedKeys()}),this.getShortcutManager=function(){return Te},f=new B$(s);const Gt=Mn(this)?V$(s):null;this.getFocusManager=function(){return f},this.getFocusScopeManager=function(){if(!Mn(s))throw new Error("The FocusScopeManager is only available for the main Handsontable instance.");return Gt},a0().forEach(d=>{const m=Vp(d);P.addItem(d,new m(this))}),Yj(s),Mn(this)&&Gj(s),Te.setActiveContextName("grid"),pe.getSingleton().run(s,"construct")}function rE(t,e,r){t.addEventListener(e,r,!1)}function nE(t,e,r){t.removeEventListener(e,r,!1)}function uu(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function uz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},n=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,f;i.textContent=r.textContent(s),o.style.position="absolute",o.style.fontSize=uu(s).fontSize,o.style.fontFamily=uu(s).fontFamily,o.style.whiteSpace="pre",n.appendChild(o);const g=parseInt(((h=uu(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),p=parseInt(((f=uu(s))===null||f===void 0?void 0:f.paddingInlineEnd)||0,10),v=o.clientWidth+g+p+1;n.removeChild(o);const y=s.style;y.height=`${r.minHeight}px`,r.minWidth>v?y.width=`${r.minWidth}px`:v>r.maxWidth?y.width=`${r.maxWidth}px`:y.width=`${v}px`;const T=s.scrollHeight?s.scrollHeight-1:0;r.minHeight>T?y.height=`${r.minHeight}px`:r.maxHeight<T?(y.height=`${r.maxHeight}px`,y.overflowY="visible"):y.height=`${T}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")r.minHeight=s.clientHeight;else{const f=parseInt(h.minHeight,10);isNaN(f)||(r.minHeight=f)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")r.maxHeight=s.clientHeight;else{const f=parseInt(h.maxHeight,10);isNaN(f)||(r.maxHeight=f)}if(h&&h.minWidth)if(h.minWidth==="inherit")r.minWidth=s.clientWidth;else{const f=parseInt(h.minWidth,10);isNaN(f)||(r.minWidth=f)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")r.maxWidth=s.clientWidth;else{const f=parseInt(h.maxWidth,10);isNaN(f)||(r.maxWidth=f)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,f){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(f),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${r.minHeight}px`,s.style.minWidth=`${r.minWidth}px`,s.style.maxWidth=`${r.maxWidth}px`,s.style.overflowY="hidden"),g&&(rE(s,"input",a),rE(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){nE(s,"input",a),nE(s,"keydown",l)}}}function iE(t,e){const r=ok(e),n=e.value.split(`
`);let i=r,o=0;for(let s=0;s<n.length;s++){const a=n[s];s!==0&&(o+=n[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),r<=l)break}G_(e,i)}function io(t,e,r){return(e=cz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cz(t){var e=hz(t,"string");return typeof e=="symbol"?e:e+""}function hz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const dz="ht_editor_visible",cu="ht_editor_hidden",oE="textEditor",fz="text";class gz extends Dw{static get EDITOR_TYPE(){return fz}constructor(e){super(e),io(this,"eventManager",new $i(this)),io(this,"autoResize",uz(this.hot.rootDocument)),io(this,"TEXTAREA",void 0),io(this,"textareaStyle",void 0),io(this,"TEXTAREA_PARENT",void 0),io(this,"textareaParentStyle",void 0),io(this,"layerClass",void 0),this.eventManager=new $i(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),Ou(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,o,s){const a=this.state;if(super.prepare(e,r,n,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==lt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===lt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),G_(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ce(this.TEXTAREA,[["data-hot-input",""],Uo(-1)]),K(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),K(this.TEXTAREA_PARENT,"handsontableInputHolder"),me(this.TEXTAREA_PARENT,this.layerClass)&&Oe(this.TEXTAREA_PARENT,this.layerClass),K(this.TEXTAREA_PARENT,cu),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){XD()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Oe(this.TEXTAREA_PARENT,this.layerClass),K(this.TEXTAREA_PARENT,cu)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;Et(e.length-1,n=>{const i=e[n];if(me(i,"handsontableEditor"))return r=!0,!1}),me(this.TEXTAREA_PARENT,cu)&&Oe(this.TEXTAREA_PARENT,cu),r?(this.layerClass=dz,K(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),K(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==lt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){V_()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===lt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===lt.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>ue(this.hot.getSelected()),group:oE},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;iE(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;iE(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(oE)}}const mz="base",pz="htTextEllipsis";function IM(t,e,r,n,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&K(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(ZS())):a&&c.push(ZS()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(QS())):(u.push(s.invalidCellClassName),a&&c.push(QS()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(pz),Oe(e,u),K(e,l),yl(e,c),Ce(e,h)}IM.RENDERER_TYPE=mz;const wz="text";function HM(t,e,r,n,i,o,s){IM.apply(this,[t,e,r,n,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Ip(a),s.trimWhitespace&&(a=a.trim()),bl(e,a)}HM.RENDERER_TYPE=wz;const vz="text",yz={CELL_TYPE:vz,editor:gz,renderer:HM};GB(yz);vn.editors={BaseEditor:Dw};function vn(t,e){const r=new MM(t,e||{},tw);return r.init(),r}vn.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new MM(t,e,tw)};vn.DefaultSettings=vM();vn.hooks=pe.getSingleton();vn.CellCoords=Ho;vn.CellRange=Cl;vn.packageName="handsontable";vn.buildDate="20/11/2025 13:26:54";vn.version="16.2.0";vn.languages={dictionaryKeys:rB,getLanguageDictionary:hM,getLanguagesDictionaries:aB,registerLanguageDictionary:cM,getTranslatedPhrase:dM};function bz(t,e){AM(t,e),e.add(t)}function ls(t,e,r){return(e=Sz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sz(t){var e=Cz(t,"string");return typeof e=="symbol"?e:e+""}function Cz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sE(t,e,r){AM(t,e),e.set(t,r)}function AM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hu(t,e,r){return t.set(Lw(t,e),r),r}function Ye(t,e){return t.get(Lw(t,e))}function Lw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const aE=new Map([["plugin",uL],["cell-type",wM],["editor",r0],["renderer",l0],["validator",u0]]),Rz=Symbol("mainSetting"),Ez="base",du=[];let oo=null;var et=new WeakMap,so=new WeakMap,lE=new WeakSet;class Fw{static get PLUGIN_KEY(){return Ez}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(e){bz(this,lE),sE(this,et,null),ls(this,"eventManager",new $i(this)),ls(this,"pluginName",null),ls(this,"pluginsInitializedCallbacks",[]),ls(this,"isPluginsReady",!1),ls(this,"enabled",!1),ls(this,"initialized",!1),sE(this,so,{}),pi(this,"hot",e,{writable:!1}),oo=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(o=>{const[s,a]=o.split(":");if(!aE.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);aE.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");du.push(o)}}if(oo||(oo=a0()),oo.indexOf(this.pluginName)>=0&&oo.splice(oo.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),oo.length===0){if(du.length>0){const i=[`${du.join(`
`)}
`,"You have to import and register them manually."].join("");throw du.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){var r=this;const n=this.constructor.DEFAULT_SETTINGS,i=this.constructor.SETTINGS_VALIDATORS;if(e===void 0)return nt(Ye(et,this))?_u(Ye(et,this),n):Ye(et,this);let o;if((Array.isArray(Ye(et,this))||nt(Ye(et,this)))&&n[Rz]===e)if(Array.isArray(Ye(et,this)))o=Ye(et,this);else{var s;o=(s=Ye(et,this)[e])!==null&&s!==void 0?s:n[e]}else if(e.includes(".")){const a=hm(Ye(et,this),e),l=hm(n,e);nt(a)?o=_u(a,l):o=a!==void 0?a:l}else nt(Ye(et,this))?o=_u(Ye(et,this),n)[e]:o=n[e];if(typeof o=="function"&&i&&typeof i=="object"){const a=i[e];if(a&&typeof a=="function")return function(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];const h=o(...u);if(a(h)===!1){const g=u.map(v=>typeof v=="string"?`"${v}"`:"").join(", "),p=u.length>0?g:"";Cr(`${r.pluginName} Plugin: "${e}" function (${p}) result                is not valid and will be ignored.`);return}return h}}return o}updatePluginSettings(e){const r=this.constructor.SETTINGS_VALIDATORS;if(r&&typeof r=="function"&&typeof e!="object"){if(r(e)===!1){Cr(`${this.pluginName} Plugin: option is not valid and it will be ignored.`);return}return hu(et,this,e),Ye(et,this)}return r&&typeof r=="object"&&typeof e=="object"?((Ye(et,this)===null||typeof Ye(et,this)!="object")&&hu(et,this,{...this.constructor.DEFAULT_SETTINGS}),Object.keys(r).forEach(n=>{if(!(n in e))return;const i=r[n];if((i?i(e[n]):!0)===!1){Cr(`${this.pluginName} Plugin: "${n}" option is not valid and it will be ignored.`);return}Ye(et,this)[n]=e[n]}),Ye(et,this)):(hu(et,this,e),e)}addHook(e,r,n){Ye(so,this)[e]=Ye(so,this)[e]||[];const i=Ye(so,this)[e];this.hot.addHook(e,r,n),i.push(r),Ye(so,this)[e]=i}removeHooks(e){z(Ye(so,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=Ye(so,this);Me(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){z(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=Lw(lE,this,Tz).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&(this.updatePluginSettings(e[this.constructor.PLUGIN_KEY]),this.updatePlugin(e)))}updatePlugin(){}destroy(){var e;hu(et,this,null),(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Me(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function Tz(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function ao(t,e,r){return(e=_z(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _z(t){var e=Oz(t,"string");return typeof e=="symbol"?e:e+""}function Oz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mz{constructor(e){ao(this,"hot",null),ao(this,"container",null),ao(this,"injected",!1),ao(this,"rows",[]),ao(this,"columns",[]),ao(this,"samples",null),ao(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),z(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),z(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{z(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(o=>{z(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=r.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),n.appendChild(c)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{z(i.strings,o=>{const s=o.col,a=e.createElement("th");n.push([s,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),z(n,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{z(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=r.createElement("td"),c=r.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),n.appendChild(c)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return n.style.width=`${o}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),o=r.createElement("thead"),s=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),u=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),K(i,e),n.appendChild(i),{fragment:n,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return K(i,o),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}function Ea(t,e,r){return(e=Iz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Iz(t){var e=Hz(t,"string");return typeof e=="symbol"?e:e+""}function Hz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vw{static get SAMPLE_COUNT(){return 3}constructor(e){Ea(this,"samples",null),Ea(this,"dataFactory",null),Ea(this,"customSampleCount",null),Ea(this,"allowDuplicates",!1),Ea(this,"includeHidden",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Vw.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}setIncludeHidden(e){this.includeHidden=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:o,to:s}=typeof n=="number"?{from:n,to:n}:n;return Et(o,s,a=>{const l=this.generateSample(e,r,a);i.set(a,l)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return Et(r.from,r.to,a=>{const l=e==="row"?this.dataFactory(n,a,this):this.dataFactory(a,n,this);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let f;h?f=c:nt(u)?f=`${Object.keys(u).length}`:Array.isArray(u)?f=`${u.length}`:f=`${Ip(u).length}`,i.has(f)||i.set(f,{needed:this.getSampleCount(),strings:[]});const g=i.get(f);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}function Az(t,e){PM(t,e),e.add(t)}function Hg(t,e,r){PM(t,e),e.set(t,r)}function PM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ta(t,e,r){return(e=Pz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pz(t){var e=xz(t,"string");return typeof e=="symbol"?e:e+""}function xz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pi(t,e){return t.get(or(t,e))}function rc(t,e,r){return t.set(or(t,e),r),r}function or(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}pe.getSingleton().register("modifyAutoColumnSizeSeed");const Ag="autoColumnSize",Nz=10,Dz="autoColumnSize";var Ww=new WeakMap,vs=new WeakMap,Ws=new WeakMap,wr=new WeakSet;class Ka extends Fw{static get PLUGIN_KEY(){return Ag}static get PLUGIN_PRIORITY(){return Nz}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Az(this,wr),Ta(this,"ghostTable",new Mz(this.hot)),Ta(this,"samplesGenerator",new Vw((r,n)=>{const i=this.hot.toPhysicalRow(r),o=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(r,n);let a="";s.spanned||(a=this.hot.getDataAtCell(r,n));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),Ta(this,"inProgress",!1),Ta(this,"measuredColumns",0),Ta(this,"columnWidthsMap",new Nc),Hg(this,Ww,!1),Hg(this,vs,[]),Hg(this,Ws,[]),this.hot.columnIndexMapper.registerMap(Dz,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>or(wr,this,uE).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[Ag]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return or(wr,e,Fz).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return or(wr,e,Vz).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return or(wr,e,Bz).call(e,...i)}),this.addHook("beforeRender",()=>or(wr,this,Lz).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>or(wr,this,Wz).call(this)),super.enablePlugin()}updatePlugin(){rc(Ws,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>or(wr,this,uE).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof r=="number"?{from:r,to:r}:r;Et(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&or(wr,this,xM).call(this,s,o)}),this.ghostTable.columns.length&&(or(wr,this,NM).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){rC(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+Ka.CALCULATION_STEP,i)},e,r),n=n+Ka.CALCULATION_STEP+1,n<i?o=dm(s):(rC(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),n=a+1),n<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Ag];let r=Ka.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return nt(e)&&(r=e.syncLimit,TD(r)?r=Jk(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,Wp))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,o)=>{const s=Pi(vs,this).length;return(s-1<o||Pi(vs,this)[o]!==i)&&n.push(this.hot.toVisualColumn(o)),s-1<o?Pi(vs,this).push(i):Pi(vs,this)[o]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function kz(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||or(wr,this,xM).call(this,r,e))}),this.ghostTable.columns.length&&(or(wr,this,NM).call(this),this.ghostTable.clean())}function xM(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((n,i)=>this.ghostTable.addColumn(i,n))}function NM(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0)}function Lz(){this.calculateVisibleColumnsWidth(),this.inProgress||(or(wr,this,kz).call(this,Pi(Ws,this)),rc(Ws,this,[]))}function Fz(t,e){e||this.recalculateAllColumnsWidth()}function Vz(t){const e=t.reduce((r,n)=>{let[,i]=n;const o=this.hot.propToCol(i);return Number.isInteger(o)&&r.indexOf(o)===-1&&r.push(o),r},[]);Pi(Ws,this).push(...e)}function uE(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function Wz(){rc(vs,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),rc(Ww,this,!0)}function Bz(t){if(!Pi(Ww,this))return;const e=t.reduce((r,n)=>{var i;const o=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);r.indexOf(s)===-1&&r.push(s)}return r},[]);Pi(Ws,this).push(...e)}function $z(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function jz(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function lo(t,e){const r={};return z(t,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&(r[i]||(r[i]=[]),r[i][o]=e(i,o))})}),r}function uo(t,e,r,n,i){z(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&zz(s,a,e,r,n,i)})})}function zz(t,e,r,n,i,o){const s=i(t,e);let a=n;s.className&&(r==="vertical"?a=$z(s.className,n):a=jz(s.className,n)),o(t,e,"className",a)}function Uz(t){return`<span class="selected">â</span>${t}`}function Pg(t,e){let r=!1;return Array.isArray(t)&&z(t,n=>(n.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return r=!0,!1}),r)),r}function DM(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:o}=n.getBoundingClientRect();r.top=i,r.left=o}return r}const Tt="---------";function Yz(){return{name:Tt}}const sn="alignment";function qz(){return{key:sn,name(){return this.getTranslatedPhrase(yw)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeActive();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${sn}:left`,name(){return this.getTranslatedPhrase(bw)},callback(){const t=this.getSelectedRange(),e=lo(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),uo(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${sn}:center`,name(){return this.getTranslatedPhrase(Sw)},callback(){const t=this.getSelectedRange(),e=lo(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),uo(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${sn}:right`,name(){return this.getTranslatedPhrase(Cw)},callback(){const t=this.getSelectedRange(),e=lo(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),uo(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${sn}:justify`,name(){return this.getTranslatedPhrase(Rw)},callback(){const t=this.getSelectedRange(),e=lo(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),uo(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Tt},{key:`${sn}:top`,name(){return this.getTranslatedPhrase(Ew)},callback(){const t=this.getSelectedRange(),e=lo(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),uo(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${sn}:middle`,name(){return this.getTranslatedPhrase(Tw)},callback(){const t=this.getSelectedRange(),e=lo(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),uo(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${sn}:bottom`,name(){return this.getTranslatedPhrase(_w)},callback(){const t=this.getSelectedRange(),e=lo(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),uo(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Bw="clear_column";function Gz(){return{key:Bw,name(){return this.getTranslatedPhrase(fw)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((r,n)=>{if(r<0||n<0)return!0;const{readOnly:i}=this.getCellMeta(r,n);return i?!0:(e=!0,!1)}),!e}}}const Wc="col_left";function Kz(){return{key:Wc,name(){return this.getTranslatedPhrase(aw)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Bc="col_right";function Xz(){return{key:Bc,name(){return this.getTranslatedPhrase(lw)},callback(){const t=this.getSelectedRangeActive().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const $c="make_read_only";function Zz(){return{key:$c,checkable:!0,ariaChecked(){return Pg(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Xu)},name(){let t=this.getTranslatedPhrase(Xu);return Pg(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=Uz(t)),t},callback(){const t=this.getSelectedRange(),e=Pg(t,(r,n)=>this.getCellMeta(r,n).readOnly);z(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeActive();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const jc="redo";function Qz(){return{key:jc,name(){return this.getTranslatedPhrase(dw)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const zc="remove_col";function Jz(){return{key:zc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(cw,e)},callback(){this.alter("remove_col",DB(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Uc="remove_row";function eU(){return{key:Uc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(uw,e)},callback(){this.alter("remove_row",kB(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Yc="row_above";function tU(){return{key:Yc,name(){return this.getTranslatedPhrase(ow)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const qc="row_below";function rU(){return{key:qc,name(){return this.getTranslatedPhrase(sw)},callback(){const t=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const nl="no_items";function nU(){return{key:nl,name(){return this.getTranslatedPhrase(iw)},disabled:!0,isCommand:!1}}const Gc="undo";function iU(){return{key:Gc,name(){return this.getTranslatedPhrase(hw)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const oU=[Yc,qc,Wc,Bc,Bw,Uc,zc,Gc,jc,$c,sn,Tt,nl],sU={[Tt]:Yz,[nl]:nU,[Yc]:tU,[qc]:rU,[Wc]:Kz,[Bc]:Xz,[Bw]:Gz,[Uc]:eU,[zc]:Jz,[Gc]:iU,[jc]:Qz,[$c]:Zz,[sn]:qz};function kM(){const t={};return Me(sU,(e,r)=>{t[r]=e()}),t}function xg(t,e,r){return(e=aU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aU(t){var e=lU(t,"string");return typeof e=="symbol"?e:e+""}function lU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uU{constructor(e){xg(this,"hot",void 0),xg(this,"commands",{}),xg(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=cU(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||jr(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),n.unshift(o.join(":")),z(u,c=>c.apply(this.hot,n))}}function cU(t,e){let r;return z(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function Ng(t,e,r){return(e=hU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hU(t){var e=dU(t,"string");return typeof e=="symbol"?e:e+""}function dU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fU{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Ng(this,"hot",void 0),Ng(this,"predefinedItems",kM()),Ng(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,Me(e,(n,i)=>{let o="";n.name===Tt?(r[Tt]=n,o=Tt):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,o=n.key):(r[n.key]=n,o=n.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return gU(e,this.defaultOrderPattern,this.predefinedItems)}}function gU(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),nt(i)?Me(i,(o,s)=>{let a=r[typeof o=="string"?o:s];a||(a=o),nt(o)?Wi(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),n.push(a)}):z(i,(o,s)=>{let a=r[o];!a&&oU.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),nt(o)&&Wi(a,o),a.key===void 0&&(a.key=s),n.push(a))}),n}function Ci(t,e,r){return(e=mU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mU(t){var e=pU(t,"string");return typeof e=="symbol"?e:e+""}function pU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wU{constructor(e,r){Ci(this,"top",void 0),Ci(this,"topRelative",void 0),Ci(this,"left",void 0),Ci(this,"leftRelative",void 0),Ci(this,"scrollTop",void 0),Ci(this,"scrollLeft",void 0),Ci(this,"cellHeight",void 0),Ci(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let o,s,a,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=n,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-n,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function _a(t,e,r){vU(t,e),e.set(t,r)}function vU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ne(t,e){return t.get(LM(t,e))}function fu(t,e,r){return t.set(LM(t,e),r),r}function LM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Bt=new WeakMap,Jt=new WeakMap,er=new WeakMap,Dg=new WeakMap,us=new WeakMap;class yU{constructor(e){_a(this,Bt,void 0),_a(this,Jt,void 0),_a(this,er,void 0),_a(this,Dg,!1),_a(this,us,{above:0,below:0,left:0,right:0}),fu(Dg,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return ne(us,this)[e]=r,this}setElement(e){return fu(Bt,this,e),this}setParentElement(e){return fu(Jt,this,e),this}updatePosition(e){fu(er,this,new wU(e,ne(Bt,this).ownerDocument.defaultView)),ne(Dg,this)?(ne(er,this).fitsBelow(ne(Bt,this))?this.setPositionBelowCursor():ne(er,this).fitsAbove(ne(Bt,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){ne(Bt,this).dir==="rtl"?ne(er,this).fitsOnLeft(ne(Bt,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():ne(er,this).fitsOnRight(ne(Bt,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=ne(us,this).above+ne(er,this).top-ne(Bt,this).offsetHeight;if(ne(Jt,this)){const n=ne(Jt,this).ownerDocument.defaultView.getComputedStyle(ne(Jt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ne(er,this).top+ne(er,this).cellHeight-ne(Bt,this).scrollHeight+i+o}ne(Bt,this).style.top=`${e}px`}setPositionBelowCursor(){let e=ne(us,this).below+ne(er,this).top+1;if(ne(Jt,this)){const n=ne(Jt,this).ownerDocument.defaultView.getComputedStyle(ne(Jt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ne(er,this).top-i-o}ne(Bt,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=ne(er,this).left;if(ne(Jt,this)){const r=ne(Jt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ne(Jt,this).querySelector(".htCore")).borderRightWidth,10);e+=ne(er,this).cellWidth+n}else e+=ne(us,this).right;ne(Bt,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=ne(us,this).left+ne(er,this).left-ne(Bt,this).offsetWidth;if(ne(Jt,this)){const r=ne(Jt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ne(Jt,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}ne(Bt,this).style.left=`${e}px`}}function bU(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Ae(e,-1,v()-1);function a(T,R){const _=v()-1;return T<0&&(T=_),T>_&&(T=0),o.has(T)?-1:(o.add(T),n(T,!1)===!1&&(T=a(R===1?++T:--T,R)),T)}function l(T){T>-1&&T<v()&&n(T,!0)!==!1&&(s=T)}function u(T){T>-1&&T<v()&&(s=T)}function c(){return s}function h(){v()>0&&(o.clear(),s=a(0,1))}function f(){v()>0&&(o.clear(),s=a(v()-1,-1))}function g(){v()>0&&(o.clear(),s=a(++s,1))}function p(){v()>0&&(o.clear(),s=a(--s,-1))}function v(){return Math.max(r(),0)}function y(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:f,toNextItem:g,toPreviousItem:p,getSize:v,clear:y}}function SU(t){return Vi(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Mm(t){return jr(t,"submenu")}function Im(t){return new RegExp(Tt,"i").test(t.name)}function xu(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function cE(t){return jr(t,"disableSelection")}function CU(t){return me(t,"htSeparator")}function RU(t){return me(t,"htSubmenu")}function EU(t){return me(t,"htDisabled")}function TU(t){return me(t,"htSelectionDisabled")}function _U(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function FM(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function OU(t,e){let r=t.slice(0);return r.reverse(),r=FM(r,e),r.reverse(),r}function MU(t){const e=[];return z(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function IU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Tt,r=t.slice(0);return r=FM(r,e),r=OU(r,e),r=MU(r),r}function HU(t){return t.checkable===!0}function AU(t){return bU({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||CU(n)||EU(n)||TU(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function PU(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(n):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const n=r.getSelectedActive();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{r.getSelectedActive()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedActive();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedActive()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedActive()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const VM="menu",hE=VM;function xU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(PU(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function n(u,c){a(c).addShortcuts(u,{group:VM})}function i(u,c){const h=a(c);u.forEach(f=>{let{keys:g}=f;g.forEach(p=>h.removeShortcutsByKeys(p))}),r.push({shortcuts:u,contextName:c}),n(u,c)}function o(){return[...r]}function s(u){return u?`${hE}:${u}`:hE}function a(u){var c;const h=t.hotMenu.getShortcutManager(),f=s(u);return(c=h.getContext(f))!==null&&c!==void 0?c:h.addContext(f)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function NU(t){return(e,r,n,i,o,s)=>{const a=e.getSourceDataAtRow(n),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Ls(r),K(l,"htItemWrapper"),t.getSettings().ariaTags){const f=!xu(a,t)&&!cE(a)&&!Im(a);Ce(r,[...HU(a)?[xD(),ju(c),VD(h)]:[PD(),ju(u)],...f?[Uo(-1)]:[],...xu(a,t)?[LD()]:[],...Mm(a)?[Tu(!1)]:[]])}r.className="",r.appendChild(l),Im(a)?K(r,"htSeparator"):typeof a.renderer=="function"?(K(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,n,i,o,u))):z_(l,u),xu(a,t)?K(r,"htDisabled"):cE(a)?K(r,"htSelectionDisabled"):Mm(a)&&K(r,"htSubmenu")}}function kg(t,e,r){DU(t,e),e.set(t,r)}function DU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function On(t,e,r){return(e=kU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kU(t){var e=LU(t,"string");return typeof e=="symbol"?e:e+""}function LU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lg(t,e,r){return t.set(WM(t,e),r),r}function Ri(t,e){return t.get(WM(t,e))}function WM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const dE=215;var cs=new WeakMap,gu=new WeakMap,mu=new WeakMap;class Kc{get tableBorderWidth(){return Ri(mu,this)===void 0&&this.hotMenu&&Lg(mu,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Ri(mu,this)}constructor(e,r){var n=this;On(this,"hot",void 0),On(this,"options",void 0),On(this,"eventManager",new $i(this)),On(this,"container",void 0),On(this,"positioner",void 0),On(this,"hotMenu",null),On(this,"hotSubMenus",{}),On(this,"parentMenu",void 0),On(this,"menuItems",null),On(this,"origOutsideClickDeselects",null),kg(this,cs,void 0),kg(this,gu,void 0),kg(this,mu,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:dE,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new yU(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(Oe(this.options.container,/ht-theme-.*/g),K(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=Io(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Ri(cs,this)}getKeyboardShortcutsCtrl(){return Ri(gu,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Q_(a=>this.openSubMenu(a),300),r=this.options.minWidth||dE;let n=!1,i=Mp(this.menuItems,a=>(a.key===nl&&(n=!0),_U(a,this.hot)));if(i.length<1&&!n)i.push(kM()[nl]);else if(i.length===0)return;i=IU(i,Tt);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ue(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:NU(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?Ri(cs,this).setCurrentPage(l.row):Ri(cs,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),nC()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!nC()||!Yu(a))&&o&&this.hasSelectedItem()&&(Ai()||xp()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Lg(cs,this,AU(this.hotMenu)),Lg(gu,this,xU(this)),Ri(gu,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Ri(cs,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedActive();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);Ce(n,[Tu(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!RU(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new Kc(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&Ce(r,[Tu(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ce(i,[Tu(!1)])}}closeAllSubMenus(){z(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?SU(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||Im(e)||xu(e,this.hot)||Mm(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,o=parseInt(n.width,10),s=zo(r,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?ur(this.hotMenu.getCell(u,0)):0;return a+(l.name===Tt?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),n.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(Se(n)&&(n=n.call(this.hot),n===null||zt(n)?n="":n=n.toString()),n=n.replace(/[^A-Za-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),K(i,`htMenu handsontable ${this.options.className}`),n&&K(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Ce(this.hotMenu.rootElement,[AD(),Uo(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Ms(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Ms(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&me(e.target,"htCore")&&Ms(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Ke(Kc,Wn);function FU(t,e){VU(t,e),e.add(t)}function VU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fg(t,e,r){return(e=WU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WU(t){var e=BU(t,"string");return typeof e=="symbol"?e:e+""}function BU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const La="contextMenu",$U=70,fE=La;pe.getSingleton().register("afterContextMenuDefaultOptions");pe.getSingleton().register("beforeContextMenuShow");pe.getSingleton().register("afterContextMenuShow");pe.getSingleton().register("afterContextMenuHide");pe.getSingleton().register("afterContextMenuExecute");var Oa=new WeakSet;class Xc extends Fw{constructor(){super(...arguments),FU(this,Oa),Fg(this,"commandExecutor",new uU(this.hot)),Fg(this,"itemsFactory",null),Fg(this,"menu",null)}static get PLUGIN_KEY(){return La}static get PLUGIN_PRIORITY(){return $U}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Yc,qc,Tt,Wc,Bc,Tt,Uc,zc,Tt,Gc,jc,Tt,$c,Tt,sn]}isEnabled(){return!!this.hot.getSettings()[La]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[La];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new Kc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>pu(Oa,this,zU).call(this)),this.menu.addLocalHook("afterOpen",()=>pu(Oa,this,UU).call(this)),this.menu.addLocalHook("afterClose",()=>pu(Oa,this,YU).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>pu(Oa,this,jU).call(this,n)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=DM(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:fE})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(fE)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.prepareMenuItems(),this.menu.open(),Me(n,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new fU(this.hot,Xc.DEFAULT_ITEMS);const e=this.hot.getSettings()[La],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),z(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function jU(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),me(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(o)&&!(me(o,"current")&&me(o,"wtBorder"))))return;const s=DM(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function zU(){this.hot.runHooks("beforeContextMenuShow",this)}function UU(){this.hot.runHooks("afterContextMenuShow",this)}function YU(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Xc.SEPARATOR={name:Tt};function qU(t){return{key:"copy",name(){return this.getTranslatedPhrase(gw)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function GU(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeActive(),r=e?Ae(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(ww,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function KU(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeActive(),r=e?Ae(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(pw,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function XU(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeActive(),r=e?Ae(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(mw,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function ZU(t){return{key:"cut",name(){return this.getTranslatedPhrase(vw)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class QU{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class JU{constructor(){this.clipboardData=new QU}preventDefault(){}composedPath(){return[]}}function eY(t,e){BM(t,e),e.add(t)}function hs(t,e,r){BM(t,e),e.set(t,r)}function BM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $t(t,e){return t.get(Rs(t,e))}function ds(t,e,r){return t.set(Rs(t,e),r),r}function Rs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ei=new WeakMap,Vg=new WeakMap,Ma=new WeakMap,Hm=new WeakMap,Am=new WeakMap,Ia=new WeakMap,Ha=new WeakSet;class tY{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;eY(this,Ha),hs(this,Ei,void 0),hs(this,Vg,void 0),hs(this,Ma,void 0),hs(this,Hm,void 0),hs(this,Am,void 0),hs(this,Ia,void 0),ds(Vg,this,r),ds(Ma,this,n),ds(Hm,this,i),ds(Am,this,o),ds(Ia,this,s)}setSelectedRange(e){ds(Ei,this,e)}getCellsRange(){if($t(Vg,this).call(this)===0||$t(Ma,this).call(this)===0)return null;const{row:e,col:r}=$t(Ei,this).getTopStartCorner(),{row:n,col:i}=$t(Ei,this).getBottomEndCorner(),o=Rs(Ha,this,rY).call(this,e,n),s=Rs(Ha,this,Wg).call(this,r,i);return{isRangeTrimmed:n!==o||i!==s,startRow:e,startCol:r,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if($t(Ma,this).call(this)===0||$t(Ia,this).call(this)===0)return null;const{col:e}=$t(Ei,this).getTopStartCorner(),{col:r}=$t(Ei,this).getBottomEndCorner(),n=Rs(Ha,this,Wg).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if($t(Ma,this).call(this)===0||$t(Ia,this).call(this)===0)return null;const{col:e}=$t(Ei,this).getTopStartCorner(),{col:r}=$t(Ei,this).getBottomEndCorner(),n=Rs(Ha,this,Wg).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-$t(Ia,this).call(this),startCol:e,endRow:-1,endCol:n}}}function Wg(t,e){return Math.min(e,Math.max(t+$t(Am,this).call(this)-1,t))}function rY(t,e){return Math.min(e,Math.max(t+$t(Hm,this).call(this)-1,t))}function $M(t){const e=[],r=[];return z(t,n=>{const i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);Et(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);Et(s,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function nY(t,e){jM(t,e),e.add(t)}function Ti(t,e,r){jM(t,e),e.set(t,r)}function jM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Aa(t,e,r){return(e=iY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iY(t){var e=oY(t,"string");return typeof e=="symbol"?e:e+""}function oY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ir(t,e){return t.get(Nt(t,e))}function nn(t,e,r){return t.set(Nt(t,e),r),r}function Nt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}pe.getSingleton().register("afterCopyLimit");pe.getSingleton().register("modifyCopyableRange");pe.getSingleton().register("beforeCut");pe.getSingleton().register("afterCut");pe.getSingleton().register("beforePaste");pe.getSingleton().register("afterPaste");pe.getSingleton().register("beforeCopy");pe.getSingleton().register("afterCopy");const Bg="copyPaste",sY=80,aY=["fragmentSelection"],zM="application/ht-source-data-json-html",gE=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Pm=new WeakMap,xm=new WeakMap,Nm=new WeakMap,fs=new WeakMap,wu=new WeakMap,vu=new WeakMap,gs=new WeakMap,nc=new WeakMap,jt=new WeakSet;class lY extends Fw{constructor(){super(...arguments),nY(this,jt),Aa(this,"columnsLimit",1/0),Aa(this,"rowsLimit",1/0),Aa(this,"pasteMode","overwrite"),Aa(this,"uiContainer",this.hot.rootDocument.body),Ti(this,Pm,!1),Ti(this,xm,!1),Ti(this,Nm,!1),Ti(this,fs,"cells-only"),Ti(this,wu,!1),Ti(this,vu,!1),Ti(this,gs,new tY({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ti(this,nc,!1),Aa(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Bg}static get SETTING_KEYS(){return[Bg,...aY]}static get PLUGIN_PRIORITY(){return sY}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Bg]}enablePlugin(){var e,r,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),nn(Pm,this,this.getSetting("copyColumnHeaders")),nn(xm,this,this.getSetting("copyColumnGroupHeaders")),nn(Nm,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Nt(jt,this,hY).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Nt(jt,n,dY).call(n,...o)}),this.addHook("afterSelectionEnd",()=>Nt(jt,this,fY).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),Pp()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Nt(jt,n,gY).call(n,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Nt(jt,n,mY).call(n,...o)}),this.addHook("afterSelection",()=>Nt(jt,this,pY).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";nn(fs,this,e),nn(wu,this,!0),Nt(jt,this,mE).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){nn(vu,this,!0),Nt(jt,this,mE).call(this,"cut")}getRangedCopyableData(e){return Zu(this.getRangedData(e))}getRangedData(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=[],{rows:i,columns:o}=$M(e);return z(i,s=>{const a=[];z(o,l=>{if(s<0)a.push(this.hot.getColHeader(l,s));else{let u=r?this.hot.getCopyableSourceData(s,l):this.hot.getCopyableData(s,l);r&&nt(u)&&(u=JSON.stringify(u)),a.push(u)}}),n.push(a)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new JU;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeActive();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}ir(gs,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);ir(fs,this)==="column-headers-only"?r.set("headers",ir(gs,this).getMostBottomColumnHeadersRange()):(ir(fs,this)==="with-column-headers"?r.set("headers",ir(gs,this).getMostBottomColumnHeadersRange()):ir(fs,this)==="with-column-group-headers"&&r.set("headers",ir(gs,this).getAllColumnHeadersRange()),r.set("cells",ir(gs,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=n;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getSelectedRangeActive();if(!e.length)return[null,null,null,null];const i=e.length,o=e[0].length,s=[],{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner();let h=a,f=l,g=a,p=l;for(;s.length<i||h<=u;){const{skipRowOnPaste:y,visualRow:T}=this.hot.getCellMeta(h,l);if(h=T+1,y===!0)continue;g=T,f=l;const R=[],_=s.length%i;for(;R.length<o||f<=c;){var v;const{skipColumnOnPaste:b,visualCol:M}=this.hot.getCellMeta(T,f),P=this.hot.getSourceDataAtCell(T,f),A=R.length%o;if(f=M+1,b===!0)continue;p=M;const D=r==null||(v=r[_])===null||v===void 0?void 0:v[A];let V=e[_][A];if(r&&ED(D)){const B=JSON.parse(D);(nt(P)||P===null)&&(V=B)}R.push(V)}s.push(R)}return nn(nc,this,!0),this.hot.populateFromArray(a,l,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,g,p]}onCopy(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ir(wu,this)||this.isEditorOpened()||To(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Ou(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),nn(wu,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0),a=Nt(jt,this,uY).call(this,this.copyableRanges);this.hot.runHooks("beforeCopy",o,this.copyableRanges,a)&&(Nt(jt,this,pE).call(this,e,o,s),this.hot.runHooks("afterCopy",o,this.copyableRanges,a)),nn(fs,this,"cells-only")}onCut(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ir(vu,this)||this.isEditorOpened()||To(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Ou(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),nn(vu,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0);this.hot.runHooks("beforeCut",o,this.copyableRanges)&&(Nt(jt,this,pE).call(this,e,o,s),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges))}onPaste(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||To(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Ou(r,this.hot.rootElement)))return;e.preventDefault();let o,s;if(e&&typeof e.clipboardData<"u"){const h=e.clipboardData.getData(zM);h&&(s=AC(h,this.hot.rootDocument).data);const f=A_(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});f&&/(<table)|(<TABLE)/g.test(f)?o=AC(f,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=BB(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[a,l,u,c]=this.populateValues(o,s);a!==null&&l!==null&&this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function mE(t){if(Pp()){const e=this.hot.getSelectedRangeActive();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&ck(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function uY(t){const{rows:e}=$M(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function cY(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&X_(n)}}}function UM(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&Z_(n)}}}function pE(t,e,r){const n=Zu(e);if(t&&t.clipboardData){const i=HC(e),o=HC(r);t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",[gE,i].join("")),t.clipboardData.setData(zM,[gE,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",n)}function hY(t){t.items.push({name:"---------"},qU(this)),ir(Pm,this)&&t.items.push(XU(this)),ir(xm,this)&&t.items.push(KU(this)),ir(Nm,this)&&t.items.push(GU(this)),t.items.push(ZU(this))}function dY(t,e,r,n,i){ir(nc,this)&&(i.value=!0),nn(nc,this,!1)}function fY(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function gY(){Nt(jt,this,UM).call(this)}function mY(){Nt(jt,this,cY).call(this)}function pY(){Nt(jt,this,UM).call(this)}var wY=hc('<div class="row align-items-center pb-1"><div class="col-4"><div class="form-check"><input class="form-check-input svelte-10olx4a" type="checkbox"/> <label class="form-check-label"> </label></div></div> <div class="col"><label class="visually-hidden"> </label> <input type="text" class="form-control form-control-sm svelte-10olx4a"/></div></div>'),vY=hc('<div class="form-check"><input class="form-check-input svelte-10olx4a" type="checkbox"/> <label class="form-check-label"> </label></div>');function co(t,e){Fm(e,!0);let r=nh(e,"placeholder",3,""),n=nh(e,"checked",15),i=nh(e,"optional",15,null);var o=yH(),s=Xg(o);{var a=u=>{var c=wY(),h=vr(c),f=vr(h),g=vr(f),p=pt(g,2),v=vr(p),y=pt(h,2),T=vr(y),R=vr(T),_=pt(T,2);Zg(()=>{Gi(g,"id",e.id),g.disabled=i()==="",Gi(p,"for",e.id),eh(v,e.id),Gi(T,"for",e.id+r()),eh(R,r()),Gi(_,"id",e.id+r()),Gi(_,"placeholder",r())}),cv(g,n),ms("input",_,()=>{i()===""?n(!1):n()||n(!0)}),IH(_,i),Ba(u,c)},l=u=>{var c=vY(),h=vr(c),f=pt(h,2),g=vr(f);Zg(()=>{Gi(h,"id",e.id),Gi(f,"for",e.id),eh(g,e.id)}),cv(h,n),Ba(u,c)};EH(s,u=>{i()!==null?u(a):u(l,!1)})}Ba(t,o),Vm()}eT(["input"]);class YM{tasks;constructor(...e){this.tasks=e}append(...e){this.tasks.push(...e)}process(e){let r=e,n=!0;for(;;){for(const i of this.tasks)(n||!i.once())&&(e=i.process(e));if(e===r)return r;r=e,n&&(n=!1)}}processAll(e){const r=[];for(const n of e){const i=this.process(n);r.push(i)}return r}}class Dm{re;constructor(e){e.global||(e=new RegExp(e,"g")),this.re=e}once(){return!1}process(e){return e.replaceAll(this.re,"")}}class yY{re;constructor(e){this.re=e}once(){return!1}process(e){const r=e.match(this.re);return r?r[0]:""}}class bY{sep;constructor(e){this.sep=e}once(){return!0}process(e){const r=e.indexOf(this.sep);return r===-1?e:e.substring(0,r)}}class SY{cutset;constructor(e){this.cutset=e}once(){return!1}process(e){return e.replaceAll(new RegExp(`^[${this.cutset}]+|[${this.cutset}]+$`,"g"),"")}}class ic{isOnce;fn;constructor(e,r){this.isOnce=e,this.fn=r}once(){return this.isOnce}process(e){return this.fn(e)}}const CY=new ic(!1,t=>t.trim()),RY=new ic(!0,t=>{const e=t.match(/\S+/g);return e?e[0]:""}),EY=new YM(new Dm(/\([^)]*\)/),new Dm(/ï¼[^ï¼]*ï¼/));var TY=wH(hc(`<script src="https://cdn.jsdelivr.net/npm/opencc-js@1/dist/umd/full.min.js">
  <\/script><!>`,1)),_Y=hc('<header class="navbar navbar-expand navbar-light flex-column flex-md-row svelte-1n46o8q"><a class="navbar-brand text-primary m-0 mr-md-3" href="/" style="font-size:24px">Simple Text Processing</a></header> <div class="container-fluid svelte-1n46o8q"><div class="row h-100"><div id="input" class="col-5"></div> <div class="col-2 p-0 pt-5"><!> <!> <!> <br/> <div class="form-check"><input class="form-check-input" type="checkbox" id="t2s"/> <label class="form-check-label" for="t2s">ç¹ â ç®</label></div> <div class="form-check"><input class="form-check-input" type="checkbox" id="s2t"/> <label class="form-check-label" for="s2t">ç® â ç¹</label></div> <br/> <!> <!> <!> <!> <br/> <button type="button" class="btn btn-primary w-100">Process</button> <br/> <br/> <button type="button" class="btn btn-primary w-100">Copy Result</button> <br/> <br/> <button type="button" class="btn btn-danger w-100">Clear</button></div> <div id="result" class="col-5"></div></div></div>',1);function OY(t,e){Fm(e,!0),ng(Ka),ng(Xc),ng(lY);const r=64;let n=Ge(!1),i=Ge(!1),o=Ge(!1),s=Ge(!1),a=Ge(""),l=Ge(!1),u=Ge(""),c=Ge(!1),h=Ge(""),f=Ge(!1),g=Ge(""),p=Ge(!0),v=Ge(!1),y=Ge(!1),T,R,_,b;const M=()=>{_=new ic(!0,OpenCC.Converter({from:"cn",to:"t"})),b=new ic(!0,OpenCC.Converter({from:"t",to:"cn"})),le(p,!1)},P=(S,O,H,x)=>{const j={autoColumnSize:!1,colHeaders:[O],colWidths(){return Math.round(window.innerWidth*.4166666667-r-24)},height(){return window.innerHeight-80-16},maxCols:1,rowHeaders:!0,rowHeaderWidth:r,startRows:1,tabMoves:{row:1,col:0},themeName:"ht-theme-main",licenseKey:"non-commercial-and-evaluation"};if(x)j.readOnly=!0,j.readOnlyCellClassName="",j.contextMenu=["copy"];else{try{j.data=JSON.parse(localStorage.getItem(H)||"")}catch{j.data=void 0}j.minSpareRows=1,j.contextMenu=["row_above","row_below","---------","remove_row","---------","undo","redo","---------","copy","cut"]}const F=new vn(document.getElementById(S),j);return x||(F.addHook("beforePaste",()=>F.updateSettings({readOnly:!0})),F.addHook("afterPaste",I=>{F.updateSettings({readOnly:!1}),F.deselectCell();for(let Q=I.length-1;Q>=0;Q--)if(I[Q][0]!==""){F.loadData(I.slice(0,Q+1));return}F.loadData([[""]])})),F};AH(()=>{T=P("input","Data","data"),R=P("result","Result","",!0)});const A=S=>S.getDataAtCol(0).filter(O=>O!==null),D=()=>{const S=new YM;if(ie(n)&&S.append(CY),ie(i)&&S.append(RY),ie(o)&&S.append(...EY.tasks),ie(s)&&S.append(new SY(ie(a))),ie(l)&&S.append(new bY(ie(u))),ie(c)&&S.append(new Dm(new RegExp(ie(h)))),ie(f)&&S.append(new yY(new RegExp(ie(g)))),ie(v)?S.append(_):ie(y)&&S.append(b),!S.tasks.length){alert("No option selected.");return}le(p,!0);const O=S.processAll(A(T));R.loadData(O.map(H=>[H])),le(p,!1)},V=()=>{confirm("Clear all data and options?")&&(T.loadData([[""]]),R.loadData([[""]]),le(n,!1),le(i,!1),le(o,!1),le(s,!1),le(a,""),le(l,!1),le(u,""),le(c,!1),le(h,""),le(f,!1),le(g,""),le(v,!1),le(y,!1),localStorage.clear())},B=async()=>{const S=A(R).join(`
`);S.trim()!==""&&(navigator.clipboard?(await navigator.clipboard.writeText(S.trimEnd()),alert("Text has been copied to clipboard.")):alert("This function requires a secure origin. (HTTPS or localhost)"))};var q=_Y();sv("beforeunload",Kg,()=>localStorage.setItem("data",JSON.stringify(T.getData()))),TH("1n46o8q",S=>{var O=TY(),H=Xg(O);pt(H),sv("load",H,M),Ba(S,O)});var L=pt(Xg(q),2),ae=vr(L),G=pt(vr(ae),2),ee=vr(G);co(ee,{id:"TrimSpace",get checked(){return ie(n)},set checked(S){le(n,S,!0)}});var st=pt(ee,2);co(st,{id:"CutSpace",get checked(){return ie(i)},set checked(S){le(i,S,!0)}});var Re=pt(st,2);co(Re,{id:"RemoveParentheses",get checked(){return ie(o)},set checked(S){le(o,S,!0)}});var Ee=pt(Re,4),$e=vr(Ee),Fe=pt(Ee,2),Ie=vr(Fe),Kr=pt(Fe,4);co(Kr,{id:"Trim",placeholder:"Cutset",get checked(){return ie(s)},set checked(S){le(s,S,!0)},get optional(){return ie(a)},set optional(S){le(a,S,!0)}});var Te=pt(Kr,2);co(Te,{id:"Cut",placeholder:"Sep",get checked(){return ie(l)},set checked(S){le(l,S,!0)},get optional(){return ie(u)},set optional(S){le(u,S,!0)}});var Gt=pt(Te,2);co(Gt,{id:"Remove",placeholder:"RegExp",get checked(){return ie(c)},set checked(S){le(c,S,!0)},get optional(){return ie(h)},set optional(S){le(h,S,!0)}});var d=pt(Gt,2);co(d,{id:"Extract",placeholder:"RegExp",get checked(){return ie(f)},set checked(S){le(f,S,!0)},get optional(){return ie(g)},set optional(S){le(g,S,!0)}});var m=pt(d,4),w=pt(m,6),C=pt(w,6);Zg(()=>{lv($e,ie(y)),lv(Ie,ie(v)),m.disabled=ie(p),w.disabled=ie(p),C.disabled=ie(p)}),ms("click",$e,()=>{le(y,!ie(y)),ie(y)&&le(v,!1)}),ms("click",Ie,()=>{le(v,!ie(v)),ie(v)&&le(y,!1)}),ms("click",m,D),ms("click",w,B),ms("click",C,V),Ba(t,q),Vm()}eT(["click"]);bH(OY,{target:document.body})});export default MY();
