var PW=Object.defineProperty;var OW=(t,e,n)=>e in t?PW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var xW=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Vo=(t,e,n)=>OW(t,typeof e!="symbol"?e+"":e,n);var Pde=xW((zde,Fm)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const ZM=!1;var nD=Array.isArray,AW=Array.prototype.indexOf,HW=Array.from,NW=Object.defineProperty,ic=Object.getOwnPropertyDescriptor,DW=Object.getOwnPropertyDescriptors,kW=Object.prototype,LW=Array.prototype,rD=Object.getPrototypeOf,QM=Object.isExtensible;function FW(t){for(var e=0;e<t.length;e++)t[e]()}const ui=2,iD=4,Vp=8,SE=16,Ts=32,Sc=64,RE=128,Wr=256,$m=512,ci=1024,bs=2048,Bl=4096,gc=8192,EE=16384,oD=32768,_E=65536,JM=1<<18,sD=1<<19,aD=1<<20,oR=1<<21,fm=Symbol("$state"),$W=Symbol("legacy props"),VW=Symbol(""),lD=new class extends Error{constructor(){super(...arguments);Vo(this,"name","StaleReactionError");Vo(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}},WW=11;function uD(t){return t===this.v}function BW(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function jW(t){return!BW(t,this.v)}function UW(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function zW(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function YW(t){throw new Error("https://svelte.dev/e/effect_orphan")}function GW(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function qW(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function KW(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function XW(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function ZW(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let QW=!1;const JW=1,eB=4,tB=8,nB=16,rB=1,iB=2,hr=Symbol(),oB="http://www.w3.org/1999/xhtml";function sB(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let Br=null;function eI(t){Br=t}function TE(t,e=!1,n){var r=Br={p:Br,c:null,d:!1,e:null,m:!1,s:t,x:null,l:null};vD(()=>{r.d=!0})}function ME(t){const e=Br;if(e!==null){const s=e.e;if(s!==null){var n=St,r=tt;e.e=null;try{for(var i=0;i<s.length;i++){var o=s[i];va(o.effect),Mo(o.reaction),CD(o.fn)}}finally{va(n),Mo(r)}}Br=e.p,e.m=!0}return{}}function cD(){return!0}function Zu(t){if(typeof t!="object"||t===null||fm in t)return t;const e=rD(t);if(e!==kW&&e!==LW)return t;var n=new Map,r=nD(t),i=cn(0),o=tt,s=a=>{var l=tt;Mo(o);var u=a();return Mo(l),u};return r&&n.set("length",cn(t.length)),new Proxy(t,{defineProperty(a,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&KW();var c=n.get(l);return c===void 0?c=s(()=>{var h=cn(u.value);return n.set(l,h),h}):Ue(c,u.value,!0),!0},deleteProperty(a,l){var u=n.get(l);if(u===void 0){if(l in a){const d=s(()=>cn(hr));n.set(l,d),Xw(i)}}else{if(r&&typeof l=="string"){var c=n.get("length"),h=Number(l);Number.isInteger(h)&&h<c.v&&Ue(c,h)}Ue(u,hr),Xw(i)}return!0},get(a,l,u){var f;if(l===fm)return t;var c=n.get(l),h=l in a;if(c===void 0&&(!h||(f=ic(a,l))!=null&&f.writable)&&(c=s(()=>{var g=Zu(h?a[l]:hr),v=cn(g);return v}),n.set(l,c)),c!==void 0){var d=Ve(c);return d===hr?void 0:d}return Reflect.get(a,l,u)},getOwnPropertyDescriptor(a,l){var u=Reflect.getOwnPropertyDescriptor(a,l);if(u&&"value"in u){var c=n.get(l);c&&(u.value=Ve(c))}else if(u===void 0){var h=n.get(l),d=h==null?void 0:h.v;if(h!==void 0&&d!==hr)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return u},has(a,l){var d;if(l===fm)return!0;var u=n.get(l),c=u!==void 0&&u.v!==hr||Reflect.has(a,l);if(u!==void 0||St!==null&&(!c||(d=ic(a,l))!=null&&d.writable)){u===void 0&&(u=s(()=>{var f=c?Zu(a[l]):hr,g=cn(f);return g}),n.set(l,u));var h=Ve(u);if(h===hr)return!1}return c},set(a,l,u,c){var T;var h=n.get(l),d=l in a;if(r&&l==="length")for(var f=u;f<h.v;f+=1){var g=n.get(f+"");g!==void 0?Ue(g,hr):f in a&&(g=s(()=>cn(hr)),n.set(f+"",g))}if(h===void 0)(!d||(T=ic(a,l))!=null&&T.writable)&&(h=s(()=>cn(void 0)),Ue(h,Zu(u)),n.set(l,h));else{d=h.v!==hr;var v=s(()=>Zu(u));Ue(h,v)}var y=Reflect.getOwnPropertyDescriptor(a,l);if(y!=null&&y.set&&y.set.call(c,u),!d){if(r&&typeof l=="string"){var E=n.get("length"),C=Number(l);Number.isInteger(C)&&C>=E.v&&Ue(E,C+1)}Xw(i)}return!0},ownKeys(a){Ve(i);var l=Reflect.ownKeys(a).filter(h=>{var d=n.get(h);return d===void 0||d.v!==hr});for(var[u,c]of n)c.v!==hr&&!(u in a)&&l.push(u);return l},setPrototypeOf(){XW()}})}function Xw(t,e=1){Ue(t,t.v+e)}function IE(t){var e=ui|bs,n=tt!==null&&(tt.f&ui)!==0?tt:null;return St===null||n!==null&&(n.f&Wr)!==0?e|=Wr:St.f|=aD,{ctx:Br,deps:null,effects:null,equals:uD,f:e,fn:t,reactions:null,rv:0,v:null,wv:0,parent:n??St,ac:null}}function aB(t){const e=IE(t);return e.equals=jW,e}function hD(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)Hl(e[n])}}function lB(t){for(var e=t.parent;e!==null;){if((e.f&ui)===0)return e;e=e.parent}return null}function dD(t){var e,n=St;va(lB(t));try{hD(t),e=OD(t)}finally{va(n)}return e}function fD(t){var e=dD(t);if(t.equals(e)||(t.v=e,t.wv=ID()),!Ec){var n=(oa||(t.f&Wr)!==0)&&t.deps!==null?Bl:ci;Io(t,n)}}const Id=new Map;function uB(t,e){var n={f:0,v:t,reactions:null,equals:uD,rv:0,wv:0};return n}function cn(t,e){const n=uB(t);return SB(n),n}function Ue(t,e,n=!1){tt!==null&&(!Co||(tt.f&JM)!==0)&&cD()&&(tt.f&(ui|SE|JM))!==0&&!(Tn!=null&&Tn[1].includes(t)&&Tn[0]===tt)&&ZW();let r=n?Zu(e):e;return cB(t,r)}function cB(t,e){if(!t.equals(e)){var n=t.v;Ec?Id.set(t,e):Id.set(t,n),t.v=e,(t.f&ui)!==0&&((t.f&bs)!==0&&dD(t),Io(t,(t.f&Wr)===0?ci:Bl)),t.wv=ID(),gD(t,bs),St!==null&&(St.f&ci)!==0&&(St.f&(Ts|Sc))===0&&(Qr===null?RB([t]):Qr.push(t))}return e}function gD(t,e){var n=t.reactions;if(n!==null)for(var r=n.length,i=0;i<r;i++){var o=n[i],s=o.f;(s&bs)===0&&(Io(o,e),(s&(ci|Wr))!==0&&((s&ui)!==0?gD(o,Bl):HE(o)))}}var sR,mD,pD,wD;function hB(){if(sR===void 0){sR=window,mD=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,n=Text.prototype;pD=ic(e,"firstChild").get,wD=ic(e,"nextSibling").get,QM(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),QM(n)&&(n.__t=void 0)}}function PE(t=""){return document.createTextNode(t)}function Vm(t){return pD.call(t)}function OE(t){return wD.call(t)}function $r(t,e){return Vm(t)}function aR(t,e){{var n=Vm(t);return n instanceof Comment&&n.data===""?OE(n):n}}function Pn(t,e=1,n=!1){let r=t;for(;e--;)r=OE(r);return r}function dB(t){St===null&&tt===null&&YW(),tt!==null&&(tt.f&Wr)!==0&&St===null&&zW(),Ec&&UW()}function fB(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function Rc(t,e,n,r=!0){var i=St,o={ctx:Br,deps:null,nodes_start:null,nodes_end:null,f:t|bs,first:null,fn:e,last:null,next:null,parent:i,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{AE(o),o.f|=oD}catch(l){throw Hl(o),l}else e!==null&&HE(o);var s=n&&o.deps===null&&o.first===null&&o.nodes_start===null&&o.teardown===null&&(o.f&(aD|RE))===0;if(!s&&r&&(i!==null&&fB(o,i),tt!==null&&(tt.f&ui)!==0)){var a=tt;(a.effects??(a.effects=[])).push(o)}return o}function vD(t){const e=Rc(Vp,null,!1);return Io(e,ci),e.teardown=t,e}function gB(t){dB();var e=St!==null&&(St.f&Ts)!==0&&Br!==null&&!Br.m;if(e){var n=Br;(n.e??(n.e=[])).push({fn:t,effect:St,reaction:tt})}else{var r=CD(t);return r}}function mB(t){const e=Rc(Sc,t,!0);return(n={})=>new Promise(r=>{n.outro?cR(e,()=>{Hl(e),r(void 0)}):(Hl(e),r(void 0))})}function CD(t){return Rc(iD,t,!1)}function yD(t){return Rc(Vp,t,!0)}function lR(t,e=[],n=IE){const r=e.map(n);return xE(()=>t(...r.map(Ve)))}function xE(t,e=0){return Rc(Vp|SE|e,t,!0)}function uR(t,e=!0){return Rc(Vp|Ts,t,!0,e)}function bD(t){var e=t.teardown;if(e!==null){const n=Ec,r=tt;nI(!0),Mo(null);try{e.call(null)}finally{nI(n),Mo(r)}}}function SD(t,e=!1){var i;var n=t.first;for(t.first=t.last=null;n!==null;){(i=n.ac)==null||i.abort(lD);var r=n.next;(n.f&Sc)!==0?n.parent=null:Hl(n,e),n=r}}function pB(t){for(var e=t.first;e!==null;){var n=e.next;(e.f&Ts)===0&&Hl(e),e=n}}function Hl(t,e=!0){var n=!1;(e||(t.f&sD)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(wB(t.nodes_start,t.nodes_end),n=!0),SD(t,e&&!n),Um(t,0),Io(t,EE);var r=t.transitions;if(r!==null)for(const o of r)o.stop();bD(t);var i=t.parent;i!==null&&i.first!==null&&RD(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function wB(t,e){for(;t!==null;){var n=t===e?null:OE(t);t.remove(),t=n}}function RD(t){var e=t.parent,n=t.prev,r=t.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=n))}function cR(t,e){var n=[];ED(t,n,!0),vB(n,()=>{Hl(t),e&&e()})}function vB(t,e){var n=t.length;if(n>0){var r=()=>--n||e();for(var i of t)i.out(r)}else e()}function ED(t,e,n){if((t.f&gc)===0){if(t.f^=gc,t.transitions!==null)for(const s of t.transitions)(s.is_global||n)&&e.push(s);for(var r=t.first;r!==null;){var i=r.next,o=(r.f&_E)!==0||(r.f&Ts)!==0;ED(r,e,o?n:!1),r=i}}}function tI(t){_D(t,!0)}function _D(t,e){if((t.f&gc)!==0){t.f^=gc;for(var n=t.first;n!==null;){var r=n.next,i=(n.f&_E)!==0||(n.f&Ts)!==0;_D(n,i?e:!1),n=r}if(t.transitions!==null)for(const o of t.transitions)(o.is_global||e)&&o.in()}}let Wm=[];function CB(){var t=Wm;Wm=[],FW(t)}function yB(t){Wm.length===0&&queueMicrotask(CB),Wm.push(t)}function bB(t){var e=St;if((e.f&oD)===0){if((e.f&RE)===0)throw t;e.fn(t)}else TD(t,e)}function TD(t,e){for(;e!==null;){if((e.f&RE)!==0)try{e.fn(t);return}catch{}e=e.parent}throw t}let hR=!1,Bm=null,Ol=!1,Ec=!1;function nI(t){Ec=t}let gm=[],tt=null,Co=!1;function Mo(t){tt=t}let St=null;function va(t){St=t}let Tn=null;function SB(t){tt!==null&&tt.f&oR&&(Tn===null?Tn=[tt,[t]]:Tn[1].push(t))}let Qn=null,Ar=0,Qr=null;function RB(t){Qr=t}let MD=1,jm=0,oa=!1;function ID(){return++MD}function Wp(t){var h;var e=t.f;if((e&bs)!==0)return!0;if((e&Bl)!==0){var n=t.deps,r=(e&Wr)!==0;if(n!==null){var i,o,s=(e&$m)!==0,a=r&&St!==null&&!oa,l=n.length;if(s||a){var u=t,c=u.parent;for(i=0;i<l;i++)o=n[i],(s||!((h=o==null?void 0:o.reactions)!=null&&h.includes(u)))&&(o.reactions??(o.reactions=[])).push(u);s&&(u.f^=$m),a&&c!==null&&(c.f&Wr)===0&&(u.f^=Wr)}for(i=0;i<l;i++)if(o=n[i],Wp(o)&&fD(o),o.wv>t.wv)return!0}(!r||St!==null&&!oa)&&Io(t,ci)}return!1}function PD(t,e,n=!0){var r=t.reactions;if(r!==null)for(var i=0;i<r.length;i++){var o=r[i];Tn!=null&&Tn[1].includes(t)&&Tn[0]===tt||((o.f&ui)!==0?PD(o,e,!1):e===o&&(n?Io(o,bs):(o.f&ci)!==0&&Io(o,Bl),HE(o)))}}function OD(t){var f;var e=Qn,n=Ar,r=Qr,i=tt,o=oa,s=Tn,a=Br,l=Co,u=t.f;Qn=null,Ar=0,Qr=null,oa=(u&Wr)!==0&&(Co||!Ol||tt===null),tt=(u&(Ts|Sc))===0?t:null,Tn=null,eI(t.ctx),Co=!1,jm++,t.f|=oR,t.ac!==null&&(t.ac.abort(lD),t.ac=null);try{var c=(0,t.fn)(),h=t.deps;if(Qn!==null){var d;if(Um(t,Ar),h!==null&&Ar>0)for(h.length=Ar+Qn.length,d=0;d<Qn.length;d++)h[Ar+d]=Qn[d];else t.deps=h=Qn;if(!oa||(u&ui)!==0&&t.reactions!==null)for(d=Ar;d<h.length;d++)((f=h[d]).reactions??(f.reactions=[])).push(t)}else h!==null&&Ar<h.length&&(Um(t,Ar),h.length=Ar);if(cD()&&Qr!==null&&!Co&&h!==null&&(t.f&(ui|Bl|bs))===0)for(d=0;d<Qr.length;d++)PD(Qr[d],t);return i!==null&&i!==t&&(jm++,Qr!==null&&(r===null?r=Qr:r.push(...Qr))),c}catch(g){bB(g)}finally{Qn=e,Ar=n,Qr=r,tt=i,oa=o,Tn=s,eI(a),Co=l,t.f^=oR}}function EB(t,e){let n=e.reactions;if(n!==null){var r=AW.call(n,t);if(r!==-1){var i=n.length-1;i===0?n=e.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(e.f&ui)!==0&&(Qn===null||!Qn.includes(e))&&(Io(e,Bl),(e.f&(Wr|$m))===0&&(e.f^=$m),hD(e),Um(e,0))}function Um(t,e){var n=t.deps;if(n!==null)for(var r=e;r<n.length;r++)EB(t,n[r])}function AE(t){var e=t.f;if((e&EE)===0){Io(t,ci);var n=St,r=Ol;St=t,Ol=!0;try{(e&SE)!==0?pB(t):SD(t),bD(t);var i=OD(t);t.teardown=typeof i=="function"?i:null,t.wv=MD;var o;ZM&&QW&&(t.f&bs)!==0&&t.deps}finally{Ol=r,St=n}}}function _B(){try{GW()}catch(t){if(Bm!==null)TD(t,Bm);else throw t}}function TB(){var t=Ol;try{var e=0;for(Ol=!0;gm.length>0;){e++>1e3&&_B();var n=gm,r=n.length;gm=[];for(var i=0;i<r;i++){var o=IB(n[i]);MB(o)}Id.clear()}}finally{hR=!1,Ol=t,Bm=null}}function MB(t){var e=t.length;if(e!==0)for(var n=0;n<e;n++){var r=t[n];(r.f&(EE|gc))===0&&Wp(r)&&(AE(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?RD(r):r.fn=null))}}function HE(t){hR||(hR=!0,queueMicrotask(TB));for(var e=Bm=t;e.parent!==null;){e=e.parent;var n=e.f;if((n&(Sc|Ts))!==0){if((n&ci)===0)return;e.f^=ci}}gm.push(e)}function IB(t){for(var e=[],n=t;n!==null;){var r=n.f,i=(r&(Ts|Sc))!==0,o=i&&(r&ci)!==0;if(!o&&(r&gc)===0){(r&iD)!==0?e.push(n):i?n.f^=ci:Wp(n)&&AE(n);var s=n.first;if(s!==null){n=s;continue}}var a=n.parent;for(n=n.next;n===null&&a!==null;)n=a.next,a=a.parent}return e}function Ve(t){var e=t.f,n=(e&ui)!==0;if(tt!==null&&!Co){if(!(Tn!=null&&Tn[1].includes(t))||Tn[0]!==tt){var r=tt.deps;t.rv<jm&&(t.rv=jm,Qn===null&&r!==null&&r[Ar]===t?Ar++:Qn===null?Qn=[t]:(!oa||!Qn.includes(t))&&Qn.push(t))}}else if(n&&t.deps===null&&t.effects===null){var i=t,o=i.parent;o!==null&&(o.f&Wr)===0&&(i.f^=Wr)}return n&&(i=t,Wp(i)&&fD(i)),Ec&&Id.has(t)?Id.get(t):t.v}function Bp(t){var e=Co;try{return Co=!0,t()}finally{Co=e}}const PB=-7169;function Io(t,e){t.f=t.f&PB|e}const OB=["touchstart","touchmove"];function xB(t){return OB.includes(t)}let rI=!1;function AB(){rI||(rI=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const n of t.target.elements)(e=n.__on_r)==null||e.call(n)})},{capture:!0}))}function xD(t){var e=tt,n=St;Mo(null),va(null);try{return t()}finally{Mo(e),va(n)}}function AD(t,e,n,r=n){t.addEventListener(e,()=>xD(n));const i=t.__on_r;i?t.__on_r=()=>{i(),r(!0)}:t.__on_r=()=>r(!0),AB()}const HD=new Set,dR=new Set;function HB(t,e,n,r={}){function i(o){if(r.capture||Gh.call(e,o),!o.cancelBubble)return xD(()=>n==null?void 0:n.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?yB(()=>{e.addEventListener(t,i,r)}):e.addEventListener(t,i,r),i}function iI(t,e,n,r,i){var o={capture:r,passive:i},s=HB(t,e,n,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&vD(()=>{e.removeEventListener(t,s,o)})}function ND(t){for(var e=0;e<t.length;e++)HD.add(t[e]);for(var n of dR)n(t)}function Gh(t){var C;var e=this,n=e.ownerDocument,r=t.type,i=((C=t.composedPath)==null?void 0:C.call(t))||[],o=i[0]||t.target,s=0,a=t.__root;if(a){var l=i.indexOf(a);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var u=i.indexOf(e);if(u===-1)return;l<=u&&(s=l)}if(o=i[s]||t.target,o!==e){NW(t,"currentTarget",{configurable:!0,get(){return o||n}});var c=tt,h=St;Mo(null),va(null);try{for(var d,f=[];o!==null;){var g=o.assignedSlot||o.parentNode||o.host||null;try{var v=o["__"+r];if(v!=null&&(!o.disabled||t.target===o))if(nD(v)){var[y,...E]=v;y.apply(o,[t,...E])}else v.call(o,t)}catch(T){d?f.push(T):d=T}if(t.cancelBubble||g===e||g===null)break;o=g}if(d){for(let T of f)queueMicrotask(()=>{throw T});throw d}}finally{t.__root=e,delete t.currentTarget,Mo(c),va(h)}}}function NB(t){var e;e=document.head.appendChild(PE());try{xE(()=>t(e),sD)}finally{}}function DB(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function fR(t,e){var n=St;n.nodes_start===null&&(n.nodes_start=t,n.nodes_end=e)}function jp(t,e){var n=(e&rB)!==0,r=(e&iB)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=DB(o?t:"<!>"+t),n||(i=Vm(i)));var s=r||mD?document.importNode(i,!0):i.cloneNode(!0);if(n){var a=Vm(s),l=s.lastChild;fR(a,l)}else fR(s,s);return s}}function kB(t){return()=>LB(t())}function LB(t){const e=t.nodeType===WW,n=t.tagName==="SCRIPT"?[t]:t.querySelectorAll("script"),r=St;for(const o of n){const s=document.createElement("script");for(var i of o.attributes)s.setAttribute(i.name,i.value);s.textContent=o.textContent,(e?t.firstChild===o:t===o)&&(r.nodes_start=s),(e?t.lastChild===o:t===o)&&(r.nodes_end=s),o.replaceWith(s)}return t}function FB(){var t=document.createDocumentFragment(),e=document.createComment(""),n=PE();return t.append(e,n),fR(e,n),t}function nd(t,e){t!==null&&t.before(e)}function Zw(t,e){var n=e==null?"":typeof e=="object"?e+"":e;n!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=n,t.nodeValue=n+"")}function $B(t,e){return VB(t,e)}const ru=new Map;function VB(t,{target:e,anchor:n,props:r={},events:i,context:o,intro:s=!0}){hB();var a=new Set,l=h=>{for(var d=0;d<h.length;d++){var f=h[d];if(!a.has(f)){a.add(f);var g=xB(f);e.addEventListener(f,Gh,{passive:g});var v=ru.get(f);v===void 0?(document.addEventListener(f,Gh,{passive:g}),ru.set(f,1)):ru.set(f,v+1)}}};l(HW(HD)),dR.add(l);var u=void 0,c=mB(()=>{var h=n??e.appendChild(PE());return uR(()=>{if(o){TE({});var d=Br;d.c=o}i&&(r.$$events=i),u=t(h,r)||{},o&&ME()}),()=>{var g;for(var d of a){e.removeEventListener(d,Gh);var f=ru.get(d);--f===0?(document.removeEventListener(d,Gh),ru.delete(d)):ru.set(d,f)}dR.delete(l),h!==n&&((g=h.parentNode)==null||g.removeChild(h))}});return WB.set(u,c),u}let WB=new WeakMap;function BB(t,e,[n,r]=[0,0]){var i=t,o=null,s=null,a=hr,l=n>0?_E:0,u=!1;const c=(d,f=!0)=>{u=!0,h(f,d)},h=(d,f)=>{a!==(a=d)&&(a?(o?tI(o):f&&(o=uR(()=>f(i))),s&&cR(s,()=>{s=null})):(s?tI(s):f&&(s=uR(()=>f(i,[n+1,r]))),o&&cR(o,()=>{o=null})))};xE(()=>{u=!1,e(c),u||h(null,null)},l)}const jB=Symbol("is custom element"),UB=Symbol("is html");function oI(t,e){var n=DD(t);n.checked!==(n.checked=e??void 0)&&(t.checked=e)}function Aa(t,e,n,r){var i=DD(t);i[e]!==(i[e]=n)&&(e==="loading"&&(t[VW]=n),n==null?t.removeAttribute(e):typeof n!="string"&&zB(t).includes(e)?t[e]=n:t.setAttribute(e,n))}function DD(t){return t.__attributes??(t.__attributes={[jB]:t.nodeName.includes("-"),[UB]:t.namespaceURI===oB})}var sI=new Map;function zB(t){var e=sI.get(t.nodeName);if(e)return e;sI.set(t.nodeName,e=[]);for(var n,r=t,i=Element.prototype;i!==r;){n=DW(r);for(var o in n)n[o].set&&e.push(o);r=rD(r)}return e}function YB(t,e,n=e){AD(t,"input",r=>{var i=r?t.defaultValue:t.value;if(i=Qw(t)?Jw(i):i,n(i),i!==(i=e())){var o=t.selectionStart,s=t.selectionEnd;t.value=i??"",s!==null&&(t.selectionStart=o,t.selectionEnd=Math.min(s,t.value.length))}}),Bp(e)==null&&t.value&&n(Qw(t)?Jw(t.value):t.value),yD(()=>{var r=e();Qw(t)&&r===Jw(t.value)||t.type==="date"&&!r&&!t.value||r!==t.value&&(t.value=r??"")})}function aI(t,e,n=e){AD(t,"change",r=>{var i=r?t.defaultChecked:t.checked;n(i)}),Bp(e)==null&&n(t.checked),yD(()=>{var r=e();t.checked=!!r})}function Qw(t){var e=t.type;return e==="number"||e==="range"}function Jw(t){return t===""?null:+t}let Of=!1;function GB(t){var e=Of;try{return Of=!1,[t(),Of]}finally{Of=e}}function qB(t){var e;return((e=t.ctx)==null?void 0:e.d)??!1}function ev(t,e,n,r){var y;var i=(n&tB)!==0,o=(n&nB)!==0,s=r,a=!0,l=()=>(a&&(a=!1,s=o?Bp(r):r),s),u;if(i){var c=fm in t||$W in t;u=((y=ic(t,e))==null?void 0:y.set)??(c&&e in t?E=>t[e]=E:void 0)}var h,d=!1;i?[h,d]=GB(()=>t[e]):h=t[e],h===void 0&&r!==void 0&&(h=l(),u&&(qW(),u(h)));var f;if(f=()=>{var E=t[e];return E===void 0?l():(a=!0,E)},(n&eB)===0)return f;if(u){var g=t.$$legacy;return function(E,C){return arguments.length>0?((!C||g||d)&&u(C?f():E),E):f()}}var v=((n&JW)!==0?IE:aB)(f);return i&&Ve(v),function(E,C){if(arguments.length>0){const T=C?Ve(v):i?Zu(E):E;return Ue(v,T),s!==void 0&&(s=T),E}return qB(v)?v.v:Ve(v)}}function KB(t){Br===null&&sB(),gB(()=>{const e=Bp(t);if(typeof e=="function")return e})}const XB="5";var tD;typeof window<"u"&&((tD=window.__svelte??(window.__svelte={})).v??(tD.v=new Set)).add(XB);var lI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},uI={},jc,cI;function nn(){if(cI)return jc;cI=1;var t=function(e){return e&&e.Math===Math&&e};return jc=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof lI=="object"&&lI)||t(typeof jc=="object"&&jc)||function(){return this}()||Function("return this")(),jc}var tv={},nv,hI;function hn(){return hI||(hI=1,nv=function(t){try{return!!t()}catch{return!0}}),nv}var rv,dI;function fi(){if(dI)return rv;dI=1;var t=hn();return rv=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),rv}var iv,fI;function Up(){if(fI)return iv;fI=1;var t=hn();return iv=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),iv}var ov,gI;function dn(){if(gI)return ov;gI=1;var t=Up(),e=Function.prototype.call;return ov=t?e.bind(e):function(){return e.apply(e,arguments)},ov}var sv={},mI;function ZB(){if(mI)return sv;mI=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return sv.f=n?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,sv}var av,pI;function zp(){return pI||(pI=1,av=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),av}var lv,wI;function rn(){if(wI)return lv;wI=1;var t=Up(),e=Function.prototype,n=e.call,r=t&&e.bind.bind(n,n);return lv=t?r:function(i){return function(){return n.apply(i,arguments)}},lv}var uv,vI;function jl(){if(vI)return uv;vI=1;var t=rn(),e=t({}.toString),n=t("".slice);return uv=function(r){return n(e(r),8,-1)},uv}var cv,CI;function QB(){if(CI)return cv;CI=1;var t=rn(),e=hn(),n=jl(),r=Object,i=t("".split);return cv=e(function(){return!r("z").propertyIsEnumerable(0)})?function(o){return n(o)==="String"?i(o,""):r(o)}:r,cv}var hv,yI;function NE(){return yI||(yI=1,hv=function(t){return t==null}),hv}var dv,bI;function Qd(){if(bI)return dv;bI=1;var t=NE(),e=TypeError;return dv=function(n){if(t(n))throw new e("Can't call method on "+n);return n},dv}var fv,SI;function Jd(){if(SI)return fv;SI=1;var t=QB(),e=Qd();return fv=function(n){return t(e(n))},fv}var gv,RI;function fn(){if(RI)return gv;RI=1;var t=typeof document=="object"&&document.all;return gv=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},gv}var mv,EI;function gi(){if(EI)return mv;EI=1;var t=fn();return mv=function(e){return typeof e=="object"?e!==null:t(e)},mv}var pv,_I;function _c(){if(_I)return pv;_I=1;var t=nn(),e=fn(),n=function(r){return e(r)?r:void 0};return pv=function(r,i){return arguments.length<2?n(t[r]):t[r]&&t[r][i]},pv}var wv,TI;function ef(){if(TI)return wv;TI=1;var t=rn();return wv=t({}.isPrototypeOf),wv}var vv,MI;function Yp(){if(MI)return vv;MI=1;var t=nn(),e=t.navigator,n=e&&e.userAgent;return vv=n?String(n):"",vv}var Cv,II;function JB(){if(II)return Cv;II=1;var t=nn(),e=Yp(),n=t.process,r=t.Deno,i=n&&n.versions||r&&r.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),Cv=a,Cv}var yv,PI;function DE(){if(PI)return yv;PI=1;var t=JB(),e=hn(),n=nn(),r=n.String;return yv=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),yv}var bv,OI;function kD(){if(OI)return bv;OI=1;var t=DE();return bv=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",bv}var Sv,xI;function kE(){if(xI)return Sv;xI=1;var t=_c(),e=fn(),n=ef(),r=kD(),i=Object;return Sv=r?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&n(s.prototype,i(o))},Sv}var Rv,AI;function Gp(){if(AI)return Rv;AI=1;var t=String;return Rv=function(e){try{return t(e)}catch{return"Object"}},Rv}var Ev,HI;function Er(){if(HI)return Ev;HI=1;var t=fn(),e=Gp(),n=TypeError;return Ev=function(r){if(t(r))return r;throw new n(e(r)+" is not a function")},Ev}var _v,NI;function tf(){if(NI)return _v;NI=1;var t=Er(),e=NE();return _v=function(n,r){var i=n[r];return e(i)?void 0:t(i)},_v}var Tv,DI;function ej(){if(DI)return Tv;DI=1;var t=dn(),e=fn(),n=gi(),r=TypeError;return Tv=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!n(a=t(s,i))||e(s=i.valueOf)&&!n(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!n(a=t(s,i)))return a;throw new r("Can't convert object to primitive value")},Tv}var Mv={exports:{}},Iv,kI;function _a(){return kI||(kI=1,Iv=!1),Iv}var Pv,LI;function LE(){if(LI)return Pv;LI=1;var t=nn(),e=Object.defineProperty;return Pv=function(n,r){try{e(t,n,{value:r,configurable:!0,writable:!0})}catch{t[n]=r}return r},Pv}var FI;function FE(){if(FI)return Mv.exports;FI=1;var t=_a(),e=nn(),n=LE(),r="__core-js_shared__",i=Mv.exports=e[r]||n(r,{});return(i.versions||(i.versions=[])).push({version:"3.43.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Mv.exports}var Ov,$I;function LD(){if($I)return Ov;$I=1;var t=FE();return Ov=function(e,n){return t[e]||(t[e]=n||{})},Ov}var xv,VI;function Tc(){if(VI)return xv;VI=1;var t=Qd(),e=Object;return xv=function(n){return e(t(n))},xv}var Av,WI;function mi(){if(WI)return Av;WI=1;var t=rn(),e=Tc(),n=t({}.hasOwnProperty);return Av=Object.hasOwn||function(i,o){return n(e(i),o)},Av}var Hv,BI;function FD(){if(BI)return Hv;BI=1;var t=rn(),e=0,n=Math.random(),r=t(1.1.toString);return Hv=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+n,36)},Hv}var Nv,jI;function Ui(){if(jI)return Nv;jI=1;var t=nn(),e=LD(),n=mi(),r=FD(),i=DE(),o=kD(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||r;return Nv=function(u){return n(a,u)||(a[u]=i&&n(s,u)?s[u]:l("Symbol."+u)),a[u]},Nv}var Dv,UI;function tj(){if(UI)return Dv;UI=1;var t=dn(),e=gi(),n=kE(),r=tf(),i=ej(),o=Ui(),s=TypeError,a=o("toPrimitive");return Dv=function(l,u){if(!e(l)||n(l))return l;var c=r(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||n(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},Dv}var kv,zI;function $D(){if(zI)return kv;zI=1;var t=tj(),e=kE();return kv=function(n){var r=t(n,"string");return e(r)?r:r+""},kv}var Lv,YI;function $E(){if(YI)return Lv;YI=1;var t=nn(),e=gi(),n=t.document,r=e(n)&&e(n.createElement);return Lv=function(i){return r?n.createElement(i):{}},Lv}var Fv,GI;function VD(){if(GI)return Fv;GI=1;var t=fi(),e=hn(),n=$E();return Fv=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),Fv}var qI;function WD(){if(qI)return tv;qI=1;var t=fi(),e=dn(),n=ZB(),r=zp(),i=Jd(),o=$D(),s=mi(),a=VD(),l=Object.getOwnPropertyDescriptor;return tv.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return r(!e(n.f,c,h),c[h])},tv}var $v={},Vv,KI;function BD(){if(KI)return Vv;KI=1;var t=fi(),e=hn();return Vv=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Vv}var Wv,XI;function gn(){if(XI)return Wv;XI=1;var t=gi(),e=String,n=TypeError;return Wv=function(r){if(t(r))return r;throw new n(e(r)+" is not an object")},Wv}var ZI;function Ta(){if(ZI)return $v;ZI=1;var t=fi(),e=VD(),n=BD(),r=gn(),i=$D(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return $v.f=t?n?function(d,f,g){if(r(d),f=i(f),r(g),typeof d=="function"&&f==="prototype"&&"value"in g&&c in g&&!g[c]){var v=a(d,f);v&&v[c]&&(d[f]=g.value,g={configurable:u in g?g[u]:v[u],enumerable:l in g?g[l]:v[l],writable:!1})}return s(d,f,g)}:s:function(d,f,g){if(r(d),f=i(f),r(g),e)try{return s(d,f,g)}catch{}if("get"in g||"set"in g)throw new o("Accessors not supported");return"value"in g&&(d[f]=g.value),d},$v}var Bv,QI;function Mc(){if(QI)return Bv;QI=1;var t=fi(),e=Ta(),n=zp();return Bv=t?function(r,i,o){return e.f(r,i,n(1,o))}:function(r,i,o){return r[i]=o,r},Bv}var jv={exports:{}},Uv,JI;function nj(){if(JI)return Uv;JI=1;var t=fi(),e=mi(),n=Function.prototype,r=t&&Object.getOwnPropertyDescriptor,i=e(n,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&r(n,"name").configurable);return Uv={EXISTS:i,PROPER:o,CONFIGURABLE:s},Uv}var zv,eP;function rj(){if(eP)return zv;eP=1;var t=rn(),e=fn(),n=FE(),r=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(i){return r(i)}),zv=n.inspectSource,zv}var Yv,tP;function ij(){if(tP)return Yv;tP=1;var t=nn(),e=fn(),n=t.WeakMap;return Yv=e(n)&&/native code/.test(String(n)),Yv}var Gv,nP;function VE(){if(nP)return Gv;nP=1;var t=LD(),e=FD(),n=t("keys");return Gv=function(r){return n[r]||(n[r]=e(r))},Gv}var qv,rP;function WE(){return rP||(rP=1,qv={}),qv}var Kv,iP;function jD(){if(iP)return Kv;iP=1;var t=ij(),e=nn(),n=gi(),r=Mc(),i=mi(),o=FE(),s=VE(),a=WE(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,f,g=function(C){return f(C)?d(C):h(C,{})},v=function(C){return function(T){var A;if(!n(T)||(A=d(T)).type!==C)throw new u("Incompatible receiver, "+C+" required");return A}};if(t||o.state){var y=o.state||(o.state=new c);y.get=y.get,y.has=y.has,y.set=y.set,h=function(C,T){if(y.has(C))throw new u(l);return T.facade=C,y.set(C,T),T},d=function(C){return y.get(C)||{}},f=function(C){return y.has(C)}}else{var E=s("state");a[E]=!0,h=function(C,T){if(i(C,E))throw new u(l);return T.facade=C,r(C,E,T),T},d=function(C){return i(C,E)?C[E]:{}},f=function(C){return i(C,E)}}return Kv={set:h,get:d,has:f,enforce:g,getterFor:v},Kv}var oP;function UD(){if(oP)return jv.exports;oP=1;var t=rn(),e=hn(),n=fn(),r=mi(),i=fi(),o=nj().CONFIGURABLE,s=rj(),a=jD(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),f=t("".replace),g=t([].join),v=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),y=String(String).split("String"),E=jv.exports=function(C,T,A){d(c(T),0,7)==="Symbol("&&(T="["+f(c(T),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),A&&A.getter&&(T="get "+T),A&&A.setter&&(T="set "+T),(!r(C,"name")||o&&C.name!==T)&&(i?h(C,"name",{value:T,configurable:!0}):C.name=T),v&&A&&r(A,"arity")&&C.length!==A.arity&&h(C,"length",{value:A.arity});try{A&&r(A,"constructor")&&A.constructor?i&&h(C,"prototype",{writable:!1}):C.prototype&&(C.prototype=void 0)}catch{}var F=l(C);return r(F,"source")||(F.source=g(y,typeof T=="string"?T:"")),C};return Function.prototype.toString=E(function(){return n(this)&&u(this).source||s(this)},"toString"),jv.exports}var Xv,sP;function BE(){if(sP)return Xv;sP=1;var t=fn(),e=Ta(),n=UD(),r=LE();return Xv=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&n(s,u,a),a.global)l?i[o]=s:r(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},Xv}var Zv={},Qv,aP;function oj(){if(aP)return Qv;aP=1;var t=Math.ceil,e=Math.floor;return Qv=Math.trunc||function(r){var i=+r;return(i>0?e:t)(i)},Qv}var Jv,lP;function nf(){if(lP)return Jv;lP=1;var t=oj();return Jv=function(e){var n=+e;return n!==n||n===0?0:t(n)},Jv}var eC,uP;function sj(){if(uP)return eC;uP=1;var t=nf(),e=Math.max,n=Math.min;return eC=function(r,i){var o=t(r);return o<0?e(o+i,0):n(o,i)},eC}var tC,cP;function aj(){if(cP)return tC;cP=1;var t=nf(),e=Math.min;return tC=function(n){var r=t(n);return r>0?e(r,9007199254740991):0},tC}var nC,hP;function Ic(){if(hP)return nC;hP=1;var t=aj();return nC=function(e){return t(e.length)},nC}var rC,dP;function lj(){if(dP)return rC;dP=1;var t=Jd(),e=sj(),n=Ic(),r=function(i){return function(o,s,a){var l=t(o),u=n(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return rC={includes:r(!0),indexOf:r(!1)},rC}var iC,fP;function zD(){if(fP)return iC;fP=1;var t=rn(),e=mi(),n=Jd(),r=lj().indexOf,i=WE(),o=t([].push);return iC=function(s,a){var l=n(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~r(c,h)||o(c,h));return c},iC}var oC,gP;function jE(){return gP||(gP=1,oC=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),oC}var mP;function uj(){if(mP)return Zv;mP=1;var t=zD(),e=jE(),n=e.concat("length","prototype");return Zv.f=Object.getOwnPropertyNames||function(i){return t(i,n)},Zv}var sC={},pP;function cj(){return pP||(pP=1,sC.f=Object.getOwnPropertySymbols),sC}var aC,wP;function hj(){if(wP)return aC;wP=1;var t=_c(),e=rn(),n=uj(),r=cj(),i=gn(),o=e([].concat);return aC=t("Reflect","ownKeys")||function(a){var l=n.f(i(a)),u=r.f;return u?o(l,u(a)):l},aC}var lC,vP;function YD(){if(vP)return lC;vP=1;var t=mi(),e=hj(),n=WD(),r=Ta();return lC=function(i,o,s){for(var a=e(o),l=r.f,u=n.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},lC}var uC,CP;function dj(){if(CP)return uC;CP=1;var t=hn(),e=fn(),n=/#|\.prototype\./,r=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=r.normalize=function(l){return String(l).replace(n,".").toLowerCase()},o=r.data={},s=r.NATIVE="N",a=r.POLYFILL="P";return uC=r,uC}var cC,yP;function wt(){if(yP)return cC;yP=1;var t=nn(),e=WD().f,n=Mc(),r=BE(),i=LE(),o=YD(),s=dj();return cC=function(a,l){var u=a.target,c=a.global,h=a.stat,d,f,g,v,y,E;if(c?f=t:h?f=t[u]||i(u,{}):f=t[u]&&t[u].prototype,f)for(g in l){if(y=l[g],a.dontCallGetSet?(E=e(f,g),v=E&&E.value):v=f[g],d=s(c?g:u+(h?".":"#")+g,a.forced),!d&&v!==void 0){if(typeof y==typeof v)continue;o(y,v)}(a.sham||v&&v.sham)&&n(y,"sham",!0),r(f,g,y,a)}},cC}var hC,bP;function rf(){if(bP)return hC;bP=1;var t=Up(),e=Function.prototype,n=e.apply,r=e.call;return hC=typeof Reflect=="object"&&Reflect.apply||(t?r.bind(n):function(){return r.apply(n,arguments)}),hC}var dC,SP;function GD(){if(SP)return dC;SP=1;var t=rn(),e=Er();return dC=function(n,r,i){try{return t(e(Object.getOwnPropertyDescriptor(n,r)[i]))}catch{}},dC}var fC,RP;function fj(){if(RP)return fC;RP=1;var t=gi();return fC=function(e){return t(e)||e===null},fC}var gC,EP;function gj(){if(EP)return gC;EP=1;var t=fj(),e=String,n=TypeError;return gC=function(r){if(t(r))return r;throw new n("Can't set "+e(r)+" as a prototype")},gC}var mC,_P;function qD(){if(_P)return mC;_P=1;var t=GD(),e=gi(),n=Qd(),r=gj();return mC=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return n(l),r(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),mC}var pC,TP;function mj(){if(TP)return pC;TP=1;var t=Ta().f;return pC=function(e,n,r){r in e||t(e,r,{configurable:!0,get:function(){return n[r]},set:function(i){n[r]=i}})},pC}var wC,MP;function pj(){if(MP)return wC;MP=1;var t=fn(),e=gi(),n=qD();return wC=function(r,i,o){var s,a;return n&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&n(r,a),r},wC}var vC,IP;function wj(){if(IP)return vC;IP=1;var t=Ui(),e=t("toStringTag"),n={};return n[e]="z",vC=String(n)==="[object z]",vC}var CC,PP;function KD(){if(PP)return CC;PP=1;var t=wj(),e=fn(),n=jl(),r=Ui(),i=r("toStringTag"),o=Object,s=n(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return CC=t?n:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?n(u):(h=n(u))==="Object"&&e(u.callee)?"Arguments":h},CC}var yC,OP;function qp(){if(OP)return yC;OP=1;var t=KD(),e=String;return yC=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},yC}var bC,xP;function vj(){if(xP)return bC;xP=1;var t=qp();return bC=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},bC}var SC,AP;function Cj(){if(AP)return SC;AP=1;var t=gi(),e=Mc();return SC=function(n,r){t(r)&&"cause"in r&&e(n,"cause",r.cause)},SC}var RC,HP;function yj(){if(HP)return RC;HP=1;var t=rn(),e=Error,n=t("".replace),r=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(r);return RC=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=n(s,i,"");return s},RC}var EC,NP;function bj(){if(NP)return EC;NP=1;var t=hn(),e=zp();return EC=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),EC}var _C,DP;function Sj(){if(DP)return _C;DP=1;var t=Mc(),e=yj(),n=bj(),r=Error.captureStackTrace;return _C=function(i,o,s,a){n&&(r?r(i,o):t(i,"stack",e(s,a)))},_C}var TC,kP;function Rj(){if(kP)return TC;kP=1;var t=_c(),e=mi(),n=Mc(),r=ef(),i=qD(),o=YD(),s=mj(),a=pj(),l=vj(),u=Cj(),c=Sj(),h=fi(),d=_a();return TC=function(f,g,v,y){var E="stackTraceLimit",C=y?2:1,T=f.split("."),A=T[T.length-1],F=t.apply(null,T);if(F){var I=F.prototype;if(!d&&e(I,"cause")&&delete I.cause,!v)return F;var O=t("Error"),Y=g(function(U,W){var Z=l(y?W:U,void 0),Q=y?new F(U):new F;return Z!==void 0&&n(Q,"message",Z),c(Q,Y,Q.stack,2),this&&r(I,this)&&a(Q,this,Y),arguments.length>C&&u(Q,arguments[C]),Q});if(Y.prototype=I,A!=="Error"?i?i(Y,O):o(Y,O,{name:!0}):h&&E in F&&(s(Y,F,E),s(Y,F,"prepareStackTrace")),o(Y,F),!d)try{I.name!==A&&n(I,"name",A),I.constructor=Y}catch{}return Y}},TC}var LP;function Ej(){if(LP)return uI;LP=1;var t=wt(),e=nn(),n=rf(),r=Rj(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=r(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=r(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return n(u,this,arguments)}}),a("EvalError",function(u){return function(h){return n(u,this,arguments)}}),a("RangeError",function(u){return function(h){return n(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return n(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return n(u,this,arguments)}}),a("TypeError",function(u){return function(h){return n(u,this,arguments)}}),a("URIError",function(u){return function(h){return n(u,this,arguments)}}),l("CompileError",function(u){return function(h){return n(u,this,arguments)}}),l("LinkError",function(u){return function(h){return n(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return n(u,this,arguments)}}),uI}Ej();var FP={},MC,$P;function XD(){if($P)return MC;$P=1;var t=jl();return MC=Array.isArray||function(n){return t(n)==="Array"},MC}var IC,VP;function ZD(){if(VP)return IC;VP=1;var t=fi(),e=XD(),n=TypeError,r=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return IC=i?function(o,s){if(e(o)&&!r(o,"length").writable)throw new n("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},IC}var PC,WP;function QD(){if(WP)return PC;WP=1;var t=TypeError,e=9007199254740991;return PC=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},PC}var BP;function _j(){if(BP)return FP;BP=1;var t=wt(),e=Tc(),n=Ic(),r=ZD(),i=QD(),o=hn(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=n(h),f=arguments.length;i(d+f);for(var g=0;g<f;g++)h[d]=arguments[g],d++;return r(h,d),d}}),FP}_j();var jP={},OC,UP;function Tj(){if(UP)return OC;UP=1;var t=jl(),e=rn();return OC=function(n){if(t(n)==="Function")return e(n)},OC}var xC,zP;function JD(){if(zP)return xC;zP=1;var t=Tj(),e=Er(),n=Up(),r=t(t.bind);return xC=function(i,o){return e(i),o===void 0?i:n?r(i,o):function(){return i.apply(o,arguments)}},xC}var AC,YP;function ek(){return YP||(YP=1,AC={}),AC}var HC,GP;function Mj(){if(GP)return HC;GP=1;var t=Ui(),e=ek(),n=t("iterator"),r=Array.prototype;return HC=function(i){return i!==void 0&&(e.Array===i||r[n]===i)},HC}var NC,qP;function UE(){if(qP)return NC;qP=1;var t=KD(),e=tf(),n=NE(),r=ek(),i=Ui(),o=i("iterator");return NC=function(s){if(!n(s))return e(s,o)||e(s,"@@iterator")||r[t(s)]},NC}var DC,KP;function Ij(){if(KP)return DC;KP=1;var t=dn(),e=Er(),n=gn(),r=Gp(),i=UE(),o=TypeError;return DC=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return n(t(l,s));throw new o(r(s)+" is not iterable")},DC}var kC,XP;function _r(){if(XP)return kC;XP=1;var t=dn(),e=gn(),n=tf();return kC=function(r,i,o){var s,a;e(r);try{if(s=n(r,"return"),!s){if(i==="throw")throw o;return o}s=t(s,r)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},kC}var LC,ZP;function Pc(){if(ZP)return LC;ZP=1;var t=JD(),e=dn(),n=gn(),r=Gp(),i=Mj(),o=Ic(),s=ef(),a=Ij(),l=UE(),u=_r(),c=TypeError,h=function(f,g){this.stopped=f,this.result=g},d=h.prototype;return LC=function(f,g,v){var y=v&&v.that,E=!!(v&&v.AS_ENTRIES),C=!!(v&&v.IS_RECORD),T=!!(v&&v.IS_ITERATOR),A=!!(v&&v.INTERRUPTED),F=t(g,y),I,O,Y,U,W,Z,Q,oe=function(ae){return I&&u(I,"normal"),new h(!0,ae)},te=function(ae){return E?(n(ae),A?F(ae[0],ae[1],oe):F(ae[0],ae[1])):A?F(ae,oe):F(ae)};if(C)I=f.iterator;else if(T)I=f;else{if(O=l(f),!O)throw new c(r(f)+" is not iterable");if(i(O)){for(Y=0,U=o(f);U>Y;Y++)if(W=te(f[Y]),W&&s(d,W))return W;return new h(!1)}I=a(f,O)}for(Z=C?f.next:I.next;!(Q=e(Z,I)).done;){try{W=te(Q.value)}catch(ae){u(I,"throw",ae)}if(typeof W=="object"&&W&&s(d,W))return W}return new h(!1)},LC}var FC,QP;function tk(){if(QP)return FC;QP=1;var t=fi(),e=Ta(),n=zp();return FC=function(r,i,o){t?e.f(r,i,n(0,o)):r[i]=o},FC}var JP;function Pj(){if(JP)return jP;JP=1;var t=wt(),e=Pc(),n=tk();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){n(o,s,a)},{AS_ENTRIES:!0}),o}}),jP}Pj();var eO={},$C,tO;function xo(){if(tO)return $C;tO=1;var t=rn(),e=Set.prototype;return $C={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},$C}var VC,nO;function Ul(){if(nO)return VC;nO=1;var t=xo().has;return VC=function(e){return t(e),e},VC}var WC,rO;function zl(){if(rO)return WC;rO=1;var t=dn();return WC=function(e,n,r){for(var i=r?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=n(s.value),a!==void 0)return a},WC}var BC,iO;function of(){if(iO)return BC;iO=1;var t=rn(),e=zl(),n=xo(),r=n.Set,i=n.proto,o=t(i.forEach),s=t(i.keys),a=s(new r).next;return BC=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},BC}var jC,oO;function zE(){if(oO)return jC;oO=1;var t=xo(),e=of(),n=t.Set,r=t.add;return jC=function(i){var o=new n;return e(i,function(s){r(o,s)}),o},jC}var UC,sO;function sf(){if(sO)return UC;sO=1;var t=GD(),e=xo();return UC=t(e.proto,"size","get")||function(n){return n.size},UC}var zC,aO;function Ao(){return aO||(aO=1,zC=function(t){return{iterator:t,next:t.next,done:!1}}),zC}var YC,lO;function Yl(){if(lO)return YC;lO=1;var t=Er(),e=gn(),n=dn(),r=nf(),i=Ao(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(n(this.keys,this.set)))},includes:function(c){return n(this.has,this.set,c)}},YC=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=r(h);if(d<0)throw new s(o);return new u(c,d)},YC}var GC,uO;function Oj(){if(uO)return GC;uO=1;var t=Ul(),e=xo(),n=zE(),r=sf(),i=Yl(),o=of(),s=zl(),a=e.has,l=e.remove;return GC=function(c){var h=t(this),d=i(c),f=n(h);return r(h)<=d.size?o(h,function(g){d.includes(g)&&l(f,g)}):s(d.getIterator(),function(g){a(f,g)&&l(f,g)}),f},GC}var qC,cO;function Gl(){if(cO)return qC;cO=1;var t=_c(),e=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};return qC=function(r,i){var o=t("Set");try{new o()[r](e(0));try{return new o()[r](e(-1)),!1}catch{if(!i)return!0;try{return new o()[r](n(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[r](n(1/0)))}}}catch{return!1}},qC}var hO;function xj(){if(hO)return eO;hO=1;var t=wt(),e=Oj(),n=hn(),r=Gl(),i=!r("difference",function(s){return s.size===0}),o=i||n(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),eO}xj();var dO={},KC,fO;function Aj(){if(fO)return KC;fO=1;var t=Ul(),e=xo(),n=sf(),r=Yl(),i=of(),o=zl(),s=e.Set,a=e.add,l=e.has;return KC=function(c){var h=t(this),d=r(c),f=new s;return n(h)>d.size?o(d.getIterator(),function(g){l(h,g)&&a(f,g)}):i(h,function(g){d.includes(g)&&a(f,g)}),f},KC}var gO;function Hj(){if(gO)return dO;gO=1;var t=wt(),e=hn(),n=Aj(),r=Gl(),i=!r("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:n}),dO}Hj();var mO={},XC,pO;function Nj(){if(pO)return XC;pO=1;var t=Ul(),e=xo().has,n=sf(),r=Yl(),i=of(),o=zl(),s=_r();return XC=function(l){var u=t(this),c=r(l);if(n(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},XC}var wO;function Dj(){if(wO)return mO;wO=1;var t=wt(),e=Nj(),n=Gl(),r=!n("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:e}),mO}Dj();var vO={},ZC,CO;function kj(){if(CO)return ZC;CO=1;var t=Ul(),e=sf(),n=of(),r=Yl();return ZC=function(o){var s=t(this),a=r(o);return e(s)>a.size?!1:n(s,function(l){if(!a.includes(l))return!1},!0)!==!1},ZC}var yO;function Lj(){if(yO)return vO;yO=1;var t=wt(),e=kj(),n=Gl(),r=!n("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:e}),vO}Lj();var bO={},QC,SO;function Fj(){if(SO)return QC;SO=1;var t=Ul(),e=xo().has,n=sf(),r=Yl(),i=zl(),o=_r();return QC=function(a){var l=t(this),u=r(a);if(n(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},QC}var RO;function $j(){if(RO)return bO;RO=1;var t=wt(),e=Fj(),n=Gl(),r=!n("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:e}),bO}$j();var EO={},JC,_O;function Vj(){if(_O)return JC;_O=1;var t=Ul(),e=xo(),n=zE(),r=Yl(),i=zl(),o=e.add,s=e.has,a=e.remove;return JC=function(u){var c=t(this),h=r(u).getIterator(),d=n(c);return i(h,function(f){s(c,f)?a(d,f):o(d,f)}),d},JC}var ey,TO;function nk(){return TO||(TO=1,ey=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},r=e[t](n);return r.size!==1||r.values().next().value!==4}catch{return!1}}),ey}var MO;function Wj(){if(MO)return EO;MO=1;var t=wt(),e=Vj(),n=nk(),r=Gl(),i=!r("symmetricDifference")||!n("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),EO}Wj();var IO={},ty,PO;function Bj(){if(PO)return ty;PO=1;var t=Ul(),e=xo().add,n=zE(),r=Yl(),i=zl();return ty=function(s){var a=t(this),l=r(s).getIterator(),u=n(a);return i(l,function(c){e(u,c)}),u},ty}var OO;function jj(){if(OO)return IO;OO=1;var t=wt(),e=Bj(),n=nk(),r=Gl(),i=!r("union")||!n("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),IO}jj();var xO={},AO={},ny,HO;function Uj(){if(HO)return ny;HO=1;var t=ef(),e=TypeError;return ny=function(n,r){if(t(r,n))return n;throw new e("Incorrect invocation")},ny}var ry,NO;function zj(){if(NO)return ry;NO=1;var t=hn();return ry=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),ry}var iy,DO;function rk(){if(DO)return iy;DO=1;var t=mi(),e=fn(),n=Tc(),r=VE(),i=zj(),o=r("IE_PROTO"),s=Object,a=s.prototype;return iy=i?s.getPrototypeOf:function(l){var u=n(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},iy}var oy,kO;function Yj(){if(kO)return oy;kO=1;var t=UD(),e=Ta();return oy=function(n,r,i){return i.get&&t(i.get,r,{getter:!0}),i.set&&t(i.set,r,{setter:!0}),e.f(n,r,i)},oy}var sy={},ay,LO;function Gj(){if(LO)return ay;LO=1;var t=zD(),e=jE();return ay=Object.keys||function(r){return t(r,e)},ay}var FO;function qj(){if(FO)return sy;FO=1;var t=fi(),e=BD(),n=Ta(),r=gn(),i=Jd(),o=Gj();return sy.f=t&&!e?Object.defineProperties:function(a,l){r(a);for(var u=i(l),c=o(l),h=c.length,d=0,f;h>d;)n.f(a,f=c[d++],u[f]);return a},sy}var ly,$O;function ik(){if($O)return ly;$O=1;var t=_c();return ly=t("document","documentElement"),ly}var uy,VO;function YE(){if(VO)return uy;VO=1;var t=gn(),e=qj(),n=jE(),r=WE(),i=ik(),o=$E(),s=VE(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},f=function(C){return l+c+a+C+l+"/"+c+a},g=function(C){C.write(f("")),C.close();var T=C.parentWindow.Object;return C=null,T},v=function(){var C=o("iframe"),T="java"+c+":",A;return C.style.display="none",i.appendChild(C),C.src=String(T),A=C.contentWindow.document,A.open(),A.write(f("document.F=Object")),A.close(),A.F},y,E=function(){try{y=new ActiveXObject("htmlfile")}catch{}E=typeof document<"u"?document.domain&&y?g(y):v():g(y);for(var C=n.length;C--;)delete E[u][n[C]];return E()};return r[h]=!0,uy=Object.create||function(T,A){var F;return T!==null?(d[u]=t(T),F=new d,d[u]=null,F[h]=T):F=E(),A===void 0?F:e.f(F,A)},uy}var cy,WO;function ok(){if(WO)return cy;WO=1;var t=hn(),e=fn(),n=gi(),r=YE(),i=rk(),o=BE(),s=Ui(),a=_a(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var f=!n(c)||t(function(){var g={};return c[l].call(g)!==g});return f?c={}:a&&(c=r(c)),e(c[l])||o(c,l,function(){return this}),cy={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},cy}var BO;function Kj(){if(BO)return AO;BO=1;var t=wt(),e=nn(),n=Uj(),r=gn(),i=fn(),o=rk(),s=Yj(),a=tk(),l=hn(),u=mi(),c=Ui(),h=ok().IteratorPrototype,d=fi(),f=_a(),g="constructor",v="Iterator",y=c("toStringTag"),E=TypeError,C=e[v],T=f||!i(C)||C.prototype!==h||!l(function(){C({})}),A=function(){if(n(this,h),o(this)===h)throw new E("Abstract class Iterator not directly constructable")},F=function(I,O){d?s(h,I,{configurable:!0,get:function(){return O},set:function(Y){if(r(this),this===h)throw new E("You can't redefine this property");u(this,I)?this[I]=Y:a(this,I,Y)}}):h[I]=O};return u(h,y)||F(y,v),(T||!u(h,g)||h[g]===Object)&&F(g,A),A.prototype=h,t({global:!0,constructor:!0,forced:T},{Iterator:A}),AO}var jO;function Xj(){return jO||(jO=1,Kj()),xO}Xj();var UO={},zO={},hy,YO;function Zj(){if(YO)return hy;YO=1;var t=BE();return hy=function(e,n,r){for(var i in n)t(e,i,n[i],r);return e},hy}var dy,GO;function Qj(){return GO||(GO=1,dy=function(t,e){return{value:t,done:e}}),dy}var fy,qO;function Jj(){if(qO)return fy;qO=1;var t=_r();return fy=function(e,n,r){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{r=t(e[i].iterator,n,r)}catch(o){n="throw",r=o}if(n==="throw")throw r;return r},fy}var gy,KO;function GE(){if(KO)return gy;KO=1;var t=dn(),e=YE(),n=Mc(),r=Zj(),i=Ui(),o=jD(),s=tf(),a=ok().IteratorPrototype,l=Qj(),u=_r(),c=Jj(),h=i("toStringTag"),d="IteratorHelper",f="WrapForValidIterator",g="normal",v="throw",y=o.set,E=function(A){var F=o.getterFor(A?f:d);return r(e(a),{next:function(){var O=F(this);if(A)return O.nextHandler();if(O.done)return l(void 0,!0);try{var Y=O.nextHandler();return O.returnHandlerResult?Y:l(Y,O.done)}catch(U){throw O.done=!0,U}},return:function(){var I=F(this),O=I.iterator;if(I.done=!0,A){var Y=s(O,"return");return Y?t(Y,O):l(void 0,!0)}if(I.inner)try{u(I.inner.iterator,g)}catch(U){return u(O,v,U)}if(I.openIters)try{c(I.openIters,g)}catch(U){return u(O,v,U)}return O&&u(O,g),l(void 0,!0)}})},C=E(!0),T=E(!1);return n(T,h,"Iterator Helper"),gy=function(A,F,I){var O=function(U,W){W?(W.iterator=U.iterator,W.next=U.next):W=U,W.type=F?f:d,W.returnHandlerResult=!!I,W.nextHandler=A,W.counter=0,W.done=!1,y(this,W)};return O.prototype=F?C:T,O},gy}var my,XO;function sk(){if(XO)return my;XO=1;var t=gn(),e=_r();return my=function(n,r,i,o){try{return o?r(t(i)[0],i[1]):r(i)}catch(s){e(n,"throw",s)}},my}var py,ZO;function qE(){return ZO||(ZO=1,py=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}}),py}var wy,QO;function Ma(){if(QO)return wy;QO=1;var t=nn();return wy=function(e,n){var r=t.Iterator,i=r&&r.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof n||(s=!1)}if(!s)return o},wy}var JO;function eU(){if(JO)return zO;JO=1;var t=wt(),e=dn(),n=Er(),r=gn(),i=Ao(),o=GE(),s=sk(),a=_a(),l=_r(),u=qE(),c=Ma(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),f=a||h||d,g=o(function(){for(var v=this.iterator,y=this.predicate,E=this.next,C,T,A;;){if(C=r(e(E,v)),T=this.done=!!C.done,T)return;if(A=C.value,s(v,y,[A,this.counter++],!0))return A}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{filter:function(y){r(this);try{n(y)}catch(E){l(this,"throw",E)}return d?e(d,this,y):new g(i(this),{predicate:y})}}),zO}var ex;function tU(){return ex||(ex=1,eU()),UO}tU();var tx={},nx={},rx;function nU(){if(rx)return nx;rx=1;var t=wt(),e=dn(),n=Pc(),r=Er(),i=gn(),o=Ao(),s=_r(),a=Ma(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;n(h,function(f){c(f,d++)},{IS_RECORD:!0})}}),nx}var ix;function rU(){return ix||(ix=1,nU()),tx}rU();var ox={},sx={},ax;function iU(){if(ax)return sx;ax=1;var t=wt(),e=dn(),n=Er(),r=gn(),i=Ao(),o=GE(),s=sk(),a=_r(),l=qE(),u=Ma(),c=_a(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),f=c||h||d,g=o(function(){var v=this.iterator,y=r(e(this.next,v)),E=this.done=!!y.done;if(!E)return s(v,this.mapper,[y.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:f},{map:function(y){r(this);try{n(y)}catch(E){a(this,"throw",E)}return d?e(d,this,y):new g(i(this),{mapper:y})}}),sx}var lx;function oU(){return lx||(lx=1,iU()),ox}oU();var ux={},cx={},vy,hx;function KE(){if(hx)return vy;hx=1;var t=rn();return vy=t([].slice),vy}var Cy,dx;function ak(){if(dx)return Cy;dx=1;var t=TypeError;return Cy=function(e,n){if(e<n)throw new t("Not enough arguments");return e},Cy}var yy,fx;function sU(){if(fx)return yy;fx=1;var t=Yp();return yy=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),yy}var by,gx;function lk(){if(gx)return by;gx=1;var t=nn(),e=Yp(),n=jl(),r=function(i){return e.slice(0,i.length)===i};return by=function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),by}var Sy,mx;function aU(){if(mx)return Sy;mx=1;var t=lk();return Sy=t==="NODE",Sy}var Ry,px;function uk(){if(px)return Ry;px=1;var t=nn(),e=rf(),n=JD(),r=fn(),i=mi(),o=hn(),s=ik(),a=KE(),l=$E(),u=ak(),c=sU(),h=aU(),d=t.setImmediate,f=t.clearImmediate,g=t.process,v=t.Dispatch,y=t.Function,E=t.MessageChannel,C=t.String,T=0,A={},F="onreadystatechange",I,O,Y,U;o(function(){I=t.location});var W=function(te){if(i(A,te)){var ae=A[te];delete A[te],ae()}},Z=function(te){return function(){W(te)}},Q=function(te){W(te.data)},oe=function(te){t.postMessage(C(te),I.protocol+"//"+I.host)};return(!d||!f)&&(d=function(ae){u(arguments.length,1);var ft=r(ae)?ae:y(ae),be=a(arguments,1);return A[++T]=function(){e(ft,void 0,be)},O(T),T},f=function(ae){delete A[ae]},h?O=function(te){g.nextTick(Z(te))}:v&&v.now?O=function(te){v.now(Z(te))}:E&&!c?(Y=new E,U=Y.port2,Y.port1.onmessage=Q,O=n(U.postMessage,U)):t.addEventListener&&r(t.postMessage)&&!t.importScripts&&I&&I.protocol!=="file:"&&!o(oe)?(O=oe,t.addEventListener("message",Q,!1)):F in l("script")?O=function(te){s.appendChild(l("script"))[F]=function(){s.removeChild(this),W(te)}}:O=function(te){setTimeout(Z(te),0)}),Ry={set:d,clear:f},Ry}var wx;function lU(){if(wx)return cx;wx=1;var t=wt(),e=nn(),n=uk().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),cx}var vx={},Ey,Cx;function uU(){if(Cx)return Ey;Cx=1;var t=nn(),e=rf(),n=fn(),r=lk(),i=Yp(),o=KE(),s=ak(),a=t.Function,l=/MSIE .\./.test(i)||r==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return Ey=function(u,c){var h=c?2:1;return l?function(d,f){var g=s(arguments.length,1)>h,v=n(d)?d:a(d),y=g?o(arguments,h):[],E=g?function(){e(v,this,y)}:v;return c?u(E,f):u(E)}:u},Ey}var yx;function cU(){if(yx)return vx;yx=1;var t=wt(),e=nn(),n=uk().set,r=uU(),i=e.setImmediate?r(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),vx}var bx;function hU(){return bx||(bx=1,lU(),cU()),ux}hU();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:ck,setPrototypeOf:Sx,isFrozen:dU,getPrototypeOf:fU,getOwnPropertyDescriptor:gU}=Object;let{freeze:tr,seal:hi,create:hk}=Object,{apply:gR,construct:mR}=typeof Reflect<"u"&&Reflect;tr||(tr=function(e){return e});hi||(hi=function(e){return e});gR||(gR=function(e,n,r){return e.apply(n,r)});mR||(mR=function(e,n){return new e(...n)});const xf=nr(Array.prototype.forEach),mU=nr(Array.prototype.lastIndexOf),Rx=nr(Array.prototype.pop),Uc=nr(Array.prototype.push),pU=nr(Array.prototype.splice),mm=nr(String.prototype.toLowerCase),_y=nr(String.prototype.toString),Ex=nr(String.prototype.match),zc=nr(String.prototype.replace),wU=nr(String.prototype.indexOf),vU=nr(String.prototype.trim),Oi=nr(Object.prototype.hasOwnProperty),zn=nr(RegExp.prototype.test),Yc=CU(TypeError);function nr(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return gR(t,e,r)}}function CU(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return mR(t,n)}}function $e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:mm;Sx&&Sx(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(dU(e)||(e[r]=o),i=o)}t[i]=!0}return t}function yU(t){for(let e=0;e<t.length;e++)Oi(t,e)||(t[e]=null);return t}function ts(t){const e=hk(null);for(const[n,r]of ck(t))Oi(t,n)&&(Array.isArray(r)?e[n]=yU(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=ts(r):e[n]=r);return e}function Gc(t,e){for(;t!==null;){const r=gU(t,e);if(r){if(r.get)return nr(r.get);if(typeof r.value=="function")return nr(r.value)}t=fU(t)}function n(){return null}return n}const _x=tr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ty=tr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),My=tr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),bU=tr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Iy=tr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),SU=tr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Tx=tr(["#text"]),Mx=tr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Py=tr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ix=tr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Af=tr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),RU=hi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),EU=hi(/<%[\w\W]*|[\w\W]*%>/gm),_U=hi(/\$\{[\w\W]*/gm),TU=hi(/^data-[\-\w.\u00B7-\uFFFF]+$/),MU=hi(/^aria-[\-\w]+$/),dk=hi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IU=hi(/^(?:\w+script|data):/i),PU=hi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),fk=hi(/^html$/i),OU=hi(/^[a-z][.\w]*(-[.\w]+)+$/i);var Px=Object.freeze({__proto__:null,ARIA_ATTR:MU,ATTR_WHITESPACE:PU,CUSTOM_ELEMENT:OU,DATA_ATTR:TU,DOCTYPE_NAME:fk,ERB_EXPR:EU,IS_ALLOWED_URI:dk,IS_SCRIPT_OR_DATA:IU,MUSTACHE_EXPR:RU,TMPLIT_EXPR:_U});const qc={element:1,text:3,progressingInstruction:7,comment:8,document:9},xU=function(){return typeof window>"u"?null:window},AU=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Ox=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function gk(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xU();const e=ve=>gk(ve);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==qc.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,v=Gc(g,"cloneNode"),y=Gc(g,"remove"),E=Gc(g,"nextSibling"),C=Gc(g,"childNodes"),T=Gc(g,"parentNode");if(typeof s=="function"){const ve=n.createElement("template");ve.content&&ve.content.ownerDocument&&(n=ve.content.ownerDocument)}let A,F="";const{implementation:I,createNodeIterator:O,createDocumentFragment:Y,getElementsByTagName:U}=n,{importNode:W}=r;let Z=Ox();e.isSupported=typeof ck=="function"&&typeof T=="function"&&I&&I.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Q,ERB_EXPR:oe,TMPLIT_EXPR:te,DATA_ATTR:ae,ARIA_ATTR:ft,IS_SCRIPT_OR_DATA:be,ATTR_WHITESPACE:He,CUSTOM_ELEMENT:gt}=Px;let{IS_ALLOWED_URI:Xt}=Px,Ke=null;const m=$e({},[..._x,...Ty,...My,...Iy,...Tx]);let w=null;const p=$e({},[...Mx,...Py,...Ix,...Af]);let _=Object.seal(hk(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),H=null,V=null,G=!0,K=!0,b=!1,R=!0,S=!1,L=!0,P=!1,D=!1,j=!1,x=!1,k=!1,B=!1,$=!0,z=!1;const se="user-content-";let ce=!0,Ee=!1,ke={},je=null;const Re=$e({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Le=null;const Rt=$e({},["audio","video","img","source","image","track"]);let yi=null;const Lo=$e({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ur="http://www.w3.org/1998/Math/MathML",Et="http://www.w3.org/2000/svg",sn="http://www.w3.org/1999/xhtml";let vt=sn,_t=!1,Fe=null;const zr=$e({},[Ur,Et,sn],_y);let Oa=$e({},["mi","mo","mn","ms","mtext"]),xa=$e({},["annotation-xml"]);const RW=$e({},["title","style","font","a","script"]);let Wc=null;const EW=["application/xhtml+xml","text/html"],_W="text/html";let Sn=null,tu=null;const TW=n.createElement("form"),$M=function(N){return N instanceof RegExp||N instanceof Function},Gw=function(){let N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(tu&&tu===N)){if((!N||typeof N!="object")&&(N={}),N=ts(N),Wc=EW.indexOf(N.PARSER_MEDIA_TYPE)===-1?_W:N.PARSER_MEDIA_TYPE,Sn=Wc==="application/xhtml+xml"?_y:mm,Ke=Oi(N,"ALLOWED_TAGS")?$e({},N.ALLOWED_TAGS,Sn):m,w=Oi(N,"ALLOWED_ATTR")?$e({},N.ALLOWED_ATTR,Sn):p,Fe=Oi(N,"ALLOWED_NAMESPACES")?$e({},N.ALLOWED_NAMESPACES,_y):zr,yi=Oi(N,"ADD_URI_SAFE_ATTR")?$e(ts(Lo),N.ADD_URI_SAFE_ATTR,Sn):Lo,Le=Oi(N,"ADD_DATA_URI_TAGS")?$e(ts(Rt),N.ADD_DATA_URI_TAGS,Sn):Rt,je=Oi(N,"FORBID_CONTENTS")?$e({},N.FORBID_CONTENTS,Sn):Re,H=Oi(N,"FORBID_TAGS")?$e({},N.FORBID_TAGS,Sn):ts({}),V=Oi(N,"FORBID_ATTR")?$e({},N.FORBID_ATTR,Sn):ts({}),ke=Oi(N,"USE_PROFILES")?N.USE_PROFILES:!1,G=N.ALLOW_ARIA_ATTR!==!1,K=N.ALLOW_DATA_ATTR!==!1,b=N.ALLOW_UNKNOWN_PROTOCOLS||!1,R=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,S=N.SAFE_FOR_TEMPLATES||!1,L=N.SAFE_FOR_XML!==!1,P=N.WHOLE_DOCUMENT||!1,x=N.RETURN_DOM||!1,k=N.RETURN_DOM_FRAGMENT||!1,B=N.RETURN_TRUSTED_TYPE||!1,j=N.FORCE_BODY||!1,$=N.SANITIZE_DOM!==!1,z=N.SANITIZE_NAMED_PROPS||!1,ce=N.KEEP_CONTENT!==!1,Ee=N.IN_PLACE||!1,Xt=N.ALLOWED_URI_REGEXP||dk,vt=N.NAMESPACE||sn,Oa=N.MATHML_TEXT_INTEGRATION_POINTS||Oa,xa=N.HTML_INTEGRATION_POINTS||xa,_=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&$M(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(_.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&$M(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(_.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(_.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),S&&(K=!1),k&&(x=!0),ke&&(Ke=$e({},Tx),w=[],ke.html===!0&&($e(Ke,_x),$e(w,Mx)),ke.svg===!0&&($e(Ke,Ty),$e(w,Py),$e(w,Af)),ke.svgFilters===!0&&($e(Ke,My),$e(w,Py),$e(w,Af)),ke.mathMl===!0&&($e(Ke,Iy),$e(w,Ix),$e(w,Af))),N.ADD_TAGS&&(Ke===m&&(Ke=ts(Ke)),$e(Ke,N.ADD_TAGS,Sn)),N.ADD_ATTR&&(w===p&&(w=ts(w)),$e(w,N.ADD_ATTR,Sn)),N.ADD_URI_SAFE_ATTR&&$e(yi,N.ADD_URI_SAFE_ATTR,Sn),N.FORBID_CONTENTS&&(je===Re&&(je=ts(je)),$e(je,N.FORBID_CONTENTS,Sn)),ce&&(Ke["#text"]=!0),P&&$e(Ke,["html","head","body"]),Ke.table&&($e(Ke,["tbody"]),delete H.tbody),N.TRUSTED_TYPES_POLICY){if(typeof N.TRUSTED_TYPES_POLICY.createHTML!="function")throw Yc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof N.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Yc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');A=N.TRUSTED_TYPES_POLICY,F=A.createHTML("")}else A===void 0&&(A=AU(f,i)),A!==null&&typeof F=="string"&&(F=A.createHTML(""));tr&&tr(N),tu=N}},VM=$e({},[...Ty,...My,...bU]),WM=$e({},[...Iy,...SU]),MW=function(N){let ee=T(N);(!ee||!ee.tagName)&&(ee={namespaceURI:vt,tagName:"template"});const me=mm(N.tagName),At=mm(ee.tagName);return Fe[N.namespaceURI]?N.namespaceURI===Et?ee.namespaceURI===sn?me==="svg":ee.namespaceURI===Ur?me==="svg"&&(At==="annotation-xml"||Oa[At]):!!VM[me]:N.namespaceURI===Ur?ee.namespaceURI===sn?me==="math":ee.namespaceURI===Et?me==="math"&&xa[At]:!!WM[me]:N.namespaceURI===sn?ee.namespaceURI===Et&&!xa[At]||ee.namespaceURI===Ur&&!Oa[At]?!1:!WM[me]&&(RW[me]||!VM[me]):!!(Wc==="application/xhtml+xml"&&Fe[N.namespaceURI]):!1},Gi=function(N){Uc(e.removed,{element:N});try{T(N).removeChild(N)}catch{y(N)}},nu=function(N,ee){try{Uc(e.removed,{attribute:ee.getAttributeNode(N),from:ee})}catch{Uc(e.removed,{attribute:null,from:ee})}if(ee.removeAttribute(N),N==="is")if(x||k)try{Gi(ee)}catch{}else try{ee.setAttribute(N,"")}catch{}},BM=function(N){let ee=null,me=null;if(j)N="<remove></remove>"+N;else{const pn=Ex(N,/^[\r\n\t ]+/);me=pn&&pn[0]}Wc==="application/xhtml+xml"&&vt===sn&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");const At=A?A.createHTML(N):N;if(vt===sn)try{ee=new d().parseFromString(At,Wc)}catch{}if(!ee||!ee.documentElement){ee=I.createDocument(vt,"template",null);try{ee.documentElement.innerHTML=_t?F:At}catch{}}const An=ee.body||ee.documentElement;return N&&me&&An.insertBefore(n.createTextNode(me),An.childNodes[0]||null),vt===sn?U.call(ee,P?"html":"body")[0]:P?ee.documentElement:An},jM=function(N){return O.call(N.ownerDocument||N,N,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},qw=function(N){return N instanceof h&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof c)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},UM=function(N){return typeof a=="function"&&N instanceof a};function Fo(ve,N,ee){xf(ve,me=>{me.call(e,N,ee,tu)})}const zM=function(N){let ee=null;if(Fo(Z.beforeSanitizeElements,N,null),qw(N))return Gi(N),!0;const me=Sn(N.nodeName);if(Fo(Z.uponSanitizeElement,N,{tagName:me,allowedTags:Ke}),L&&N.hasChildNodes()&&!UM(N.firstElementChild)&&zn(/<[/\w!]/g,N.innerHTML)&&zn(/<[/\w!]/g,N.textContent)||N.nodeType===qc.progressingInstruction||L&&N.nodeType===qc.comment&&zn(/<[/\w]/g,N.data))return Gi(N),!0;if(!Ke[me]||H[me]){if(!H[me]&&GM(me)&&(_.tagNameCheck instanceof RegExp&&zn(_.tagNameCheck,me)||_.tagNameCheck instanceof Function&&_.tagNameCheck(me)))return!1;if(ce&&!je[me]){const At=T(N)||N.parentNode,An=C(N)||N.childNodes;if(An&&At){const pn=An.length;for(let ir=pn-1;ir>=0;--ir){const $o=v(An[ir],!0);$o.__removalCount=(N.__removalCount||0)+1,At.insertBefore($o,E(N))}}}return Gi(N),!0}return N instanceof l&&!MW(N)||(me==="noscript"||me==="noembed"||me==="noframes")&&zn(/<\/no(script|embed|frames)/i,N.innerHTML)?(Gi(N),!0):(S&&N.nodeType===qc.text&&(ee=N.textContent,xf([Q,oe,te],At=>{ee=zc(ee,At," ")}),N.textContent!==ee&&(Uc(e.removed,{element:N.cloneNode()}),N.textContent=ee)),Fo(Z.afterSanitizeElements,N,null),!1)},YM=function(N,ee,me){if($&&(ee==="id"||ee==="name")&&(me in n||me in TW))return!1;if(!(K&&!V[ee]&&zn(ae,ee))){if(!(G&&zn(ft,ee))){if(!w[ee]||V[ee]){if(!(GM(N)&&(_.tagNameCheck instanceof RegExp&&zn(_.tagNameCheck,N)||_.tagNameCheck instanceof Function&&_.tagNameCheck(N))&&(_.attributeNameCheck instanceof RegExp&&zn(_.attributeNameCheck,ee)||_.attributeNameCheck instanceof Function&&_.attributeNameCheck(ee))||ee==="is"&&_.allowCustomizedBuiltInElements&&(_.tagNameCheck instanceof RegExp&&zn(_.tagNameCheck,me)||_.tagNameCheck instanceof Function&&_.tagNameCheck(me))))return!1}else if(!yi[ee]){if(!zn(Xt,zc(me,He,""))){if(!((ee==="src"||ee==="xlink:href"||ee==="href")&&N!=="script"&&wU(me,"data:")===0&&Le[N])){if(!(b&&!zn(be,zc(me,He,"")))){if(me)return!1}}}}}}return!0},GM=function(N){return N!=="annotation-xml"&&Ex(N,gt)},qM=function(N){Fo(Z.beforeSanitizeAttributes,N,null);const{attributes:ee}=N;if(!ee||qw(N))return;const me={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:w,forceKeepAttr:void 0};let At=ee.length;for(;At--;){const An=ee[At],{name:pn,namespaceURI:ir,value:$o}=An,Bc=Sn(pn),Kw=$o;let Hn=pn==="value"?Kw:vU(Kw);if(me.attrName=Bc,me.attrValue=Hn,me.keepAttr=!0,me.forceKeepAttr=void 0,Fo(Z.uponSanitizeAttribute,N,me),Hn=me.attrValue,z&&(Bc==="id"||Bc==="name")&&(nu(pn,N),Hn=se+Hn),L&&zn(/((--!?|])>)|<\/(style|title)/i,Hn)){nu(pn,N);continue}if(me.forceKeepAttr)continue;if(!me.keepAttr){nu(pn,N);continue}if(!R&&zn(/\/>/i,Hn)){nu(pn,N);continue}S&&xf([Q,oe,te],XM=>{Hn=zc(Hn,XM," ")});const KM=Sn(N.nodeName);if(!YM(KM,Bc,Hn)){nu(pn,N);continue}if(A&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!ir)switch(f.getAttributeType(KM,Bc)){case"TrustedHTML":{Hn=A.createHTML(Hn);break}case"TrustedScriptURL":{Hn=A.createScriptURL(Hn);break}}if(Hn!==Kw)try{ir?N.setAttributeNS(ir,pn,Hn):N.setAttribute(pn,Hn),qw(N)?Gi(N):Rx(e.removed)}catch{nu(pn,N)}}Fo(Z.afterSanitizeAttributes,N,null)},IW=function ve(N){let ee=null;const me=jM(N);for(Fo(Z.beforeSanitizeShadowDOM,N,null);ee=me.nextNode();)Fo(Z.uponSanitizeShadowNode,ee,null),zM(ee),qM(ee),ee.content instanceof o&&ve(ee.content);Fo(Z.afterSanitizeShadowDOM,N,null)};return e.sanitize=function(ve){let N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ee=null,me=null,At=null,An=null;if(_t=!ve,_t&&(ve="<!-->"),typeof ve!="string"&&!UM(ve))if(typeof ve.toString=="function"){if(ve=ve.toString(),typeof ve!="string")throw Yc("dirty is not a string, aborting")}else throw Yc("toString is not a function");if(!e.isSupported)return ve;if(D||Gw(N),e.removed=[],typeof ve=="string"&&(Ee=!1),Ee){if(ve.nodeName){const $o=Sn(ve.nodeName);if(!Ke[$o]||H[$o])throw Yc("root node is forbidden and cannot be sanitized in-place")}}else if(ve instanceof a)ee=BM("<!---->"),me=ee.ownerDocument.importNode(ve,!0),me.nodeType===qc.element&&me.nodeName==="BODY"||me.nodeName==="HTML"?ee=me:ee.appendChild(me);else{if(!x&&!S&&!P&&ve.indexOf("<")===-1)return A&&B?A.createHTML(ve):ve;if(ee=BM(ve),!ee)return x?null:B?F:""}ee&&j&&Gi(ee.firstChild);const pn=jM(Ee?ve:ee);for(;At=pn.nextNode();)zM(At),qM(At),At.content instanceof o&&IW(At.content);if(Ee)return ve;if(x){if(k)for(An=Y.call(ee.ownerDocument);ee.firstChild;)An.appendChild(ee.firstChild);else An=ee;return(w.shadowroot||w.shadowrootmode)&&(An=W.call(r,An,!0)),An}let ir=P?ee.outerHTML:ee.innerHTML;return P&&Ke["!doctype"]&&ee.ownerDocument&&ee.ownerDocument.doctype&&ee.ownerDocument.doctype.name&&zn(fk,ee.ownerDocument.doctype.name)&&(ir="<!DOCTYPE "+ee.ownerDocument.doctype.name+`>
`+ir),S&&xf([Q,oe,te],$o=>{ir=zc(ir,$o," ")}),A&&B?A.createHTML(ir):ir},e.setConfig=function(){let ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Gw(ve),D=!0},e.clearConfig=function(){tu=null,D=!1},e.isValidAttribute=function(ve,N,ee){tu||Gw({});const me=Sn(ve),At=Sn(N);return YM(me,At,ee)},e.addHook=function(ve,N){typeof N=="function"&&Uc(Z[ve],N)},e.removeHook=function(ve,N){if(N!==void 0){const ee=mU(Z[ve],N);return ee===-1?void 0:pU(Z[ve],ee,1)[0]}return Rx(Z[ve])},e.removeHooks=function(ve){Z[ve]=[]},e.removeAllHooks=function(){Z=Ox()},e}var HU=gk();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var mk;function X(){return mk.apply(null,arguments)}function NU(t){mk=t}function Wi(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function xl(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function nt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function XE(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(nt(t,e))return!1;return!0}function mr(t){return t===void 0}function Ss(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function af(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function pk(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function sa(t,e){for(var n in e)nt(e,n)&&(t[n]=e[n]);return nt(e,"toString")&&(t.toString=e.toString),nt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Ho(t,e,n,r){return $k(t,e,n,r,!0).utc()}function DU(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Oe(t){return t._pf==null&&(t._pf=DU()),t._pf}var pR;Array.prototype.some?pR=Array.prototype.some:pR=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function ZE(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Oe(t),n=pR.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function Kp(t){var e=Ho(NaN);return t!=null?sa(Oe(e),t):Oe(e).userInvalidated=!0,e}var xx=X.momentProperties=[],Oy=!1;function QE(t,e){var n,r,i,o=xx.length;if(mr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),mr(e._i)||(t._i=e._i),mr(e._f)||(t._f=e._f),mr(e._l)||(t._l=e._l),mr(e._strict)||(t._strict=e._strict),mr(e._tzm)||(t._tzm=e._tzm),mr(e._isUTC)||(t._isUTC=e._isUTC),mr(e._offset)||(t._offset=e._offset),mr(e._pf)||(t._pf=Oe(e)),mr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=xx[n],i=e[r],mr(i)||(t[r]=i);return t}function lf(t){QE(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Oy===!1&&(Oy=!0,X.updateOffset(this),Oy=!1)}function Bi(t){return t instanceof lf||t!=null&&t._isAMomentObject!=null}function wk(t){X.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function pi(t,e){var n=!0;return sa(function(){if(X.deprecationHandler!=null&&X.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])nt(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}wk(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var Ax={};function vk(t,e){X.deprecationHandler!=null&&X.deprecationHandler(t,e),Ax[t]||(wk(e),Ax[t]=!0)}X.suppressDeprecationWarnings=!1;X.deprecationHandler=null;function No(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function kU(t){var e,n;for(n in t)nt(t,n)&&(e=t[n],No(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function wR(t,e){var n=sa({},t),r;for(r in e)nt(e,r)&&(xl(t[r])&&xl(e[r])?(n[r]={},sa(n[r],t[r]),sa(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)nt(t,r)&&!nt(e,r)&&xl(t[r])&&(n[r]=sa({},n[r]));return n}function JE(t){t!=null&&this.set(t)}var vR;Object.keys?vR=Object.keys:vR=function(t){var e,n=[];for(e in t)nt(t,e)&&n.push(e);return n};var LU={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function FU(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return No(r)?r.call(e,n):r}function Po(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var e0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Hf=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,xy={},oc={};function Ce(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(oc[t]=i),e&&(oc[e[0]]=function(){return Po(i.apply(this,arguments),e[1],e[2])}),n&&(oc[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function $U(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function VU(t){var e=t.match(e0),n,r;for(n=0,r=e.length;n<r;n++)oc[e[n]]?e[n]=oc[e[n]]:e[n]=$U(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=No(e[s])?e[s].call(i,t):e[s];return o}}function pm(t,e){return t.isValid()?(e=Ck(e,t.localeData()),xy[e]=xy[e]||VU(e),xy[e](t)):t.localeData().invalidDate()}function Ck(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Hf.lastIndex=0;n>=0&&Hf.test(t);)t=t.replace(Hf,r),Hf.lastIndex=0,n-=1;return t}var WU={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function BU(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(e0).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var jU="Invalid date";function UU(){return this._invalidDate}var zU="%d",YU=/\d{1,2}/;function GU(t){return this._ordinal.replace("%d",t)}var qU={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function KU(t,e,n,r){var i=this._relativeTime[n];return No(i)?i(t,e,n,r):i.replace(/%d/i,t)}function XU(t,e){var n=this._relativeTime[t>0?"future":"past"];return No(n)?n(e):n.replace(/%s/i,e)}var Hx={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function wi(t){return typeof t=="string"?Hx[t]||Hx[t.toLowerCase()]:void 0}function t0(t){var e={},n,r;for(r in t)nt(t,r)&&(n=wi(r),n&&(e[n]=t[r]));return e}var ZU={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function QU(t){var e=[],n;for(n in t)nt(t,n)&&e.push({unit:n,priority:ZU[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var yk=/\d/,jr=/\d\d/,bk=/\d{3}/,n0=/\d{4}/,Xp=/[+-]?\d{6}/,xt=/\d\d?/,Sk=/\d\d\d\d?/,Rk=/\d\d\d\d\d\d?/,Zp=/\d{1,3}/,r0=/\d{1,4}/,Qp=/[+-]?\d{1,6}/,Oc=/\d+/,Jp=/[+-]?\d+/,JU=/Z|[+-]\d\d:?\d\d/gi,ew=/Z|[+-]\d\d(?::?\d\d)?/gi,ez=/[+-]?\d+(\.\d{1,3})?/,uf=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,xc=/^[1-9]\d?/,i0=/^([1-9]\d|\d)/,zm;zm={};function ue(t,e,n){zm[t]=No(e)?e:function(r,i){return r&&n?n:e}}function tz(t,e){return nt(zm,t)?zm[t](e._strict,e._locale):new RegExp(nz(t))}function nz(t){return Cs(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Cs(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function oi(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Ye(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=oi(e)),n}var CR={};function mt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Ss(e)&&(r=function(o,s){s[e]=Ye(o)}),i=t.length,n=0;n<i;n++)CR[t[n]]=r}function cf(t,e){mt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function rz(t,e,n){e!=null&&nt(CR,t)&&CR[t](e,n._a,n,t)}function tw(t){return t%4===0&&t%100!==0||t%400===0}var Bn=0,ds=1,yo=2,yn=3,Fi=4,fs=5,El=6,iz=7,oz=8;Ce("Y",0,0,function(){var t=this.year();return t<=9999?Po(t,4):"+"+t});Ce(0,["YY",2],0,function(){return this.year()%100});Ce(0,["YYYY",4],0,"year");Ce(0,["YYYYY",5],0,"year");Ce(0,["YYYYYY",6,!0],0,"year");ue("Y",Jp);ue("YY",xt,jr);ue("YYYY",r0,n0);ue("YYYYY",Qp,Xp);ue("YYYYYY",Qp,Xp);mt(["YYYYY","YYYYYY"],Bn);mt("YYYY",function(t,e){e[Bn]=t.length===2?X.parseTwoDigitYear(t):Ye(t)});mt("YY",function(t,e){e[Bn]=X.parseTwoDigitYear(t)});mt("Y",function(t,e){e[Bn]=parseInt(t,10)});function rd(t){return tw(t)?366:365}X.parseTwoDigitYear=function(t){return Ye(t)+(Ye(t)>68?1900:2e3)};var Ek=Ac("FullYear",!0);function sz(){return tw(this.year())}function Ac(t,e){return function(n){return n!=null?(_k(this,t,n),X.updateOffset(this,e),this):Pd(this,t)}}function Pd(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function _k(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!tw(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function az(t){return t=wi(t),No(this[t])?this[t]():this}function lz(t,e){if(typeof t=="object"){t=t0(t);var n=QU(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=wi(t),No(this[t]))return this[t](e);return this}function uz(t,e){return(t%e+e)%e}var Qt;Array.prototype.indexOf?Qt=Array.prototype.indexOf:Qt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function o0(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=uz(e,12);return t+=(e-n)/12,n===1?tw(t)?29:28:31-n%7%2}Ce("M",["MM",2],"Mo",function(){return this.month()+1});Ce("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ce("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",xt,xc);ue("MM",xt,jr);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});mt(["M","MM"],function(t,e){e[ds]=Ye(t)-1});mt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[ds]=i:Oe(n).invalidMonth=t});var cz="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Tk="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Mk=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,hz=uf,dz=uf;function fz(t,e){return t?Wi(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Mk).test(e)?"format":"standalone"][t.month()]:Wi(this._months)?this._months:this._months.standalone}function gz(t,e){return t?Wi(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Mk.test(e)?"format":"standalone"][t.month()]:Wi(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function mz(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Ho([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=Qt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Qt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Qt.call(this._shortMonthsParse,s),i!==-1?i:(i=Qt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Qt.call(this._longMonthsParse,s),i!==-1?i:(i=Qt.call(this._shortMonthsParse,s),i!==-1?i:null))}function pz(t,e,n){var r,i,o;if(this._monthsParseExact)return mz.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Ho([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function Ik(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Ye(e);else if(e=t.localeData().monthsParse(e),!Ss(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,o0(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function Pk(t){return t!=null?(Ik(this,t),X.updateOffset(this,!0),this):Pd(this,"Month")}function wz(){return o0(this.year(),this.month())}function vz(t){return this._monthsParseExact?(nt(this,"_monthsRegex")||Ok.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(nt(this,"_monthsShortRegex")||(this._monthsShortRegex=hz),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function Cz(t){return this._monthsParseExact?(nt(this,"_monthsRegex")||Ok.call(this),t?this._monthsStrictRegex:this._monthsRegex):(nt(this,"_monthsRegex")||(this._monthsRegex=dz),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function Ok(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=Ho([2e3,i]),s=Cs(this.monthsShort(o,"")),a=Cs(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function yz(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Od(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Ym(t,e,n){var r=7+e-n,i=(7+Od(t,0,r).getUTCDay()-e)%7;return-i+r-1}function xk(t,e,n,r,i){var o=(7+n-r)%7,s=Ym(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=rd(l)+a):a>rd(t)?(l=t+1,u=a-rd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function xd(t,e,n){var r=Ym(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+ys(s,e,n)):i>ys(t.year(),e,n)?(o=i-ys(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function ys(t,e,n){var r=Ym(t,e,n),i=Ym(t+1,e,n);return(rd(t)-r+i)/7}Ce("w",["ww",2],"wo","week");Ce("W",["WW",2],"Wo","isoWeek");ue("w",xt,xc);ue("ww",xt,jr);ue("W",xt,xc);ue("WW",xt,jr);cf(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Ye(t)});function bz(t){return xd(t,this._week.dow,this._week.doy).week}var Sz={dow:0,doy:6};function Rz(){return this._week.dow}function Ez(){return this._week.doy}function _z(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function Tz(t){var e=xd(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ce("d",0,"do","day");Ce("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ce("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ce("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ce("e",0,0,"weekday");Ce("E",0,0,"isoWeekday");ue("d",xt);ue("e",xt);ue("E",xt);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});cf(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Oe(n).invalidWeekday=t});cf(["d","e","E"],function(t,e,n,r){e[r]=Ye(t)});function Mz(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function Iz(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function s0(t,e){return t.slice(e,7).concat(t.slice(0,e))}var Pz="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ak="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Oz="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),xz=uf,Az=uf,Hz=uf;function Nz(t,e){var n=Wi(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?s0(n,this._week.dow):t?n[t.day()]:n}function Dz(t){return t===!0?s0(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function kz(t){return t===!0?s0(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function Lz(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Ho([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=Qt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Qt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Qt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Qt.call(this._weekdaysParse,s),i!==-1||(i=Qt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Qt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Qt.call(this._shortWeekdaysParse,s),i!==-1||(i=Qt.call(this._weekdaysParse,s),i!==-1)?i:(i=Qt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Qt.call(this._minWeekdaysParse,s),i!==-1||(i=Qt.call(this._weekdaysParse,s),i!==-1)?i:(i=Qt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function Fz(t,e,n){var r,i,o;if(this._weekdaysParseExact)return Lz.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Ho([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function $z(t){if(!this.isValid())return t!=null?this:NaN;var e=Pd(this,"Day");return t!=null?(t=Mz(t,this.localeData()),this.add(t-e,"d")):e}function Vz(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function Wz(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=Iz(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function Bz(t){return this._weekdaysParseExact?(nt(this,"_weekdaysRegex")||a0.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(nt(this,"_weekdaysRegex")||(this._weekdaysRegex=xz),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function jz(t){return this._weekdaysParseExact?(nt(this,"_weekdaysRegex")||a0.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(nt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Az),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Uz(t){return this._weekdaysParseExact?(nt(this,"_weekdaysRegex")||a0.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(nt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Hz),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function a0(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Ho([2e3,1]).day(o),a=Cs(this.weekdaysMin(s,"")),l=Cs(this.weekdaysShort(s,"")),u=Cs(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function l0(){return this.hours()%12||12}function zz(){return this.hours()||24}Ce("H",["HH",2],0,"hour");Ce("h",["hh",2],0,l0);Ce("k",["kk",2],0,zz);Ce("hmm",0,0,function(){return""+l0.apply(this)+Po(this.minutes(),2)});Ce("hmmss",0,0,function(){return""+l0.apply(this)+Po(this.minutes(),2)+Po(this.seconds(),2)});Ce("Hmm",0,0,function(){return""+this.hours()+Po(this.minutes(),2)});Ce("Hmmss",0,0,function(){return""+this.hours()+Po(this.minutes(),2)+Po(this.seconds(),2)});function Hk(t,e){Ce(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}Hk("a",!0);Hk("A",!1);function Nk(t,e){return e._meridiemParse}ue("a",Nk);ue("A",Nk);ue("H",xt,i0);ue("h",xt,xc);ue("k",xt,xc);ue("HH",xt,jr);ue("hh",xt,jr);ue("kk",xt,jr);ue("hmm",Sk);ue("hmmss",Rk);ue("Hmm",Sk);ue("Hmmss",Rk);mt(["H","HH"],yn);mt(["k","kk"],function(t,e,n){var r=Ye(t);e[yn]=r===24?0:r});mt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});mt(["h","hh"],function(t,e,n){e[yn]=Ye(t),Oe(n).bigHour=!0});mt("hmm",function(t,e,n){var r=t.length-2;e[yn]=Ye(t.substr(0,r)),e[Fi]=Ye(t.substr(r)),Oe(n).bigHour=!0});mt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[yn]=Ye(t.substr(0,r)),e[Fi]=Ye(t.substr(r,2)),e[fs]=Ye(t.substr(i)),Oe(n).bigHour=!0});mt("Hmm",function(t,e,n){var r=t.length-2;e[yn]=Ye(t.substr(0,r)),e[Fi]=Ye(t.substr(r))});mt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[yn]=Ye(t.substr(0,r)),e[Fi]=Ye(t.substr(r,2)),e[fs]=Ye(t.substr(i))});function Yz(t){return(t+"").toLowerCase().charAt(0)==="p"}var Gz=/[ap]\.?m?\.?/i,qz=Ac("Hours",!0);function Kz(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var Dk={calendar:LU,longDateFormat:WU,invalidDate:jU,ordinal:zU,dayOfMonthOrdinalParse:YU,relativeTime:qU,months:cz,monthsShort:Tk,week:Sz,weekdays:Pz,weekdaysMin:Oz,weekdaysShort:Ak,meridiemParse:Gz},Ht={},Kc={},Ad;function Xz(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function Nx(t){return t&&t.toLowerCase().replace("_","-")}function Zz(t){for(var e=0,n,r,i,o;e<t.length;){for(o=Nx(t[e]).split("-"),n=o.length,r=Nx(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=nw(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&Xz(o,r)>=n-1)break;n--}e++}return Ad}function Qz(t){return!!(t&&t.match("^[^/\\\\]*$"))}function nw(t){var e=null,n;if(Ht[t]===void 0&&typeof Fm<"u"&&Fm&&Fm.exports&&Qz(t))try{e=Ad._abbr,n=require,n("./locale/"+t),fa(e)}catch{Ht[t]=null}return Ht[t]}function fa(t,e){var n;return t&&(mr(e)?n=Ms(t):n=u0(t,e),n?Ad=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Ad._abbr}function u0(t,e){if(e!==null){var n,r=Dk;if(e.abbr=t,Ht[t]!=null)vk("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Ht[t]._config;else if(e.parentLocale!=null)if(Ht[e.parentLocale]!=null)r=Ht[e.parentLocale]._config;else if(n=nw(e.parentLocale),n!=null)r=n._config;else return Kc[e.parentLocale]||(Kc[e.parentLocale]=[]),Kc[e.parentLocale].push({name:t,config:e}),null;return Ht[t]=new JE(wR(r,e)),Kc[t]&&Kc[t].forEach(function(i){u0(i.name,i.config)}),fa(t),Ht[t]}else return delete Ht[t],null}function Jz(t,e){if(e!=null){var n,r,i=Dk;Ht[t]!=null&&Ht[t].parentLocale!=null?Ht[t].set(wR(Ht[t]._config,e)):(r=nw(t),r!=null&&(i=r._config),e=wR(i,e),r==null&&(e.abbr=t),n=new JE(e),n.parentLocale=Ht[t],Ht[t]=n),fa(t)}else Ht[t]!=null&&(Ht[t].parentLocale!=null?(Ht[t]=Ht[t].parentLocale,t===fa()&&fa(t)):Ht[t]!=null&&delete Ht[t]);return Ht[t]}function Ms(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Ad;if(!Wi(t)){if(e=nw(t),e)return e;t=[t]}return Zz(t)}function eY(){return vR(Ht)}function c0(t){var e,n=t._a;return n&&Oe(t).overflow===-2&&(e=n[ds]<0||n[ds]>11?ds:n[yo]<1||n[yo]>o0(n[Bn],n[ds])?yo:n[yn]<0||n[yn]>24||n[yn]===24&&(n[Fi]!==0||n[fs]!==0||n[El]!==0)?yn:n[Fi]<0||n[Fi]>59?Fi:n[fs]<0||n[fs]>59?fs:n[El]<0||n[El]>999?El:-1,Oe(t)._overflowDayOfYear&&(e<Bn||e>yo)&&(e=yo),Oe(t)._overflowWeeks&&e===-1&&(e=iz),Oe(t)._overflowWeekday&&e===-1&&(e=oz),Oe(t).overflow=e),t}var tY=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,nY=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,rY=/Z|[+-]\d\d(?::?\d\d)?/,Nf=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Ay=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],iY=/^\/?Date\((-?\d+)/i,oY=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,sY={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function kk(t){var e,n,r=t._i,i=tY.exec(r)||nY.exec(r),o,s,a,l,u=Nf.length,c=Ay.length;if(i){for(Oe(t).iso=!0,e=0,n=u;e<n;e++)if(Nf[e][1].exec(i[1])){s=Nf[e][0],o=Nf[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(Ay[e][1].exec(i[3])){a=(i[2]||" ")+Ay[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(rY.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),d0(t)}else t._isValid=!1}function aY(t,e,n,r,i,o){var s=[lY(t),Tk.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function lY(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function uY(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function cY(t,e,n){if(t){var r=Ak.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Oe(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function hY(t,e,n){if(t)return sY[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function Lk(t){var e=oY.exec(uY(t._i)),n;if(e){if(n=aY(e[4],e[3],e[2],e[5],e[6],e[7]),!cY(e[1],n,t))return;t._a=n,t._tzm=hY(e[8],e[9],e[10]),t._d=Od.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Oe(t).rfc2822=!0}else t._isValid=!1}function dY(t){var e=iY.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(kk(t),t._isValid===!1)delete t._isValid;else return;if(Lk(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:X.createFromInputFallback(t)}X.createFromInputFallback=pi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function ju(t,e,n){return t??e??n}function fY(t){var e=new Date(X.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function h0(t){var e,n,r=[],i,o,s;if(!t._d){for(i=fY(t),t._w&&t._a[yo]==null&&t._a[ds]==null&&gY(t),t._dayOfYear!=null&&(s=ju(t._a[Bn],i[Bn]),(t._dayOfYear>rd(s)||t._dayOfYear===0)&&(Oe(t)._overflowDayOfYear=!0),n=Od(s,0,t._dayOfYear),t._a[ds]=n.getUTCMonth(),t._a[yo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[yn]===24&&t._a[Fi]===0&&t._a[fs]===0&&t._a[El]===0&&(t._nextDay=!0,t._a[yn]=0),t._d=(t._useUTC?Od:yz).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[yn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Oe(t).weekdayMismatch=!0)}}function gY(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=ju(e.GG,t._a[Bn],xd(Ot(),1,4).year),r=ju(e.W,1),i=ju(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=xd(Ot(),o,s),n=ju(e.gg,t._a[Bn],u.year),r=ju(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>ys(n,o,s)?Oe(t)._overflowWeeks=!0:l!=null?Oe(t)._overflowWeekday=!0:(a=xk(n,r,i,o,s),t._a[Bn]=a.year,t._dayOfYear=a.dayOfYear)}X.ISO_8601=function(){};X.RFC_2822=function(){};function d0(t){if(t._f===X.ISO_8601){kk(t);return}if(t._f===X.RFC_2822){Lk(t);return}t._a=[],Oe(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=Ck(t._f,t._locale).match(e0)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(tz(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Oe(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),oc[o]?(r?Oe(t).empty=!1:Oe(t).unusedTokens.push(o),rz(o,r,t)):t._strict&&!r&&Oe(t).unusedTokens.push(o);Oe(t).charsLeftOver=a-l,e.length>0&&Oe(t).unusedInput.push(e),t._a[yn]<=12&&Oe(t).bigHour===!0&&t._a[yn]>0&&(Oe(t).bigHour=void 0),Oe(t).parsedDateParts=t._a.slice(0),Oe(t).meridiem=t._meridiem,t._a[yn]=mY(t._locale,t._a[yn],t._meridiem),u=Oe(t).era,u!==null&&(t._a[Bn]=t._locale.erasConvertYear(u,t._a[Bn])),h0(t),c0(t)}function mY(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function pY(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Oe(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=QE({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],d0(e),ZE(e)&&(s=!0),o+=Oe(e).charsLeftOver,o+=Oe(e).unusedTokens.length*10,Oe(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));sa(t,n||e)}function wY(t){if(!t._d){var e=t0(t._i),n=e.day===void 0?e.date:e.day;t._a=pk([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),h0(t)}}function vY(t){var e=new lf(c0(Fk(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function Fk(t){var e=t._i,n=t._f;return t._locale=t._locale||Ms(t._l),e===null||n===void 0&&e===""?Kp({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Bi(e)?new lf(c0(e)):(af(e)?t._d=e:Wi(n)?pY(t):n?d0(t):CY(t),ZE(t)||(t._d=null),t))}function CY(t){var e=t._i;mr(e)?t._d=new Date(X.now()):af(e)?t._d=new Date(e.valueOf()):typeof e=="string"?dY(t):Wi(e)?(t._a=pk(e.slice(0),function(n){return parseInt(n,10)}),h0(t)):xl(e)?wY(t):Ss(e)?t._d=new Date(e):X.createFromInputFallback(t)}function $k(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(xl(t)&&XE(t)||Wi(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,vY(o)}function Ot(t,e,n,r){return $k(t,e,n,r,!1)}var yY=pi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ot.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Kp()}),bY=pi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ot.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Kp()});function Vk(t,e){var n,r;if(e.length===1&&Wi(e[0])&&(e=e[0]),!e.length)return Ot();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function SY(){var t=[].slice.call(arguments,0);return Vk("isBefore",t)}function RY(){var t=[].slice.call(arguments,0);return Vk("isAfter",t)}var EY=function(){return Date.now?Date.now():+new Date},Xc=["year","quarter","month","week","day","hour","minute","second","millisecond"];function _Y(t){var e,n=!1,r,i=Xc.length;for(e in t)if(nt(t,e)&&!(Qt.call(Xc,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Xc[r]]){if(n)return!1;parseFloat(t[Xc[r]])!==Ye(t[Xc[r]])&&(n=!0)}return!0}function TY(){return this._isValid}function MY(){return zi(NaN)}function rw(t){var e=t0(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=_Y(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=Ms(),this._bubble()}function wm(t){return t instanceof rw}function yR(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function IY(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)Ye(t[s])!==Ye(e[s])&&o++;return o+i}function Wk(t,e){Ce(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Po(~~(n/60),2)+e+Po(~~n%60,2)})}Wk("Z",":");Wk("ZZ","");ue("Z",ew);ue("ZZ",ew);mt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=f0(ew,t)});var PY=/([\+\-]|\d\d)/gi;function f0(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(PY)||["-",0,0],o=+(i[1]*60)+Ye(i[2]),o===0?0:i[0]==="+"?o:-o)}function g0(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(Bi(t)||af(t)?t.valueOf():Ot(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),X.updateOffset(n,!1),n):Ot(t).local()}function bR(t){return-Math.round(t._d.getTimezoneOffset())}X.updateOffset=function(){};function OY(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=f0(ew,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=bR(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?Uk(this,zi(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,X.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:bR(this)}function xY(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function AY(t){return this.utcOffset(0,t)}function HY(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(bR(this),"m")),this}function NY(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=f0(JU,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function DY(t){return this.isValid()?(t=t?Ot(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function kY(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function LY(){if(!mr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return QE(t,this),t=Fk(t),t._a?(e=t._isUTC?Ho(t._a):Ot(t._a),this._isDSTShifted=this.isValid()&&IY(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function FY(){return this.isValid()?!this._isUTC:!1}function $Y(){return this.isValid()?this._isUTC:!1}function Bk(){return this.isValid()?this._isUTC&&this._offset===0:!1}var VY=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,WY=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function zi(t,e){var n=t,r=null,i,o,s;return wm(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Ss(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=VY.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Ye(r[yo])*i,h:Ye(r[yn])*i,m:Ye(r[Fi])*i,s:Ye(r[fs])*i,ms:Ye(yR(r[El]*1e3))*i}):(r=WY.exec(t))?(i=r[1]==="-"?-1:1,n={y:Ha(r[2],i),M:Ha(r[3],i),w:Ha(r[4],i),d:Ha(r[5],i),h:Ha(r[6],i),m:Ha(r[7],i),s:Ha(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=BY(Ot(n.from),Ot(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new rw(n),wm(t)&&nt(t,"_locale")&&(o._locale=t._locale),wm(t)&&nt(t,"_isValid")&&(o._isValid=t._isValid),o}zi.fn=rw.prototype;zi.invalid=MY;function Ha(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function Dx(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function BY(t,e){var n;return t.isValid()&&e.isValid()?(e=g0(e,t),t.isBefore(e)?n=Dx(t,e):(n=Dx(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function jk(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(vk(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=zi(n,r),Uk(this,i,t),this}}function Uk(t,e,n,r){var i=e._milliseconds,o=yR(e._days),s=yR(e._months);t.isValid()&&(r=r??!0,s&&Ik(t,Pd(t,"Month")+s*n),o&&_k(t,"Date",Pd(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&X.updateOffset(t,o||s))}var jY=jk(1,"add"),UY=jk(-1,"subtract");function zk(t){return typeof t=="string"||t instanceof String}function zY(t){return Bi(t)||af(t)||zk(t)||Ss(t)||GY(t)||YY(t)||t===null||t===void 0}function YY(t){var e=xl(t)&&!XE(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||nt(t,o);return e&&n}function GY(t){var e=Wi(t),n=!1;return e&&(n=t.filter(function(r){return!Ss(r)&&zk(t)}).length===0),e&&n}function qY(t){var e=xl(t)&&!XE(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||nt(t,o);return e&&n}function KY(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function XY(t,e){arguments.length===1&&(arguments[0]?zY(arguments[0])?(t=arguments[0],e=void 0):qY(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Ot(),r=g0(n,this).startOf("day"),i=X.calendarFormat(this,r)||"sameElse",o=e&&(No(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Ot(n)))}function ZY(){return new lf(this)}function QY(t,e){var n=Bi(t)?t:Ot(t);return this.isValid()&&n.isValid()?(e=wi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function JY(t,e){var n=Bi(t)?t:Ot(t);return this.isValid()&&n.isValid()?(e=wi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function eG(t,e,n,r){var i=Bi(t)?t:Ot(t),o=Bi(e)?e:Ot(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function tG(t,e){var n=Bi(t)?t:Ot(t),r;return this.isValid()&&n.isValid()?(e=wi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function nG(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function rG(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function iG(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=g0(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=wi(e),e){case"year":o=vm(this,r)/12;break;case"month":o=vm(this,r);break;case"quarter":o=vm(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:oi(o)}function vm(t,e){if(t.date()<e.date())return-vm(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}X.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";X.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function oG(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function sG(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?pm(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):No(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",pm(n,"Z")):pm(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function aG(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function lG(t){t||(t=this.isUtc()?X.defaultFormatUtc:X.defaultFormat);var e=pm(this,t);return this.localeData().postformat(e)}function uG(t,e){return this.isValid()&&(Bi(t)&&t.isValid()||Ot(t).isValid())?zi({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function cG(t){return this.from(Ot(),t)}function hG(t,e){return this.isValid()&&(Bi(t)&&t.isValid()||Ot(t).isValid())?zi({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function dG(t){return this.to(Ot(),t)}function Yk(t){var e;return t===void 0?this._locale._abbr:(e=Ms(t),e!=null&&(this._locale=e),this)}var Gk=pi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function qk(){return this._locale}var Gm=1e3,sc=60*Gm,qm=60*sc,Kk=(365*400+97)*24*qm;function ac(t,e){return(t%e+e)%e}function Xk(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-Kk:new Date(t,e,n).valueOf()}function Zk(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-Kk:Date.UTC(t,e,n)}function fG(t){var e,n;if(t=wi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?Zk:Xk,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=ac(e+(this._isUTC?0:this.utcOffset()*sc),qm);break;case"minute":e=this._d.valueOf(),e-=ac(e,sc);break;case"second":e=this._d.valueOf(),e-=ac(e,Gm);break}return this._d.setTime(e),X.updateOffset(this,!0),this}function gG(t){var e,n;if(t=wi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?Zk:Xk,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=qm-ac(e+(this._isUTC?0:this.utcOffset()*sc),qm)-1;break;case"minute":e=this._d.valueOf(),e+=sc-ac(e,sc)-1;break;case"second":e=this._d.valueOf(),e+=Gm-ac(e,Gm)-1;break}return this._d.setTime(e),X.updateOffset(this,!0),this}function mG(){return this._d.valueOf()-(this._offset||0)*6e4}function pG(){return Math.floor(this.valueOf()/1e3)}function wG(){return new Date(this.valueOf())}function vG(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function CG(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function yG(){return this.isValid()?this.toISOString():null}function bG(){return ZE(this)}function SG(){return sa({},Oe(this))}function RG(){return Oe(this).overflow}function EG(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ce("N",0,0,"eraAbbr");Ce("NN",0,0,"eraAbbr");Ce("NNN",0,0,"eraAbbr");Ce("NNNN",0,0,"eraName");Ce("NNNNN",0,0,"eraNarrow");Ce("y",["y",1],"yo","eraYear");Ce("y",["yy",2],0,"eraYear");Ce("y",["yyy",3],0,"eraYear");Ce("y",["yyyy",4],0,"eraYear");ue("N",m0);ue("NN",m0);ue("NNN",m0);ue("NNNN",DG);ue("NNNNN",kG);mt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Oe(n).era=i:Oe(n).invalidEra=t});ue("y",Oc);ue("yy",Oc);ue("yyy",Oc);ue("yyyy",Oc);ue("yo",LG);mt(["y","yy","yyy","yyyy"],Bn);mt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Bn]=n._locale.eraYearOrdinalParse(t,i):e[Bn]=parseInt(t,10)});function _G(t,e){var n,r,i,o=this._eras||Ms("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=X(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=X(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function TG(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function MG(t,e){var n=t.since<=t.until?1:-1;return e===void 0?X(t.since).year():X(t.since).year()+(e-t.offset)*n}function IG(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function PG(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function OG(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function xG(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-X(i[t].since).year())*n+i[t].offset;return this.year()}function AG(t){return nt(this,"_erasNameRegex")||p0.call(this),t?this._erasNameRegex:this._erasRegex}function HG(t){return nt(this,"_erasAbbrRegex")||p0.call(this),t?this._erasAbbrRegex:this._erasRegex}function NG(t){return nt(this,"_erasNarrowRegex")||p0.call(this),t?this._erasNarrowRegex:this._erasRegex}function m0(t,e){return e.erasAbbrRegex(t)}function DG(t,e){return e.erasNameRegex(t)}function kG(t,e){return e.erasNarrowRegex(t)}function LG(t,e){return e._eraYearOrdinalRegex||Oc}function p0(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Cs(u[i].name),a=Cs(u[i].abbr),l=Cs(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ce(0,["gg",2],0,function(){return this.weekYear()%100});Ce(0,["GG",2],0,function(){return this.isoWeekYear()%100});function iw(t,e){Ce(0,[t,t.length],0,e)}iw("gggg","weekYear");iw("ggggg","weekYear");iw("GGGG","isoWeekYear");iw("GGGGG","isoWeekYear");ue("G",Jp);ue("g",Jp);ue("GG",xt,jr);ue("gg",xt,jr);ue("GGGG",r0,n0);ue("gggg",r0,n0);ue("GGGGG",Qp,Xp);ue("ggggg",Qp,Xp);cf(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Ye(t)});cf(["gg","GG"],function(t,e,n,r){e[r]=X.parseTwoDigitYear(t)});function FG(t){return Qk.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function $G(t){return Qk.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function VG(){return ys(this.year(),1,4)}function WG(){return ys(this.isoWeekYear(),1,4)}function BG(){var t=this.localeData()._week;return ys(this.year(),t.dow,t.doy)}function jG(){var t=this.localeData()._week;return ys(this.weekYear(),t.dow,t.doy)}function Qk(t,e,n,r,i){var o;return t==null?xd(this,r,i).year:(o=ys(t,r,i),e>o&&(e=o),UG.call(this,t,e,n,r,i))}function UG(t,e,n,r,i){var o=xk(t,e,n,r,i),s=Od(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Ce("Q",0,"Qo","quarter");ue("Q",yk);mt("Q",function(t,e){e[ds]=(Ye(t)-1)*3});function zG(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ce("D",["DD",2],"Do","date");ue("D",xt,xc);ue("DD",xt,jr);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});mt(["D","DD"],yo);mt("Do",function(t,e){e[yo]=Ye(t.match(xt)[0])});var Jk=Ac("Date",!0);Ce("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",Zp);ue("DDDD",bk);mt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Ye(t)});function YG(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ce("m",["mm",2],0,"minute");ue("m",xt,i0);ue("mm",xt,jr);mt(["m","mm"],Fi);var GG=Ac("Minutes",!1);Ce("s",["ss",2],0,"second");ue("s",xt,i0);ue("ss",xt,jr);mt(["s","ss"],fs);var qG=Ac("Seconds",!1);Ce("S",0,0,function(){return~~(this.millisecond()/100)});Ce(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ce(0,["SSS",3],0,"millisecond");Ce(0,["SSSS",4],0,function(){return this.millisecond()*10});Ce(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ce(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ce(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ce(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ce(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",Zp,yk);ue("SS",Zp,jr);ue("SSS",Zp,bk);var aa,eL;for(aa="SSSS";aa.length<=9;aa+="S")ue(aa,Oc);function KG(t,e){e[El]=Ye(("0."+t)*1e3)}for(aa="S";aa.length<=9;aa+="S")mt(aa,KG);eL=Ac("Milliseconds",!1);Ce("z",0,0,"zoneAbbr");Ce("zz",0,0,"zoneName");function XG(){return this._isUTC?"UTC":""}function ZG(){return this._isUTC?"Coordinated Universal Time":""}var J=lf.prototype;J.add=jY;J.calendar=XY;J.clone=ZY;J.diff=iG;J.endOf=gG;J.format=lG;J.from=uG;J.fromNow=cG;J.to=hG;J.toNow=dG;J.get=az;J.invalidAt=RG;J.isAfter=QY;J.isBefore=JY;J.isBetween=eG;J.isSame=tG;J.isSameOrAfter=nG;J.isSameOrBefore=rG;J.isValid=bG;J.lang=Gk;J.locale=Yk;J.localeData=qk;J.max=bY;J.min=yY;J.parsingFlags=SG;J.set=lz;J.startOf=fG;J.subtract=UY;J.toArray=vG;J.toObject=CG;J.toDate=wG;J.toISOString=sG;J.inspect=aG;typeof Symbol<"u"&&Symbol.for!=null&&(J[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});J.toJSON=yG;J.toString=oG;J.unix=pG;J.valueOf=mG;J.creationData=EG;J.eraName=IG;J.eraNarrow=PG;J.eraAbbr=OG;J.eraYear=xG;J.year=Ek;J.isLeapYear=sz;J.weekYear=FG;J.isoWeekYear=$G;J.quarter=J.quarters=zG;J.month=Pk;J.daysInMonth=wz;J.week=J.weeks=_z;J.isoWeek=J.isoWeeks=Tz;J.weeksInYear=BG;J.weeksInWeekYear=jG;J.isoWeeksInYear=VG;J.isoWeeksInISOWeekYear=WG;J.date=Jk;J.day=J.days=$z;J.weekday=Vz;J.isoWeekday=Wz;J.dayOfYear=YG;J.hour=J.hours=qz;J.minute=J.minutes=GG;J.second=J.seconds=qG;J.millisecond=J.milliseconds=eL;J.utcOffset=OY;J.utc=AY;J.local=HY;J.parseZone=NY;J.hasAlignedHourOffset=DY;J.isDST=kY;J.isLocal=FY;J.isUtcOffset=$Y;J.isUtc=Bk;J.isUTC=Bk;J.zoneAbbr=XG;J.zoneName=ZG;J.dates=pi("dates accessor is deprecated. Use date instead.",Jk);J.months=pi("months accessor is deprecated. Use month instead",Pk);J.years=pi("years accessor is deprecated. Use year instead",Ek);J.zone=pi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",xY);J.isDSTShifted=pi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",LY);function QG(t){return Ot(t*1e3)}function JG(){return Ot.apply(null,arguments).parseZone()}function tL(t){return t}var rt=JE.prototype;rt.calendar=FU;rt.longDateFormat=BU;rt.invalidDate=UU;rt.ordinal=GU;rt.preparse=tL;rt.postformat=tL;rt.relativeTime=KU;rt.pastFuture=XU;rt.set=kU;rt.eras=_G;rt.erasParse=TG;rt.erasConvertYear=MG;rt.erasAbbrRegex=HG;rt.erasNameRegex=AG;rt.erasNarrowRegex=NG;rt.months=fz;rt.monthsShort=gz;rt.monthsParse=pz;rt.monthsRegex=Cz;rt.monthsShortRegex=vz;rt.week=bz;rt.firstDayOfYear=Ez;rt.firstDayOfWeek=Rz;rt.weekdays=Nz;rt.weekdaysMin=kz;rt.weekdaysShort=Dz;rt.weekdaysParse=Fz;rt.weekdaysRegex=Bz;rt.weekdaysShortRegex=jz;rt.weekdaysMinRegex=Uz;rt.isPM=Yz;rt.meridiem=Kz;function Km(t,e,n,r){var i=Ms(),o=Ho().set(r,e);return i[n](o,t)}function nL(t,e,n){if(Ss(t)&&(e=t,t=void 0),t=t||"",e!=null)return Km(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Km(t,r,n,"month");return i}function w0(t,e,n,r){typeof t=="boolean"?(Ss(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Ss(e)&&(n=e,e=void 0),e=e||"");var i=Ms(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Km(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Km(e,(s+o)%7,r,"day");return a}function e2(t,e){return nL(t,e,"months")}function t2(t,e){return nL(t,e,"monthsShort")}function n2(t,e,n){return w0(t,e,n,"weekdays")}function r2(t,e,n){return w0(t,e,n,"weekdaysShort")}function i2(t,e,n){return w0(t,e,n,"weekdaysMin")}fa("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Ye(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});X.lang=pi("moment.lang is deprecated. Use moment.locale instead.",fa);X.langData=pi("moment.langData is deprecated. Use moment.localeData instead.",Ms);var Wo=Math.abs;function o2(){var t=this._data;return this._milliseconds=Wo(this._milliseconds),this._days=Wo(this._days),this._months=Wo(this._months),t.milliseconds=Wo(t.milliseconds),t.seconds=Wo(t.seconds),t.minutes=Wo(t.minutes),t.hours=Wo(t.hours),t.months=Wo(t.months),t.years=Wo(t.years),this}function rL(t,e,n,r){var i=zi(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function s2(t,e){return rL(this,t,e,1)}function a2(t,e){return rL(this,t,e,-1)}function kx(t){return t<0?Math.floor(t):Math.ceil(t)}function l2(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=kx(SR(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=oi(t/1e3),r.seconds=i%60,o=oi(i/60),r.minutes=o%60,s=oi(o/60),r.hours=s%24,e+=oi(s/24),l=oi(iL(e)),n+=l,e-=kx(SR(l)),a=oi(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function iL(t){return t*4800/146097}function SR(t){return t*146097/4800}function u2(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=wi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+iL(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(SR(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function Is(t){return function(){return this.as(t)}}var oL=Is("ms"),c2=Is("s"),h2=Is("m"),d2=Is("h"),f2=Is("d"),g2=Is("w"),m2=Is("M"),p2=Is("Q"),w2=Is("y"),v2=oL;function C2(){return zi(this)}function y2(t){return t=wi(t),this.isValid()?this[t+"s"]():NaN}function ql(t){return function(){return this.isValid()?this._data[t]:NaN}}var b2=ql("milliseconds"),S2=ql("seconds"),R2=ql("minutes"),E2=ql("hours"),_2=ql("days"),T2=ql("months"),M2=ql("years");function I2(){return oi(this.days()/7)}var ss=Math.round,Qu={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function P2(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function O2(t,e,n,r){var i=zi(t).abs(),o=ss(i.as("s")),s=ss(i.as("m")),a=ss(i.as("h")),l=ss(i.as("d")),u=ss(i.as("M")),c=ss(i.as("w")),h=ss(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,P2.apply(null,d)}function x2(t){return t===void 0?ss:typeof t=="function"?(ss=t,!0):!1}function A2(t,e){return Qu[t]===void 0?!1:e===void 0?Qu[t]:(Qu[t]=e,t==="s"&&(Qu.ss=e-1),!0)}function H2(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Qu,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Qu,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=O2(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Hy=Math.abs;function iu(t){return(t>0)-(t<0)||+t}function ow(){if(!this.isValid())return this.localeData().invalidDate();var t=Hy(this._milliseconds)/1e3,e=Hy(this._days),n=Hy(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=oi(t/60),i=oi(r/60),t%=60,r%=60,o=oi(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=iu(this._months)!==iu(a)?"-":"",c=iu(this._days)!==iu(a)?"-":"",h=iu(this._milliseconds)!==iu(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var Qe=rw.prototype;Qe.isValid=TY;Qe.abs=o2;Qe.add=s2;Qe.subtract=a2;Qe.as=u2;Qe.asMilliseconds=oL;Qe.asSeconds=c2;Qe.asMinutes=h2;Qe.asHours=d2;Qe.asDays=f2;Qe.asWeeks=g2;Qe.asMonths=m2;Qe.asQuarters=p2;Qe.asYears=w2;Qe.valueOf=v2;Qe._bubble=l2;Qe.clone=C2;Qe.get=y2;Qe.milliseconds=b2;Qe.seconds=S2;Qe.minutes=R2;Qe.hours=E2;Qe.days=_2;Qe.weeks=I2;Qe.months=T2;Qe.years=M2;Qe.humanize=H2;Qe.toISOString=ow;Qe.toString=ow;Qe.toJSON=ow;Qe.locale=Yk;Qe.localeData=qk;Qe.toIsoString=pi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ow);Qe.lang=Gk;Ce("X",0,0,"unix");Ce("x",0,0,"valueOf");ue("x",Jp);ue("X",ez);mt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});mt("x",function(t,e,n){n._d=new Date(Ye(t))});//! moment.js
X.version="2.30.1";NU(Ot);X.fn=J;X.min=SY;X.max=RY;X.now=EY;X.utc=Ho;X.unix=QG;X.months=e2;X.isDate=af;X.locale=fa;X.invalid=Kp;X.duration=zi;X.isMoment=Bi;X.weekdays=n2;X.parseZone=JG;X.localeData=Ms;X.isDuration=wm;X.monthsShort=t2;X.weekdaysMin=i2;X.defineLocale=u0;X.updateLocale=Jz;X.locales=eY;X.weekdaysShort=r2;X.normalizeUnits=wi;X.relativeTimeRounding=x2;X.relativeTimeThreshold=A2;X.calendarFormat=KY;X.prototype=J;X.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function sL(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function RR(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function id(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function mn(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Ca(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Be(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function M(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function aL(t){return mn(t,(e,n)=>e+n,0)}function N2(t){return mn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function D2(t){return mn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function k2(t){return t.length?aL(t)/t.length:0}function lL(t){return mn(t,(e,n)=>e.concat(Array.isArray(n)?lL(n):n),[])}function uL(t){const e=[];return M(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function ER(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return M(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function L2(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return M(i,s=>{o=o.filter(a=>s.includes(a))}),o}function F2(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return M(i,s=>{M(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function _R(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const $2=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:k2,arrayEach:M,arrayFilter:Ca,arrayFlatten:lL,arrayMap:Be,arrayMax:N2,arrayMin:D2,arrayReduce:mn,arraySum:aL,arrayUnique:uL,extendArray:RR,getDifferenceOfArrays:ER,getIntersectionOfArrays:L2,getUnionOfArrays:F2,pivot:id,stringToArray:_R,to2dArray:sL},Symbol.toStringTag,{value:"Module"}));function st(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return mn(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function bt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function le(t){return typeof t<"u"}function Pt(t){return typeof t>"u"}function Wt(t){return t===null||t===""||Pt(t)}function cL(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const qh="length",od=t=>parseInt(t,16),Lx=t=>parseInt(t,10),Xm=(t,e,n)=>t.substr(e,n),sd=t=>t.codePointAt(0)-65,TR=t=>`${t}`.replace(/\-/g,""),V2=t=>od(Xm(TR(t),od("12"),sd("F")))/(od(Xm(TR(t),sd("B"),~~![][qh]))||9),W2=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let Fx=!1;const $x={invalid:()=>st`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return st`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>st`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Vx={invalid:()=>st`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return st`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>st`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function hL(t,e){const n=!Wt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.3.0";let o,s="invalid",a="invalid";t=TR(t||"");const l=B2(t);if(n||r||l)if(l){const u=X("29/04/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=V2(t);o=X((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(W2()&&(s="valid",a="valid"),!Fx&&s!=="valid"&&($x[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"]($x[s]({keyValidityDate:o,hotVersion:i})),Fx=!0),a!=="valid"&&e.parentNode&&Vx[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=Vx[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function B2(t){let e=[][qh],n=e;if(t[qh]!==sd("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=sd(i.shift());o;o=sd(i.shift()||"A"))--o<""[qh]?n=n|(Lx(`${Lx(od(r)+(od(Xm(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Xm(t,o,o?i[qh]===1?9:8:6);return n===e}const j2=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:hL,isDefined:le,isEmpty:Wt,isRegExp:cL,isUndefined:Pt,stringify:bt},Symbol.toStringTag,{value:"Module"}));function jn(t){return t[0].toUpperCase()+t.substr(1)}function U2(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=bt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function v0(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function C0(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function y0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function MR(t){return sw(`${t}`,{ALLOWED_TAGS:[]})}function sw(t,e){return HU.sanitize(t,e)}const z2=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:U2,isPercentValue:C0,randomString:v0,sanitize:sw,stripTags:MR,substitute:y0,toUpperCaseFirst:jn},Symbol.toStringTag,{value:"Module"})),Kl=t=>["tabindex",t],Y2=()=>["role","treegrid"],gs=()=>["role","presentation"],G2=()=>["role","gridcell"],q2=()=>["role","rowheader"],dL=()=>["role","rowgroup"],K2=()=>["role","columnheader"],IR=()=>["role","row"],X2=()=>["role","menu"],Z2=()=>["role","menuitem"],Q2=()=>["role","menuitemcheckbox"],J2=()=>["role","combobox"],fL=()=>["role","listbox"],eq=()=>["role","option"],tq=()=>["role","checkbox"],nq=()=>["scope","col"],rq=()=>["scope","row"],iq=()=>["type","text"],Hd=t=>["aria-label",t],Xl=()=>["aria-hidden","true"],oq=()=>["aria-disabled","true"],sq=()=>["aria-multiselectable","true"],gL=t=>["aria-haspopup",t],mL=t=>["aria-rowcount",t],aw=t=>["aria-colcount",t],pL=t=>["aria-rowindex",t],b0=t=>["aria-colindex",t],li=t=>["aria-expanded",t],aq=t=>["aria-sort",t],Wx=()=>["aria-readonly","true"],Bx=()=>["aria-invalid","true"],wL=t=>["aria-checked",t],S0=()=>["aria-selected","true"],lq=()=>["aria-autocomplete","list"],uq=t=>["aria-controls",t],cq=t=>["aria-activedescendant",t],hq=t=>["aria-live",t],dq=t=>["aria-relevant",t],fq=t=>["aria-setsize",t],gq=t=>["aria-posinset",t];function vL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function ad(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function CL(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Nl(t){return CL(t)&&t.parent}function mq(t){return!!Object.getPrototypeOf(t.parent)}function ya(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Kh(t,e,n){const r=[];let i=t;for(;i&&(i=ya(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function yL(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function ga(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function bL(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Gs(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function SL(t){return!t||!t.length?[]:t.filter(e=>!!e)}function RL(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function we(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function q(t,e){typeof e=="string"&&(e=e.split(" ")),e=SL(e),e.length>0&&t.classList.add(...e)}function pe(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=RL(e,!0);n=SL(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function ye(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Zl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=RL(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function R0(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)R0(e[n])}}function Oo(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const EL=/(<(.*)>|&(.*);)/;function Ql(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;EL.test(e)?t.innerHTML=n?sw(e):e:ba(t,e)}function ba(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(Oo(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Dl(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return Dl(r.host.impl);if(r.host)return Dl(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function _L(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function On(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function E0(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function lw(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function uw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?E0(e):t.scrollTop}function _0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?lw(e):t.scrollLeft}function Nd(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function TL(t){return t.scrollHeight-t.clientHeight}function ML(t){return t.scrollWidth-t.clientWidth}function mc(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Dd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function pq(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function qt(t){return t.offsetWidth}function en(t){return t.offsetHeight}function lc(t){return t.clientHeight||t.innerHeight}function T0(t){return t.clientWidth||t.innerWidth}function wq(t,e,n){t.addEventListener(e,n,!1)}function vq(t,e,n){t.removeEventListener(e,n,!1)}function M0(t){return t.selectionStart?t.selectionStart:0}function IL(t){return t.selectionEnd?t.selectionEnd:0}function Cq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function PR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function hf(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let Ny;function yq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function bn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Ny===void 0&&(Ny=yq(t)),Ny}function I0(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function P0(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function cw(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function bq(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function df(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function ld(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function hw(t){return ld(t)&&t.hasAttribute("data-hot-input")===!1}function Sq(t){const e=t.ownerDocument.activeElement;hw(e)||t.select()}function O0(t){return!t.parentNode}function PL(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function x0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();ye(t,"contenteditable",!0),n&&ye(t,...Xl()),e&&q(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function A0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&pe(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function OL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;x0(t,n),e(),A0(t,n)}function _o(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const Rq=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:EL,addClass:q,addEvent:wq,clearTextSelection:PR,closest:ya,closestDown:Kh,empty:Oo,fastInnerHTML:Ql,fastInnerText:ba,findFirstParentWithClass:yL,getCaretPosition:M0,getCssTransform:bq,getFrameElement:CL,getMaximumScrollLeft:ML,getMaximumScrollTop:TL,getParent:vL,getParentWindow:Nl,getScrollLeft:_0,getScrollTop:uw,getScrollableElement:Nd,getScrollbarWidth:bn,getSelectionEndPosition:IL,getSelectionText:Cq,getStyle:Dd,getTrimmingContainer:mc,getWindowScrollLeft:lw,getWindowScrollTop:E0,hasAccessToParentWindow:mq,hasClass:we,hasHorizontalScrollbar:P0,hasVerticalScrollbar:I0,hasZeroHeight:_L,index:bL,innerHeight:lc,innerWidth:T0,isChildOf:ga,isDetached:O0,isHTMLElement:_o,isInput:ld,isInternalElement:ad,isOutsideInput:hw,isVisible:Dl,makeElementContentEditableAndSelectItsContent:x0,matchesCSSRules:pq,observeVisibilityChangeOnce:PL,offset:On,outerHeight:en,outerWidth:qt,overlayContainsElement:Gs,removeAttribute:Zl,removeClass:pe,removeContentEditableFromElementAndDeselect:A0,removeEvent:vq,removeTextNodes:R0,resetCssTransform:df,runWithSelectedContendEditableElement:OL,selectElementIfAllowed:Sq,setAttribute:ye,setCaretPosition:hf,setOverlayPosition:cw},Symbol.toStringTag,{value:"Module"}));function ot(t){return typeof t=="function"}function xL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function Eq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=xL(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function ff(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function _q(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return mn(i,(u,c)=>c(u),r.apply(this,a))}}function H0(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function AL(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Tq(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Zm(t,e,n,r,i,o,s,a){return le(a)?t.call(e,n,r,i,o,s,a):le(s)?t.call(e,n,r,i,o,s):le(o)?t.call(e,n,r,i,o):le(i)?t.call(e,n,r,i):le(r)?t.call(e,n,r):le(n)?t.call(e,n):t.call(e)}const Mq=Object.freeze(Object.defineProperty({__proto__:null,curry:AL,curryRight:Tq,debounce:ff,fastCall:Zm,isFunction:ot,partial:H0,pipe:_q,throttle:xL,throttleAfterHits:Eq},Symbol.toStringTag,{value:"Module"}));var jx={},Dy,Ux;function Iq(){if(Ux)return Dy;Ux=1;var t=rn(),e=XD(),n=fn(),r=jl(),i=qp(),o=t([].push);return Dy=function(s){if(n(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||r(c)==="Number"||r(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(f,g){if(d)return d=!1,g;if(e(this))return g;for(var v=0;v<h;v++)if(l[v]===f)return g}}},Dy}var zx;function Pq(){if(zx)return jx;zx=1;var t=wt(),e=_c(),n=rf(),r=dn(),i=rn(),o=hn(),s=fn(),a=kE(),l=KE(),u=Iq(),c=DE(),h=String,d=e("JSON","stringify"),f=i(/./.exec),g=i("".charAt),v=i("".charCodeAt),y=i("".replace),E=i(1.1.toString),C=/[\uD800-\uDFFF]/g,T=/^[\uD800-\uDBFF]$/,A=/^[\uDC00-\uDFFF]$/,F=!c||o(function(){var U=e("Symbol")("stringify detection");return d([U])!=="[null]"||d({a:U})!=="{}"||d(Object(U))!=="{}"}),I=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),O=function(U,W){var Z=l(arguments),Q=u(W);if(!(!s(Q)&&(U===void 0||a(U))))return Z[1]=function(oe,te){if(s(Q)&&(te=r(Q,this,h(oe),te)),!a(te))return te},n(d,null,Z)},Y=function(U,W,Z){var Q=g(Z,W-1),oe=g(Z,W+1);return f(T,U)&&!f(A,oe)||f(A,U)&&!f(T,Q)?"\\u"+E(v(U,0),16):U};return d&&t({target:"JSON",stat:!0,arity:3,forced:F||I},{stringify:function(W,Z,Q){var oe=l(arguments),te=n(F?O:d,null,oe);return I&&typeof te=="string"?y(te,C,Y):te}}),jx}Pq();function pc(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ae(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=pc(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[pc(n[0])]:e[r]=[]:e[r]=null)})),e}function HL(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function tn(t,e,n){const r=Array.isArray(n);return Ae(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function gf(t,e){Ae(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),gf(t[r],e[r])):t[r]=e[r]})}function Un(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function ji(t){const e={};return Ae(t,(n,r)=>{e[r]=n}),e}function ct(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return M(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ae(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=g=>{let v=g;return(Array.isArray(v)||xe(v))&&(v=Un(v)),v};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function dw(t,e){return JSON.stringify(t)===JSON.stringify(e)}function xe(t){return Object.prototype.toString.call(t)==="[object Object]"}function Do(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ae(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function NL(t,e){const n=e.split(".");let r=t;return Ae(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Cm(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(Jt(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function fw(t){if(!xe(t))return 0;const e=function(n){let r=0;return xe(n)?Ae(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Rr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Jt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const Oq=Object.freeze(Object.defineProperty({__proto__:null,clone:ji,createObjectPropListener:Rr,deepClone:Un,deepExtend:gf,deepObjectSize:fw,defineGetter:Do,duckSchema:pc,extend:tn,getProperty:NL,hasOwnProperty:Jt,inherit:HL,isObject:xe,isObjectEqual:dw,mixin:ct,objectEach:Ae,setProperty:Cm},Symbol.toStringTag,{value:"Module"}));function kd(t){return window.requestAnimationFrame(t)}function Ld(t){window.cancelAnimationFrame(t)}function N0(){return"ontouchstart"in window}function DL(){return typeof window<"u"}let ou;function kL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ou||(typeof Intl=="object"?ou=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?ou=(n,r)=>`${n}`.localeCompare(r):ou=(n,r)=>n===r?0:n>r?-1:1,ou)}const xq=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Ld,getComparisonFunction:kL,isCSR:DL,isTouchSupported:N0,requestAnimationFrame:kd},Symbol.toStringTag,{value:"Module"})),ei=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Ps={chrome:ei((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:ei(t=>/CriOS/.test(t)),edge:ei(t=>/Edge/.test(t)),edgeWebKit:ei(t=>/EdgiOS/.test(t)),firefox:ei(t=>/Firefox/.test(t)),firefoxWebKit:ei(t=>/FxiOS/.test(t)),mobile:ei(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:ei((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Hc={mac:ei(t=>/^Mac/.test(t)),win:ei(t=>/^Win/.test(t)),linux:ei(t=>/^Linux/.test(t)),ios:ei(t=>/iPhone|iPad|iPod/i.test(t))};function LL(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ae(Ps,n=>{let{test:r}=n;return void r(t,e)})}function FL(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ae(Hc,e=>{let{test:n}=e;return void n(t)})}DL()&&(LL(),FL());function D0(){return Ps.chrome.value}function $L(){return Ps.chromeWebKit.value}function ym(){return Ps.firefox.value}function VL(){return Ps.firefoxWebKit.value}function Fd(){return Ps.safari.value}function WL(){return Ps.edge.value}function Aq(){return Ps.edgeWebKit.value}function Eo(){return Ps.mobile.value}function k0(){return Hc.ios.value}function L0(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Hc.mac.value}function OR(){return Hc.win.value}function Qm(){return Hc.mac.value}function Hq(){return Hc.linux.value}const Nq=Object.freeze(Object.defineProperty({__proto__:null,isChrome:D0,isChromeWebKit:$L,isEdge:WL,isEdgeWebKit:Aq,isFirefox:ym,isFirefoxWebKit:VL,isIOS:k0,isIpadOS:L0,isLinuxOS:Hq,isMacOS:Qm,isMobileBrowser:Eo,isSafari:Fd,isWindowsOS:OR,setBrowserMeta:LL,setPlatformMeta:FL},Symbol.toStringTag,{value:"Module"})),de={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:ym()?182:174,AUDIO_MUTE:ym()?181:173,AUDIO_UP:ym()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Dq=[de.ALT,de.ARROW_DOWN,de.ARROW_LEFT,de.ARROW_RIGHT,de.ARROW_UP,de.AUDIO_DOWN,de.AUDIO_MUTE,de.AUDIO_UP,de.BACKSPACE,de.CAPS_LOCK,de.DELETE,de.END,de.ENTER,de.ESCAPE,de.F1,de.F2,de.F3,de.F4,de.F5,de.F6,de.F7,de.F8,de.F9,de.F10,de.F11,de.F12,de.F13,de.F14,de.F15,de.F16,de.F17,de.F18,de.F19,de.HOME,de.INSERT,de.MEDIA_NEXT,de.MEDIA_PLAY_PAUSE,de.MEDIA_PREV,de.MEDIA_STOP,de.NULL,de.NUM_LOCK,de.PAGE_DOWN,de.PAGE_UP,de.PAUSE,de.SCROLL_LOCK,de.SHIFT,de.TAB];function BL(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function F0(t){return Dq.includes(t)}function kq(t){const e=[];return Qm()?e.push(de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX):e.push(de.CONTROL),e.includes(t)}function jL(t){return[de.CONTROL,de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX].includes(t)}function Nc(t,e){const n=e.split("|");let r=!1;return M(n,i=>{if(t===de[i])return r=!0,!1}),r}const Lq=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:de,isCtrlKey:kq,isCtrlMetaKey:jL,isFunctionKey:F0,isKey:Nc,isPrintableChar:BL},Symbol.toStringTag,{value:"Module"}));function vi(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function ta(t){return t.isImmediatePropagationEnabled===!1}function Sa(t){return t.button===2}function gw(t){return t.button===0}function UL(t){return t instanceof TouchEvent}function zL(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!_o(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const Fq=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:ta,isLeftClick:gw,isRightClick:Sa,isTouchEvent:UL,offsetRelativeTo:zL,stopImmediatePropagation:vi},Symbol.toStringTag,{value:"Module"}));function et(){le(console)&&console.warn(...arguments)}function $0(){le(console)&&console.error(...arguments)}const bl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],ky=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Ly=new Map([[]]);var Yx={},Fy,Gx;function $q(){if(Gx)return Fy;Gx=1;var t=Ic();return Fy=function(e,n,r){for(var i=0,o=arguments.length>2?r:t(n),s=new e(o);o>i;)s[i]=n[i++];return s},Fy}var $y,qx;function Vq(){if(qx)return $y;qx=1;var t=nn();return $y=function(e,n){var r=t[e],i=r&&r.prototype;return i&&i[n]},$y}var Vy,Kx;function mw(){if(Kx)return Vy;Kx=1;var t=Ui(),e=YE(),n=Ta().f,r=t("unscopables"),i=Array.prototype;return i[r]===void 0&&n(i,r,{configurable:!0,value:e(null)}),Vy=function(o){i[r][o]=!0},Vy}var Xx;function Wq(){if(Xx)return Yx;Xx=1;var t=wt(),e=rn(),n=Er(),r=Jd(),i=$q(),o=Vq(),s=mw(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&n(c);var h=r(this),d=i(a,h);return l(d,c)}}),s("toSorted"),Yx}Wq();var Zx={},Qx={},Jx;function Bq(){if(Jx)return Qx;Jx=1;var t=wt(),e=dn(),n=Pc(),r=Er(),i=gn(),o=Ao(),s=_r(),a=Ma(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,g){if(c(f,d++))return g(f)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),Qx}var e1;function jq(){return e1||(e1=1,Bq()),Zx}jq();function Uq(t,e){YL(t,e),e.add(t)}function Wy(t,e,n){YL(t,e),e.set(t,n)}function YL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function t1(t,e,n){return t.set(Jm(t,e),n),n}function In(t,e){return t.get(Jm(t,e))}function Jm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zq=100;var Or=new WeakMap,Uu=new WeakMap,By=new WeakMap,jy=new WeakSet;class n1{constructor(){Uq(this,jy),Wy(this,Or,new Map),Wy(this,Uu,new Map),Wy(this,By,new Set),bl.forEach(e=>Jm(jy,this,r1).call(this,e))}getHooks(e){var n;return(n=In(Or,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};In(Or,this).has(e)||(Jm(jy,this,r1).call(this,e),bl.push(e));const i=In(Or,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=In(By,this).has(e);!u&&o!==0&&(u=!0,In(By,this).add(e)),u&&i.length>1&&In(Or,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return In(Or,this).has(e)&&In(Or,this).get(e).length>0}remove(e,n){if(!In(Or,this).has(e))return!1;const r=In(Or,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=In(Uu,this).get(e);return i.skip=!0,o+=1,o>zq&&(In(Or,this).set(e,r.filter(s=>!s.skip)),o=0),In(Uu,this).set(e,o),!0}return!1}destroy(){In(Or,this).clear(),In(Uu,this).clear(),t1(Or,this,null),t1(Uu,this,null)}}function r1(t){In(Or,this).set(t,[]),In(Uu,this).set(t,0)}function Yq(t,e,n){return(e=Gq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gq(t){var e=qq(t,"string");return typeof e=="symbol"?e:e+""}function qq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Kq=st`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class re{constructor(){Yq(this,"globalBucket",new n1)}static getSingleton(){return Zq()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new n1),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?M(n,o=>this.add(e,o,r)):(ky.has(e)&&et(y0(Kq,{hookName:e,removedInVersion:ky.get(e)})),Ly.has(e)&&et(Ly.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?M(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?M(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Zm(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Zm(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||bl.push(e)}deregister(e){this.isRegistered(e)&&bl.splice(bl.indexOf(e),1)}isDeprecated(e){return Ly.has(e)||ky.has(e)}isRegistered(e){return bl.indexOf(e)>=0}getRegistered(){return bl}}const Xq=new re;function Zq(){return Xq}const Uy=new Map;function Yi(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Uy.has(t)||Uy.set(t,new Map);const e=Uy.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const xR=new WeakMap,{register:Qq,getItem:GL,hasItem:qL,getNames:Jq,getValues:Ade}=Yi("editors");function eK(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},re.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function KL(t,e){let n;if(typeof t=="function")xR.get(t)||pr(null,t),n=xR.get(t);else if(typeof t=="string")n=GL(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function ep(t){if(typeof t=="function")return t;if(!qL(t))throw Error(`No registered editor found under "${t}" name`);return GL(t).getConstructor()}function pr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new eK(e);typeof t=="string"&&Qq(t,n),xR.set(e,n)}function tK(t,e,n){return(e=nK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nK(t){var e=rK(t,"string");return typeof e=="symbol"?e:e+""}function rK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let bm=0;class di{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;tK(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,iK(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),bm+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),bm-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),bm-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function iK(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),vi(this)},t}function oK(){return bm}function sK(t,e){aK(t,e),e.add(t)}function aK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Na(t,e,n){return(e=lK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lK(t){var e=uK(t,"string");return typeof e=="symbol"?e:e+""}function uK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zy(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Df=new WeakSet;class AR{constructor(e,n,r){sK(this,Df),Na(this,"hot",void 0),Na(this,"tableMeta",void 0),Na(this,"selection",void 0),Na(this,"eventManager",void 0),Na(this,"destroyed",!1),Na(this,"activeEditor",void 0),Na(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new di(e),this.hot.addHook("afterDocumentKeyDown",i=>zy(Df,this,i1).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>zy(Df,this,i1).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>zy(Df,this,cK).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=KL(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function i1(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||ta(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!F0(n)&&!jL(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function cK(t,e){e.isCell()&&this.openEditor(null,t,!0)}const o1=new WeakMap;AR.getInstance=function(t,e,n){let r=o1.get(t);return r||(r=new AR(t,e,n),o1.set(t,r)),r};function hK(t,e){XL(t,e),e.add(t)}function Zc(t,e,n){XL(t,e),e.set(t,n)}function XL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ct(t,e){return t.get(cs(t,e))}function Qc(t,e,n){return t.set(cs(t,e),n),n}function cs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const uc=Object.freeze({CELL:"cell",MIXED:"mixed"});var un=new WeakMap,kf=new WeakMap,Lf=new WeakMap,Ff=new WeakMap,$f=new WeakMap,Xs=new WeakSet;class dK{constructor(e){var n=this;hK(this,Xs),Zc(this,un,void 0),Zc(this,kf,void 0),Zc(this,Lf,1),Zc(this,Ff,null),Zc(this,$f,new Map);const r=e.getSettings();Qc(un,this,e),Qc(kf,this,r.imeFastEdit?uc.MIXED:uc.CELL),Ct(un,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return cs(Xs,n,gK).call(n,...o)}),Ct(un,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return cs(Xs,n,s1).call(n,...o)}),Ct(un,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return cs(Xs,n,s1).call(n,...o)}),Ct(un,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return cs(Xs,n,fK).call(n,...o)})}getFocusMode(){return Ct(kf,this)}setFocusMode(e){Object.values(uc).includes(e)?Qc(kf,this,e):et(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Ct(Lf,this)}setRefocusDelay(e){Qc(Lf,this,e)}setRefocusElementGetter(e){Qc(Ff,this,e)}getRefocusElement(){var e;return typeof Ct(Ff,this)=="function"?Ct(Ff,this).call(this):(e=Ct(un,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=Ct(un,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Ct(un,this).runHooks("modifyFocusedElement",s.row,s.col,r);_o(a)||(a=r),a&&!((o=Ct(un,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):cs(Xs,this,V0).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ct(Lf,this);if(Ct(un,this).getSettings().imeFastEdit&&!((e=Ct(un,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=Ct(un,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),Ct($f,this).has(n)||Ct($f,this).set(n,ff(()=>{if(!Ct(un,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),Ct($f,this).get(n)()}}}function V0(t){var e;const n=(e=Ct(un,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!Ct(un,this).selection.isCellVisible(n)){t(null);return}const r=Ct(un,this).getCell(n.row,n.col,!0);r===null?Ct(un,this).addHookOnce("afterScroll",()=>{t(Ct(un,this).getCell(n.row,n.col,!0))}):t(r)}function s1(){cs(Xs,this,V0).call(this,t=>{const{activeElement:e}=Ct(un,this).rootDocument;e&&hw(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function fK(){cs(Xs,this,V0).call(this,t=>{this.getFocusMode()===uc.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function gK(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?uc.MIXED:uc.CELL)}var a1={},Yy,l1;function mK(){if(l1)return Yy;l1=1;var t=gi(),e=jl(),n=Ui(),r=n("match");return Yy=function(i){var o;return t(i)&&((o=i[r])!==void 0?!!o:e(i)==="RegExp")},Yy}var Gy,u1;function pK(){if(u1)return Gy;u1=1;var t=nn(),e=hn(),n=t.RegExp,r=!e(function(){var i=!0;try{n(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,f){Object.defineProperty(o,d,{get:function(){return s+=f,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(n.prototype,"flags").get.call(o);return h!==a||s!==a});return Gy={correct:r},Gy}var qy,c1;function wK(){if(c1)return qy;c1=1;var t=gn();return qy=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},qy}var Ky,h1;function vK(){if(h1)return Ky;h1=1;var t=dn(),e=mi(),n=ef(),r=pK(),i=wK(),o=RegExp.prototype;return Ky=r.correct?function(s){return s.flags}:function(s){return!r.correct&&n(o,s)&&!e(s,"flags")?t(i,s):s.flags},Ky}var Xy,d1;function CK(){if(d1)return Xy;d1=1;var t=rn(),e=Tc(),n=Math.floor,r=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return Xy=function(l,u,c,h,d,f){var g=c+l.length,v=h.length,y=a;return d!==void 0&&(d=e(d),y=s),i(f,y,function(E,C){var T;switch(r(C,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,g);case"<":T=d[o(C,1,-1)];break;default:var A=+C;if(A===0)return E;if(A>v){var F=n(A/10);return F===0?E:F<=v?h[F-1]===void 0?r(C,1):h[F-1]+r(C,1):E}T=h[A-1]}return T===void 0?"":T})},Xy}var f1;function yK(){if(f1)return a1;f1=1;var t=wt(),e=dn(),n=rn(),r=Qd(),i=fn(),o=gi(),s=mK(),a=qp(),l=tf(),u=vK(),c=CK(),h=Ui(),d=_a(),f=h("replace"),g=TypeError,v=n("".indexOf),y=n("".replace),E=n("".slice),C=Math.max;return t({target:"String",proto:!0},{replaceAll:function(A,F){var I=r(this),O,Y,U,W,Z,Q,oe,te,ae,ft,be=0,He="";if(o(A)){if(O=s(A),O&&(Y=a(r(u(A))),!~v(Y,"g")))throw new g("`.replaceAll` does not allow non-global regexes");if(U=l(A,f),U)return e(U,A,I,F);if(d&&O)return y(a(I),A,F)}for(W=a(I),Z=a(A),Q=i(F),Q||(F=a(F)),oe=Z.length,te=C(1,oe),ae=v(W,Z);ae!==-1;)ft=Q?a(F(Z,ae,W)):c(Z,W,ae,[],void 0,F),He+=E(W,be,ae)+ft,be=ae+oe,ae=ae+te>W.length?-1:v(W,Z,ae+te);return be<W.length&&(He+=E(W,be)),He}}),a1}yK();var g1={},m1={},p1;function bK(){if(p1)return m1;p1=1;var t=wt(),e=Pc(),n=Er(),r=gn(),i=Ao(),o=_r(),s=Ma(),a=rf(),l=hn(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(f){r(this);try{n(f)}catch(C){o(this,"throw",C)}var g=arguments.length<2,v=g?void 0:arguments[1];if(h)return a(h,this,g?[f]:[f,v]);var y=i(this),E=0;if(e(y,function(C){g?(g=!1,v=C):v=f(v,C,E),E++},{IS_RECORD:!0}),g)throw new u("Reduce of empty iterator with no initial value");return v}}),m1}var w1;function SK(){return w1||(w1=1,bK()),g1}SK();const ZL={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},RK=new RegExp(Object.keys(ZL).map(t=>`(${t})`).join("|"),"gi");function EK(t){return(t&&t.nodeName||"")==="TABLE"}function HR(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,g=[];for(let y=0;y<s;y+=1){const E=!f&&n&&y===0;let C="";if(f)C=`<th>${t.getColHeader(y-c)}</th>`;else if(E)C=`<th>${t.getRowHeader(d-h)}</th>`;else{const T=i[d][y],{hidden:A,rowspan:F,colspan:I}=t.getCellMeta(d-h,y-c);if(!A){const O=[];if(F&&O.push(`rowspan="${F}"`),I&&O.push(`colspan="${I}"`),Wt(T))C=`<td ${O.join(" ")}></td>`;else{const Y=T.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");C=`<td ${O.join(" ")}>${Y}</td>`}}}g.push(C)}const v=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function NR(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Wt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function QL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,A=>{const F=A.match(/<td\b[^>]*?>/g)[0],I=/<p.*?>/g,O=A.substring(F.length,A.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(I,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${F}${O}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),o=i.querySelector("table")}if(!o||!EK(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((T,A)=>T+A.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(o.tHead){const T=Array.from(o.tHead.rows).filter(A=>{const F=A.querySelector("td")!==null;return F&&h.push(A),!F});f=T.length,d=f>0,f>1?n.nestedHeaders=Array.from(T).reduce((A,F)=>{const I=Array.from(F.cells).reduce((O,Y,U)=>{if(a&&U===0)return O;const{colSpan:W,innerHTML:Z}=Y,Q=W>1?{label:Z,colspan:W}:Z;return O.push(Q),O},[]);return A.push(I),A},[]):d&&(n.colHeaders=Array.from(T[0].children).reduce((A,F,I)=>(a&&I===0||A.push(F.innerHTML),A),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((T,A)=>(T.push(...Array.from(A.rows)),T),[]),...c];g=v.length;const y=new Array(g);for(let T=0;T<g;T++)y[T]=new Array(u);const E=[],C=[];for(let T=0;T<g;T++){const A=v[T],F=Array.from(A.cells),I=F.length;for(let O=0;O<I;O++){const Y=F[O],{nodeName:U,innerHTML:W,rowSpan:Z,colSpan:Q}=Y,oe=y[T].findIndex(te=>te===void 0);if(U==="TD"){if(Z>1||Q>1){for(let be=T;be<T+Z;be++)if(be<g)for(let He=oe;He<oe+Q;He++)y[be][He]=null;const ae=Y.getAttribute("style");ae&&ae.includes("mso-ignore:colspan")||E.push({col:oe,row:T,rowspan:Z,colspan:Q})}let te="";s&&/excel/gi.test(s.content)?te=W.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):te=W.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[T][oe]=te.replace(RK,ae=>ZL[ae])}else C.push(W)}}return E.length&&(n.mergeCells=E),C.length&&(n.rowHeaders=C),y.length&&(n.data=y),n}const _K=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:NR,htmlToGridSettings:QL,instanceToHTML:HR},Symbol.toStringTag,{value:"Module"}));function Vn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function JL(t){return Vn(t,[","])}function fe(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function DR(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function W0(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function ze(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const TK=Object.freeze(Object.defineProperty({__proto__:null,clamp:ze,isNumeric:Vn,isNumericLike:JL,rangeEach:fe,rangeEachReverse:DR,valueAccordingPercent:W0},Symbol.toStringTag,{value:"Module"})),kR="asc",MK="desc",v1=new Map([[kR,[-1,1]],[MK,[1,-1]]]),IK=t=>`The priority '${t}' is already declared in a map.`,PK=t=>`The priority '${t}' is not a number.`;function OK(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=ot(t)?t:IK,e=ot(e)?e:PK;function r(o,s){if(!Vn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:kR;const[s,a]=v1.get(o)||v1.get(kR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const xK=t=>`The id '${t}' is already declared in a map.`;function pw(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=ot(t)?t:xK;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const AK=t=>`'${t}' value is already declared in a unique set.`;function HK(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=ot(t)?t:AK;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const B0=t=>`There is already registered "${t}" plugin.`,NK=t=>`There is already registered plugin on priority "${t}".`,DK=t=>`The priority "${t}" is not a number.`,eF=OK({errorPriorityExists:NK,errorPriorityNaN:DK}),tF=HK({errorItemExists:B0}),LR=pw({errorIdExists:B0});function j0(){return[...eF.getItems(),...tF.getItems()]}function mf(t){const e=jn(t);return LR.getItem(e)}function kK(t){return!!mf(t)}function Ge(t,e,n){[t,e,n]=FK(t,e,n),mf(t)===void 0&&LK(t,e,n)}function LK(t,e,n){const r=jn(t);if(LR.hasItem(r))throw new Error(B0(r));n===void 0?tF.addItem(r):eF.addItem(n,r),LR.addItem(r,e)}function FK(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:$K,getItem:VK,hasItem:nF,getNames:WK,getValues:Hde}=Yi("renderers");function tp(t){if(typeof t=="function")return t;if(!nF(t))throw Error(`No registered renderer found under "${t}" name`);return VK(t)}function Hr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),$K(t,e)}const{register:BK,getItem:jK,hasItem:rF,getNames:UK,getValues:Nde}=Yi("validators");function U0(t){if(typeof t=="function")return t;if(!rF(t))throw Error(`No registered validator found under "${t}" name`);return jK(t)}function Sl(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),BK(t,e)}var C1={},y1;function zK(){if(y1)return C1;y1=1;var t=wt(),e=Tc(),n=Ic(),r=nf(),i=mw();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=n(a),u=r(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),C1}zK();var b1={},S1;function YK(){if(S1)return b1;S1=1;var t=wt(),e=rn(),n=Qd(),r=nf(),i=qp(),o=hn(),s=e("".charAt),a=o(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(n(this)),h=c.length,d=r(u),f=d>=0?d:h+d;return f<0||f>=h?void 0:s(c,f)}}),b1}YK();function Jc(t,e,n){return(e=GK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GK(t){var e=qK(t,"string");return typeof e=="symbol"?e:e+""}function qK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KK{constructor(){Jc(this,"count",0),Jc(this,"startColumn",null),Jc(this,"endColumn",null),Jc(this,"startPosition",null),Jc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function eh(t,e,n){return(e=XK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XK(t){var e=ZK(t,"string");return typeof e=="symbol"?e:e+""}function ZK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QK{constructor(){eh(this,"count",0),eh(this,"startRow",null),eh(this,"endRow",null),eh(this,"startPosition",null),eh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function th(t,e,n){return(e=JK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JK(t){var e=e3(t,"string");return typeof e=="symbol"?e:e+""}function e3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iF{constructor(){th(this,"count",0),th(this,"startColumn",null),th(this,"endColumn",null),th(this,"startPosition",null),th(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function nh(t,e,n){return(e=t3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t3(t){var e=n3(t,"string");return typeof e=="symbol"?e:e+""}function n3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oF{constructor(){nh(this,"count",0),nh(this,"startRow",null),nh(this,"endRow",null),nh(this,"startPosition",null),nh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function rh(t,e,n){return(e=r3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r3(t){var e=i3(t,"string");return typeof e=="symbol"?e:e+""}function i3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o3{constructor(){rh(this,"count",0),rh(this,"startColumn",0),rh(this,"endColumn",0),rh(this,"startPosition",0),rh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function ih(t,e,n){return(e=s3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s3(t){var e=a3(t,"string");return typeof e=="symbol"?e:e+""}function a3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l3{constructor(){ih(this,"count",0),ih(this,"startRow",0),ih(this,"endRow",0),ih(this,"startPosition",0),ih(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function R1(t,e,n){return(e=u3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u3(t){var e=c3(t,"string");return typeof e=="symbol"?e:e+""}function c3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h3 extends iF{constructor(){super(...arguments),R1(this,"columnStartOffset",0),R1(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function E1(t,e,n){return(e=d3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d3(t){var e=f3(t,"string");return typeof e=="symbol"?e:e+""}function f3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g3 extends oF{constructor(){super(...arguments),E1(this,"rowStartOffset",0),E1(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _1(t,e,n){return(e=m3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m3(t){var e=p3(t,"string");return typeof e=="symbol"?e:e+""}function p3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sF{constructor(e){_1(this,"calculationTypes",[]),_1(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function bi(t,e,n){return(e=w3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w3(t){var e=v3(t,"string");return typeof e=="symbol"?e:e+""}function v3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const wc=50;class C3 extends sF{constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),bi(this,"viewportWidth",0),bi(this,"scrollOffset",0),bi(this,"zeroBasedScrollOffset",0),bi(this,"totalColumns",0),bi(this,"columnWidthFn",null),bi(this,"columnWidth",0),bi(this,"overrideFn",null),bi(this,"inlineStartOffset",0),bi(this,"totalCalculatedWidth",0),bi(this,"startPositions",[]),bi(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?wc:n}}function Yr(t,e,n){return(e=y3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y3(t){var e=b3(t,"string");return typeof e=="symbol"?e:e+""}function b3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S3 extends sF{constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),Yr(this,"viewportHeight",0),Yr(this,"scrollOffset",0),Yr(this,"zeroBasedScrollOffset",0),Yr(this,"totalRows",0),Yr(this,"rowHeightFn",null),Yr(this,"rowHeight",0),Yr(this,"overrideFn",null),Yr(this,"horizontalScrollbarHeight",0),Yr(this,"innerViewportHeight",0),Yr(this,"totalCalculatedHeight",0),Yr(this,"startPositions",[]),Yr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function R3(t,e,n){E3(t,e),e.set(t,n)}function E3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function T1(t,e,n){return(e=_3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _3(t){var e=T3(t,"string");return typeof e=="symbol"?e:e+""}function T3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function su(t,e){return t.get(aF(t,e))}function M1(t,e,n){return t.set(aF(t,e),n),n}function aF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bo=new WeakMap;class kl{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;T1(this,"row",null),T1(this,"col",null),R3(this,Bo,!1),M1(Bo,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return su(Bo,this)}isSouthEastOf(e){return this.row>=e.row&&(su(Bo,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(su(Bo,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(su(Bo,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(su(Bo,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof kl&&M1(Bo,this,e.isRtl()),this}clone(){return new kl(this.row,this.col,su(Bo,this))}toObject(){return{row:this.row,col:this.col}}}function M3(t,e,n){I3(t,e),e.set(t,n)}function I3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zy(t,e,n){return(e=P3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P3(t){var e=O3(t,"string");return typeof e=="symbol"?e:e+""}function O3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gr(t,e){return t.get(lF(t,e))}function x3(t,e,n){return t.set(lF(t,e),n),n}function lF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var or=new WeakMap;class pf{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Zy(this,"highlight",null),Zy(this,"from",null),Zy(this,"to",null),M3(this,or,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),x3(or,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Gr(or,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Gr(or,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Gr(or,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Gr(or,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Gr(or,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Gr(or,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Gr(or,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Gr(or,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof kl))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(Gr(or,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(Gr(or,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new pf(this.highlight,this.from,this.to,Gr(or,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new kl(e,n,Gr(or,this))}}function qi(t,e,n){A3(t,e),e.set(t,n)}function A3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ge(t,e){return t.get(uF(t,e))}function As(t,e,n){return t.set(uF(t,e),n),n}function uF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qr=new WeakMap,Qy=new WeakMap,Rn=new WeakMap,au=new WeakMap,Vf=new WeakMap,Si=new WeakMap,Jy=new WeakMap,oh=new WeakMap,Da=new WeakMap,Ki=new WeakMap;let cF=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;qi(this,qr,void 0),qi(this,Qy,void 0),qi(this,Rn,void 0),qi(this,au,void 0),qi(this,Vf,void 0),qi(this,Si,void 0),qi(this,Jy,void 0),qi(this,oh,void 0),qi(this,Da,[null,null]),qi(this,Ki,[null,null]),As(qr,this,r),As(Qy,this,n),As(Rn,this,o),As(au,this,s),As(Vf,this,a),As(Si,this,i),As(Jy,this,e),this.registerEvents()}registerEvents(){ge(Si,this).addEventListener(ge(Rn,this).holder,"contextmenu",r=>this.onContextMenu(r)),ge(Si,this).addEventListener(ge(Rn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),ge(Si,this).addEventListener(ge(Rn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{ge(Si,this).addEventListener(ge(Rn,this).holder,"touchstart",r=>this.onTouchStart(r)),ge(Si,this).addEventListener(ge(Rn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),ge(Si,this).addEventListener(ge(Rn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ge(qr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ge(qr,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{ge(Si,this).addEventListener(ge(Rn,this).holder,"mouseup",r=>this.onMouseUp(r)),ge(Si,this).addEventListener(ge(Rn,this).holder,"mousedown",r=>this.onMouseDown(r))};Eo()?e():(N0()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(ge(oh,this)&&r){const[i,o]=[r.row,ge(oh,this).from.row],[s,a]=[r.col,ge(oh,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=ge(Rn,this).TABLE,i=Kh(e,["TD","TH"],r);return i?(n.coords=ge(Rn,this).getCoords(i),n.TD=i):we(e,"wtBorder")&&we(e,"current")?(n.coords=ge(au,this).getFocusSelection().cellRange.highlight,n.TD=ge(Rn,this).getCell(n.coords)):we(e,"wtBorder")&&we(e,"area")&&ge(au,this).getAreaSelection().cellRange&&(n.coords=ge(au,this).getAreaSelection().cellRange.to,n.TD=ge(Rn,this).getCell(n.coords)),n}onMouseDown(e){const n=ge(Qy,this).rootDocument.activeElement,r=H0(vL,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);we(i,"corner")?ge(qr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&ge(qr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(ge(Ki,this)[0]=o.TD,clearTimeout(ge(Da,this)[0]),ge(Da,this)[0]=setTimeout(()=>{ge(Ki,this)[0]=null},1e3))}onContextMenu(e){if(ge(qr,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!ge(qr,this).has("onCellMouseOver"))return;const n=ge(Rn,this).TABLE,r=Kh(e.target,["TD","TH"],n),i=ge(Vf,this)||this;r&&r!==i.lastMouseOver&&ga(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,ge(Rn,this).getCoords(r),r))}onMouseOut(e){if(!ge(qr,this).has("onCellMouseOut"))return;const n=ge(Rn,this).TABLE,r=Kh(e.target,["TD","TH"],n),i=Kh(e.relatedTarget,["TD","TH"],n),o=ge(Vf,this)||this;r&&r!==i&&ga(r,n)&&(this.callListener("onCellMouseOut",e,ge(Rn,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&ge(qr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===ge(Ki,this)[0]&&n.TD===ge(Ki,this)[1]?(we(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),ge(Ki,this)[0]=null,ge(Ki,this)[1]=null):n.TD===ge(Ki,this)[0]&&(ge(Ki,this)[1]=n.TD,clearTimeout(ge(Da,this)[1]),ge(Da,this)[1]=setTimeout(()=>{ge(Ki,this)[1]=null},500)))}onTouchStart(e){As(oh,this,ge(au,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&ge(qr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];k0()&&($L()||VL())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=ge(qr,this).getSettingPure(e);o&&o(n,r,i,ge(Jy,this).call(this))}destroy(){clearTimeout(ge(Da,this)[0]),clearTimeout(ge(Da,this)[1]),ge(Si,this).destroy()}};function eb(t,e,n){return(e=H3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H3(t){var e=N3(t,"string");return typeof e=="symbol"?e:e+""}function N3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D3{constructor(e,n,r){eb(this,"offset",void 0),eb(this,"total",void 0),eb(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function tb(t,e,n){return(e=k3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k3(t){var e=L3(t,"string");return typeof e=="symbol"?e:e+""}function L3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F3{constructor(e,n,r){tb(this,"offset",void 0),tb(this,"total",void 0),tb(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Wf(t,e,n){return(e=$3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $3(t){var e=V3(t,"string");return typeof e=="symbol"?e:e+""}function V3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W3{constructor(){Wf(this,"currentSize",0),Wf(this,"nextSize",0),Wf(this,"currentOffset",0),Wf(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const B3=0,I1=1,FR=2;function nb(t,e,n){return(e=j3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j3(t){var e=U3(t,"string");return typeof e=="symbol"?e:e+""}function U3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class z3{constructor(){nb(this,"size",new W3),nb(this,"workingSpace",B3),nb(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=I1,e.workingSpace=FR,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=FR,e.workingSpace=I1,this.sharedSize=e.getViewSize()}}var P1={},rb,O1;function Y3(){if(O1)return rb;O1=1;var t=Gp(),e=TypeError;return rb=function(n,r){if(!delete n[r])throw new e("Cannot delete property "+t(r)+" of "+t(n))},rb}var x1;function G3(){if(x1)return P1;x1=1;var t=wt(),e=Tc(),n=Ic(),r=ZD(),i=Y3(),o=QD(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=n(h),f=arguments.length;if(f){o(d+f);for(var g=d;g--;){var v=g+f;g in h?h[v]=h[g]:i(h,v)}for(var y=0;y<f;y++)h[y]=arguments[y]}return r(h,d+f)}}),P1}G3();function q3(t,e,n){return(e=K3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K3(t){var e=X3(t,"string");return typeof e=="symbol"?e:e+""}function X3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A1{constructor(e,n){q3(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function Z3(t,e,n){return(e=Q3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q3(t){var e=J3(t,"string");return typeof e=="symbol"?e:e+""}function J3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eX{constructor(e){Z3(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new A1(o,n),l=new A1(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(FR)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function lu(t,e,n){return(e=tX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tX(t){var e=nX(t,"string");return typeof e=="symbol"?e:e+""}function nX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hF{constructor(e,n){lu(this,"rootNode",void 0),lu(this,"nodesPool",void 0),lu(this,"sizeSet",new z3),lu(this,"collectedNodes",[]),lu(this,"viewDiffer",new eX(this.sizeSet)),lu(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class dF extends hF{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function H1(t,e,n){return(e=rX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rX(t){var e=iX(t,"string");return typeof e=="symbol"?e:e+""}function iX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oX{constructor(e){H1(this,"nodeType",void 0),H1(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function sh(t,e,n){return(e=sX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sX(t){var e=aX(t,"string");return typeof e=="symbol"?e:e+""}function aX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wf{constructor(e,n){sh(this,"nodesPool",null),sh(this,"nodeType",void 0),sh(this,"rootNode",void 0),sh(this,"table",null),sh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new oX(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function N1(t,e,n){return(e=lX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lX(t){var e=uX(t,"string");return typeof e=="symbol"?e:e+""}function uX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cX extends wf{constructor(){super("TH"),N1(this,"orderViews",new WeakMap),N1(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new dF(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Zl(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ye(d,[q2(),rq(),b0(h+1),Kl(-1)]),n[h](a,d,h)}u.end()}}}class hX extends wf{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Oo(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&ye(this.rootNode,[dL()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&ye(s,[IR(),pL(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Zl(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ye(u,[b0(a+1+this.table.rowHeadersCount),Kl(-1),K2(),...a>=0?[nq()]:[IR()]]),r[n](l,u,n)}}}}let D1=!1;class dX extends wf{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!D1&&e>1e3&&(D1=!0,et(st`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&q(r,"rowHeader")}}function fX(t,e,n){return(e=gX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gX(t){var e=mX(t,"string");return typeof e=="symbol"?e:e+""}function mX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uu={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let k1=!1;class pX extends wf{constructor(e){super("TR",e),fX(this,"orderView",void 0),this.orderView=new hF(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!k1&&e>1e3&&(k1=!0,et(st`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&ye(this.rootNode,[dL()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;ye(o,[IR(),pL(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?we(o,uu.rowEven)||(pe(o,uu.rowOdd),q(o,uu.rowEven)):we(o,uu.rowOdd)||(pe(o,uu.rowEven),q(o,uu.rowOdd))}this.orderView.end()}}function L1(t,e,n){return(e=wX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wX(t){var e=vX(t,"string");return typeof e=="symbol"?e:e+""}function vX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CX extends wf{constructor(){super("TD"),L1(this,"orderViews",new WeakMap),L1(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new dF(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),g=c.getCurrentNode();if(we(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),Zl(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var o,s;ye(g,[...g.hasAttribute("role")?[]:[G2()],Kl(-1),b0(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function an(t,e,n){return(e=yX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yX(t){var e=bX(t,"string");return typeof e=="symbol"?e:e+""}function bX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SX{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};an(this,"rootNode",void 0),an(this,"rootDocument",void 0),an(this,"rowHeaders",null),an(this,"columnHeaders",null),an(this,"colGroup",null),an(this,"rows",null),an(this,"cells",null),an(this,"rowFilter",null),an(this,"columnFilter",null),an(this,"rowUtils",null),an(this,"columnUtils",null),an(this,"rowsToRender",0),an(this,"columnsToRender",0),an(this,"rowHeaderFunctions",[]),an(this,"rowHeadersCount",0),an(this,"columnHeaderFunctions",[]),an(this,"columnHeadersCount",0),an(this,"cellRenderer",void 0),an(this,"activeOverlayName",void 0),an(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class RX{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new SX(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new cX,columnHeaders:new hX(n),colGroup:new dX(r),rows:new pX(i),cells:new CX}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function ib(t,e,n){return(e=EX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EX(t){var e=_X(t,"string");return typeof e=="symbol"?e:e+""}function _X(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TX{constructor(e,n){ib(this,"dataAccessObject",void 0),ib(this,"wtSettings",void 0),ib(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function F1(t,e,n){return(e=MX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MX(t){var e=IX(t,"string");return typeof e=="symbol"?e:e+""}function IX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PX{constructor(e,n){F1(this,"dataAccessObject",void 0),F1(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function Xi(t,e,n){return(e=OX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OX(t){var e=xX(t,"string");return typeof e=="symbol"?e:e+""}function xX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dc{constructor(e,n,r,i,o){Xi(this,"wtSettings",null),Xi(this,"domBindings",void 0),Xi(this,"TBODY",null),Xi(this,"THEAD",null),Xi(this,"COLGROUP",null),Xi(this,"hasTableHeight",!0),Xi(this,"hasTableWidth",!0),Xi(this,"isTableVisible",!1),Xi(this,"tableOffset",0),Xi(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,R0(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new PX(this.dataAccessObject,this.wtSettings),this.columnUtils=new TX(this.dataAccessObject,this.wtSettings),this.tableRenderer=new RX({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!we(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&ye(r,[gs()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!we(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ye(r,[gs()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!we(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",ye(r,[Kl(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&ye(r.parentNode,[gs()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ye(r,[gs()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=On(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=On(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new F3(f,o,c),this.columnFilter=new D3(g,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),v=y.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(bo)||this.is(ma))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(bo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(bo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=lc(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(bo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=ya(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=bL(r),s=n.cellIndex;Gs($l,n,this.wtRootElement)||Gs(Ll,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Gs(ma,n,this.wtRootElement)||Gs(bo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),Gs($l,n,this.wtRootElement)||Gs(Fl,n,this.wtRootElement)||Gs(ma,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),r=lc(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),o=i?en:lc,s=i?0:1,a=i?1:0;let l,u,c,h,d;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const f=c===0?a:0;d?u=o(d):u=o(h)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-f||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return qt(this.TABLE)}getHeight(){return en(this.TABLE)}getTotalWidth(){const e=qt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=en(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Dl(this.TABLE)}_modifyRowHeaderWidth(e){let n=ot(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const AX="stickyRowsBottom",z0={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Do(z0,"MIXIN_NAME",AX,{writable:!1,enumerable:!1});const HX="stickyColumnsStart",ww={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Do(ww,"MIXIN_NAME",HX,{writable:!1,enumerable:!1});class Y0 extends Dc{constructor(e,n,r,i){super(e,n,r,i,ma)}}ct(Y0,z0);ct(Y0,ww);const Ll="top",bo="bottom",Fl="inline_start",$l="top_inline_start_corner",ma="bottom_inline_start_corner",fF=[Ll,bo,Fl,$l,ma],NX=new Map([[Ll,`ht_clone_${Ll}`],[bo,`ht_clone_${bo}`],[Fl,`ht_clone_${Fl} ht_clone_left`],[$l,`ht_clone_${$l} ht_clone_top_left_corner`],[ma,`ht_clone_${ma} ht_clone_bottom_left_corner`]]);function DX(t,e){kX(t,e),e.add(t)}function kX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LX(t,e,n){return(e=FX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FX(t){var e=$X(t,"string");return typeof e=="symbol"?e:e+""}function $X(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ah=new WeakSet;class VX{constructor(e){DX(this,ah),LX(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=Rr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=Rr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Bf(ah,this,V1).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Bf(ah,this,V1).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Bf(ah,this,$1).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Bf(ah,this,$1).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function $1(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=On(r.wtRootElement).left;const u=Math.abs(_0(s,s));if(l>u){const c=T0(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function V1(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=On(n.wtRootElement),a=uw(o,o);if(s.top>a){const l=lc(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Kr(t,e,n){return(e=WX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WX(t){var e=BX(t,"string");return typeof e=="symbol"?e:e+""}function BX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G0{get eventManager(){return new di(this)}constructor(e,n){Kr(this,"wtTable",void 0),Kr(this,"wtScroll",void 0),Kr(this,"wtViewport",void 0),Kr(this,"wtOverlays",void 0),Kr(this,"selectionManager",void 0),Kr(this,"wtEvent",void 0),Kr(this,"guid",`wt_${v0()}`),Kr(this,"drawInterrupted",!1),Kr(this,"drawn",!1),Kr(this,"activeOverlayName","master"),Kr(this,"domBindings",void 0),Kr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new VX(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){ba(r,e[n])}])}}createCellCoords(e,n){return new kl(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new pf(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||_L(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function W1(t,e,n){return(e=jX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jX(t){var e=UX(t,"string");return typeof e=="symbol"?e:e+""}function UX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zX extends G0{constructor(e,n,r){super(e,n),W1(this,"cloneSource",void 0),W1(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.stylesHandler=r.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new cF(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function YX(t,e,n){return(e=GX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GX(t){var e=qX(t,"string");return typeof e=="symbol"?e:e+""}function qX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vf{constructor(e,n,r,i,o){YX(this,"wtSettings",null),Do(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=mc(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=mc(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Nd(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){et(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+bn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(fF.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${NX.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&ye(o,[gs()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Ll||u==="vertical"&&this.type===Fl?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Nd(e.TABLE),new zX(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class KX extends vf{constructor(e,n,r,i,o,s){super(e,n,ma,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Y0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else df(n),this.repositionOverlay();let r=en(this.clone.wtTable.TABLE);const i=qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=bn(r)),i.style.bottom=`${o}px`}}const XX="calculatedColumns",vw={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Do(vw,"MIXIN_NAME",XX,{writable:!1,enumerable:!1});class q0 extends Dc{constructor(e,n,r,i){super(e,n,r,i,bo)}}ct(q0,z0);ct(q0,vw);function ZX(t,e,n){return(e=QX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QX(t){var e=JX(t,"string");return typeof e=="symbol"?e:e+""}function JX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e4 extends vf{constructor(e,n,r,i){super(e,n,bo,r,i),ZX(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new q0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=bn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(lw(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,stylesHandler:i}=this.wot,o=i.getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=bn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=en(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=bn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return uw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=we(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(q(s,"innerBorderBottom"),o=!a):(pe(s,"innerBorderBottom"),o=a)}return o}}const t4="calculatedRows",K0={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Do(K0,"MIXIN_NAME",t4,{writable:!1,enumerable:!1});class X0 extends Dc{constructor(e,n,r,i){super(e,n,r,i,Fl)}}ct(X0,K0);ct(X0,ww);const n4="localHooks",xn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Zm(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Do(xn,"MIXIN_NAME",n4,{writable:!1,enumerable:!1});let gF=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};ct(gF,xn);const mF="active-header",Z0="header",Q0="area",ud="focus",r4="fill",i4="row",o4="column",s4="custom-selection",J0=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var B1={},j1;function a4(){if(j1)return B1;j1=1;var t=mw();return t("flat"),B1}a4();function l4(t,e){pF(t,e),e.add(t)}function U1(t,e,n){pF(t,e),e.set(t,n)}function pF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lt(t,e){return t.get(cd(t,e))}function z1(t,e,n){return t.set(cd(t,e),n),n}function cd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ii=new WeakMap,Ln=new WeakMap,jf=new WeakSet;class u4{constructor(){l4(this,jf),U1(this,Ii,void 0),U1(this,Ln,void 0)}setActiveOverlay(e){return z1(Ln,this,e),this}setActiveSelection(e){return z1(Ii,this,e),this}scan(){const e=Lt(Ii,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Lt(Ii,this).getCorners(),{wtTable:s}=Lt(Ln,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let g=s.getColumnHeader(h,f);const v=Lt(Ln,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Lt(Ii,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});v!==null&&(v!==h&&(g=s.getColumnHeader(v,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Lt(Ii,this).getCorners(),{wtTable:s}=Lt(Ln,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let g=s.getRowHeader(h,f);const v=Lt(Ln,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Lt(Ii,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});v!==null&&(v!==h&&(g=s.getRowHeader(v,f)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Lt(Ln,this);cd(jf,this,c4).call(this,(r,i)=>{const o=n.getCell(Lt(Ln,this).createCellCoords(r,i)),s=Lt(Ln,this).getSetting("onAfterDrawSelection",r,i,Lt(Ii,this).settings.layerLevel);typeof s=="string"&&q(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=Lt(Ii,this).getCorners(),{wtTable:i}=Lt(Ln,this);cd(jf,this,Y1).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Lt(Ln,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Lt(Ii,this).getCorners(),{wtTable:i}=Lt(Ln,this);cd(jf,this,Y1).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Lt(Ln,this).createCellCoords(o,s));e(a)}})}}function c4(t){let[e,n,r,i]=Lt(Ii,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=Lt(Ln,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(Lt(Ln,this).createCellCoords(e,n));if(!_o(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function Y1(t){const{wtTable:e}=Lt(Ln,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class G1{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=J0(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),vi(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Eo()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:n}=this.wot,r=n.getCSSVariableValue("cell-mobile-handle-size"),i=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),s=n.getCSSVariableValue("cell-mobile-handle-border-width"),a=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};Ae(c,(d,f)=>{this.selectionHandles.styles.bottomHitArea[f]=d,this.selectionHandles.styles.topHitArea[f]=d});const h=n.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${i}px`,background:`${o}`,border:`${s}px solid ${a}`};Ae(h,(d,f)=>{this.selectionHandles.styles.bottom[f]=d,this.selectionHandles.styles.top[f]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),v=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(r-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,c.top=`${parseInt(r-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const C=Math.min(parseInt(i+o,10),y-g-f*2),T=Math.min(parseInt(i+o-v/4,10),y-v-f*2);h[l]=`${C}px`,d[l]=`${T}px`;const A=Math.min(parseInt(r+s,10),E-g-f*2),F=Math.min(parseInt(r+s-v/4,10),E-v-f*2);h.top=`${A}px`,d.top=`${F}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=s.getFirstRenderedRow(),h=s.getLastRenderedRow(),d=s.getFirstRenderedColumn(),f=s.getLastRenderedColumn();if(d<0&&f<0||c<0&&h<0){this.disappear();return}let g;if(u){if(r=Math.max(r,d),o=Math.min(o,f),n=Math.max(n,c),i=Math.min(i,h),o<r||i<n){this.disappear();return}g=s.getCell(this.wot.createCellCoords(n,r))}else if(g=s.getCell(this.wot.createCellCoords(n,r)),!_o(g)){this.disappear();return}const v=u?s.getCell(this.wot.createCellCoords(i,o)):g,y=On(g),E=u?On(v):y,C=On(s.TABLE),T=y.top,A=y.left,F=this.wot.wtSettings.getSetting("rtlMode");let I=0,O=0;if(F){const be=qt(s.TABLE),He=qt(g),gt=l.innerWidth-C.left-be;O=A+He-E.left,I=l.innerWidth-A-He-gt-1}else O=E.left+qt(v)-A,I=A-C.left-1;if(this.isEntireColumnSelected(n,i)){const be=n,He=this.getDimensionsFromHeader("columns",r,o,be,C);let gt=null;He&&([gt,I,O]=He),gt&&(g=gt)}let Y=T-C.top-1,U=E.top+en(v)-T;if(this.isEntireRowSelected(r,o)){const be=r,He=this.getDimensionsFromHeader("rows",n,i,be,C);let gt=null;He&&([gt,Y,U]=He),gt&&(g=gt)}const W=l.getComputedStyle(g);parseInt(W.borderTopWidth,10)>0&&(Y+=1,U=U>0?U-1:0),parseInt(W[F?"borderRightWidth":"borderLeftWidth"],10)>0&&(I+=1,O=O>0?O-1:0);const Z=F?"right":"left";this.topStyle.top=`${Y}px`,this.topStyle[Z]=`${I}px`,this.topStyle.width=`${O}px`,this.topStyle.display="block",this.startStyle.top=`${Y}px`,this.startStyle[Z]=`${I}px`,this.startStyle.height=`${U}px`,this.startStyle.display="block";const Q=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${Y+U-Q}px`,this.bottomStyle[Z]=`${I}px`,this.bottomStyle.width=`${O}px`,this.bottomStyle.display="block",this.endStyle.top=`${Y}px`,this.endStyle[Z]=`${I+O-Q}px`,this.endStyle.height=`${U+1}px`,this.endStyle.display="block";let oe=this.settings.border.cornerVisible;oe=typeof oe=="function"?oe(this.settings.layerLevel):oe;const te=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[ae,ft]=[i,o];if(te&&Array.isArray(te)&&([,,ae,ft]=te),Eo()||!oe||this.isPartRange(ae,ft))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Y+U+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[Z]=`${I+O+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let be=mc(s.TABLE);const He=be===l;He&&(be=a.documentElement);const gt=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Xt=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),Ke=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const m=He?v.getBoundingClientRect().left:v.offsetLeft;let w=!1,p=0;F?(p=m-parseInt(this.cornerDefaultStyle.width,10)/2,w=p<0):(p=m+qt(v)+parseInt(this.cornerDefaultStyle.width,10)/2,w=p>=T0(be)),w&&(this.cornerStyle[Z]=`${Math.floor(I+O+this.cornerCenterPointOffset-Xt-gt)}px`,this.cornerStyle[F?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const p=(He?v.getBoundingClientRect().top:v.offsetTop)+en(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=lc(be),_=this.wot.stylesHandler.isClassicTheme();if(p){const H=Math.floor(Y+U+this.cornerCenterPointOffset-Ke-gt);_?(this.cornerStyle.top=`${H}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${H-1}px`}}this.cornerStyle.display="block"}Eo()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,Y,I,O,U)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,g=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return en(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return qt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(g=l(n,y-i),v=l(r,y-i),!g||!v)return!1;const E=On(g),C=On(v);return g&&v&&(h=E[f]-o[f]-1,d=C[f]+u(v)-E[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?q(this[e],"hidden"):(we(this[e],"hidden")&&pe(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?q(this[e],"hidden"):pe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Eo()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function h4(t,e){wF(t,e),e.add(t)}function cu(t,e,n){wF(t,e),e.set(t,n)}function wF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ne(t,e){return t.get(e_(t,e))}function q1(t,e,n){return t.set(e_(t,e),n),n}function e_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fn=new WeakMap,wr=new WeakMap,ob=new WeakMap,Xh=new WeakMap,sb=new WeakMap,ka=new WeakMap,K1=new WeakSet;class d4{constructor(e){h4(this,K1),cu(this,Fn,void 0),cu(this,wr,void 0),cu(this,ob,new u4),cu(this,Xh,new WeakMap),cu(this,sb,new WeakSet),cu(this,ka,new Map),q1(wr,this,e)}setActiveOverlay(e){return q1(Fn,this,e),Ne(ob,this).setActiveOverlay(Ne(Fn,this)),Ne(Xh,this).has(Ne(Fn,this))||Ne(Xh,this).set(Ne(Fn,this),new Set),this}getFocusSelection(){return Ne(wr,this)!==null?Ne(wr,this).getFocus():null}getAreaSelection(){return Ne(wr,this)!==null?Ne(wr,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Ne(ka,this).has(e)){const r=Ne(ka,this).get(e);if(r.has(Ne(Fn,this)))return r.get(Ne(Fn,this));const i=new G1(Ne(Fn,this),e.settings);return r.set(Ne(Fn,this),i),i}const n=new G1(Ne(Fn,this),e.settings);return Ne(ka,this).set(e,new Map([[Ne(Fn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=Ne(ka,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Ne(ka,this).get(e).forEach(n=>n.destroy()),Ne(ka,this).delete(e)}render(e){if(Ne(wr,this)===null)return;e&&e_(K1,this,f4).call(this);const n=Array.from(Ne(wr,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Ne(sb,this).has(s)||(Ne(sb,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&Ne(ob,this).setActiveSelection(s).scan().forEach(g=>{if(r.has(g)){const v=r.get(g);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else r.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const d=s.getCorners();Ne(Fn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>Ne(Xh,this).get(Ne(Fn,this)).add(u)),q(s,l),s.nodeName==="TD"&&Array.isArray((a=Ne(wr,this).options)===null||a===void 0?void 0:a.cellAttributes)&&ye(s,Ne(wr,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{ye(o,[...i.get(o)])})}}function f4(){const t=Ne(Xh,this).get(Ne(Fn,this)),e=Ne(Fn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=Ne(Fn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=Ne(wr,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=Ne(wr,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=Ne(wr,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...Ne(wr,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)pe(o[a],n),Zl(o[a],s)}),t.clear()}class g4 extends vf{constructor(e,n,r,i){super(e,n,Fl,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new X0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),cw(r,`${o}px`,"0px")):(o=this.getScrollPosition(),df(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,E0(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=bn(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=qt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=J0(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!we(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=bn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,ML(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(_0(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?pe(r,"emptyRows"):q(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)q(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=we(r,"innerBorderInlineStart");e?(q(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(pe(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const m4="stickyRowsTop",t_={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Do(t_,"MIXIN_NAME",m4,{writable:!1,enumerable:!1});class n_ extends Dc{constructor(e,n,r,i){super(e,n,r,i,$l)}}ct(n_,t_);ct(n_,ww);function X1(t,e,n){return(e=p4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p4(t){var e=w4(t,"string");return typeof e=="symbol"?e:e+""}function w4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v4 extends vf{constructor(e,n,r,i,o,s){super(e,n,$l,r,i),X1(this,"topOverlay",void 0),X1(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new n_(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();cw(e,`${i}px`,`${o}px`)}else df(e);let n=en(this.clone.wtTable.TABLE);const r=qt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class r_ extends Dc{constructor(e,n,r,i){super(e,n,r,i,Ll)}}ct(r_,t_);ct(r_,vw);function C4(t,e,n){return(e=y4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y4(t){var e=b4(t,"string");return typeof e=="symbol"?e:e+""}function b4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S4 extends vf{constructor(e,n,r,i){super(e,n,Ll,r,i),C4(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new r_(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),cw(e,"0px",`${i}px`)}else i=this.getScrollPosition(),df(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(lw(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wot.stylesHandler.getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=bn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=en(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=J0(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!we(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=bn(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,TL(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return uw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?pe(i,"emptyColumns"):q(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=we(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(q(i,"innerBorderTop"),a=!h):(pe(i,"innerBorderTop"),a=h)}}return a}}function Uf(t,e,n){R4(t,e),e.set(t,n)}function R4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jo(t,e,n){return(e=E4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E4(t){var e=_4(t,"string");return typeof e=="symbol"?e:e+""}function _4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function La(t,e,n){return t.set(vF(t,e),n),n}function Uo(t,e){return t.get(vF(t,e))}function vF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hu=new WeakMap,zf=new WeakMap,du=new WeakMap,Yf=new WeakMap;class T4{constructor(e,n,r,i,o,s){jo(this,"wot",null),Uf(this,hu,[]),jo(this,"topOverlay",null),jo(this,"bottomOverlay",null),jo(this,"inlineStartOverlay",null),jo(this,"topInlineStartCornerOverlay",null),jo(this,"bottomInlineStartCornerOverlay",null),jo(this,"browserLineHeight",void 0),jo(this,"wtSettings",null),Uf(this,zf,!1),Uf(this,du,0),Uf(this,Yf,null),jo(this,"resizeObserver",new ResizeObserver(c=>{kd(()=>{!Array.isArray(c)||!c.length||(La(du,this,Uo(du,this)+1),Uo(du,this)===100&&(et("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Uo(Yf,this)!==null&&clearTimeout(Uo(Yf,this)),La(Yf,this,setTimeout(()=>{La(du,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=bn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Nd(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...Uo(hu,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new S4(...e),this.bottomOverlay=new e4(...e),this.inlineStartOverlay=new g4(...e),this.topInlineStartCornerOverlay=new v4(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new KX(...e,this.bottomOverlay,this.inlineStartOverlay),La(hu,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){La(zf,this,Uo(hu,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),Uo(hu,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Uo(hu,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!D0())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{kd(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{La(du,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Nc(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Uo(zf,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),La(zf,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Nd(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),v=f()?1:0,y=g()?1:0;d.width=`${c+y}px`,d.height=`${u+v}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return M(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];M(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function Z1(t,e,n){return(e=M4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M4(t){var e=I4(t,"string");return typeof e=="symbol"?e:e+""}function I4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P4{constructor(e){Z1(this,"settings",{}),Z1(this,"defaults",Object.freeze(this.getDefaults())),Ae(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);ba(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ae(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class i_ extends Dc{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=mc(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Dd(e,"height",n),o=Dd(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Dl(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}ct(i_,K0);ct(i_,vw);class O4{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new l3:new g3],["fullyVisible",()=>new QK],["partiallyVisible",()=>new oF]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new o3:new h3],["fullyVisible",()=>new KK],["partiallyVisible",()=>new iF]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=en(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return On(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=en(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=qt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=bn(this.domBindings.rootDocument),new S3({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=bn(this.domBindings.rootDocument)),new C3({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){Ae(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}function x4(t,e){CF(t,e),e.add(t)}function Fa(t,e,n){CF(t,e),e.set(t,n)}function CF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function It(t,e){return t.get(ki(t,e))}function Di(t,e,n){return t.set(ki(t,e),n),n}function ki(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Q1=23;var uo=new WeakMap,hs=new WeakMap,o_=new WeakMap,$R=new WeakMap,qs=new WeakMap,Zh=new WeakMap,$d=new WeakMap,fo=new WeakSet;class A4{constructor(e){x4(this,fo),Fa(this,uo,void 0),Fa(this,hs,void 0),Fa(this,o_,void 0),Fa(this,$R,void 0),Fa(this,qs,!0),Fa(this,Zh,{}),Fa(this,$d,{}),Di(hs,this,e.rootTable.parentElement.parentElement),Di($R,this,e.rootDocument)}isClassicTheme(){return It(qs,this)}getCSSVariableValue(e){var n;if(It(qs,this))return null;if(It(Zh,this)[`--ht-${e}`])return It(Zh,this)[`--ht-${e}`];const r=(n=ki(fo,this,k4).call(this,`--ht-${e}`))!==null&&n!==void 0?n:ki(fo,this,yF).call(this,`--ht-${e}`);if(r!==null)return It(Zh,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=It($d,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(It(qs,this))return Q1;const e=ki(fo,this,H4).call(this);return!e&&we(It(hs,this),"ht-wrapper")?(et(`The "${It(uo,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),Di(qs,this,!0),this.useTheme(),Q1):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){ki(fo,this,J1).call(this),Di(qs,this,!0),Di(uo,this,e||void 0);return}e&&e!==It(uo,this)&&(It(uo,this)&&ki(fo,this,L4).call(this),Di(uo,this,e),Di(qs,this,!1),ki(fo,this,N4).call(this),ki(fo,this,J1).call(this))}getThemeName(){return It(uo,this)}removeClassNames(){we(It(hs,this),It(uo,this))&&pe(It(hs,this),It(uo,this))}}function H4(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function N4(){pe(It(hs,this),/ht-theme-.*/g),q(It(hs,this),It(uo,this))}function J1(){this.isClassicTheme()||Di(o_,this,getComputedStyle(It(hs,this)));const t=ki(fo,this,D4).call(this,["box-sizing","border-bottom-width"]);It($d,this).td={...It($d,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function D4(t){const e=It($R,this),n=It(hs,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function k4(t){const e=Math.ceil(parseFloat(ki(fo,this,yF).call(this,t)));return Number.isNaN(e)?null:e}function yF(t){const e=It(o_,this).getPropertyValue(t);return e===""?null:e}function L4(){Di($d,this,{}),Di(Zh,this,{}),Di(qs,this,!0)}class F4 extends G0{constructor(e,n){super(e,new P4(n)),this.stylesHandler=new A4(this.domBindings);const r=this.wtSettings.getSetting("facade",this);this.wtTable=new i_(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new O4(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new d4(this.wtSettings.getSetting("selections")),this.wtEvent=new cF(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new T4(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ae(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),pe(this.wtTable.wtRootElement.parentNode,n),q(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!fF.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class s_{constructor(e){e instanceof G0?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new s_(n);return()=>r},this._wot=new F4(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function eA(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function $4(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}const V4=new Map([["mousedown",eA],["mouseover",$4],["touchstart",eA]]);function tA(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;V4.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:gw(t)||t.type==="touchstart",isRightClick:Sa(t)})}const bF=new WeakMap,a_=Symbol("rootInstance");function W4(t){bF.set(t,!0)}function B4(t){return t===a_}function Sm(t){return bF.has(t)}function j4(t,e){SF(t,e),e.add(t)}function Hs(t,e,n){SF(t,e),e.set(t,n)}function SF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ns(t,e,n){return(e=U4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U4(t){var e=z4(t,"string");return typeof e=="symbol"?e:e+""}function z4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zt(t,e){return t.get(cc(t,e))}function sr(t,e,n){return t.set(cc(t,e),n),n}function cc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ab=new WeakMap,Gf=new WeakMap,qf=new WeakMap,zo=new WeakMap,Ri=new WeakMap,lb=new WeakMap,ub=new WeakMap,fu=new WeakMap,Qh=new WeakSet;class Y4{constructor(e){j4(this,Qh),Ns(this,"hot",void 0),Ns(this,"eventManager",void 0),Ns(this,"settings",void 0),Ns(this,"THEAD",void 0),Ns(this,"TBODY",void 0),Ns(this,"_wt",void 0),Ns(this,"activeWt",void 0),Hs(this,ab,0),Hs(this,Gf,0),Ns(this,"postponedAdjustElementsSize",!1),Hs(this,qf,!1),Hs(this,zo,void 0),Hs(this,Ri,void 0),Hs(this,lb,0),Hs(this,ub,0),Hs(this,fu,null),this.hot=e,this.eventManager=new di(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),cc(Qh,this,q4).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),q(e,"handsontable"),sr(Ri,this,n.createElement("TABLE")),q(Zt(Ri,this),"htCore"),this.hot.getSettings().tableClassName&&q(Zt(Ri,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(ye(Zt(Ri,this),[gs()]),ye(e,[Y2(),mL(-1),aw(this.hot.countCols()),sq()])),this.THEAD=n.createElement("THEAD"),Zt(Ri,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),Zt(Ri,this).appendChild(this.TBODY),this.hot.table=Zt(Ri,this),this.hot.container.insertBefore(Zt(Ri,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{sr(qf,this,!0),this.isTextSelectionAllowed(a.target)||(PR(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{sr(qf,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Zt(qf,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&PR(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&gw(a)&&r.finish(),sr(zo,this,!1);const l=hw(n.activeElement);ld(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!Sa(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&Sa(a)&&(r.finish(),sr(zo,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),sr(zo,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(Zt(zo,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const g=bn(n);if(n.elementFromPoint(u+g,c)!==d||n.elementFromPoint(u,c+g)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=Nl(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=Nl(s);this.eventManager.addEventListener(Zt(Ri,this),"selectstart",a=>{this.settings.fragmentSelection||ld(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&q(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&pe(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Zt(Ri,this),isDataViewInstance:()=>Sm(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),sr(Gf,this,o.length),this.hot.getSettings().ariaTags&&cc(Qh,this,RF).call(this)===this.hot.countCols()&&cc(Qh,this,G4).call(this,Zt(Gf,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),sr(ab,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,v,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,v,f),this.hot.runHooks("afterRenderer",a,l,u,g,v,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Dl(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,sr(zo,this,!0),sr(fu,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!ta(o)&&(tA(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,sr(zo,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!ta(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!ta(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!ta(o)&&(Zt(zo,this)&&(!Zt(fu,this)||Zt(fu,this).x!==o.clientX||Zt(fu,this).y!==o.clientY)&&tA(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,sr(fu,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(ta(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,v,y,E]=f;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new s_(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(ld(e))return!0;const n=ga(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Zt(zo,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!we(r,"relative")){Oo(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;we(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",q(s,["relative",...o()])):(Oo(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(ye(a,...gs()),ye(l,...gs())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(we(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):we(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Ql(e,r(n,i)):(ba(e," "),q(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){sr(lb,this,e),sr(ub,this,n)}getLastSize(){return{width:Zt(lb,this),height:Zt(ub,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Zt(ab,this)}getRowHeadersCount(){return Zt(Gf,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function RF(){return parseInt(this.hot.rootElement.getAttribute(aw()[0]),10)}function G4(t){const e=cc(Qh,this,RF).call(this)+t;ye(this.hot.rootElement,...aw(e))}function q4(){const t=this.hot.rootElement;this.hasVerticalScroll()?q(t,"htHasScrollY"):pe(t,"htHasScrollY"),this.hasHorizontalScroll()?q(t,"htHasScrollX"):pe(t,"htHasScrollX")}var nA={},rA={},iA;function K4(){if(iA)return rA;iA=1;var t=wt(),e=dn(),n=Pc(),r=Er(),i=gn(),o=Ao(),s=_r(),a=Ma(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return!n(h,function(f,g){if(!c(f,d++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),rA}var oA;function X4(){return oA||(oA=1,K4()),nA}X4();const EF="ABCDEFGHIJKLMNOPQRSTUVWXYZ",VR=EF.length;function Cw(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%VR,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/VR,10);return n}function Z4(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=VR**r*(EF.indexOf(t[n])+1);return e-=1,e}function Q4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(Cw(i)+(r+1));n.push(o)}return n}function J4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=Cw(i)+(r+1);n.push(o)}return n}function e9(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function l_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function u_(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&xe(t[0])&&(e=fw(t[0]))),e}function _F(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function TF(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const t9=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:u_,createEmptySpreadsheetData:e9,createSpreadsheetData:Q4,createSpreadsheetObjectData:J4,dataRowToChangesArray:l_,isArrayOfArrays:_F,isArrayOfObjects:TF,spreadsheetColumnIndex:Z4,spreadsheetColumnLabel:Cw},Symbol.toStringTag,{value:"Module"}));function lh(t,e,n){return(e=n9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n9(t){var e=r9(t,"string");return typeof e=="symbol"?e:e+""}function r9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class i9{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];lh(this,"hot",void 0),lh(this,"data",void 0),lh(this,"dataType","array"),lh(this,"colToProp",()=>{}),lh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return M(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):fe(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(xe(a)||ot(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;fe(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?Cm(l,d,f):l[d]=f}})}else Ae(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Cm(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Rr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:Cm(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?NL(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Rr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return fe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return u_(this.data)}destroy(){this.data=null,this.hot=null}}var sA={},aA={},lA;function o9(){if(lA)return aA;lA=1;var t=wt(),e=dn(),n=Pc(),r=Er(),i=gn(),o=Ao(),s=_r(),a=Ma(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,g){if(c(f,d++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),aA}var uA;function s9(){return uA||(uA=1,o9()),sA}s9();function cA(t,e,n){return(e=a9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a9(t){var e=l9(t,"string");return typeof e=="symbol"?e:e+""}function l9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;cA(this,"indexedValues",[]),cA(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ot(this.initValueOrFn)?fe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):fe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}ct(Jl,xn);function c_(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>ot(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function h_(t,e){return Ca(t,(n,r)=>e.includes(r)===!1)}class Ia extends Jl{insert(e,n){this.indexedValues=c_(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=h_(this.indexedValues,e),super.remove(e)}}class yw extends Ia{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return mn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function d_(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Vd(t,e){return Ca(t,n=>e.includes(n)===!1)}function f_(t,e){return Be(t,n=>n-e.filter(r=>r<n).length)}function g_(t,e){const n=e[0],r=e.length;return Be(t,i=>i>=n?i+r:i)}function u9(t,e,n){return(e=c9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c9(t){var e=h9(t,"string");return typeof e=="symbol"?e:e+""}function h9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bw extends Jl{constructor(){super(...arguments),u9(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Vd(this.orderOfIndexes,[e]),ot(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=c_(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=g_(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=h_(this.indexedValues,e),this.orderOfIndexes=Vd(this.orderOfIndexes,e),this.orderOfIndexes=f_(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Cf extends Ia{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return mn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const hA=new Map([["indexesSequence",{getListWithInsertedItems:d_,getListWithRemovedItems:Vd}],["physicallyIndexed",{getListWithInsertedItems:c_,getListWithRemovedItems:h_}]]),MF=t=>{if(hA.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return hA.get(t)};class IF extends Jl{constructor(){super(e=>e)}insert(e,n){const r=g_(this.indexedValues,n);this.indexedValues=d_(r,e,n),super.insert(e,n)}remove(e){const n=Vd(this.indexedValues,e);this.indexedValues=f_(n,e),super.remove(e)}}const dA=new Map([["hiding",yw],["index",Jl],["linkedPhysicalIndexToValue",bw],["physicalIndexToValue",Ia],["trimming",Cf]]);function d9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!dA.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(dA.get(t))(e)}function f9(t,e,n){return(e=g9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g9(t){var e=m9(t,"string");return typeof e=="symbol"?e:e+""}function m9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let WR=0;class m_{constructor(){f9(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),WR+=1)}unregister(e){const n=this.collection.get(e);le(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),WR-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Pt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}ct(m_,xn);function p9(){return WR}function cb(t,e,n){return(e=w9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w9(t){var e=v9(t,"string");return typeof e=="symbol"?e:e+""}function v9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fA extends m_{constructor(e,n){super(),cb(this,"mergedValuesCache",[]),cb(this,"aggregationFunction",void 0),cb(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Be(this.get(),o=>o.getValues()),r=[],i=le(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Be(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return le(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function C9(t,e,n){y9(t,e),e.set(t,n)}function y9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function b9(t,e,n){return t.set(PF(t,e),n),n}function S9(t,e){return t.get(PF(t,e))}function PF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hb=new WeakMap;class OF{constructor(){C9(this,hb,[])}subscribe(e){return this.addLocalHook("change",e),this._write(S9(hb,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){b9(hb,this,e)}}ct(OF,xn);function gA(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function uh(t,e,n){R9(t,e),e.set(t,n)}function R9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xr(t,e){return t.get(xF(t,e))}function Kf(t,e,n){return t.set(xF(t,e),n),n}function xF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xf=new WeakMap,ch=new WeakMap,Zf=new WeakMap,Qf=new WeakMap,Jf=new WeakMap;class E9{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};uh(this,Xf,new Set),uh(this,ch,[]),uh(this,Zf,[]),uh(this,Qf,!1),uh(this,Jf,!1),Kf(Jf,this,e??!1)}createObserver(){const e=new OF;return Xr(Xf,this).add(e),e.addLocalHook("unsubscribe",()=>{Xr(Xf,this).delete(e)}),e._writeInitialChanges(gA(Xr(ch,this),Xr(Zf,this))),e}emit(e){let n=Xr(Zf,this);(!Xr(Qf,this)||Xr(ch,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Xr(Jf,this)):Kf(ch,this,new Array(e.length).fill(Xr(Jf,this))),Xr(Qf,this)||(Kf(Qf,this,!0),n=Xr(ch,this)));const r=gA(n,e);Xr(Xf,this).forEach(i=>i._write(r)),Kf(Zf,this,e)}}function Yn(t,e,n){return(e=_9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _9(t){var e=T9(t,"string");return typeof e=="symbol"?e:e+""}function T9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BR{constructor(){Yn(this,"indexesSequence",new IF),Yn(this,"trimmingMapsCollection",new fA(e=>e.some(n=>n===!0),!1)),Yn(this,"hidingMapsCollection",new fA(e=>e.some(n=>n===!0),!1)),Yn(this,"variousMapsCollection",new m_),Yn(this,"hidingChangesObservable",new E9({initialIndexValue:!1})),Yn(this,"notTrimmedIndexesCache",[]),Yn(this,"notHiddenIndexesCache",[]),Yn(this,"isBatched",!1),Yn(this,"indexesSequenceChanged",!1),Yn(this,"indexesChangeSource",void 0),Yn(this,"trimmedIndexesChanged",!1),Yn(this,"hiddenIndexesChanged",!1),Yn(this,"renderablePhysicalIndexesCache",[]),Yn(this,"fromPhysicalToVisualIndexesCache",new Map),Yn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,d9(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Cf?this.trimmingMapsCollection.register(e,n):n instanceof yw?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return le(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return le(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return le(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return le(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Be(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Vd(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(d_(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=le(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Be(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}ct(BR,xn);function M9(t,e){return Ae(e,(n,r)=>{Pt(t[r])&&(t[r]=n)}),t}function AF(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function HF(t){le(t)&&$0(st`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function I9(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:P9,getValues:O9}=Yi("phraseFormatters");function x9(t,e){P9(t,e)}function A9(){return O9()}x9("pluralize",I9);const NF="ContextMenu:items",Me=NF,p_=`${Me}.noItems`,w_=`${Me}.insertRowAbove`,v_=`${Me}.insertRowBelow`,C_=`${Me}.insertColumnOnTheLeft`,y_=`${Me}.insertColumnOnTheRight`,b_=`${Me}.removeRow`,S_=`${Me}.removeColumn`,R_=`${Me}.undo`,E_=`${Me}.redo`,np=`${Me}.readOnly`,__=`${Me}.clearColumn`,T_=`${Me}.copy`,M_=`${Me}.copyWithHeaders`,I_=`${Me}.copyWithGroupHeaders`,P_=`${Me}.copyHeadersOnly`,O_=`${Me}.cut`,x_=`${Me}.freezeColumn`,A_=`${Me}.unfreezeColumn`,H_=`${Me}.mergeCells`,N_=`${Me}.unmergeCells`,D_=`${Me}.addComment`,k_=`${Me}.editComment`,L_=`${Me}.removeComment`,F_=`${Me}.readOnlyComment`,$_=`${Me}.align`,V_=`${Me}.align.left`,W_=`${Me}.align.center`,B_=`${Me}.align.right`,j_=`${Me}.align.justify`,U_=`${Me}.align.top`,z_=`${Me}.align.middle`,Y_=`${Me}.align.bottom`,G_=`${Me}.borders`,q_=`${Me}.borders.top`,K_=`${Me}.borders.right`,X_=`${Me}.borders.bottom`,Z_=`${Me}.borders.left`,Q_=`${Me}.borders.remove`,J_=`${Me}.nestedHeaders.insertChildRow`,eT=`${Me}.nestedHeaders.detachFromParent`,tT=`${Me}.hideColumn`,nT=`${Me}.showColumn`,rT=`${Me}.hideRow`,iT=`${Me}.showRow`,rr="Filters:",Bt=`${rr}conditions`,Sw=`${Bt}.none`,oT=`${Bt}.isEmpty`,sT=`${Bt}.isNotEmpty`,aT=`${Bt}.isEqualTo`,lT=`${Bt}.isNotEqualTo`,uT=`${Bt}.beginsWith`,cT=`${Bt}.endsWith`,hT=`${Bt}.contains`,dT=`${Bt}.doesNotContain`,H9=`${Bt}.byValue`,fT=`${Bt}.greaterThan`,gT=`${Bt}.greaterThanOrEqualTo`,mT=`${Bt}.lessThan`,pT=`${Bt}.lessThanOrEqualTo`,wT=`${Bt}.isBetween`,vT=`${Bt}.isNotBetween`,CT=`${Bt}.after`,yT=`${Bt}.before`,bT=`${Bt}.today`,ST=`${Bt}.tomorrow`,RT=`${Bt}.yesterday`,ET=`${rr}labels.filterByCondition`,_T=`${rr}labels.filterByValue`,TT=`${rr}labels.conjunction`,Rw=`${rr}labels.disjunction`,rp=`${rr}values.blankCells`,MT=`${rr}buttons.selectAll`,IT=`${rr}buttons.clear`,PT=`${rr}buttons.ok`,OT=`${rr}buttons.cancel`,xT=`${rr}buttons.placeholder.search`,AT=`${rr}buttons.placeholder.value`,HT=`${rr}buttons.placeholder.secondValue`,NT="CheckboxRenderer:",DT=`${NT}checked`,kT=`${NT}unchecked`,N9=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:DT,CHECKBOX_RENDERER_NAMESPACE:NT,CHECKBOX_UNCHECKED:kT,CONTEXTMENU_ITEMS_ADD_COMMENT:D_,CONTEXTMENU_ITEMS_ALIGNMENT:$_,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Y_,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:W_,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:j_,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:V_,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:z_,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:B_,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:U_,CONTEXTMENU_ITEMS_BORDERS:G_,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:X_,CONTEXTMENU_ITEMS_BORDERS_LEFT:Z_,CONTEXTMENU_ITEMS_BORDERS_RIGHT:K_,CONTEXTMENU_ITEMS_BORDERS_TOP:q_,CONTEXTMENU_ITEMS_CLEAR_COLUMN:__,CONTEXTMENU_ITEMS_COPY:T_,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:P_,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:I_,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:M_,CONTEXTMENU_ITEMS_CUT:O_,CONTEXTMENU_ITEMS_EDIT_COMMENT:k_,CONTEXTMENU_ITEMS_FREEZE_COLUMN:x_,CONTEXTMENU_ITEMS_HIDE_COLUMN:tT,CONTEXTMENU_ITEMS_HIDE_ROW:rT,CONTEXTMENU_ITEMS_INSERT_LEFT:C_,CONTEXTMENU_ITEMS_INSERT_RIGHT:y_,CONTEXTMENU_ITEMS_MERGE_CELLS:H_,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:eT,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:J_,CONTEXTMENU_ITEMS_NO_ITEMS:p_,CONTEXTMENU_ITEMS_READ_ONLY:np,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:F_,CONTEXTMENU_ITEMS_REDO:E_,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Q_,CONTEXTMENU_ITEMS_REMOVE_COLUMN:S_,CONTEXTMENU_ITEMS_REMOVE_COMMENT:L_,CONTEXTMENU_ITEMS_REMOVE_ROW:b_,CONTEXTMENU_ITEMS_ROW_ABOVE:w_,CONTEXTMENU_ITEMS_ROW_BELOW:v_,CONTEXTMENU_ITEMS_SHOW_COLUMN:nT,CONTEXTMENU_ITEMS_SHOW_ROW:iT,CONTEXTMENU_ITEMS_UNDO:R_,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:A_,CONTEXTMENU_ITEMS_UNMERGE_CELLS:N_,CONTEXT_MENU_ITEMS_NAMESPACE:NF,FILTERS_BUTTONS_CANCEL:OT,FILTERS_BUTTONS_CLEAR:IT,FILTERS_BUTTONS_OK:PT,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:xT,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:HT,FILTERS_BUTTONS_PLACEHOLDER_VALUE:AT,FILTERS_BUTTONS_SELECT_ALL:MT,FILTERS_CONDITIONS_AFTER:CT,FILTERS_CONDITIONS_BEFORE:yT,FILTERS_CONDITIONS_BEGINS_WITH:uT,FILTERS_CONDITIONS_BETWEEN:wT,FILTERS_CONDITIONS_BY_VALUE:H9,FILTERS_CONDITIONS_CONTAINS:hT,FILTERS_CONDITIONS_EMPTY:oT,FILTERS_CONDITIONS_ENDS_WITH:cT,FILTERS_CONDITIONS_EQUAL:aT,FILTERS_CONDITIONS_GREATER_THAN:fT,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:gT,FILTERS_CONDITIONS_LESS_THAN:mT,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:pT,FILTERS_CONDITIONS_NAMESPACE:Bt,FILTERS_CONDITIONS_NONE:Sw,FILTERS_CONDITIONS_NOT_BETWEEN:vT,FILTERS_CONDITIONS_NOT_CONTAIN:dT,FILTERS_CONDITIONS_NOT_EMPTY:sT,FILTERS_CONDITIONS_NOT_EQUAL:lT,FILTERS_CONDITIONS_TODAY:bT,FILTERS_CONDITIONS_TOMORROW:ST,FILTERS_CONDITIONS_YESTERDAY:RT,FILTERS_DIVS_FILTER_BY_CONDITION:ET,FILTERS_DIVS_FILTER_BY_VALUE:_T,FILTERS_LABELS_CONJUNCTION:TT,FILTERS_LABELS_DISJUNCTION:Rw,FILTERS_NAMESPACE:rr,FILTERS_VALUES_BLANK_CELLS:rp},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const DF={languageCode:"en-US",[p_]:"No available options",[w_]:"Insert row above",[v_]:"Insert row below",[C_]:"Insert column left",[y_]:"Insert column right",[b_]:["Remove row","Remove rows"],[S_]:["Remove column","Remove columns"],[R_]:"Undo",[E_]:"Redo",[np]:"Read only",[__]:"Clear column",[$_]:"Alignment",[V_]:"Left",[W_]:"Center",[B_]:"Right",[j_]:"Justify",[U_]:"Top",[z_]:"Middle",[Y_]:"Bottom",[x_]:"Freeze column",[A_]:"Unfreeze column",[G_]:"Borders",[q_]:"Top",[K_]:"Right",[X_]:"Bottom",[Z_]:"Left",[Q_]:"Remove border(s)",[D_]:"Add comment",[k_]:"Edit comment",[L_]:"Delete comment",[F_]:"Read-only comment",[H_]:"Merge cells",[N_]:"Unmerge cells",[T_]:"Copy",[M_]:["Copy with header","Copy with headers"],[I_]:["Copy with group header","Copy with group headers"],[P_]:["Copy header only","Copy headers only"],[O_]:"Cut",[J_]:"Insert child row",[eT]:"Detach from parent",[tT]:["Hide column","Hide columns"],[nT]:["Show column","Show columns"],[rT]:["Hide row","Hide rows"],[iT]:["Show row","Show rows"],[Sw]:"None",[oT]:"Is empty",[sT]:"Is not empty",[aT]:"Is equal to",[lT]:"Is not equal to",[uT]:"Begins with",[cT]:"Ends with",[hT]:"Contains",[dT]:"Does not contain",[fT]:"Greater than",[gT]:"Greater than or equal to",[mT]:"Less than",[pT]:"Less than or equal to",[wT]:"Is between",[vT]:"Is not between",[CT]:"After",[yT]:"Before",[bT]:"Today",[ST]:"Tomorrow",[RT]:"Yesterday",[rp]:"Blank cells",[ET]:"Filter by condition",[_T]:"Filter by value",[TT]:"And",[Rw]:"Or",[MT]:"Select all",[IT]:"Clear",[PT]:"OK",[OT]:"Cancel",[xT]:"Search",[AT]:"Value",[HT]:"Second value",[DT]:"Checked",[kT]:"Unchecked"},D9=N9,jR=DF.languageCode,{register:k9,getItem:kF,hasItem:L9,getValues:F9}=Yi("languagesDictionaries");LF(DF);function LF(t,e){let n=t,r=e;return xe(t)&&(r=t,n=r.languageCode),$9(n,r),k9(n,Un(r)),Un(r)}function $9(t,e){t!==jR&&M9(e,kF(jR))}function FF(t){return LT(t)?Un(kF(t)):null}function LT(t){return L9(t)}function V9(){return F9()}function $F(t,e,n){const r=FF(t);if(r===null)return null;const i=r[e];if(Pt(i))return null;const o=W9(i,n);return Array.isArray(o)?o[0]:o}function W9(t,e){let n=t;return M(A9(),r=>{n=r(t,e)}),n}function B9(t){let e=AF(t);return LT(e)||(e=jR,HF(t)),e}function j9(t,e,n){return(e=U9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U9(t){var e=z9(t,"string");return typeof e=="symbol"?e:e+""}function z9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Os extends gF{constructor(e,n){super(e,null),j9(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function db(t){let{activeHeaderClassName:e,...n}=t;return new Os({className:e,...n,selectionType:mF})}function Y9(t){let{areaCornerVisible:e,...n}=t;return new Os({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:Q0})}function G9(t){let{...e}=t;return new Os({className:"highlight",...e,selectionType:Q0})}function q9(t){let{columnClassName:e,...n}=t;return new Os({className:e,...n,selectionType:o4})}function K9(t){let{cellCornerVisible:e,...n}=t;return new Os({className:"current",headerAttributes:[S0()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:ud})}function X9(t){let{border:e,visualCellRange:n,...r}=t;return new Os({...e,...r,selectionType:s4},n)}function Z9(t){let{...e}=t;return new Os({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:r4})}function mA(t){let{headerClassName:e,...n}=t;return new Os({className:e,...n,selectionType:Z0})}function Q9(t){let{rowClassName:e,...n}=t;return new Os({className:e,...n,selectionType:i4})}function J9(t,e){e6(t,e),e.add(t)}function e6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ar(t,e,n){return(e=t6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t6(t){var e=n6(t,"string");return typeof e=="symbol"?e:e+""}function n6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zi=new WeakSet;class r6{constructor(e){J9(this,Zi),ar(this,"options",void 0),ar(this,"layerLevel",0),ar(this,"focus",void 0),ar(this,"fill",void 0),ar(this,"layeredAreas",new Map),ar(this,"areas",new Map),ar(this,"rowHeaders",new Map),ar(this,"columnHeaders",new Map),ar(this,"activeRowHeaders",new Map),ar(this,"activeColumnHeaders",new Map),ar(this,"activeCornerHeaders",new Map),ar(this,"rowHighlights",new Map),ar(this,"columnHighlights",new Map),ar(this,"customSelections",[]),this.options=e,this.focus=K9(e),this.fill=Z9(e)}isEnabledFor(e,n){let r=e;e===ud&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Yo(Zi,this,Go).call(this,this.layeredAreas,Y9)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Yo(Zi,this,Go).call(this,this.areas,G9)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Yo(Zi,this,Go).call(this,this.rowHeaders,mA)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Yo(Zi,this,Go).call(this,this.columnHeaders,mA)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Yo(Zi,this,Go).call(this,this.activeRowHeaders,db)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Yo(Zi,this,Go).call(this,this.activeColumnHeaders,db)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Yo(Zi,this,Go).call(this,this.activeCornerHeaders,db)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Yo(Zi,this,Go).call(this,this.rowHighlights,Q9)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Yo(Zi,this,Go).call(this,this.columnHighlights,q9)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(X9({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),M(this.areas.values(),e=>void e.clear()),M(this.layeredAreas.values(),e=>void e.clear()),M(this.rowHeaders.values(),e=>void e.clear()),M(this.columnHeaders.values(),e=>void e.clear()),M(this.activeRowHeaders.values(),e=>void e.clear()),M(this.activeColumnHeaders.values(),e=>void e.clear()),M(this.activeCornerHeaders.values(),e=>void e.clear()),M(this.rowHighlights.values(),e=>void e.clear()),M(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Go(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function pA(t,e,n){return(e=i6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i6(t){var e=o6(t,"string");return typeof e=="symbol"?e:e+""}function o6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s6{constructor(e){pA(this,"ranges",[]),pA(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function a6(t,e){VF(t,e),e.add(t)}function fb(t,e,n){VF(t,e),e.set(t,n)}function VF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ze(t,e){return t.get(ln(t,e))}function eg(t,e,n){return t.set(ln(t,e),n),n}function ln(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var tg=new WeakMap,yt=new WeakMap,$i=new WeakMap,vn=new WeakSet;class UR{constructor(e,n){a6(this,vn),fb(this,tg,void 0),fb(this,yt,void 0),fb(this,$i,{x:0,y:0}),eg(tg,this,e),eg(yt,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Ze(yt,this).createCellCoords(e,n);let o=Ze(tg,this).current().highlight;const s=Ze(yt,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=ln(vn,this,WF).call(this),{row:h,col:d}=ln(vn,this,vA).call(this,o),f=Ze(yt,this).fixedRowsBottom(),g=Ze(yt,this).minSpareRows(),v=Ze(yt,this).minSpareCols(),y=Ze(yt,this).autoWrapRow(),E=Ze(yt,this).autoWrapCol(),C=Ze(yt,this).createCellCoords(h+i.row,d+i.col);if(C.row>=c){const F=Rr(r&&g>0&&f===0),I=C.col+1,O=Ze(yt,this).createCellCoords(C.row-c,I>=u?I-u:I);this.runLocalHooks("beforeColumnWrap",F,ln(vn,this,gu).call(this,O),I>=u),F.value?this.runLocalHooks("insertRowRequire",Ze(yt,this).countRenderableRows()):E&&C.assign(O)}else if(C.row<0){const F=Rr(E),I=C.col-1,O=Ze(yt,this).createCellCoords(c+C.row,I<0?u+I:I);this.runLocalHooks("beforeColumnWrap",F,ln(vn,this,gu).call(this,O),I<0),E&&C.assign(O)}if(C.col>=u){const F=Rr(r&&v>0),I=C.row+1,O=Ze(yt,this).createCellCoords(I>=c?I-c:I,C.col-u);this.runLocalHooks("beforeRowWrap",F,ln(vn,this,gu).call(this,O),I>=c),F.value?this.runLocalHooks("insertColRequire",Ze(yt,this).countRenderableColumns()):y&&C.assign(O)}else if(C.col<0){const F=Rr(y),I=C.row-1,O=Ze(yt,this).createCellCoords(I<0?c+I:I,u+C.col);this.runLocalHooks("beforeRowWrap",F,ln(vn,this,gu).call(this,O),I<0),y&&C.assign(O)}const{rowDir:T,colDir:A}=ln(vn,this,wA).call(this,C);a=T,l=A,o=ln(vn,this,gu).call(this,C)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=Ze(yt,this).createCellCoords(e,n),i=Ze(tg,this).current(),o=Ze(yt,this).visualToRenderableCoords(i.highlight),s=ln(vn,this,gb).call(this,i.to.row,i.from.row),a=ln(vn,this,mb).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=ln(vn,this,vA).call(this,i.highlight),f=Ze(yt,this).createCellCoords(s+r.row,a+r.col),g=i.getTopStartCorner(),v=i.getTopEndCorner(),y=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const A=f.col-d;f.col=ln(vn,this,mb).call(this,g.col,v.col)+A}else if(r.col>0&&a<=d&&f.col>d){const A=ln(vn,this,mb).call(this,v.col,g.col),F=Math.max(f.col-A,1);f.col=A+F}if(r.row<0&&s>=h&&f.row<h){const A=f.row-h;f.row=ln(vn,this,gb).call(this,g.row,y.row)+A}else if(r.row>0&&s<=h&&f.row>h){const A=ln(vn,this,gb).call(this,y.row,g.row),F=Math.max(f.row-A,1);f.row=A+F}const{rowDir:E,colDir:C}=ln(vn,this,wA).call(this,f);u=E,c=C;const T=ln(vn,this,gu).call(this,f);r.row===0&&r.col!==0?l.col=T.col:r.row!==0&&r.col===0?l.row=T.row:(l.row=T.row,l.col=T.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;eg($i,this,{x:n,y:r})}resetOffsetSize(){eg($i,this,{x:0,y:0})}}function wA(t){const{width:e,height:n}=ln(vn,this,WF).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function WF(){return{width:Ze($i,this).x+Ze(yt,this).countRenderableColumns(),height:Ze($i,this).y+Ze(yt,this).countRenderableRows()}}function gb(t,e){const n=Ze(yt,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:Ze($i,this).y+n}function mb(t,e){const n=Ze(yt,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Ze($i,this).x+n}function vA(t){const{row:e,col:n}=Ze(yt,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return Ze(yt,this).createCellCoords(Ze($i,this).y+e,Ze($i,this).x+n)}function gu(t){const e=t.clone();return e.col=t.col-Ze($i,this).x,e.row=t.row-Ze($i,this).y,Ze(yt,this).renderableToVisualCoords(e)}ct(UR,xn);const Ew=0,_w=1,BF=2,FT=3,l6=[FT,BF],u6=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],pb=Symbol("root"),CA=Symbol("child");function vc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pb;if(e!==pb&&e!==CA)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===pb;let i=Ew;if(n){const o=t[0];t.length===0?i=_w:r&&o instanceof pf?i=FT:r&&Array.isArray(o)?i=vc(o,CA):t.length>=2&&t.length<=4&&!t.some((a,l)=>!u6[l].includes(typeof a))&&(i=BF)}return i}function Wd(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!l6.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===FT;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Pt(u)&&(u=a),Pt(c)&&(c=l),!r){const f=a,g=l,v=u,y=c;a=Math.min(f,v),l=Math.min(g,y),u=Math.max(f,v),c=Math.max(g,y)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function c6(t){const e=vc(t.getSelected());if(e===Ew||e===_w)return[];const n=Wd(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;M(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return mn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function h6(t){const e=vc(t.getSelected());if(e===Ew||e===_w)return[];const n=Wd(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;M(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return mn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function mu(t,e,n){d6(t,e),e.set(t,n)}function d6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $a(t,e,n){return(e=f6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f6(t){var e=g6(t,"string");return typeof e=="symbol"?e:e+""}function g6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tt(t,e){return t.get(jF(t,e))}function Qi(t,e,n){return t.set(jF(t,e),n),n}function jF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Nn=new WeakMap,Va=new WeakMap,ng=new WeakMap,hh=new WeakMap,rg=new WeakMap,dh=new WeakMap;class UF{constructor(e,n){var r=this;$a(this,"settings",void 0),$a(this,"tableProps",void 0),$a(this,"inProgress",!1),$a(this,"selectedRange",new s6((i,o,s)=>this.tableProps.createCellRange(i,o,s))),$a(this,"highlight",void 0),mu(this,Nn,void 0),mu(this,Va,void 0),$a(this,"selectedByRowHeader",new Set),$a(this,"selectedByColumnHeader",new Set),mu(this,ng,!1),mu(this,hh,!1),mu(this,rg,"unknown"),mu(this,dh,-1),this.settings=e,this.tableProps=n,this.highlight=new r6({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[S0()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),Qi(Nn,this,new UR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Qi(Va,this,new UR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Tt(Nn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),Tt(Nn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),Tt(Nn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),Tt(Nn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),Tt(Nn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),Tt(Nn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),Tt(Nn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),Tt(Nn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),Tt(Va,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),Tt(Va,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){Qi(rg,this,e)}markEndSource(){Qi(rg,this,"unknown")}getSelectionSource(){return Tt(rg,this)}setExpectedLayers(e){Qi(dh,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Qi(dh,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Pt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();Qi(ng,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Pt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Tt(dh,this)===-1||this.selectedRange.size()===Tt(dh,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(M(this.highlight.getAreas(),g=>void g.clear()),M(this.highlight.getLayeredAreas(),g=>void g.clear()),M(this.highlight.getRowHeaders(),g=>void g.clear()),M(this.highlight.getColumnHeaders(),g=>void g.clear()),M(this.highlight.getActiveRowHeaders(),g=>void g.clear()),M(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),M(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),M(this.highlight.getRowHighlights(),g=>void g.clear()),M(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(Q0,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(Z0,e.highlight)){if(!e.isSingleHeader()){const y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),C=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),T=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),l.add(C).commit(),d.add(y).commit(),f.add(C).commit()):(a.add(y).add(E).commit(),l.add(C).add(T).commit(),d.add(y).add(E).commit(),f.add(C).add(T).commit())}const g=!Tt(hh,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),v=!Tt(hh,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(ud,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(Qi(ng,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Tt(Nn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Tt(Nn,this).resetOffsetSize(),this.setRangeStart(Tt(Nn,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?Tt(Nn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Tt(Nn,this).resetOffsetSize(),this.setRangeEnd(Tt(Nn,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?Tt(Va,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):Tt(Va,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=Tt(Va,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(ze(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(ze(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(ze(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,ze(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,ze(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,ze(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Rr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Tt(ng,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;Qi(hh,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(ze(d.row,u,o-1),ze(d.col,c,s-1)));const g=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.finish(),Qi(hh,this,!1)}selectCells(e){var n=this;const r=vc(e);if(r===_w)return!1;if(r===Ew)throw new Error(st`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Wd(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),M(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=ze(r.row,u,s-1),g=ze(r.col,Math.min(i,o),Math.max(i,o))):(f=ze(r,u,s-1),g=i);const v=this.tableProps.createCellCoords(f,g),y=l===0?0:ze(v.row,u,-1),E=s-1,C=this.tableProps.createCellCoords(y,i),T=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",C,T,v),C.row=y,T.row=E,this.setRangeStartOnly(C,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectColumns",C,T,v),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=ze(r.row,Math.min(e,n),Math.max(e,n)),d=ze(r.col,a,o-1)):(h=e,d=ze(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),g=s===0?0:ze(f.col,a,-1),v=o-1,y=this.tableProps.createCellCoords(e,g),E=this.tableProps.createCellCoords(n,v);this.runLocalHooks("beforeSelectRows",y,E,f),y.col=g,E.col=v,this.setRangeStartOnly(y,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",y,E,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:s}=r;this.clear(),s.assign({row:ze(s.row,-1/0,e-1),col:ze(s.col,-1/0,n-1)}),i.assign({row:ze(i.row,-1/0,e-1),col:ze(i.col,-1/0,n-1)}),o.assign({row:ze(o.row,0,e-1),col:ze(o.col,0,n-1)}),this.selectedRange.ranges.push(r),this.highlight.isEnabledFor(ud,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(ud,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}ct(UF,xn);const yA=/^(\r\n|\n\r|\r|\n)/,m6=/^[^\t\r\n]+/,bA=/^\t/;function p6(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(bA))t=t.replace(bA,""),n+=1,e[r][n]="";else if(t.match(yA))t=t.replace(yA,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(m6);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function hd(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function Wa(t,e,n){return(e=w6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w6(t){var e=v6(t,"string");return typeof e=="symbol"?e:e+""}function v6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ju{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){Wa(this,"hot",void 0),Wa(this,"metaManager",void 0),Wa(this,"tableMeta",void 0),Wa(this,"dataSource",void 0),Wa(this,"duckSchema",void 0),Wa(this,"colToPropCache",void 0),Wa(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=fw(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(xe(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return u_(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ae(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&le(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(le(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?pc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=Un(this.getSchema()):(g=[],fe(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},gf(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,g=c;i==="end"&&(g=Math.min(g+1,a));const v=g;for(;f<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let E=0;E<h;E+=1)typeof o[E]>"u"&&(o[E]=[]),o[E].push(null);else o.push([null]);else for(let E=0;E<h;E++)o[E].splice(g,0,null);f+=1,g+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(v,n));const y=this.hot.toVisualColumn(v);return this.hot.runHooks("afterCreateCol",y,f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:v}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];RR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return sL(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];RR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Jt(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=Rr(a);this.hot.runHooks("modifyData",r,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Rr(o);this.hot.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&Jt(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Ju.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Ju.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return hd(this.getRange(e,n,Ju.DESTINATION_RENDERER))}getCopyableText(e,n){return hd(this.getRange(e,n,Ju.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:C6,getItem:y6,hasItem:zF,getNames:b6,getValues:Lde}=Yi("cellTypes");function $T(t){if(!zF(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return y6(t)}function Zr(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&pr(t,n),r&&Hr(t,r),i&&Sl(t,i),C6(t,e)}function S6(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Jt(e,t)}function Tw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?$T(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ae(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!xe(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ae(r,(o,s)=>{if(S6(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),tn(t,i)}function R6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}HL(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Rm(t){return Number.isInteger(t)&&t>=0}function Em(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function ig(t){return t==null}const YF=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Wt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Wt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),dw(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function SA(t,e,n){return(e=E6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E6(t){var e=_6(t,"string");return typeof e=="symbol"?e:e+""}function _6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function T6(){return class{}}class M6{constructor(e){SA(this,"metaCtor",T6()),SA(this,"meta",void 0),this.meta=this.metaCtor.prototype,tn(this.meta,YF()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;tn(this.meta,e),Tw(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function I6(t,e,n){return(e=P6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P6(t){var e=O6(t,"string");return typeof e=="symbol"?e:e+""}function O6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x6{constructor(e){I6(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){tn(this.meta,e),Tw(this.meta,e,e)}}function og(t,e,n){return(e=A6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A6(t){var e=H6(t,"string");return typeof e=="symbol"?e:e+""}function H6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ip{constructor(e){og(this,"valueFactory",void 0),og(this,"data",[]),og(this,"index",[]),og(this,"holes",new Set),this.valueFactory=e}obtain(e){Em(()=>Rm(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Em(()=>Rm(e)||ig(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=ig(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Em(()=>Rm(e)||ig(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(ig(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function RA(t,e,n){return(e=N6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N6(t){var e=D6(t,"string");return typeof e=="symbol"?e:e+""}function D6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const k6=["data","width"];class L6{constructor(e){RA(this,"globalMeta",void 0),RA(this,"metas",new ip(()=>this._createMeta())),this.globalMeta=e,this.metas=new ip(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);tn(r,n),Tw(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return R6(this.globalMeta.getMetaConstructor(),k6).prototype}}function EA(t,e,n){return(e=F6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F6(t){var e=$6(t,"string");return typeof e=="symbol"?e:e+""}function $6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V6{constructor(e){EA(this,"columnMeta",void 0),EA(this,"metas",new ip(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);tn(i,r),Tw(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)le(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){Em(()=>Rm(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new ip(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class GF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new M6(e),this.tableMeta=new x6(this.globalMeta),this.columnMeta=new L6(this.globalMeta),this.cellMeta=new V6(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}ct(GF,xn);function _A(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=jn(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":ot(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Ju(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let v,y=0,E=0;for(y=0,E=d.startRows;y<E;y++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)v=Un(g),t.push(v);else if(i.dataType==="array")v=Un(g[0]),t.push(v);else{v=[];for(let C=0,T=d.startCols;C<T;C++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&ye(i.rootElement,[mL(-1),aw(i.countCols()+(i.view?i.countRowHeaders():0))])}function TA(t,e,n){return(e=W6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W6(t){var e=B6(t,"string");return typeof e=="symbol"?e:e+""}function B6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j6{constructor(e){var n=this;TA(this,"metaManager",void 0),TA(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),re.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Jt(e,"type")?e.type:null;let c=ot(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function U6(t,e,n){z6(t,e),e.set(t,n)}function z6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wb(t,e,n){return(e=Y6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y6(t){var e=G6(t,"string");return typeof e=="symbol"?e:e+""}function G6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function q6(t,e){return t.get(K6(t,e))}function K6(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var MA=new WeakMap;class X6{constructor(e){wb(this,"metaManager",void 0),wb(this,"usageTracker",new Set),wb(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),U6(this,MA,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,q6(MA,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const qF="gridDefault",Pa="editorManager.handlingEditor",Z6={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},Q6="hooksRefRegisterer",KF={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){M(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ae(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Do(KF,"MIXIN_NAME",Q6,{writable:!1,enumerable:!1});function Ei(t,e,n){return(e=J6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J6(t){var e=e8(t,"string");return typeof e=="symbol"?e:e+""}function e8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const t8="base",Yt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class kc{static get EDITOR_TYPE(){return t8}constructor(e){Ei(this,"hot",void 0),Ei(this,"state",Yt.VIRGIN),Ei(this,"_opened",!1),Ei(this,"_fullEditMode",!1),Ei(this,"_closeCallback",null),Ei(this,"TD",null),Ei(this,"row",null),Ei(this,"col",null),Ei(this,"prop",null),Ei(this,"originalValue",null),Ei(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Yt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Yt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Yt.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:bt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Yt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Yt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=Yt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Yt.FINISHED,this.discardEditor(s)}):(this.state=Yt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Yt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Yt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Yt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Yt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Yt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=On(n),a=qt(n),l=On(this.hot.rootElement),u=qt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,g=o.innerWidth-l.left-u,{wtTable:v}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,y=v.name,E=["master","inline_start"].includes(y)?d:0,C=["master","top","bottom"].includes(y)?f:0,T=s.top===l.top?0:1;let A=s.top-l.top-T-E,F=0;this.hot.isRtl()?F=o.innerWidth-s.left-a-g-1+C:F=s.left-l.left-1-C,["top","top_inline_start_corner"].includes(y)&&(A+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(F+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const I=this.hot.hasColHeaders(),O=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Y=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),W=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(I&&O<=0||O===W)&&(A+=1),Y<=0&&(F+=1);const Z=i.rowsRenderCalculator.startPosition,Q=i.columnsRenderCalculator.startPosition,oe=Math.abs(r.inlineStartOverlay.getScrollPosition()),te=r.topOverlay.getScrollPosition(),ae=bn(this.hot.rootDocument);let ft=n.offsetTop;if(["inline_start","master"].includes(y)&&(ft+=Z-te),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:G,wtTable:K}=r.bottomOverlay.clone;ft+=G.getWorkspaceHeight()-K.getHeight()-ae}let be=n.offsetLeft;this.hot.isRtl()?(be>=0?be=v.getWidth()-n.offsetLeft:be=Math.abs(be),be+=Q-oe-a):["top","master","bottom"].includes(y)&&(be+=Q-oe);const He=o.getComputedStyle(this.TD),gt=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Xt=parseInt(He[gt],10)>0?0:1,Ke=parseInt(He.borderTopWidth,10)>0?0:1,m=qt(n)+Xt,w=en(n)+Ke,p=I0(c)?ae:0,_=P0(h)?ae:0,H=this.hot.view.maximumVisibleElementWidth(be)-p+Xt,V=Math.max(this.hot.view.maximumVisibleElementHeight(ft)-_+Ke,this.hot.view.getDefaultRowHeight());return{top:A,start:F,height:w,maxHeight:V,width:m,maxWidth:H}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}ct(kc,KF);const n8={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Yt.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},r8={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},i8={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},o8={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},s8={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),vi(e))}};function a8(){return[Z6,n8,r8,i8,o8,s8]}const l8={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},u8={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},c8={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},h8={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},d8={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},f8={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},g8={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},m8={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},p8={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},w8={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},v8={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},C8={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},y8={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},b8={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function S8(){return[l8,u8,c8,h8,d8,f8,g8,m8,p8,w8,v8,C8,y8,b8]}const R8={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},E8={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},_8={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},T8={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},M8={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},I8={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},P8={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},O8={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},x8={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},A8={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},H8={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},N8={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},D8={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},k8={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},L8={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},F8={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function $8(){return[R8,E8,_8,T8,M8,I8,P8,O8,x8,A8,H8,N8,D8,k8,L8,F8]}const V8={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},W8={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},B8={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},j8={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},U8={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},z8=[...a8(),...S8(),...$8(),V8,W8,B8,j8,U8];function XF(t){const e={};return z8.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function Y8(t){const e=t.getShortcutManager().addContext("editor"),n=XF(t),r={group:Pa};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function G8(t){const e=t.getShortcutManager().addContext("grid"),n=XF(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:qF};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Pa,runOnlyIf:()=>le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function q8(t){[G8,Y8].forEach(e=>e(t))}function K8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=IA(t),i=IA(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function IA(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&ye(n,[Hd("Focus catcher")]),n}function X8(t){const e=Z8(t);let n;const{activate:r,deactivate:i}=K8(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:zR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:YR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,g,v)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,v.value=!0),s){var y;n=(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:qF,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?zR(t):YR(t)),u(),!1;h.preventDefault()},position:"after"}])}function zR(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function YR(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function Z8(t){return e=>{if(!e)return null;const n=zR(t),r=YR(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function Lc(t){_o(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function Mw(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,g=r.getBottomEndCorner().row,v=f<=h,y=g>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?r.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:v&&y?r.highlight.row:v?f:y?g:E.row}}}function Q8(t){return e=>{const n=Mw(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;Lc(t.getCell(r?-1:0,n,!0))})}}function J8(){return()=>{}}function e5(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;Lc(t.getCell(n,r,!0))})}}function t5(t){return e=>{const n=Mw(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Lc(t.getCell(i,o,!0))})}}function n5(t){return e=>{const n=Mw(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Lc(t.getCell(i,o,!0))})}}function r5(t){return e=>{const n=Mw(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;Lc(t.getCell(n,r?-1:0,!0))})}}function i5(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{Lc(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function o5(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=e5(t):e.isSelectedByCorner()?s=J8():e.isSelectedByRowHeader()?s=r5(t):e.isSelectedByColumnHeader()?s=Q8(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=t5(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=i5(t):e.getSelectedRange().size()>1&&(s=n5(t)),(o=s)===null||o===void 0||o(i)}}}const PA=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),sg=t=>t.map(e=>{const n=e.toLowerCase();return PA.has(n)?PA.get(n):n}).sort().join("+"),s5=t=>t.split("+"),OA=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),vb=t=>{let{which:e,key:n}=t;if(OA.has(e))return OA.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},ZF=Symbol("shortcut-context");function QF(t){return xe(t)&&t.__kindOf===ZF}const a5=t=>{const e=pw({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:v,position:y,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Pt(c))throw new Error("You need to define the shortcut's group.");if(ot(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(st`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const C={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:g};le(v)&&(C.relativeToGroup=v,C.position=y),QF(E)&&(C.forwardToContext=E),l.forEach(T=>{const A=sg(T);if(e.hasItem(A)){const I=e.getItem(A);let O=I.findIndex(Y=>Y.group===v);O!==-1?y==="before"?O-=1:O+=1:O=I.length,I.splice(O,0,C)}else e.addItem(A,[C])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ae(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=sg(l);e.removeItem(u)};return{__kindOf:ZF,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=sg(l),c=e.getItem(u);return le(c)?c.slice():[]},hasShortcut:l=>{const u=sg(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(g=>g.group!==l);f.length===0?i(s5(h)):(d.length=0,d.push(...f))})}}};function l5(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const u5=["meta","alt","shift","control"],fh=l5(),gh=[];let ag=0;function c5(t,e,n,r,i){const o=f=>u5.includes(f),s=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return f.altKey&&v.push("alt"),g&&(f.ctrlKey||f.metaKey)?v.push("control/meta"):(f.ctrlKey&&v.push("control"),f.metaKey&&v.push("meta")),f.shiftKey&&v.push("shift"),v},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||ta(f))return;const v=vb(f);let y=[];o(v)||(y=s(f));const E=[v].concat(y);!i(f,E)&&(Qm()&&y.includes("meta")||!Qm()&&y.includes("control"))&&i(f,[v].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const g=vb(f);o(g)&&fh.press(g)}},u=f=>{if(typeof f.key=="string"){const g=vb(f);o(g)&&fh.release(g)}},c=()=>{fh.releaseAll()};return{mount:()=>{let f=t;for(ag+=1;f;)ag===1&&(f.document.documentElement.addEventListener("keydown",l),gh.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),gh.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=Nl(f)},unmount:()=>{let f=t;for(ag-=1;f;){if(ag===0){for(let g=0;g<gh.length;g++){const{event:v,listener:y}=gh[g];f.document.documentElement.removeEventListener(v,y)}gh.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=Nl(f)}},isPressed:f=>fh.isPressed(f),releasePressedKeys:()=>fh.releaseAll()}}const h5=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=pw({errorIdExists:g=>`The "${g}" context name is already registered.`});let s="grid";const a=g=>{const v=a5(g);return o.addItem(g,v),v},l=()=>s,u=g=>o.getItem(g),c=g=>{if(!o.hasItem(g))throw new Error(st`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=g};let h=!1;const d=function(g,v){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=QF(y)?y:u(y);let C=!1;if(!E.hasShortcut(v))return C;const T=E.getShortcuts(v);for(let A=0;A<T.length;A++){const{callback:F,runOnlyIf:I,preventDefault:O,stopPropagation:Y,captureCtrl:U,forwardToContext:W}=T[A];if(I(g)===!0){if(h=U,C=F(g,v)===!1,h=!1,O&&g.preventDefault(),Y&&(vi(g),g.stopPropagation()),C)break;W&&d(g,v,W)}}return C},f=c5(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function xA(t){const{classNames:e}=yL(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let Cb=null;const yb=new Map;function JF(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new di(o);let a,l,u,c,h,d,f=!0;B4(i)&&W4(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",v=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=B9(e.language);const y=Object.fromEntries(Object.entries(e).filter(m=>{let[w]=m;return!(re.getSingleton().isRegistered(w)||re.getSingleton().isDeprecated(w))})),E=new GF(o,y,[j6,X6]),C=E.getTableMeta(),T=E.getGlobalMeta(),A=pw();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),Sm(this)&&(hL(e.licenseKey,t),q(t,"ht-wrapper")),this.guid=`ht_${v0()}`,yb.set(this.guid,this),this.columnIndexMapper=new BR,this.rowIndexMapper=new BR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterColumnSequenceChange",m)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterRowSequenceChange",m)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",m=>{o.runHooks("beforeCompositionStart",m)}),l=new i9(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const F=m=>{const{row:w,col:p}=m;return o._createCellCoords(w>=0?o.rowIndexMapper.getRenderableFromVisualIndex(w):w,p>=0?o.columnIndexMapper.getRenderableFromVisualIndex(p):p)},I=m=>{const{row:w,col:p}=m;return o._createCellCoords(w>=0?o.rowIndexMapper.getVisualFromRenderableIndex(w):w,p>=0?o.columnIndexMapper.getVisualFromRenderableIndex(p):p)},O=(m,w)=>{const p=w>m?1:-1,_=Math.min(m,w),H=Math.max(m,w),V=o.rowIndexMapper.getNearestNotHiddenIndex(m,p);return V===null||p===1&&V>H||p===-1&&V<_?null:V>=0?o.rowIndexMapper.getRenderableFromVisualIndex(V):V},Y=(m,w)=>{const p=w>m?1:-1,_=Math.min(m,w),H=Math.max(m,w),V=o.columnIndexMapper.getNearestNotHiddenIndex(m,p);return V===null||p===1&&V>H||p===-1&&V<_?null:V>=0?o.columnIndexMapper.getRenderableFromVisualIndex(V):V};let U=new UF(C,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:m=>a.propToCol(m),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(m,w)=>o._createCellCoords(m,w),createCellRange:(m,w,p)=>o._createCellRange(m,w,p),visualToRenderableCoords:F,renderableToVisualCoords:I,findFirstNonHiddenRenderableRow:O,findFirstNonHiddenRenderableColumn:Y,isDisabledCellSelection:(m,w)=>m<0||w<0?o.getSettings().disableVisualSelection:o.getCellMeta(m,w).disableVisualSelection});this.selection=U;const W=m=>{let{hiddenIndexesChanged:w}=m;this.forceFullRender=!0,w&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",W),this.rowIndexMapper.addLocalHook("cacheUpdated",W),this.selection.addLocalHook("afterSetRangeEnd",(m,w)=>{const p=Rr(!1),_=this.selection.getSelectedRange(),{from:H,to:V}=_.current(),G=_.size()-1;this.runHooks("afterSelection",H.row,H.col,V.row,V.col,p,G),this.runHooks("afterSelectionByProp",H.row,o.colToProp(H.col),V.row,o.colToProp(V.col),p,G),w&&(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(m);const K=U.isSelectedByRowHeader(),b=U.isSelectedByColumnHeader();K&&b?q(this.rootElement,["ht__selection--rows","ht__selection--columns"]):K?(pe(this.rootElement,"ht__selection--columns"),q(this.rootElement,"ht__selection--rows")):b?(pe(this.rootElement,"ht__selection--rows"),q(this.rootElement,"ht__selection--columns")):pe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),U.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",m=>{this.runHooks("beforeSelectionFocusSet",m.row,m.col)}),this.selection.addLocalHook("afterSetFocus",m=>{const w=Rr(!1);this.runHooks("afterSelectionFocusSet",m.row,m.col,w),(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(m),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",m=>{const w=m.length-1,{from:p,to:_}=m[w];this.runHooks("afterSelectionEnd",p.row,p.col,_.row,_.col,w),this.runHooks("afterSelectionEndByProp",p.row,o.colToProp(p.col),_.row,o.colToProp(_.col),w)}),this.selection.addLocalHook("afterIsMultipleSelection",m=>{const w=this.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=w)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),pe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSetRangeStart",...w)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSetRangeStartOnly",...w)}).addLocalHook("beforeSetRangeEnd",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSetRangeEnd",...w)}).addLocalHook("beforeSelectColumns",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSelectColumns",...w)}).addLocalHook("afterSelectColumns",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterSelectColumns",...w)}).addLocalHook("beforeSelectRows",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeSelectRows",...w)}).addLocalHook("afterSelectRows",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterSelectRows",...w)}).addLocalHook("beforeModifyTransformStart",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("modifyTransformStart",...w)}).addLocalHook("afterModifyTransformStart",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterModifyTransformStart",...w)}).addLocalHook("beforeModifyTransformFocus",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("modifyTransformFocus",...w)}).addLocalHook("afterModifyTransformFocus",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterModifyTransformFocus",...w)}).addLocalHook("beforeModifyTransformEnd",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("modifyTransformEnd",...w)}).addLocalHook("afterModifyTransformEnd",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("afterModifyTransformEnd",...w)}).addLocalHook("beforeRowWrap",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeRowWrap",...w)}).addLocalHook("beforeColumnWrap",function(){for(var m=arguments.length,w=new Array(m),p=0;p<m;p++)w[p]=arguments[p];return r.runHooks("beforeColumnWrap",...w)}).addLocalHook("insertRowRequire",m=>this.alter("insert_row_above",m,1,"auto")).addLocalHook("insertColRequire",m=>this.alter("insert_col_start",m,1,"auto")),u={alter(m,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,_=arguments.length>3?arguments[3]:void 0,H=arguments.length>4?arguments[4]:void 0;const V=G=>{if(G.length===0)return[];const K=[...G];return K.sort((R,S)=>{let[L]=R,[P]=S;return L===P?0:L>P?1:-1}),mn(K,(R,S)=>{let[L,P]=S;const D=R[R.length-1],[j,x]=D,k=j+x;if(L<=k){const B=Math.max(P-(k-L),0);D[1]+=B}else R.push([L,P]);return R},[K[0]])};switch(m){case"insert_row_below":case"insert_row_above":const G=o.countSourceRows();if(C.maxRows===G)return;const K=m==="insert_row_below"?"below":"above";w=w??(K==="below"?G:0);const{delta:b,startPhysicalIndex:R}=a.createRow(w,p,{source:_,mode:K});U.shiftRows(o.toVisualRow(R),b);break;case"insert_col_start":case"insert_col_end":const S=m==="insert_col_end"?"end":"start";w=w??(S==="end"?o.countSourceCols():0);const{delta:L,startPhysicalIndex:P}=a.createCol(w,p,{source:_,mode:S});if(L){if(Array.isArray(C.colHeaders)){const x=[o.toVisualColumn(P),0];x.length+=L,Array.prototype.splice.apply(C.colHeaders,x)}U.shiftColumns(o.toVisualColumn(P),L)}break;case"remove_row":const D=x=>{let k=0;M(x,B=>{let[$,z]=B;const se=Wt($)?o.countRows()-1:Math.max($-k,0);if(Number.isInteger($)&&($=Math.max($-k,0)),!a.removeRow($,z,_))return;if(U.isSelected()){const{row:Re}=o.getSelectedRangeLast().highlight;Re>=$&&Re<=$+z-1&&c.closeEditor(!0)}const Ee=o.countRows(),ke=C.fixedRowsTop;ke>=se+1&&(C.fixedRowsTop-=Math.min(z,ke-se));const je=C.fixedRowsBottom;je&&se>=Ee-je&&(C.fixedRowsBottom-=Math.min(z,je)),Ee===0?U.deselect():_==="ContextMenu.removeRow"?U.refresh():U.shiftRows($,-z),k+=z})};Array.isArray(w)?D(V(w)):D([[w,p]]);break;case"remove_col":const j=x=>{let k=0;M(x,B=>{let[$,z]=B;const se=Wt($)?o.countCols()-1:Math.max($-k,0);let ce=o.toPhysicalColumn(se);if(Number.isInteger($)&&($=Math.max($-k,0)),!a.removeCol($,z,_))return;if(U.isSelected()){const{col:Re}=o.getSelectedRangeLast().highlight;Re>=$&&Re<=$+z-1&&c.closeEditor(!0)}o.countCols()===0?U.deselect():_==="ContextMenu.removeColumn"?U.refresh():U.shiftColumns($,-z);const je=C.fixedColumnsStart;je>=se+1&&(C.fixedColumnsStart-=Math.min(z,je-se)),Array.isArray(C.colHeaders)&&(typeof ce>"u"&&(ce=-1),C.colHeaders.splice(ce,z)),k+=z})};Array.isArray(w)?j(V(w)):j([[w,p]]);break;default:throw new Error(`There is no such action "${m}"`)}H||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const m=C.minRows,w=C.minSpareRows,p=C.minCols,_=C.minSpareCols;if(m){const H=o.countRows();H<m&&a.createRow(H,m-H,{source:"auto"})}if(w){const H=o.countEmptyRows(!0);if(H<w){const V=w-H,G=Math.min(V,C.maxRows-o.countSourceRows());a.createRow(o.countRows(),G,{source:"auto"})}}{let H;(p||_)&&(H=o.countEmptyCols(!0));let V=o.countCols();if(p&&!C.columns&&V<p){const G=p-V;H+=G,a.createCol(V,G,{source:"auto"})}if(_&&!C.columns&&o.dataType==="array"&&H<_){V=o.countCols();const G=_-H,K=Math.min(G,C.maxCols-V);a.createCol(V,K,{source:"auto"})}}},populateFromArray(m,w,p,_,H){let V,G,K,b;const R=[],S={},L=[],P=m.row,D=m.col;if(G=w.length,G===0)return!1;let j=0,x=0;switch(xe(p)&&(j=p.col-D+1,x=p.row-P+1),H){case"shift_down":const k=id(w),B=k.length,$=Math.max(B,j),z=o.getData().slice(P),se=id(z).slice(D,D+$);for(K=0;K<$;K+=1)if(K<B){for(V=0,G=k[K].length;V<x-G;V+=1)k[K].push(k[K][V%G]);K<se.length?L.push(k[K].concat(se[K])):L.push(k[K].concat(new Array(z.length).fill(null)))}else L.push(k[K%B].concat(se[K]));o.populateFromArray(P,D,id(L));break;case"shift_right":const ce=w.length,Ee=Math.max(ce,x),ke=o.getData().slice(P).map(Et=>Et.slice(D));for(V=0;V<Ee;V+=1)if(V<ce){for(K=0,b=w[V].length;K<j-b;K+=1)w[V].push(w[V][K%b]);if(V<ke.length)for(let Et=0;Et<ke[V].length;Et+=1)w[V].push(ke[V][Et]);else w[V].push(...new Array(ke[0].length).fill(null))}else w.push(w[V%G].slice(0,Ee).concat(ke[V]));o.populateFromArray(P,D,w);break;case"overwrite":default:S.row=m.row,S.col=m.col;let je=0,Re=0,Le=!0,Rt;const yi=function(sn){let vt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const _t=w[sn%w.length];return vt!==null?_t[vt%_t.length]:_t},Lo=w.length,Ur=p?p.row-m.row+1:0;for(p?G=Ur:G=Math.max(Lo,Ur),V=0;V<G&&!(p&&S.row>p.row&&Ur>Lo||!C.allowInsertRow&&S.row>o.countRows()-1||S.row>=C.maxRows);V++){const Et=V-je,sn=yi(Et).length,vt=p?p.col-m.col+1:0;if(p?b=vt:b=Math.max(sn,vt),S.col=m.col,Rt=o.getCellMeta(S.row,S.col),(_==="CopyPaste.paste"||_==="Autofill.fill")&&Rt.skipRowOnPaste){je+=1,S.row+=1,G+=1;continue}for(Re=0,K=0;K<b&&!(p&&S.col>p.col&&vt>sn||!C.allowInsertColumn&&S.col>o.countCols()-1||S.col>=C.maxCols);K++){if(Rt=o.getCellMeta(S.row,S.col),(_==="CopyPaste.paste"||_==="Autofill.fill")&&Rt.skipColumnOnPaste){Re+=1,S.col+=1,b+=1;continue}if(Rt.readOnly&&_!=="UndoRedo.undo"){S.col+=1;continue}const _t=K-Re;let Fe=yi(Et,_t),zr=o.getDataAtCell(S.row,S.col);if(Fe!==null&&typeof Fe=="object")if(Array.isArray(Fe)&&zr===null&&(zr=[]),zr===null||typeof zr!="object")Le=!1;else{const Oa=pc(Array.isArray(zr)?zr:zr[0]||zr),xa=pc(Array.isArray(Fe)?Fe:Fe[0]||Fe);dw(Oa,xa)||Array.isArray(Oa)&&Array.isArray(xa)?Fe=Un(Fe):Le=!1}else zr!==null&&typeof zr=="object"&&(Le=!1);Le&&R.push([S.row,S.col,Fe]),Le=!0,S.col+=1}S.row+=1}o.setDataAtCell(R,null,null,_||"populateFromArray");break}}};function Z(m){const w=AF(m);LT(w)?(o.runHooks("beforeLanguageChange",w),T.language=w,o.runHooks("afterLanguageChange",w)):HF(m)}function Q(m,w){const p=m==="className"?o.rootElement:o.table;if(f)q(p,w);else{let _=[],H=[];T[m]&&(_=Array.isArray(T[m])?T[m]:_R(T[m])),w&&(H=Array.isArray(w)?w:_R(w));const V=ER(_,H),G=ER(H,_);V.length&&pe(p,V),G.length&&q(p,G)}T[m]=w}this.init=function(){l.setData(C.data),o.runHooks("beforeInit"),(Eo()||L0())&&q(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new Y4(this);const m=C.themeName||xA(o.rootElement);o.useTheme(m),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=AR.getInstance(o,C,U),d=o5(o),h=new dK(o),Sm(this)&&X8(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&PL(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function oe(){let m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function te(m){const w=m.replace(",",".");return isNaN(parseFloat(w))===!1?parseFloat(w):m}function ae(m,w,p){if(!m.length){p();return}const _=o.getActiveEditor(),H=new oe;let V=!0;H.onQueueEmpty=()=>{_&&V&&_.cancelChanges(),p()};for(let G=m.length-1;G>=0;G--){const[K,b]=m[G],R=a.propToCol(b);let S;Number.isInteger(R)?S=o.getCellMeta(K,R):S={...Object.getPrototypeOf(C),...C},o.getCellValidator(S)&&(H.addValidatorToQueue(),o.validateCell(m[G][3],S,function(L,P){return function(D){if(typeof D!="boolean")throw new Error("Validation error: result is not boolean");D===!1&&P.allowInvalid===!1&&(V=!1,m.splice(L,1),P.valid=!0),H.removeValidatorFormQueue()}}(G,S),w))}H.checkIfQueueIsEmpty()}function ft(m,w){for(let _=m.length-1;_>=0;_--){let H=!1;if(m[_]===null){m.splice(_,1);continue}if(!((m[_][2]===null||m[_][2]===void 0)&&(m[_][3]===null||m[_][3]===void 0))){if(C.allowInsertRow)for(;m[_][0]>o.countRows()-1;){const{delta:V}=a.createRow(void 0,void 0,{source:"auto"});if(V===0){H=!0;break}}if(o.dataType==="array"&&(!C.columns||C.columns.length===0)&&C.allowInsertColumn)for(;a.propToCol(m[_][1])>o.countCols()-1;){const{delta:V}=a.createCol(void 0,void 0,{source:"auto"});if(V===0){H=!0;break}}H||a.set(m[_][0],m[_][1],m[_][3])}}if(m.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",m,w),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",m,w||"edit");const _=o.getActiveEditor();_&&le(_.refreshValue)&&_.refreshValue()}else o.render()}this._createCellCoords=function(m,w){return o.view._wt.createCellCoords(m,w)},this._createCellRange=function(m,w,p){return o.view._wt.createCellRange(m,w,p)},this.validateCell=function(m,w,p,_){let H=o.getCellValidator(w);function V(G){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||w.hidden===!0){p(G);return}const b=w.visualCol,R=w.visualRow,S=o.getCell(R,b,!0);if(S&&S.nodeName!=="TH"){const L=o.rowIndexMapper.getRenderableFromVisualIndex(R),P=o.columnIndexMapper.getRenderableFromVisualIndex(b);o.view._wt.getSetting("cellRenderer",L,P,S)}p(G)}cL(H)&&(H=function(G){return function(K,b){b(G.test(K))}}(H)),ot(H)?(m=o.runHooks("beforeValidate",m,w.visualRow,w.prop,_),o._registerImmediate(()=>{H.call(w,m,G=>{o&&(G=o.runHooks("afterValidate",G,m,w.visualRow,w.prop,_),w.valid=G,V(G),o.runHooks("postAfterValidate",G,m,w.visualRow,w.prop,_))})})):o._registerImmediate(()=>{w.valid=!0,V(w.valid,!1)})};function be(m,w,p){return Array.isArray(m)?m:[[m,w,p]]}function He(m,w){const p=o.runHooks("beforeChange",m,w||"edit"),_=m.filter(V=>V!==null);if(p===!1||_.length===0){var H;return(H=o.getActiveEditor())===null||H===void 0||H.cancelChanges(),[]}for(let V=_.length-1;V>=0;V--){const[G,K,,b]=_[V],R=a.propToCol(K);let S;Number.isInteger(R)?S=o.getCellMeta(G,R):S={...Object.getPrototypeOf(C),...C};const{type:L,checkedTemplate:P,uncheckedTemplate:D}=S;if(L==="numeric"&&typeof b=="string"&&JL(b)&&(_[V][3]=te(b)),L==="checkbox"){const j=bt(b),x=j===bt(P),k=j===bt(D);(x||k)&&(_[V][3]=x?P:D)}}return _}this.setDataAtCell=function(m,w,p,_){const H=be(m,w,p),V=[];let G=_,K,b,R;for(K=0,b=H.length;K<b;K++){if(typeof H[K]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof H[K][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");H[K][1]>=this.countCols()?R=H[K][1]:R=a.colToProp(H[K][1]),V.push([H[K][0],R,l.getAtCell(this.toPhysicalRow(H[K][0]),H[K][1]),H[K][2]])}!G&&typeof m=="object"&&(G=w);const S=He(V,G);o.runHooks("afterSetDataAtCell",S,G),ae(S,G,()=>{ft(S,G)})},this.setDataAtRowProp=function(m,w,p,_){const H=be(m,w,p),V=[];let G=_,K,b;for(K=0,b=H.length;K<b;K++)V.push([H[K][0],H[K][1],l.getAtCell(this.toPhysicalRow(H[K][0]),H[K][1]),H[K][2]]);!G&&typeof m=="object"&&(G=w);const R=He(V,_);o.runHooks("afterSetDataAtRowProp",R,G),ae(R,G,()=>{ft(R,G)})},this.listen=function(){o&&!o.isListening()&&(yb.forEach(m=>{o!==m&&m.unlisten()}),Cb=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Cb=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return Cb===o.guid},this.destroyEditor=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(m),o.view.render(),w&&U.isSelected()&&c.prepareEditor()},this.populateFromArray=function(m,w,p,_,H,V,G){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const K=typeof _=="number"?o._createCellCoords(_,H):null;return u.populateFromArray(o._createCellCoords(m,w),p,K,V,G)},this.spliceCol=function(m,w,p){for(var _=arguments.length,H=new Array(_>3?_-3:0),V=3;V<_;V++)H[V-3]=arguments[V];return a.spliceCol(m,w,p,...H)},this.spliceRow=function(m,w,p){for(var _=arguments.length,H=new Array(_>3?_-3:0),V=3;V<_;V++)H[V-3]=arguments[V];return a.spliceRow(m,w,p,...H)},this.getSelected=function(){if(U.isSelected())return Be(U.getSelectedRange(),m=>{let{from:w,to:p}=m;return[w.row,w.col,p.row,p.col]})},this.getSelectedLast=function(){const m=this.getSelected();let w;return m&&m.length>0&&(w=m[m.length-1]),w},this.getSelectedRange=function(){if(U.isSelected())return Array.from(U.getSelectedRange())},this.getSelectedRangeLast=function(){const m=this.getSelectedRange();let w;return m&&m.length>0&&(w=m[m.length-1]),w},this.emptySelectedCells=function(m){if(!U.isSelected()||this.countRows()===0||this.countCols()===0)return;const w=[];M(U.getSelectedRange(),p=>{if(p.isSingleHeader())return;const _=p.getTopStartCorner(),H=p.getBottomEndCorner();fe(_.row,H.row,V=>{fe(_.col,H.col,G=>{this.getCellMeta(V,G).readOnly||w.push([V,G,null])})})}),w.length>0&&this.setDataAtCell(w,m)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const m=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(m,0),!this.isRenderSuspended()&&m===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(m){this.suspendRender();const w=m();return this.resumeRender(),w},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(w,0),(!this.isExecutionSuspended()&&w===this.executionSuspendedCounter||m)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=m();return this.resumeExecution(w),p},this.batch=function(m){this.suspendRender(),this.suspendExecution();const w=m();return this.resumeExecution(),this.resumeRender(),w},this.refreshDimensions=function(){if(!o.view)return;const m=o.view,{width:w,height:p}=m.getLastSize(),{width:_,height:H}=o.rootElement.getBoundingClientRect(),V=_!==w||H!==p;o.runHooks("beforeRefreshDimensions",{width:w,height:p},{width:_,height:H},V)!==!1&&((V||m._wt.wtOverlays.scrollableElement===o.rootWindow)&&(m.setLastSize(_,H),o.render(),m.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:w,height:p},{width:_,height:H},V))},this.updateData=function(m,w){_A(m,p=>{a=p},p=>{a=p,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),U.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:w,metaManager:E,firstRun:f})},this.loadData=function(m,w){_A(m,p=>{a=p},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),U.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:w,metaManager:E,firstRun:f})},this.getInitialColumnCount=function(){const m=C.columns;let w=0;if(Array.isArray(m))w=m.length;else if(ot(m))if(o.dataType==="array"){const p=this.countSourceCols();for(let _=0;_<p;_+=1)m(_)&&(w+=1)}else(o.dataType==="object"||o.dataType==="function")&&(w=a.colToPropCache.length);else if(le(C.dataSchema)){const p=a.getSchema();w=Array.isArray(p)?p.length:fw(p)}else w=this.countSourceCols();return w},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(m,w,p,_){return Pt(m)?a.getAll():a.getRange(o._createCellCoords(m,w),o._createCellCoords(p,_),a.DESTINATION_RENDERER)},this.getCopyableText=function(m,w,p,_){return a.getCopyableText(o._createCellCoords(m,w),o._createCellCoords(p,_))},this.getCopyableData=function(m,w){return a.getCopyable(m,a.colToProp(w))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(f?o.loadData:o.updateData).bind(this);let _=!1,H,V;if(le(m.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(m.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(m.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');m.language&&Z(m.language);for(H in m)if(!(H==="data"||H==="language"))if(H==="className")Q("className",m.className);else if(H==="tableClassName"&&o.table)Q("tableClassName",m.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(re.getSingleton().isRegistered(H)||re.getSingleton().isDeprecated(H)){const S=m[H];ot(S)?(re.getSingleton().addAsFixed(H,S,o),C[H]=S):Array.isArray(S)&&(re.getSingleton().add(H,S,o),C[H]=S)}else!w&&Jt(m,H)&&(T[H]=m[H]);m.data===void 0&&C.data===void 0?p(null,"updateSettings"):m.data!==void 0?p(m.data,"updateSettings"):m.columns!==void 0&&(a.createMap(),o.initIndexMappers());const G=o.countCols(),K=C.columns;if(K&&ot(K)&&(_=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&E.clearCache(),G>0)for(H=0,V=0;H<G;H++){if(K){const S=_?K(H):K[V];S&&E.updateColumnMeta(V,S)}V+=1}le(m.cell)&&Ae(m.cell,S=>{o.setCellMetaObject(S.row,S.col,S)}),o.runHooks("afterCellMetaReset");let b=o.rootElement.style.height;b!==""&&(b=parseInt(o.rootElement.style.height,10));let R=m.height;if(ot(R)&&(R=R()),w&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),R===null){const S=o.rootElement.getAttribute("data-initialstyle");S&&(S.indexOf("height")>-1||S.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",S):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else R!==void 0&&(o.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,o.rootElement.style.overflow="hidden");if(typeof m.width<"u"){let S=m.width;ot(S)&&(S=S()),o.rootElement.style.width=isNaN(S)?`${S}`:`${S}px`}if(!w){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const S=o.getCurrentThemeName(),L=Jt(m,"themeName");S&&L&&S!==m.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(S));const P=L&&m.themeName||xA(o.rootElement);o.useTheme(P),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",m)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!w&&o.view&&(b===""||R===""||R===void 0)&&b!==R&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const m=o.getSelectedLast();if(C.getValue){if(ot(C.getValue))return C.getValue.call(o);if(m)return o.getData()[m[0][0]][C.getValue]}else if(m)return o.getDataAtCell(m[0],m[1])},this.getSettings=function(){return C},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,w,p,_,H){u.alter(m,w,p,_,H)},this.getCell=function(m,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=w,H=m;if(w>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(w)))return null;_=this.columnIndexMapper.getRenderableFromVisualIndex(w)}if(m>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(m)))return null;H=this.rowIndexMapper.getRenderableFromVisualIndex(m)}return H===null||_===null||H===void 0||_===void 0?null:o.view.getCellAtCoords(o._createCellCoords(H,_),p)},this.getCoords=function(m){const w=this.view._wt.wtTable.getCoords(m);if(w===null)return null;const{row:p,col:_}=w;let H=p,V=_;return p>=0&&(H=this.rowIndexMapper.getVisualFromRenderableIndex(p)),_>=0&&(V=this.columnIndexMapper.getVisualFromRenderableIndex(_)),o._createCellCoords(H,V)},this.colToProp=function(m){return a.colToProp(m)},this.propToCol=function(m){return a.propToCol(m)},this.toVisualRow=m=>this.rowIndexMapper.getVisualFromPhysicalIndex(m),this.toVisualColumn=m=>this.columnIndexMapper.getVisualFromPhysicalIndex(m),this.toPhysicalRow=m=>this.rowIndexMapper.getPhysicalFromVisualIndex(m),this.toPhysicalColumn=m=>this.columnIndexMapper.getPhysicalFromVisualIndex(m),this.getDataAtCell=function(m,w){return a.get(m,a.colToProp(w))},this.getDataAtRowProp=function(m,w){return a.get(m,w)},this.getDataAtCol=function(m){const w=[],p=a.getRange(o._createCellCoords(0,m),o._createCellCoords(C.data.length-1,m),a.DESTINATION_RENDERER);for(let _=0;_<p.length;_+=1)for(let H=0;H<p[_].length;H+=1)w.push(p[_][H]);return w},this.getDataAtProp=function(m){const w=[],p=a.getRange(o._createCellCoords(0,a.propToCol(m)),o._createCellCoords(C.data.length-1,a.propToCol(m)),a.DESTINATION_RENDERER);for(let _=0;_<p.length;_+=1)for(let H=0;H<p[_].length;H+=1)w.push(p[_][H]);return w},this.getSourceData=function(m,w,p,_){let H;return m===void 0?H=l.getData():H=l.getByRange(o._createCellCoords(m,w),o._createCellCoords(p,_)),H},this.getSourceDataArray=function(m,w,p,_){let H;return m===void 0?H=l.getData(!0):H=l.getByRange(o._createCellCoords(m,w),o._createCellCoords(p,_),!0),H},this.getSourceDataAtCol=function(m){return l.getAtColumn(m)},this.setSourceDataAtCell=function(m,w,p,_){const H=be(m,w,p),V=this.hasHook("afterSetSourceDataAtCell"),G=[];V&&M(H,b=>{let[R,S,L]=b;G.push([R,S,l.getAtCell(R,S),L])}),M(H,b=>{let[R,S,L]=b;l.setAtCell(R,S,L)}),V&&this.runHooks("afterSetSourceDataAtCell",G,_),this.render();const K=o.getActiveEditor();K&&le(K.refreshValue)&&K.refreshValue()},this.getSourceDataAtRow=function(m){return l.getAtRow(m)},this.getSourceDataAtCell=function(m,w){return l.getAtCell(m,w)},this.getDataAtRow=function(m){return a.getRange(o._createCellCoords(m,0),o._createCellCoords(m,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(m,w,p,_){const H=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,w,p,_],[V,G]=H;let[,,K,b]=H,R=null,S=null;K===void 0&&(K=V),b===void 0&&(b=G);let L="mixed";return fe(Math.max(Math.min(V,K),0),Math.max(V,K),P=>{let D=!0;return fe(Math.max(Math.min(G,b),0),Math.max(G,b),j=>(S=this.getCellMeta(P,j).type,R?D=R===S:R=S,D)),L=D?S:"mixed",D}),L},this.removeCellMeta=function(m,w,p){const[_,H]=[this.toPhysicalRow(m),this.toPhysicalColumn(w)];let V=E.getCellMetaKeyValue(_,H,p);o.runHooks("beforeRemoveCellMeta",m,w,p,V)!==!1&&(E.removeCellMeta(_,H,p),o.runHooks("afterRemoveCellMeta",m,w,p,V)),V=null},this.spliceCellsMeta=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,_=new Array(p>2?p-2:0),H=2;H<p;H++)_[H-2]=arguments[H];if(_.length>0&&!Array.isArray(_[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&E.removeRow(this.toPhysicalRow(m),w),_.length>0&&M(_.reverse(),V=>{E.createRow(this.toPhysicalRow(m)),M(V,(G,K)=>this.setCellMetaObject(m,K,G))}),o.render()},this.setCellMetaObject=function(m,w,p){typeof p=="object"&&Ae(p,(_,H)=>{this.setCellMeta(m,w,H,_)})},this.setCellMeta=function(m,w,p,_){if(o.runHooks("beforeSetCellMeta",m,w,p,_)===!1)return;let V=m,G=w;m<this.countRows()&&(V=this.toPhysicalRow(m)),w<this.countCols()&&(G=this.toPhysicalColumn(w)),E.setCellMeta(V,G,p,_),o.runHooks("afterSetCellMeta",m,w,p,_)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(m,w){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},_=this.toPhysicalRow(m),H=this.toPhysicalColumn(w);return _===null&&(_=m),H===null&&(H=w),E.getCellMeta(_,H,{visualRow:m,visualColumn:w,...p})},this.getColumnMeta=function(m){return E.getColumnMeta(this.toPhysicalColumn(m))},this.getCellMetaAtRow=function(m){return E.getCellsMetaAtRow(m)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||C.columns)},this.getCellRenderer=function(m,w){const p=typeof m=="number"?o.getCellMeta(m,w).renderer:m.renderer;return typeof p=="string"?tp(p):Pt(p)?tp("text"):p},this.getCellEditor=function(m,w){const p=typeof m=="number"?o.getCellMeta(m,w).editor:m.editor;return typeof p=="string"?ep(p):Pt(p)?ep("text"):p},this.getCellValidator=function(m,w){const p=typeof m=="number"?o.getCellMeta(m,w).validator:m.validator;return typeof p=="string"?U0(p):p},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,w){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(w,m)},this.validateColumns=function(m,w){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(w,void 0,m)},this._validateCells=function(m,w,p){const _=new oe;m&&(_.onQueueEmpty=m);let H=o.countRows()-1;for(;H>=0;){if(w!==void 0&&w.indexOf(H)===-1){H-=1;continue}let V=o.countCols()-1;for(;V>=0;){if(p!==void 0&&p.indexOf(V)===-1){V-=1;continue}_.addValidatorToQueue(),o.validateCell(o.getDataAtCell(H,V),o.getCellMeta(H,V),G=>{if(typeof G!="boolean")throw new Error("Validation error: result is not boolean");G===!1&&(_.valid=!1),_.removeValidatorFormQueue()},"validateCells"),V-=1}H-=1}_.checkIfQueueIsEmpty()},this.getRowHeader=function(m){let w=C.rowHeaders,p=m;return p!==void 0&&(p=o.runHooks("modifyRowHeader",p)),p===void 0?(w=[],fe(o.countRows()-1,_=>{w.push(o.getRowHeader(_))})):Array.isArray(w)&&w[p]!==void 0?w=w[p]:ot(w)?w=w(p):w&&typeof w!="string"&&typeof w!="number"&&(w=p+1),w},this.hasRowHeaders=function(){return!!C.rowHeaders},this.hasColHeaders=function(){if(C.colHeaders!==void 0&&C.colHeaders!==null)return!!C.colHeaders;for(let m=0,w=o.countCols();m<w;m++)if(o.getColHeader(m))return!0;return!1},this.getColHeader=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=o.runHooks("modifyColHeader",m);if(p===void 0){const K=[],b=o.countCols();for(let R=0;R<b;R++)K.push(o.getColHeader(R));return K}let _=C.colHeaders;const H=function(K){const b=[],R=o.countCols();let S=0;for(;S<R;S++)ot(C.columns)&&C.columns(S)&&b.push(S);return b[K]},V=o.toPhysicalColumn(p),G=H(V);return C.colHeaders===!1?_=null:C.columns&&ot(C.columns)&&C.columns(G)&&C.columns(G).title?_=C.columns(G).title:C.columns&&C.columns[V]&&C.columns[V].title?_=C.columns[V].title:Array.isArray(C.colHeaders)&&C.colHeaders[V]!==void 0?_=C.colHeaders[V]:ot(C.colHeaders)?_=C.colHeaders(V):C.colHeaders&&typeof C.colHeaders!="string"&&typeof C.colHeaders!="number"&&(_=Cw(p)),_=o.runHooks("modifyColumnHeaderValue",_,m,w),_},this._getColWidthFromSettings=function(m){let w;if(m>=0&&(w=o.getCellMeta(0,m).width),(w===void 0||w===C.width)&&(w=C.colWidths),w!=null){switch(typeof w){case"object":w=w[m];break;case"function":w=w(m);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getColWidth=function(m,w){let p=o._getColWidthFromSettings(m);return p=o.runHooks("modifyColWidth",p,m,w),p===void 0&&(p=wc),p},this._getRowHeightFromSettings=function(m){const w=this.view.getDefaultRowHeight();let p=C.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[m];break;case"function":p=p(m);break}typeof p=="string"&&(p=parseInt(p,10))}return p!=null&&p<w?w:p},this.getRowHeight=function(m,w){let p=o._getRowHeightFromSettings(m);return p=o.runHooks("modifyRowHeight",p,m,w),p},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const m=C.maxCols,w=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(m,w)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return DR(o.countRows()-1,p=>{if(o.isEmptyRow(p))w+=1;else if(m===!0)return!1}),w},this.countEmptyCols=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return DR(o.countCols()-1,p=>{if(o.isEmptyCol(p))w+=1;else if(m===!0)return!1}),w},this.isEmptyRow=function(m){return C.isEmptyRow.call(o,m)},this.isEmptyCol=function(m){return C.isEmptyCol.call(o,m)},this.selectCell=function(m,w,p,_){let H=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,V=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Pt(m)||Pt(w)?!1:this.selectCells([[m,w,p,_]],H,V)},this.selectCells=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;w===!1&&d.suspend();const _=U.selectCells(m);return _&&p&&o.listen(),d.resume(),_},this.selectColumns=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;return U.selectColumns(m,w,p)},this.selectRows=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;return U.selectRows(m,w,p)},this.deselectCell=function(){U.deselect()},this.selectAll=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,p=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),U.selectAll(m,w,p)};const gt=(m,w)=>m.getNearestNotHiddenIndex(w,1,!0);this.scrollViewportTo=function(m,w){if(typeof m=="number"){var p;m={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(p=arguments[4])!==null&&p!==void 0?p:!0}}const{row:_,col:H,considerHiddenIndexes:V}=m??{};let G=_,K=H;if(ot(w)&&this.addHookOnce("afterScroll",w),V===void 0||V){const L=Number.isInteger(_)&&_>=0,P=Number.isInteger(H)&&H>=0,D=L?gt(this.rowIndexMapper,_):void 0,j=P?gt(this.columnIndexMapper,H):void 0;if(D===null||j===null)return!1;G=L?o.rowIndexMapper.getRenderableFromVisualIndex(D):_,K=P?o.columnIndexMapper.getRenderableFromVisualIndex(j):H}const b=Number.isInteger(G),R=Number.isInteger(K);let S=!1;return b&&G>=0&&R&&K>=0?S=o.view.scrollViewport(o._createCellCoords(G,K),m.horizontalSnap,m.verticalSnap):b&&G>=0&&(R&&K<0||!R)?S=o.view.scrollViewportVertically(G,m.verticalSnap):R&&K>=0&&(b&&G<0||!b)&&(S=o.view.scrollViewportHorizontally(K,m.horizontalSnap)),ot(w)&&(S?this.view.render():(this.removeHook("afterScroll",w),this._registerMicrotask(()=>w()))),S},this.scrollToFocusedCell=function(m){if(!this.selection.isSelected())return!1;ot(m)&&this.addHookOnce("afterScroll",m);const{highlight:w}=this.getSelectedRangeLast(),p=this.scrollViewportTo(w.toObject());return p?this.view.render():ot(m)&&(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m())),p},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),E.clearCache(),yb.delete(this.guid),Sm(o)){const m=this.rootDocument.querySelector(".hot-display-license-info");m&&m.parentNode.removeChild(m)}Oo(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),A.getItems().forEach(m=>{let[,w]=m;w.destroy()}),A.clear(),o.runHooks("afterDestroy")},!0),re.getSingleton().destroy(o),Ae(o,(m,w,p)=>{ot(m)?p[w]=Xt(w):w!=="guid"&&(p[w]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,U=null,c=null,o=null};function Xt(m){return()=>{throw new Error(`The "${m}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(m){return A.getItem(jn(m))},this.getPluginName=function(m){return m===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:A.getId(m)},this.getInstance=function(){return o},this.addHook=function(m,w,p){re.getSingleton().add(m,w,o,p)},this.hasHook=function(m){return re.getSingleton().has(m,o)||re.getSingleton().has(m)},this.addHookOnce=function(m,w,p){re.getSingleton().once(m,w,o,p)},this.removeHook=function(m,w){re.getSingleton().remove(m,w,o)},this.runHooks=function(m,w,p,_,H,V,G){return re.getSingleton().run(o,m,w,p,_,H,V,G)},this.getTranslatedPhrase=function(m,w){return $F(C.language,m,w)},this.toHTML=()=>HR(this),this.toTableElement=()=>{const m=this.rootDocument.createElement("div");return m.insertAdjacentHTML("afterbegin",HR(this)),m.firstElementChild},this.timeouts=[],this.useTheme=m=>{this.view.getStylesHandler().useTheme(m),this.runHooks("afterSetTheme",m,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=m;typeof p=="function"&&(p=setTimeout(p,w)),this.timeouts.push(p)},this._clearTimeouts=function(){M(this.timeouts,m=>{clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){M(this.immediates,m=>{clearImmediate(m)})},this._registerMicrotask=function(m){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||m()})},this._getEditorManager=function(){return c};const Ke=h5({handleEvent(){return o.isListening()},beforeKeyDown:m=>this.runHooks("beforeKeyDown",m),afterKeyDown:m=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",m=>{m.ctrlKey===!1&&m.metaKey===!1&&Ke.releasePressedKeys()}),this.getShortcutManager=function(){return Ke},this.getFocusManager=function(){return h},j0().forEach(m=>{const w=mf(m);A.addItem(m,new w(this))}),q8(o),Ke.setActiveContextName("grid"),re.getSingleton().run(o,"construct")}function AA(t,e,n){t.addEventListener(e,n,!1)}function HA(t,e,n){t.removeEventListener(e,n,!1)}function lg(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function e$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=lg(s).fontSize,o.style.fontFamily=lg(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=lg(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=lg(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),v=o.clientWidth+f+g+1;r.removeChild(o);const y=s.style;y.height=`${n.minHeight}px`,n.minWidth>v?y.width=`${n.minWidth}px`:v>n.maxWidth?y.width=`${n.maxWidth}px`:y.width=`${v}px`;const E=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>E?y.height=`${n.minHeight}px`:n.maxHeight<E?(y.height=`${n.maxHeight}px`,y.overflowY="visible"):y.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(AA(s,"input",a),AA(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){HA(s,"input",a),HA(s,"keydown",l)}}}function NA(t,e){const n=M0(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}hf(e,i)}function Ba(t,e,n){return(e=d5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d5(t){var e=f5(t,"string");return typeof e=="symbol"?e:e+""}function f5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const g5="ht_editor_visible",ug="ht_editor_hidden",DA="textEditor",m5="text";class eu extends kc{static get EDITOR_TYPE(){return m5}constructor(e){super(e),Ba(this,"eventManager",new di(this)),Ba(this,"autoResize",e$(this.hot.rootDocument)),Ba(this,"TEXTAREA",void 0),Ba(this,"textareaStyle",void 0),Ba(this,"TEXTAREA_PARENT",void 0),Ba(this,"textareaParentStyle",void 0),Ba(this,"layerClass",void 0),this.eventManager=new di(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),ad(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Yt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Yt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),hf(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),ye(this.TEXTAREA,[["data-hot-input",""],Kl(-1)]),q(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),q(this.TEXTAREA_PARENT,"handsontableInputHolder"),we(this.TEXTAREA_PARENT,this.layerClass)&&pe(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,ug),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){WL()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",pe(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,ug)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;fe(e.length-1,r=>{const i=e[r];if(we(i,"handsontableEditor"))return n=!0,!1}),we(this.TEXTAREA_PARENT,ug)&&pe(this.TEXTAREA_PARENT,ug),n?(this.layerClass=g5,q(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),q(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Yt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){k0()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Yt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Yt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>le(this.hot.getSelected()),group:DA},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;NA(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;NA(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(DA)}}const p5="base";function yf(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&q(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(Wx())):a&&c.push(Wx()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(Bx())):(u.push(s.invalidCellClassName),a&&c.push(Bx()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),pe(e,u),q(e,l),Zl(e,c),ye(e,h)}yf.RENDERER_TYPE=p5;const w5="text";function xs(t,e,n,r,i,o,s){yf.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=bt(a),s.trimWhitespace&&(a=a.trim()),ba(e,a)}xs.RENDERER_TYPE=w5;const v5="text",t$={CELL_TYPE:v5,editor:eu,renderer:xs};Zr(t$);Se.editors={BaseEditor:kc};function Se(t,e){const n=new JF(t,e||{},a_);return n.init(),n}Se.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new JF(t,e,a_)};Se.DefaultSettings=YF();Se.hooks=re.getSingleton();Se.CellCoords=kl;Se.CellRange=pf;Se.packageName="handsontable";Se.buildDate="24/04/2025 10:59:00";Se.version="15.3.0";Se.languages={dictionaryKeys:D9,getLanguageDictionary:FF,getLanguagesDictionaries:V9,registerLanguageDictionary:LF,getTranslatedPhrase:$F};const kA="handsontableEditor",C5="handsontable";class VT extends eu{static get EDITOR_TYPE(){return C5}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),hf(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&tn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{if(!n){var r;(r=this.htEditor)===null||r===void 0||r.useTheme(e)}})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:kA,relativeToGroup:Pa,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),vi(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(kA)}}function y5(t,e){n$(t,e),e.add(t)}function LA(t,e,n){n$(t,e),e.set(t,n)}function n$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cg(t,e,n){return(e=b5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b5(t){var e=S5(t,"string");return typeof e=="symbol"?e:e+""}function S5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bb(t,e){return t.get(GR(t,e))}function GR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const R5="autocomplete";var Sb=new WeakMap,FA=new WeakMap,Rb=new WeakSet;class WT extends VT{constructor(){super(...arguments),y5(this,Rb),cg(this,"query",null),cg(this,"strippedChoices",[]),cg(this,"rawChoices",[]),LA(this,Sb,this.hot.guid.slice(0,9)),LA(this,FA,ff(()=>{this.focus()},100)),cg(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=MR(bt(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return R5}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),q(this.htContainer,"autocompleteEditor"),q(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&ye(this.TEXTAREA,[iq(),J2(),gL("listbox"),lq()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&ye(this.TEXTAREA,[li("false"),uq(`${bb(Sb,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",bb(FA,this)),this.htEditor.updateSettings({colWidths:e?[qt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{xs(a,l,u,c,h,d,f);const{filteringCaseSensitive:g,allowHtml:v,locale:y}=this.cellProperties,E=this.query;let C=bt(d),T,A;C&&!v&&(T=g===!0?C.indexOf(E):C.toLocaleLowerCase(y).indexOf(E.toLocaleLowerCase(y)),T!==-1&&(A=C.substr(T,E.length),C=C.replace(A,`<strong>${A}</strong>`))),n&&ye(l,[eq(),...r?[fq(i)]:[],...r?[gq(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=C},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{ye(h,[S0()]),ye(this.TEXTAREA,...cq(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(ye(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...gs()),ye(this.htEditor.rootElement,[fL(),hq("polite"),dq("text"),["id",`${bb(Sb,this)}-listbox-${o}-${s}`]]),ye(this.TEXTAREA,...li("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ye(this.TEXTAREA,[li("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=M0(this.TEXTAREA),r=IL(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(id([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),hf(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),n=e.height;let r=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const a=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getHeight(),o=this.hot.view.getWorkspaceHeight()-r-n,s=i>o&&r>o+n;return s?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(s?r:o,i),s}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),GR(Rb,this,$A).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),GR(Rb,this,$A).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(o,s)=>s).reduce((o,s)=>{const a=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight();return o+a},0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Be(e,o=>bt(o));return Be(r,o=>n?o:MR(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===de.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===de.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(BL(e.keyCode)||e.keyCode===de.BACKSPACE||e.keyCode===de.DELETE||e.keyCode===de.INSERT){let n=10;if(e.keyCode===de.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function $A(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+bn(this.hot.rootDocument)})}const E5="checkbox";class r$ extends kc{static get EDITOR_TYPE(){return E5}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');we(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const la=()=>window,ii=()=>window.document,qR=(t,e)=>window.setTimeout(t,e),co=function(t,e,n,r){t.addEventListener(e,n,!!r)},qo=function(t,e,n,r){t.removeEventListener(e,n,!!r)},_5=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},xr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},Eb=function(t,e){xr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},_b=function(t,e){t.className=_5((" "+t.className+" ").replace(" "+e+" "," "))},BT=function(t){return/Array/.test(Object.prototype.toString.call(t))},kr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},T5=function(t){let e=t.getDay();return e===0||e===6},M5=function(t){return t%4===0&&t%100!==0||t%400===0},VA=function(t,e){return[31,M5(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},hg=function(t){kr(t)&&t.setHours(0,0,0,0)},dg=function(t,e){return t.getTime()===e.getTime()},op=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?kr(e[r])?n&&(t[r]=new Date(e[r].getTime())):BT(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=op({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},WA=function(t,e,n){let r=ii().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=op(r,n),t.dispatchEvent(r)},BA=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Ji={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},jA=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},I5=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},P5=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},O5=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():P5(o,i))+"</td>"},x5=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},A5=function(t){return"<tbody>"+t.join("")+"</tbody>"},H5=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+jA(t,e)+'">'+jA(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},N5=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,g,v=!0,y=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",BT(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return g='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,c&&(r===0||u.minMonth>=r)&&(v=!1),h&&(r===11||u.maxMonth<=r)&&(y=!1),e===0&&(d+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},D5=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+H5(t)+A5(e)+"</table>"};function KR(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||la().event;let o=i.target||i.srcElement;if(o)if(xr(o,"is-disabled")||(xr(o,"pika-button")&&!xr(o,"is-empty")&&!xr(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&qR(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):xr(o,"pika-prev")?e.prevMonth():xr(o,"pika-next")&&e.nextMonth()),xr(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||la().event;let o=i.target||i.srcElement;o&&(xr(o,"pika-select-month")?e.gotoMonth(o.value):xr(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||la().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),kr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=ii().activeElement;do if(xr(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=qR(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||la().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&xr(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),co(o,"change",e._onChange)));do if(xr(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=ii().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),co(e.el,"mousedown",e._onMouseDown,!0),co(e.el,"touchend",e._onMouseDown,!0),co(e.el,"change",e._onChange),n.keyboardInput&&co(ii(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?ii().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),co(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;kr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",co(n.trigger,"click",e._onInputClick),co(n.trigger,"focus",e._onInputFocus),co(n.trigger,"blur",e._onInputBlur)):this.show()}KR.prototype={config:function(t){this._o||(this._o=op({},Ji,!0));let e=op(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,kr(e.minDate)||(e.minDate=!1),kr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),BT(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Ji.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,kr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return kr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",WA(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!kr(t))return;let n=this._o.minDate,r=this._o.maxDate;kr(n)&&t<n?t=n:kr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),hg(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),WA(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(kr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=BA(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=BA({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(hg(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Ji.minDate,this._o.minYear=Ji.minYear,this._o.minMonth=Ji.minMonth,this._o.startRange=Ji.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(hg(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Ji.maxDate,this._o.maxYear=Ji.maxYear,this._o.maxMonth=Ji.maxMonth,this._o.endRange=Ji.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+N5(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&qR(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=la().innerWidth||ii().documentElement.clientWidth,i=la().innerHeight||ii().documentElement.clientHeight,o=ii().body.scrollTop||ii().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+la().pageXOffset,a=l.bottom+la().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",Eb(this.el,u?"left-aligned":"right-aligned"),Eb(this.el,c?"bottom-aligned":"top-aligned"),_b(this.el,u?"right-aligned":"left-aligned"),_b(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=VA(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];hg(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=VA(h,u),g=o+s,v=g;for(;v>7;)v-=7;g+=7-v;let y=!1;for(let E=0,C=0;E<g;E++){let T=new Date(t,e,1+(E-s)),A=kr(this._d)?dg(T,this._d):!1,F=dg(T,i),I=r.events.indexOf(T.toDateString())!==-1,O=E<s||E>=o+s,Y=1+(E-s),U=e,W=t,Z=r.startRange&&dg(r.startRange,T),Q=r.endRange&&dg(r.endRange,T),oe=r.startRange&&r.endRange&&r.startRange<T&&T<r.endRange,te=r.minDate&&T<r.minDate||r.maxDate&&T>r.maxDate||r.disableWeekends&&T5(T)||r.disableDayFn&&r.disableDayFn(T);O&&(E<s?(Y=f+Y,U=u,W=h):(Y=Y-o,U=c,W=d));let ae={day:Y,month:U,year:W,hasEvent:I,isSelected:A,isToday:F,isDisabled:te,isEmpty:O,isStartRange:Z,isEndRange:Q,isInRange:oe,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&A&&(y=!0),l.push(I5(ae)),++C===7&&(r.showWeekNumber&&l.unshift(O5(this,E-s,e,t,r.firstWeekOfYearMinDays)),a.push(x5(l,r.isRTL,r.pickWholeWeek,y)),l=[],C=0,y=!1)}return D5(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),_b(this.el,"is-hidden"),this._o.bound&&(co(ii(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&qo(ii(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Eb(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),qo(this.el,"mousedown",this._onMouseDown,!0),qo(this.el,"touchend",this._onMouseDown,!0),qo(this.el,"change",this._onChange),t.keyboardInput&&qo(ii(),"keydown",this._onKeyChange),t.field&&(qo(t.field,"change",this._onInputChange),t.bound&&(qo(t.trigger,"click",this._onInputClick),qo(t.trigger,"focus",this._onInputFocus),qo(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function k5(t,e){L5(t,e),e.add(t)}function L5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UA(t,e,n){return(e=F5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F5(t){var e=$5(t,"string");return typeof e=="symbol"?e:e+""}function $5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const i$="date",zA="dateEditor",V5="DD/MM/YYYY";var fg=new WeakSet;class o$ extends eu{constructor(){super(...arguments),k5(this,fg),UA(this,"parentDestroyed",!1),UA(this,"$datePicker",null)}static get EDITOR_TYPE(){return i$}init(){if(typeof X!="function")throw new Error("You need to include moment.js to your project.");if(typeof KR!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(pe(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),q(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();pe(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{we(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:zA})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(zA),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=Tb(fg,this,Mb).call(this),r=this.hot.view.isMouseDown(),i=e?F0(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new KR(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(X),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,X(o,n,!0).isValid()&&this.$datePicker.setMoment(X(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,X(o,n,!0).isValid()&&this.$datePicker.setMoment(X(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&gf(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:Tb(fg,this,Mb).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=X(a).format(Tb(fg,this,Mb).call(this))),this.setValue(a),i&&i(),Eo()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Yt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+en(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-qt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function Mb(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:V5}const W5="dropdown";class s$ extends WT{static get EDITOR_TYPE(){return W5}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const B5="numeric";class a$ extends eu{static get EDITOR_TYPE(){return B5}}function j5(t,e,n){return(e=U5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U5(t){var e=z5(t,"string");return typeof e=="symbol"?e:e+""}function z5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Y5="password";class l$ extends eu{constructor(){super(...arguments),j5(this,"autoResize",e$(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return Y5}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Oo(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Ib="ht_editor_visible",YA="selectEditor",G5="select";class u$ extends kc{static get EDITOR_TYPE(){return G5}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Xl()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),q(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",we(this.selectWrapper,Ib)&&pe(this.selectWrapper,Ib),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Oo(this.select),Ae(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Ql(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Yt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",q(this.selectWrapper,Ib)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:YA};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(YA)}}const q5="time";class c$ extends eu{static get EDITOR_TYPE(){return q5}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function K5(){pr(kc),pr(WT),pr(r$),pr(o$),pr(s$),pr(VT),pr(a$),pr(l$),pr(u$),pr(eu),pr(c$)}const X5="html";function jT(t,e,n,r,i,o,s){yf.apply(this,[t,e,n,r,i,o,s]),Ql(e,o??"",!1)}jT.RENDERER_TYPE=X5;const Z5="autocomplete";function Fc(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?jT:xs,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Xl()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),q(e,"htAutocomplete"),!t.acArrowListener){const h=new di(t);t.acArrowListener=function(d){we(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Fc.RENDERER_TYPE=Z5;const Q5="dropdown";function UT(t,e,n,r,i,o,s){Fc.apply(this,[t,e,n,r,i,o,s])}UT.RENDERER_TYPE=Q5;const GA=new WeakMap,qA=new WeakMap,J5="htBadValue",Cc="data-row",yc="data-col",e7="checkboxRenderer",h$="checkbox";re.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===h$){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function zT(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;yf.apply(this,[t,e,n,r,i,o,s]),t7(t);let u=n7(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),Oo(e),o===s.checkedTemplate||bt(o).toLocaleLowerCase(s.locale)===bt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||bt(o).toLocaleLowerCase(s.locale)===bt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Wt(o)?q(u,"noValue"):(u.style.display="none",q(u,J5),h=!0),ye(u,[[Cc,n],[yc,r]]),l&&ye(u,[Hd(u.checked?t.getTranslatedPhrase(DT):t.getTranslatedPhrase(kT)),wL(u.checked),tq()]),!h&&c){let v="";if(c.value)v=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const E=t.getDataAtRowProp(n,c.property);v=E!==null?E:""}const y=r7(a,v,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(y),e.appendChild(u)):(y.appendChild(u),u=y):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(y)):(y.insertBefore(u,y.firstChild),u=y))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),GA.has(t)||(GA.set(t,!0),d());function d(){const y=t.getShortcutManager().getContext("grid"),E={group:e7,relativeToGroup:Pa,position:"before"};y.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const C=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(C==null?void 0:C.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}}],E)}function f(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=t.getSelectedRange(),E=[],C=new Map;let T=[],A=0;if(y){for(let F=0;F<y.length;F++){const{row:I,col:O}=y[F].getTopStartCorner(),{row:Y,col:U}=y[F].getBottomEndCorner();for(let W=I;W<=Y;W+=1)for(let Z=O;Z<=U;Z+=1){const Q=t.getCellMeta(W,Z);if(Q.hidden)continue;const oe={checkedTemplate:Q.checkedTemplate,uncheckedTemplate:Q.uncheckedTemplate};if(Q.type!=="checkbox"){v===!0&&!Q.readOnly&&(C.has(E.length)?C.set(E.length,[...C.get(E.length),[W,Z,null]]):C.set(E.length,[[W,Z,null]]));continue}if(Q.readOnly===!0)continue;typeof Q.checkedTemplate>"u"&&(Q.checkedTemplate=!0),typeof Q.uncheckedTemplate>"u"&&(Q.uncheckedTemplate=!1);const te=t.getDataAtCell(W,Z);v===!1?[Q.checkedTemplate,Q.checkedTemplate.toString()].includes(te)?T.push([W,Z,Q.uncheckedTemplate,oe]):[Q.uncheckedTemplate,Q.uncheckedTemplate.toString(),null,void 0].includes(te)&&T.push([W,Z,Q.checkedTemplate,oe]):T.push([W,Z,Q.uncheckedTemplate,oe]),A+=1}E.push(A),A=0}T.every(F=>{let[,,I]=F;return I===T[0][2]})?T=T.map(F=>{let[I,O,Y]=F;return[I,O,Y]}):T=T.map(F=>{let[I,O,,Y]=F;return[I,O,Y.checkedTemplate]}),T.length>0&&E.forEach((F,I)=>{let O=T.splice(0,F);C.size&&C.has(I)&&(O=[...O,...C.get(I)]),t.setDataAtCell(O)})}}function g(){const v=t.getSelectedRange();if(v){for(let y=0;y<v.length;y++){const E=v[y].getTopStartCorner(),C=v[y].getBottomEndCorner();for(let T=E.row;T<=C.row;T++)for(let A=E.col;A<=C.col;A++){if(t.getCellMeta(T,A).readOnly)continue;const I=t.getCell(T,A);if(_o(I)&&I.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}zT.RENDERER_TYPE=h$;function t7(t){let e=qA.get(t);if(!e){const{rootElement:n}=t;e=new di(t),e.addEventListener(n,"click",r=>o7(r,t)),e.addEventListener(n,"mouseup",r=>i7(r,t)),e.addEventListener(n,"change",r=>s7(r,t)),qA.set(t,e)}return e}function n7(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function r7(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function i7(t,e){const{target:n}=t;YT(n)&&(!n.hasAttribute(Cc)||!n.hasAttribute(yc)||setTimeout(e.listen,10))}function o7(t,e){const{target:n}=t;if(!YT(n)||!n.hasAttribute(Cc)||!n.hasAttribute(yc))return;const r=parseInt(n.getAttribute(Cc),10),i=parseInt(n.getAttribute(yc),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function s7(t,e){const{target:n}=t;if(!YT(n)||!n.hasAttribute(Cc)||!n.hasAttribute(yc))return;const r=parseInt(n.getAttribute(Cc),10),i=parseInt(n.getAttribute(yc),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function YT(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const a7="handsontable";function GT(t,e,n,r,i,o,s){Fc.apply(this,[t,e,n,r,i,o,s])}GT.RENDERER_TYPE=a7;var l7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function u7(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Pb,KA;function c7(){return KA||(KA=1,Pb={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),Pb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Ob,XA;function d$(){if(XA)return Ob;XA=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,g){if(!isNaN(+l))return+l;let v="",y=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(y!==l)return-1*n(y,u,c,h,d,f);for(let I=0;I<t.length;I++){let O=t[I];if(v=l.replace(RegExp(`([0-9 ])(${O.key})$`),"$1"),v!==l)return n(v,u,c,h,d,f)*O.factor}if(v=l.replace("%",""),v!==l)return n(v,u,c,h,d,f)/100;let E=parseFloat(l);if(isNaN(E))return;let C=h(E);if(C&&C!=="."&&(v=l.replace(new RegExp(`${e(C)}$`),""),v!==l))return n(v,u,c,h,d,f);let T={};Object.keys(f).forEach(I=>{T[f[I]]=I});let A=Object.keys(T).sort().reverse(),F=A.length;for(let I=0;I<F;I++){let O=A[I],Y=T[O];if(v=l.replace(O,""),v!==l){let U;switch(Y){case"thousand":U=Math.pow(10,3);break;case"million":U=Math.pow(10,6);break;case"billion":U=Math.pow(10,9);break;case"trillion":U=Math.pow(10,12);break}return n(v,u,c,h,d,f)*U}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,g){if(l==="")return;if(l===d)return 0;let v=r(l,u,c);return n(v,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=XT();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),g=c.getZeroFormat(),v=c.currentAbbreviations(),y;if(typeof l=="string")o(l,h)?y=s(l):y=i(l,h,d,f,g,v);else if(typeof l=="number")y=l;else return;if(y!==void 0)return y}return Ob={unformat:a},Ob}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var xb,ZA;function qT(){if(ZA)return xb;ZA=1;let t=d$();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(y,E)=>E.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:y=>y.output==="byte"},characteristic:{type:"number",restriction:y=>y>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(y,E)=>E.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:y=>y>=0,message:"value must be positive"},{restriction:(y,E)=>!E.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:y=>y>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(y,E)=>E.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:y=>y.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(y,E){let C=d(y),T=g(E);return C&&T}function d(y){return t.unformat(y)!==void 0}function f(y,E,C,T=!1){let A=Object.keys(y).map(F=>{if(!E[F])return console.error(`${C} Invalid key: ${F}`),!1;let I=y[F],O=E[F];if(typeof O=="string"&&(O={type:O}),O.type==="format"){if(!f(I,u,`[Validate ${F}]`,!0))return!1}else if(typeof I!==O.type)return console.error(`${C} ${F} type mismatched: "${O.type}" expected, "${typeof I}" provided`),!1;if(O.restrictions&&O.restrictions.length){let Y=O.restrictions.length;for(let U=0;U<Y;U++){let{restriction:W,message:Z}=O.restrictions[U];if(!W(I,y))return console.error(`${C} ${F} invalid value: ${Z}`),!1}}return O.restriction&&!O.restriction(I,y)?(console.error(`${C} ${F} invalid value: ${O.message}`),!1):O.validValues&&O.validValues.indexOf(I)===-1?(console.error(`${C} ${F} invalid value: must be among ${JSON.stringify(O.validValues)}, "${I}" provided`),!1):!(O.children&&!f(I,O.children,`[Validate ${F}]`))});return T||A.push(...Object.keys(E).map(F=>{let I=E[F];if(typeof I=="string"&&(I={type:I}),I.mandatory){let O=I.mandatory;if(typeof O=="function"&&(O=O(y)),O&&y[F]===void 0)return console.error(`${C} Missing mandatory key "${F}"`),!1}return!0})),A.reduce((F,I)=>F&&I,!0)}function g(y){return f(y,u,"[Validate format]")}function v(y){return f(y,c,"[Validate language]")}return xb={validate:h,validateFormat:g,validateInput:d,validateLanguage:v},xb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function h7(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function d7(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function f7(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function g7(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function m7(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function p7(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function w7(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function v7(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function C7(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function y7(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function b7(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function S7(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function R7(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function E7(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function _7(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function T7(t,e={}){return typeof t!="string"?t:(t=h7(t,e),t=d7(t,e),f7(t,e),p7(t,e),w7(t,e),R7(t,e),y7(t,e),b7(t,e),v7(t,e),S7(t,e),C7(t,e),g7(t,e),m7(t,e),E7(t,e),_7(t,e),e)}var KT={parseFormat:T7};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Ab,QA;function XT(){if(QA)return Ab;QA=1;const t=c7(),e=qT(),n=KT;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(g=>g.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,Ab=r,Ab}function M7(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function I7(t,e){t.forEach(n=>{let r;try{r=M7(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var P7=t=>({loadLanguagesInNode:e=>I7(e,t)}),f$={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(I){var O,Y,U,W=p.prototype={constructor:p,toString:null,valueOf:null},Z=new p(1),Q=20,oe=4,te=-7,ae=21,ft=-1e7,be=1e7,He=!1,gt=1,Xt=0,Ke={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},m="0123456789abcdefghijklmnopqrstuvwxyz",w=!0;function p(b,R){var S,L,P,D,j,x,k,B,$=this;if(!($ instanceof p))return new p(b,R);if(R==null){if(b&&b._isBigNumber===!0){$.s=b.s,!b.c||b.e>be?$.c=$.e=null:b.e<ft?$.c=[$.e=0]:($.e=b.e,$.c=b.c.slice());return}if((x=typeof b=="number")&&b*0==0){if($.s=1/b<0?(b=-b,-1):1,b===~~b){for(D=0,j=b;j>=10;j/=10,D++);D>be?$.c=$.e=null:($.e=D,$.c=[b]);return}B=String(b)}else{if(!r.test(B=String(b)))return U($,B,x);$.s=B.charCodeAt(0)==45?(B=B.slice(1),-1):1}(D=B.indexOf("."))>-1&&(B=B.replace(".","")),(j=B.search(/e/i))>0?(D<0&&(D=j),D+=+B.slice(j+1),B=B.substring(0,j)):D<0&&(D=B.length)}else{if(C(R,2,m.length,"Base"),R==10&&w)return $=new p(b),G($,Q+$.e+1,oe);if(B=String(b),x=typeof b=="number"){if(b*0!=0)return U($,B,x,R);if($.s=1/b<0?(B=B.slice(1),-1):1,p.DEBUG&&B.replace(/^0\.0*|\./,"").length>15)throw Error(a+b)}else $.s=B.charCodeAt(0)===45?(B=B.slice(1),-1):1;for(S=m.slice(0,R),D=j=0,k=B.length;j<k;j++)if(S.indexOf(L=B.charAt(j))<0){if(L=="."){if(j>D){D=k;continue}}else if(!P&&(B==B.toUpperCase()&&(B=B.toLowerCase())||B==B.toLowerCase()&&(B=B.toUpperCase()))){P=!0,j=-1,D=0;continue}return U($,String(b),x,R)}x=!1,B=Y(B,R,10,$.s),(D=B.indexOf("."))>-1?B=B.replace(".",""):D=B.length}for(j=0;B.charCodeAt(j)===48;j++);for(k=B.length;B.charCodeAt(--k)===48;);if(B=B.slice(j,++k)){if(k-=j,x&&p.DEBUG&&k>15&&(b>c||b!==o(b)))throw Error(a+$.s*b);if((D=D-j-1)>be)$.c=$.e=null;else if(D<ft)$.c=[$.e=0];else{if($.e=D,$.c=[],j=(D+1)%u,D<0&&(j+=u),j<k){for(j&&$.c.push(+B.slice(0,j)),k-=u;j<k;)$.c.push(+B.slice(j,j+=u));j=u-(B=B.slice(j)).length}else j-=k;for(;j--;B+="0");$.c.push(+B)}}else $.c=[$.e=0]}p.clone=g,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(b){var R,S;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(R="DECIMAL_PLACES")&&(S=b[R],C(S,0,f,R),Q=S),b.hasOwnProperty(R="ROUNDING_MODE")&&(S=b[R],C(S,0,8,R),oe=S),b.hasOwnProperty(R="EXPONENTIAL_AT")&&(S=b[R],S&&S.pop?(C(S[0],-1e9,0,R),C(S[1],0,f,R),te=S[0],ae=S[1]):(C(S,-1e9,f,R),te=-(ae=S<0?-S:S))),b.hasOwnProperty(R="RANGE"))if(S=b[R],S&&S.pop)C(S[0],-1e9,-1,R),C(S[1],1,f,R),ft=S[0],be=S[1];else if(C(S,-1e9,f,R),S)ft=-(be=S<0?-S:S);else throw Error(s+R+" cannot be zero: "+S);if(b.hasOwnProperty(R="CRYPTO"))if(S=b[R],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))He=S;else throw He=!S,Error(s+"crypto unavailable");else He=S;else throw Error(s+R+" not true or false: "+S);if(b.hasOwnProperty(R="MODULO_MODE")&&(S=b[R],C(S,0,9,R),gt=S),b.hasOwnProperty(R="POW_PRECISION")&&(S=b[R],C(S,0,f,R),Xt=S),b.hasOwnProperty(R="FORMAT"))if(S=b[R],typeof S=="object")Ke=S;else throw Error(s+R+" not an object: "+S);if(b.hasOwnProperty(R="ALPHABET"))if(S=b[R],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))w=S.slice(0,10)=="0123456789",m=S;else throw Error(s+R+" invalid: "+S)}else throw Error(s+"Object expected: "+b);return{DECIMAL_PLACES:Q,ROUNDING_MODE:oe,EXPONENTIAL_AT:[te,ae],RANGE:[ft,be],CRYPTO:He,MODULO_MODE:gt,POW_PRECISION:Xt,FORMAT:Ke,ALPHABET:m}},p.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var R,S,L=b.c,P=b.e,D=b.s;e:if({}.toString.call(L)=="[object Array]"){if((D===1||D===-1)&&P>=-1e9&&P<=f&&P===o(P)){if(L[0]===0){if(P===0&&L.length===1)return!0;break e}if(R=(P+1)%u,R<1&&(R+=u),String(L[0]).length==R){for(R=0;R<L.length;R++)if(S=L[R],S<0||S>=l||S!==o(S))break e;if(S!==0)return!0}}}else if(L===null&&P===null&&(D===null||D===1||D===-1))return!0;throw Error(s+"Invalid BigNumber: "+b)},p.maximum=p.max=function(){return H(arguments,-1)},p.minimum=p.min=function(){return H(arguments,1)},p.random=function(){var b=9007199254740992,R=Math.random()*b&2097151?function(){return o(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var L,P,D,j,x,k=0,B=[],$=new p(Z);if(S==null?S=Q:C(S,0,f),j=i(S/u),He)if(crypto.getRandomValues){for(L=crypto.getRandomValues(new Uint32Array(j*=2));k<j;)x=L[k]*131072+(L[k+1]>>>11),x>=9e15?(P=crypto.getRandomValues(new Uint32Array(2)),L[k]=P[0],L[k+1]=P[1]):(B.push(x%1e14),k+=2);k=j/2}else if(crypto.randomBytes){for(L=crypto.randomBytes(j*=7);k<j;)x=(L[k]&31)*281474976710656+L[k+1]*1099511627776+L[k+2]*4294967296+L[k+3]*16777216+(L[k+4]<<16)+(L[k+5]<<8)+L[k+6],x>=9e15?crypto.randomBytes(7).copy(L,k):(B.push(x%1e14),k+=7);k=j/7}else throw He=!1,Error(s+"crypto unavailable");if(!He)for(;k<j;)x=R(),x<9e15&&(B[k++]=x%1e14);for(j=B[--k],S%=u,j&&S&&(x=h[u-S],B[k]=o(j/x)*x);B[k]===0;B.pop(),k--);if(k<0)B=[D=0];else{for(D=-1;B[0]===0;B.splice(0,1),D-=u);for(k=1,x=B[0];x>=10;x/=10,k++);k<u&&(D-=u-k)}return $.e=D,$.c=B,$}}(),p.sum=function(){for(var b=1,R=arguments,S=new p(R[0]);b<R.length;)S=S.plus(R[b++]);return S},Y=function(){var b="0123456789";function R(S,L,P,D){for(var j,x=[0],k,B=0,$=S.length;B<$;){for(k=x.length;k--;x[k]*=L);for(x[0]+=D.indexOf(S.charAt(B++)),j=0;j<x.length;j++)x[j]>P-1&&(x[j+1]==null&&(x[j+1]=0),x[j+1]+=x[j]/P|0,x[j]%=P)}return x.reverse()}return function(S,L,P,D,j){var x,k,B,$,z,se,ce,Ee,ke=S.indexOf("."),je=Q,Re=oe;for(ke>=0&&($=Xt,Xt=0,S=S.replace(".",""),Ee=new p(L),se=Ee.pow(S.length-ke),Xt=$,Ee.c=R(F(y(se.c),se.e,"0"),10,P,b),Ee.e=Ee.c.length),ce=R(S,L,P,j?(x=m,b):(x=b,m)),B=$=ce.length;ce[--$]==0;ce.pop());if(!ce[0])return x.charAt(0);if(ke<0?--B:(se.c=ce,se.e=B,se.s=D,se=O(se,Ee,je,Re,P),ce=se.c,z=se.r,B=se.e),k=B+je+1,ke=ce[k],$=P/2,z=z||k<0||ce[k+1]!=null,z=Re<4?(ke!=null||z)&&(Re==0||Re==(se.s<0?3:2)):ke>$||ke==$&&(Re==4||z||Re==6&&ce[k-1]&1||Re==(se.s<0?8:7)),k<1||!ce[0])S=z?F(x.charAt(1),-je,x.charAt(0)):x.charAt(0);else{if(ce.length=k,z)for(--P;++ce[--k]>P;)ce[k]=0,k||(++B,ce=[1].concat(ce));for($=ce.length;!ce[--$];);for(ke=0,S="";ke<=$;S+=x.charAt(ce[ke++]));S=F(S,B,x.charAt(0))}return S}}(),O=function(){function b(L,P,D){var j,x,k,B,$=0,z=L.length,se=P%d,ce=P/d|0;for(L=L.slice();z--;)k=L[z]%d,B=L[z]/d|0,j=ce*k+B*se,x=se*k+j%d*d+$,$=(x/D|0)+(j/d|0)+ce*B,L[z]=x%D;return $&&(L=[$].concat(L)),L}function R(L,P,D,j){var x,k;if(D!=j)k=D>j?1:-1;else for(x=k=0;x<D;x++)if(L[x]!=P[x]){k=L[x]>P[x]?1:-1;break}return k}function S(L,P,D,j){for(var x=0;D--;)L[D]-=x,x=L[D]<P[D]?1:0,L[D]=x*j+L[D]-P[D];for(;!L[0]&&L.length>1;L.splice(0,1));}return function(L,P,D,j,x){var k,B,$,z,se,ce,Ee,ke,je,Re,Le,Rt,yi,Lo,Ur,Et,sn,vt=L.s==P.s?1:-1,_t=L.c,Fe=P.c;if(!_t||!_t[0]||!Fe||!Fe[0])return new p(!L.s||!P.s||(_t?Fe&&_t[0]==Fe[0]:!Fe)?NaN:_t&&_t[0]==0||!Fe?vt*0:vt/0);for(ke=new p(vt),je=ke.c=[],B=L.e-P.e,vt=D+B+1,x||(x=l,B=v(L.e/u)-v(P.e/u),vt=vt/u|0),$=0;Fe[$]==(_t[$]||0);$++);if(Fe[$]>(_t[$]||0)&&B--,vt<0)je.push(1),z=!0;else{for(Lo=_t.length,Et=Fe.length,$=0,vt+=2,se=o(x/(Fe[0]+1)),se>1&&(Fe=b(Fe,se,x),_t=b(_t,se,x),Et=Fe.length,Lo=_t.length),yi=Et,Re=_t.slice(0,Et),Le=Re.length;Le<Et;Re[Le++]=0);sn=Fe.slice(),sn=[0].concat(sn),Ur=Fe[0],Fe[1]>=x/2&&Ur++;do{if(se=0,k=R(Fe,Re,Et,Le),k<0){if(Rt=Re[0],Et!=Le&&(Rt=Rt*x+(Re[1]||0)),se=o(Rt/Ur),se>1)for(se>=x&&(se=x-1),ce=b(Fe,se,x),Ee=ce.length,Le=Re.length;R(ce,Re,Ee,Le)==1;)se--,S(ce,Et<Ee?sn:Fe,Ee,x),Ee=ce.length,k=1;else se==0&&(k=se=1),ce=Fe.slice(),Ee=ce.length;if(Ee<Le&&(ce=[0].concat(ce)),S(Re,ce,Le,x),Le=Re.length,k==-1)for(;R(Fe,Re,Et,Le)<1;)se++,S(Re,Et<Le?sn:Fe,Le,x),Le=Re.length}else k===0&&(se++,Re=[0]);je[$++]=se,Re[0]?Re[Le++]=_t[yi]||0:(Re=[_t[yi]],Le=1)}while((yi++<Lo||Re[0]!=null)&&vt--);z=Re[0]!=null,je[0]||je.splice(0,1)}if(x==l){for($=1,vt=je[0];vt>=10;vt/=10,$++);G(ke,D+(ke.e=$+B*u-1)+1,j,z)}else ke.e=B,ke.r=+z;return ke}}();function _(b,R,S,L){var P,D,j,x,k;if(S==null?S=oe:C(S,0,8),!b.c)return b.toString();if(P=b.c[0],j=b.e,R==null)k=y(b.c),k=L==1||L==2&&(j<=te||j>=ae)?A(k,j):F(k,j,"0");else if(b=G(new p(b),R,S),D=b.e,k=y(b.c),x=k.length,L==1||L==2&&(R<=D||D<=te)){for(;x<R;k+="0",x++);k=A(k,D)}else if(R-=j,k=F(k,D,"0"),D+1>x){if(--R>0)for(k+=".";R--;k+="0");}else if(R+=D-x,R>0)for(D+1==x&&(k+=".");R--;k+="0");return b.s<0&&P?"-"+k:k}function H(b,R){for(var S,L,P=1,D=new p(b[0]);P<b.length;P++)L=new p(b[P]),(!L.s||(S=E(D,L))===R||S===0&&D.s===R)&&(D=L);return D}function V(b,R,S){for(var L=1,P=R.length;!R[--P];R.pop());for(P=R[0];P>=10;P/=10,L++);return(S=L+S*u-1)>be?b.c=b.e=null:S<ft?b.c=[b.e=0]:(b.e=S,b.c=R),b}U=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,S=/^\.([^.]+)$/,L=/^-?(Infinity|NaN)$/,P=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(D,j,x,k){var B,$=x?j:j.replace(P,"");if(L.test($))D.s=isNaN($)?null:$<0?-1:1;else{if(!x&&($=$.replace(b,function(z,se,ce){return B=(ce=ce.toLowerCase())=="x"?16:ce=="b"?2:8,!k||k==B?se:z}),k&&(B=k,$=$.replace(R,"$1").replace(S,"0.$1")),j!=$))return new p($,B);if(p.DEBUG)throw Error(s+"Not a"+(k?" base "+k:"")+" number: "+j);D.s=null}D.c=D.e=null}}();function G(b,R,S,L){var P,D,j,x,k,B,$,z=b.c,se=h;if(z){e:{for(P=1,x=z[0];x>=10;x/=10,P++);if(D=R-P,D<0)D+=u,j=R,k=z[B=0],$=o(k/se[P-j-1]%10);else if(B=i((D+1)/u),B>=z.length)if(L){for(;z.length<=B;z.push(0));k=$=0,P=1,D%=u,j=D-u+1}else break e;else{for(k=x=z[B],P=1;x>=10;x/=10,P++);D%=u,j=D-u+P,$=j<0?0:o(k/se[P-j-1]%10)}if(L=L||R<0||z[B+1]!=null||(j<0?k:k%se[P-j-1]),L=S<4?($||L)&&(S==0||S==(b.s<0?3:2)):$>5||$==5&&(S==4||L||S==6&&(D>0?j>0?k/se[P-j]:0:z[B-1])%10&1||S==(b.s<0?8:7)),R<1||!z[0])return z.length=0,L?(R-=b.e+1,z[0]=se[(u-R%u)%u],b.e=-R||0):z[0]=b.e=0,b;if(D==0?(z.length=B,x=1,B--):(z.length=B+1,x=se[u-D],z[B]=j>0?o(k/se[P-j]%se[j])*x:0),L)for(;;)if(B==0){for(D=1,j=z[0];j>=10;j/=10,D++);for(j=z[0]+=x,x=1;j>=10;j/=10,x++);D!=x&&(b.e++,z[0]==l&&(z[0]=1));break}else{if(z[B]+=x,z[B]!=l)break;z[B--]=0,x=1}for(D=z.length;z[--D]===0;z.pop());}b.e>be?b.c=b.e=null:b.e<ft&&(b.c=[b.e=0])}return b}function K(b){var R,S=b.e;return S===null?b.toString():(R=y(b.c),R=S<=te||S>=ae?A(R,S):F(R,S,"0"),b.s<0?"-"+R:R)}return W.absoluteValue=W.abs=function(){var b=new p(this);return b.s<0&&(b.s=1),b},W.comparedTo=function(b,R){return E(this,new p(b,R))},W.decimalPlaces=W.dp=function(b,R){var S,L,P,D=this;if(b!=null)return C(b,0,f),R==null?R=oe:C(R,0,8),G(new p(D),b+D.e+1,R);if(!(S=D.c))return null;if(L=((P=S.length-1)-v(this.e/u))*u,P=S[P])for(;P%10==0;P/=10,L--);return L<0&&(L=0),L},W.dividedBy=W.div=function(b,R){return O(this,new p(b,R),Q,oe)},W.dividedToIntegerBy=W.idiv=function(b,R){return O(this,new p(b,R),0,1)},W.exponentiatedBy=W.pow=function(b,R){var S,L,P,D,j,x,k,B,$,z=this;if(b=new p(b),b.c&&!b.isInteger())throw Error(s+"Exponent not an integer: "+K(b));if(R!=null&&(R=new p(R)),x=b.e>14,!z.c||!z.c[0]||z.c[0]==1&&!z.e&&z.c.length==1||!b.c||!b.c[0])return $=new p(Math.pow(+K(z),x?b.s*(2-T(b)):+K(b))),R?$.mod(R):$;if(k=b.s<0,R){if(R.c?!R.c[0]:!R.s)return new p(NaN);L=!k&&z.isInteger()&&R.isInteger(),L&&(z=z.mod(R))}else{if(b.e>9&&(z.e>0||z.e<-1||(z.e==0?z.c[0]>1||x&&z.c[1]>=24e7:z.c[0]<8e13||x&&z.c[0]<=9999975e7)))return D=z.s<0&&T(b)?-0:0,z.e>-1&&(D=1/D),new p(k?1/D:D);Xt&&(D=i(Xt/u+2))}for(x?(S=new p(.5),k&&(b.s=1),B=T(b)):(P=Math.abs(+K(b)),B=P%2),$=new p(Z);;){if(B){if($=$.times(z),!$.c)break;D?$.c.length>D&&($.c.length=D):L&&($=$.mod(R))}if(P){if(P=o(P/2),P===0)break;B=P%2}else if(b=b.times(S),G(b,b.e+1,1),b.e>14)B=T(b);else{if(P=+K(b),P===0)break;B=P%2}z=z.times(z),D?z.c&&z.c.length>D&&(z.c.length=D):L&&(z=z.mod(R))}return L?$:(k&&($=Z.div($)),R?$.mod(R):D?G($,Xt,oe,j):$)},W.integerValue=function(b){var R=new p(this);return b==null?b=oe:C(b,0,8),G(R,R.e+1,b)},W.isEqualTo=W.eq=function(b,R){return E(this,new p(b,R))===0},W.isFinite=function(){return!!this.c},W.isGreaterThan=W.gt=function(b,R){return E(this,new p(b,R))>0},W.isGreaterThanOrEqualTo=W.gte=function(b,R){return(R=E(this,new p(b,R)))===1||R===0},W.isInteger=function(){return!!this.c&&v(this.e/u)>this.c.length-2},W.isLessThan=W.lt=function(b,R){return E(this,new p(b,R))<0},W.isLessThanOrEqualTo=W.lte=function(b,R){return(R=E(this,new p(b,R)))===-1||R===0},W.isNaN=function(){return!this.s},W.isNegative=function(){return this.s<0},W.isPositive=function(){return this.s>0},W.isZero=function(){return!!this.c&&this.c[0]==0},W.minus=function(b,R){var S,L,P,D,j=this,x=j.s;if(b=new p(b,R),R=b.s,!x||!R)return new p(NaN);if(x!=R)return b.s=-R,j.plus(b);var k=j.e/u,B=b.e/u,$=j.c,z=b.c;if(!k||!B){if(!$||!z)return $?(b.s=-R,b):new p(z?j:NaN);if(!$[0]||!z[0])return z[0]?(b.s=-R,b):new p($[0]?j:oe==3?-0:0)}if(k=v(k),B=v(B),$=$.slice(),x=k-B){for((D=x<0)?(x=-x,P=$):(B=k,P=z),P.reverse(),R=x;R--;P.push(0));P.reverse()}else for(L=(D=(x=$.length)<(R=z.length))?x:R,x=R=0;R<L;R++)if($[R]!=z[R]){D=$[R]<z[R];break}if(D&&(P=$,$=z,z=P,b.s=-b.s),R=(L=z.length)-(S=$.length),R>0)for(;R--;$[S++]=0);for(R=l-1;L>x;){if($[--L]<z[L]){for(S=L;S&&!$[--S];$[S]=R);--$[S],$[L]+=l}$[L]-=z[L]}for(;$[0]==0;$.splice(0,1),--B);return $[0]?V(b,$,B):(b.s=oe==3?-1:1,b.c=[b.e=0],b)},W.modulo=W.mod=function(b,R){var S,L,P=this;return b=new p(b,R),!P.c||!b.s||b.c&&!b.c[0]?new p(NaN):!b.c||P.c&&!P.c[0]?new p(P):(gt==9?(L=b.s,b.s=1,S=O(P,b,0,3),b.s=L,S.s*=L):S=O(P,b,0,gt),b=P.minus(S.times(b)),!b.c[0]&&gt==1&&(b.s=P.s),b)},W.multipliedBy=W.times=function(b,R){var S,L,P,D,j,x,k,B,$,z,se,ce,Ee,ke,je,Re=this,Le=Re.c,Rt=(b=new p(b,R)).c;if(!Le||!Rt||!Le[0]||!Rt[0])return!Re.s||!b.s||Le&&!Le[0]&&!Rt||Rt&&!Rt[0]&&!Le?b.c=b.e=b.s=null:(b.s*=Re.s,!Le||!Rt?b.c=b.e=null:(b.c=[0],b.e=0)),b;for(L=v(Re.e/u)+v(b.e/u),b.s*=Re.s,k=Le.length,z=Rt.length,k<z&&(Ee=Le,Le=Rt,Rt=Ee,P=k,k=z,z=P),P=k+z,Ee=[];P--;Ee.push(0));for(ke=l,je=d,P=z;--P>=0;){for(S=0,se=Rt[P]%je,ce=Rt[P]/je|0,j=k,D=P+j;D>P;)B=Le[--j]%je,$=Le[j]/je|0,x=ce*B+$*se,B=se*B+x%je*je+Ee[D]+S,S=(B/ke|0)+(x/je|0)+ce*$,Ee[D--]=B%ke;Ee[D]=S}return S?++L:Ee.splice(0,1),V(b,Ee,L)},W.negated=function(){var b=new p(this);return b.s=-b.s||null,b},W.plus=function(b,R){var S,L=this,P=L.s;if(b=new p(b,R),R=b.s,!P||!R)return new p(NaN);if(P!=R)return b.s=-R,L.minus(b);var D=L.e/u,j=b.e/u,x=L.c,k=b.c;if(!D||!j){if(!x||!k)return new p(P/0);if(!x[0]||!k[0])return k[0]?b:new p(x[0]?L:P*0)}if(D=v(D),j=v(j),x=x.slice(),P=D-j){for(P>0?(j=D,S=k):(P=-P,S=x),S.reverse();P--;S.push(0));S.reverse()}for(P=x.length,R=k.length,P-R<0&&(S=k,k=x,x=S,R=P),P=0;R;)P=(x[--R]=x[R]+k[R]+P)/l|0,x[R]=l===x[R]?0:x[R]%l;return P&&(x=[P].concat(x),++j),V(b,x,j)},W.precision=W.sd=function(b,R){var S,L,P,D=this;if(b!=null&&b!==!!b)return C(b,1,f),R==null?R=oe:C(R,0,8),G(new p(D),b,R);if(!(S=D.c))return null;if(P=S.length-1,L=P*u+1,P=S[P]){for(;P%10==0;P/=10,L--);for(P=S[0];P>=10;P/=10,L++);}return b&&D.e+1>L&&(L=D.e+1),L},W.shiftedBy=function(b){return C(b,-9007199254740991,c),this.times("1e"+b)},W.squareRoot=W.sqrt=function(){var b,R,S,L,P,D=this,j=D.c,x=D.s,k=D.e,B=Q+4,$=new p("0.5");if(x!==1||!j||!j[0])return new p(!x||x<0&&(!j||j[0])?NaN:j?D:1/0);if(x=Math.sqrt(+K(D)),x==0||x==1/0?(R=y(j),(R.length+k)%2==0&&(R+="0"),x=Math.sqrt(+R),k=v((k+1)/2)-(k<0||k%2),x==1/0?R="5e"+k:(R=x.toExponential(),R=R.slice(0,R.indexOf("e")+1)+k),S=new p(R)):S=new p(x+""),S.c[0]){for(k=S.e,x=k+B,x<3&&(x=0);;)if(P=S,S=$.times(P.plus(O(D,P,B,1))),y(P.c).slice(0,x)===(R=y(S.c)).slice(0,x))if(S.e<k&&--x,R=R.slice(x-3,x+1),R=="9999"||!L&&R=="4999"){if(!L&&(G(P,P.e+Q+2,0),P.times(P).eq(D))){S=P;break}B+=4,x+=4,L=1}else{(!+R||!+R.slice(1)&&R.charAt(0)=="5")&&(G(S,S.e+Q+2,1),b=!S.times(S).eq(D));break}}return G(S,S.e+Q+1,oe,b)},W.toExponential=function(b,R){return b!=null&&(C(b,0,f),b++),_(this,b,R,1)},W.toFixed=function(b,R){return b!=null&&(C(b,0,f),b=b+this.e+1),_(this,b,R)},W.toFormat=function(b,R,S){var L,P=this;if(S==null)b!=null&&R&&typeof R=="object"?(S=R,R=null):b&&typeof b=="object"?(S=b,b=R=null):S=Ke;else if(typeof S!="object")throw Error(s+"Argument not an object: "+S);if(L=P.toFixed(b,R),P.c){var D,j=L.split("."),x=+S.groupSize,k=+S.secondaryGroupSize,B=S.groupSeparator||"",$=j[0],z=j[1],se=P.s<0,ce=se?$.slice(1):$,Ee=ce.length;if(k&&(D=x,x=k,k=D,Ee-=D),x>0&&Ee>0){for(D=Ee%x||x,$=ce.substr(0,D);D<Ee;D+=x)$+=B+ce.substr(D,x);k>0&&($+=B+ce.slice(D)),se&&($="-"+$)}L=z?$+(S.decimalSeparator||"")+((k=+S.fractionGroupSize)?z.replace(new RegExp("\\d{"+k+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):z):$}return(S.prefix||"")+L+(S.suffix||"")},W.toFraction=function(b){var R,S,L,P,D,j,x,k,B,$,z,se,ce=this,Ee=ce.c;if(b!=null&&(x=new p(b),!x.isInteger()&&(x.c||x.s!==1)||x.lt(Z)))throw Error(s+"Argument "+(x.isInteger()?"out of range: ":"not an integer: ")+K(x));if(!Ee)return new p(ce);for(R=new p(Z),B=S=new p(Z),L=k=new p(Z),se=y(Ee),D=R.e=se.length-ce.e-1,R.c[0]=h[(j=D%u)<0?u+j:j],b=!b||x.comparedTo(R)>0?D>0?R:B:x,j=be,be=1/0,x=new p(se),k.c[0]=0;$=O(x,R,0,1),P=S.plus($.times(L)),P.comparedTo(b)!=1;)S=L,L=P,B=k.plus($.times(P=B)),k=P,R=x.minus($.times(P=R)),x=P;return P=O(b.minus(S),L,0,1),k=k.plus(P.times(B)),S=S.plus(P.times(L)),k.s=B.s=ce.s,D=D*2,z=O(B,L,D,oe).minus(ce).abs().comparedTo(O(k,S,D,oe).minus(ce).abs())<1?[B,L]:[k,S],be=j,z},W.toNumber=function(){return+K(this)},W.toPrecision=function(b,R){return b!=null&&C(b,1,f),_(this,b,R,2)},W.toString=function(b){var R,S=this,L=S.s,P=S.e;return P===null?L?(R="Infinity",L<0&&(R="-"+R)):R="NaN":(b==null?R=P<=te||P>=ae?A(y(S.c),P):F(y(S.c),P,"0"):b===10&&w?(S=G(new p(S),Q+P+1,oe),R=F(y(S.c),S.e,"0")):(C(b,2,m.length,"Base"),R=Y(F(y(S.c),P,"0"),10,b,L,!0)),L<0&&S.c[0]&&(R="-"+R)),R},W.valueOf=W.toJSON=function(){return K(this)},W._isBigNumber=!0,I!=null&&p.set(I),p}function v(I){var O=I|0;return I>0||I===O?O:O-1}function y(I){for(var O,Y,U=1,W=I.length,Z=I[0]+"";U<W;){for(O=I[U++]+"",Y=u-O.length;Y--;O="0"+O);Z+=O}for(W=Z.length;Z.charCodeAt(--W)===48;);return Z.slice(0,W+1||1)}function E(I,O){var Y,U,W=I.c,Z=O.c,Q=I.s,oe=O.s,te=I.e,ae=O.e;if(!Q||!oe)return null;if(Y=W&&!W[0],U=Z&&!Z[0],Y||U)return Y?U?0:-oe:Q;if(Q!=oe)return Q;if(Y=Q<0,U=te==ae,!W||!Z)return U?0:!W^Y?1:-1;if(!U)return te>ae^Y?1:-1;for(oe=(te=W.length)<(ae=Z.length)?te:ae,Q=0;Q<oe;Q++)if(W[Q]!=Z[Q])return W[Q]>Z[Q]^Y?1:-1;return te==ae?0:te>ae^Y?1:-1}function C(I,O,Y,U){if(I<O||I>Y||I!==o(I))throw Error(s+(U||"Argument")+(typeof I=="number"?I<O||I>Y?" out of range: ":" not an integer: ":" not a primitive number: ")+String(I))}function T(I){var O=I.c.length-1;return v(I.e/u)==O&&I.c[O]%2!=0}function A(I,O){return(I.length>1?I.charAt(0)+"."+I.slice(1):I)+(O<0?"e":"e+")+O}function F(I,O,Y){var U,W;if(O<0){for(W=Y+".";++O;W+=Y);I=W+I}else if(U=I.length,++O>U){for(W=Y,O-=U;--O;W+=Y);I+=W}else O<U&&(I=I.slice(0,O)+"."+I.slice(O));return I}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(l7)})(f$);var g$=f$.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const xi=XT(),O7=qT(),x7=KT,A7=g$,Mn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},bf={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:m$,decimalSuffixes:sp}=xi.currentBytes(),ZT={general:{scale:1024,suffixes:sp},binary:{scale:1024,suffixes:m$},decimal:{scale:1e3,suffixes:sp}};function H7(t,e={},n){if(typeof e=="string"&&(e=x7.parseFormat(e)),!O7.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=N7(t,e,n);return s=J7(s,i),s=eZ(s,o),s}function N7(t,e,n){switch(e.output){case"currency":return e=zu(e,xi.currentCurrencyDefaultFormat()),B7(t,e,xi);case"percent":return e=zu(e,xi.currentPercentageDefaultFormat()),W7(t,e,xi,n);case"byte":return e=zu(e,xi.currentByteDefaultFormat()),F7(t,e,xi,n);case"time":return e=zu(e,xi.currentTimeDefaultFormat()),V7(t);case"ordinal":return e=zu(e,xi.currentOrdinalDefaultFormat()),$7(t,e,xi);case"number":default:return Sf({instance:t,providedFormat:e})}}function D7(t){let e=ZT.decimal;return Iw(t._value,e.suffixes,e.scale).suffix}function k7(t){let e=ZT.binary;return Iw(t._value,e.suffixes,e.scale).suffix}function L7(t){let e=ZT.general;return Iw(t._value,e.suffixes,e.scale).suffix}function Iw(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function F7(t,e,n,r){let i=e.base||"binary",o=Object.assign({},bf,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||sp,marker:"bd"},binary:{scale:1024,suffixes:s||m$,marker:"b"},decimal:{scale:1e3,suffixes:a||sp,marker:"d"}}[i],{value:c,suffix:h}=Iw(t._value,u.suffixes,u.scale);return`${Sf({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function $7(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},bf,e),o=Sf({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function V7(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function W7(t,e,n,r){let i=e.prefixSymbol,o=Sf({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},bf,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function B7(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},bf,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=Sf({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function j7({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&Mn[e]?(a=r[e],t=t/Mn[e]):l>=Mn.trillion||n&&s(l/Mn.trillion)===1?(a=r.trillion,t=t/Mn.trillion):l<Mn.trillion&&l>=Mn.billion||n&&s(l/Mn.billion)===1?(a=r.billion,t=t/Mn.billion):l<Mn.billion&&l>=Mn.million||n&&s(l/Mn.million)===1?(a=r.million,t=t/Mn.million):(l<Mn.million&&l>=Mn.thousand||n&&s(l/Mn.thousand)===1)&&(a=r.thousand,t=t/Mn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function U7({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function gg(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function z7(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+gg(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(gg(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=gg(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${gg(e)}`),n}function Y7(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?z7(t,e):new A7(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function G7(t,e,n,r,i,o){if(r===-1)return t;let s=Y7(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function q7(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function K7(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function X7(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),K7(u.length,a).forEach((f,g)=>{u=u.slice(0,f+g)+s+u.slice(f+g)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function Z7(t,e){return t+e}function Q7(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function J7(t,e){return e+t}function eZ(t,e){return t+e}function Sf({instance:t,providedFormat:e,state:n=xi,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},bf,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,v=s.trimMantissa,y=s.thousandSeparated,E=s.spaceSeparated,C=s.negative,T=s.forceSign,A=s.exponential,F=s.roundingFunction,I="";if(d){let Y=j7({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:E,roundingFunction:F,totalLength:a});o=Y.value,I+=Y.abbreviation,a&&(f=Y.mantissaPrecision)}if(A){let Y=U7({value:o,characteristicPrecision:l});o=Y.value,I=Y.abbreviation+I}let O=G7(o.toString(),o,g,f,v,F);return O=q7(O,o,u,l),O=X7(O,o,y,n,r),(d||A)&&(O=Z7(O,I)),(T||o<0)&&(O=Q7(O,o,C)),O}function zu(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var tZ=t=>({format:(...e)=>H7(...e,t),getByteUnit:(...e)=>L7(...e,t),getBinaryByteUnit:(...e)=>k7(...e,t),getDecimalByteUnit:(...e)=>D7(...e,t),formatOrDefault:zu});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Rs=g$;function nZ(t,e,n){let r=new Rs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Rs(i),t._value=r.plus(i).toNumber(),t}function p$(t,e,n){let r=new Rs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Rs(i),t._value=r.minus(i).toNumber(),t}function rZ(t,e,n){let r=new Rs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Rs(i),t._value=r.times(i).toNumber(),t}function iZ(t,e,n){let r=new Rs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Rs(i),t._value=r.dividedBy(i).toNumber(),t}function oZ(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function sZ(t,e,n){let r=n(t._value);return p$(r,e,n),Math.abs(r._value)}var aZ=t=>({add:(e,n)=>nZ(e,n,t),subtract:(e,n)=>p$(e,n,t),multiply:(e,n)=>rZ(e,n,t),divide:(e,n)=>iZ(e,n,t),set:(e,n)=>oZ(e,n,t),difference:(e,n)=>sZ(e,n,t),BigNumber:Rs});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const lZ="2.5.0",ko=XT(),uZ=qT(),cZ=P7(Kt),hZ=d$();let ja=tZ(Kt),vl=aZ(Kt);const dZ=KT;class w${constructor(e){this._value=e}clone(){return Kt(this._value)}format(e={}){return ja.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=dZ.parseFormat(e)),e=ja.formatOrDefault(e,ko.currentCurrencyDefaultFormat()),e.output="currency",ja.format(this,e)}formatTime(e={}){return e.output="time",ja.format(this,e)}binaryByteUnits(){return ja.getBinaryByteUnit(this)}decimalByteUnits(){return ja.getDecimalByteUnit(this)}byteUnits(){return ja.getByteUnit(this)}difference(e){return vl.difference(this,e)}add(e){return vl.add(this,e)}subtract(e){return vl.subtract(this,e)}multiply(e){return vl.multiply(this,e)}divide(e){return vl.divide(this,e)}set(e){return vl.set(this,v$(e))}value(){return this._value}valueOf(){return this._value}}function v$(t){let e=t;return Kt.isNumbro(t)?e=t._value:typeof t=="string"?e=Kt.unformat(t):isNaN(t)&&(e=NaN),e}function Kt(t){return new w$(v$(t))}Kt.version=lZ;Kt.isNumbro=function(t){return t instanceof w$};Kt.language=ko.currentLanguage;Kt.registerLanguage=ko.registerLanguage;Kt.setLanguage=ko.setLanguage;Kt.languages=ko.languages;Kt.languageData=ko.languageData;Kt.zeroFormat=ko.setZeroFormat;Kt.defaultFormat=ko.currentDefaults;Kt.setDefaults=ko.setDefaults;Kt.defaultCurrencyFormat=ko.currentCurrencyDefaultFormat;Kt.validate=uZ.validate;Kt.loadLanguagesInNode=cZ.loadLanguagesInNode;Kt.unformat=hZ.unformat;Kt.BigNumber=vl.BigNumber;var fZ=Kt,Ua=u7(fZ);const gZ="numeric";function C$(t,e){if(Vn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!Ua.languages()[r]){const o=r.replace("-",""),s=Ua.allLanguages?Ua.allLanguages[r]:Ua[o];s&&Ua.registerLanguage(s)}Ua.setLanguage(r),t=Ua(t).format(i||"0")}return t}function QT(t,e,n,r,i,o,s){let a=o;if(Vn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=C$(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}xs(t,e,n,r,i,a,s)}QT.RENDERER_TYPE=gZ;const mZ="password";function JT(t,e,n,r,i,o,s){xs.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";fe(a-1,()=>{u+=l}),Ql(e,u)}JT.RENDERER_TYPE=mZ;const pZ="select";function eM(t,e,n,r,i,o,s){xs.apply(this,[t,e,n,r,i,o,s])}eM.RENDERER_TYPE=pZ;const wZ="time";function tM(t,e,n,r,i,o,s){xs.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}tM.RENDERER_TYPE=wZ;function vZ(){Hr(Fc),Hr(yf),Hr(zT),Hr(UT),Hr(GT),Hr(jT),Hr(QT),Hr(JT),Hr(eM),Hr(xs),Hr(tM)}const CZ="autocomplete";function Pw(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,JA(n,e)):JA(n,e)(this.source):e(!0)}Pw.VALIDATOR_TYPE=CZ;function JA(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function y$(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const yZ=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:y$},Symbol.toStringTag,{value:"Module"})),bZ="date";function nM(t,e){const n=KL(i$,this.instance);let r=t,i=!0;r==null&&(r="");let o=X(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=X(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=SZ(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}nM.VALIDATOR_TYPE=bZ;function SZ(t,e){const n=X(y$(t)),r=X(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const RZ="dropdown";function rM(t,e){Pw.apply(this,[t,e])}rM.VALIDATOR_TYPE=RZ;const EZ="numeric";function iM(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Vn(t))}iM.VALIDATOR_TYPE=EZ;const _Z=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],TZ="time";function oM(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=X(i,_Z,!0).isValid()?X(i):X(i,n);let a=s.isValid(),l=X(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}oM.VALIDATOR_TYPE=TZ;function MZ(){Sl(Pw),Sl(rM),Sl(nM),Sl(iM),Sl(oM)}const IZ="autocomplete",PZ={CELL_TYPE:IZ,editor:WT,renderer:Fc,validator:Pw},OZ="checkbox",xZ={CELL_TYPE:OZ,editor:r$,renderer:zT},AZ="date";function b$(t,e,n,r,i,o,s){Fc.apply(this,[t,e,n,r,i,o,s])}b$.RENDERER_TYPE=AZ;const HZ="date",NZ={CELL_TYPE:HZ,editor:o$,renderer:b$,validator:nM},DZ="dropdown",kZ={CELL_TYPE:DZ,editor:s$,renderer:UT,validator:rM,filter:!1,strict:!0},LZ="handsontable",FZ={CELL_TYPE:LZ,editor:VT,renderer:GT},$Z="numeric",VZ={CELL_TYPE:$Z,editor:a$,renderer:QT,validator:iM,dataType:"number"},WZ="password",BZ={CELL_TYPE:WZ,editor:l$,renderer:JT,copyable:!1},jZ="select",UZ={CELL_TYPE:jZ,editor:u$,renderer:eM},zZ="time",YZ={CELL_TYPE:zZ,editor:c$,renderer:tM,validator:oM};function GZ(){Zr(PZ),Zr(xZ),Zr(NZ),Zr(kZ),Zr(FZ),Zr(VZ),Zr(BZ),Zr(UZ),Zr(t$),Zr(YZ)}function qZ(t,e){S$(t,e),e.add(t)}function KZ(t,e,n){S$(t,e),e.set(t,n)}function S$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pu(t,e,n){return(e=XZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XZ(t){var e=ZZ(t,"string");return typeof e=="symbol"?e:e+""}function ZZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wu(t,e){return t.get(R$(t,e))}function R$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const eH=new Map([["plugin",kK],["cell-type",zF],["editor",qL],["renderer",nF],["validator",rF]]),E$=Symbol("mainSetting"),QZ="base",mg=[];let za=null;var Ya=new WeakMap,tH=new WeakSet;class qe{static get PLUGIN_KEY(){return QZ}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){qZ(this,tH),pu(this,"eventManager",new di(this)),pu(this,"pluginName",null),pu(this,"pluginsInitializedCallbacks",[]),pu(this,"isPluginsReady",!1),pu(this,"enabled",!1),pu(this,"initialized",!1),KZ(this,Ya,{}),Do(this,"hot",e,{writable:!1}),za=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!eH.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);eH.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");mg.push(o)}}if(za||(za=j0()),za.indexOf(this.pluginName)>=0&&za.splice(za.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),za.length===0){if(mg.length>0){const i=[`${mg.join(`
`)}
`,"You have to import and register them manually."].join("");throw mg.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||xe(n))&&r[E$]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(xe(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){wu(Ya,this)[e]=wu(Ya,this)[e]||[];const i=wu(Ya,this)[e];this.hot.addHook(e,n,r),i.push(n),wu(Ya,this)[e]=i}removeHooks(e){M(wu(Ya,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=wu(Ya,this);Ae(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){M(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=R$(tH,this,JZ).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ae(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function JZ(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Ga(t,e,n){return(e=eQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eQ(t){var e=tQ(t,"string");return typeof e=="symbol"?e:e+""}function tQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let sM=class{constructor(e){Ga(this,"hot",null),Ga(this,"container",null),Ga(this,"injected",!1),Ga(this,"rows",[]),Ga(this,"columns",[]),Ga(this,"samples",null),Ga(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&q(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),M(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),M(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{M(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{M(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{M(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),M(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{M(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),q(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return q(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function pg(t,e,n){return(e=nQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nQ(t){var e=rQ(t,"string");return typeof e=="symbol"?e:e+""}function rQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ow{static get SAMPLE_COUNT(){return 3}constructor(e){pg(this,"samples",null),pg(this,"dataFactory",null),pg(this,"customSampleCount",null),pg(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Ow.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return fe(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return fe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:xe(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${bt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function iQ(t,e){_$(t,e),e.add(t)}function Hb(t,e,n){_$(t,e),e.set(t,n)}function _$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mh(t,e,n){return(e=oQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oQ(t){var e=sQ(t,"string");return typeof e=="symbol"?e:e+""}function sQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ua(t,e){return t.get(Cr(t,e))}function ap(t,e,n){return t.set(Cr(t,e),n),n}function Cr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("modifyAutoColumnSizeSeed");const Nb="autoColumnSize",aQ=10,lQ="autoColumnSize";var aM=new WeakMap,Yu=new WeakMap,bc=new WeakMap,Nr=new WeakSet;class dd extends qe{static get PLUGIN_KEY(){return Nb}static get PLUGIN_PRIORITY(){return aQ}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),iQ(this,Nr),mh(this,"ghostTable",new sM(this.hot)),mh(this,"samplesGenerator",new Ow((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),mh(this,"inProgress",!1),mh(this,"measuredColumns",0),mh(this,"columnWidthsMap",new Ia),Hb(this,aM,!1),Hb(this,Yu,[]),Hb(this,bc,[]),this.hot.columnIndexMapper.registerMap(lQ,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>Cr(Nr,this,nH).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[Nb]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cr(Nr,e,hQ).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cr(Nr,e,dQ).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cr(Nr,e,gQ).call(e,...i)}),this.addHook("beforeRender",()=>Cr(Nr,this,cQ).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>Cr(Nr,this,fQ).call(this)),super.enablePlugin()}updatePlugin(){ap(bc,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>Cr(Nr,this,nH).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;fe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&Cr(Nr,this,T$).call(this,s,o)}),this.ghostTable.columns.length&&(Cr(Nr,this,M$).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Ld(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+dd.CALCULATION_STEP,i)},e,n),r=r+dd.CALCULATION_STEP+1,r<i?o=kd(s):(Ld(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Nb];let n=dd.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return xe(e)&&(n=e.syncLimit,C0(n)?n=W0(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,wc))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=ua(Yu,this).length;return(s-1<o||ua(Yu,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?ua(Yu,this).push(i):ua(Yu,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function uQ(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||Cr(Nr,this,T$).call(this,n,e))}),this.ghostTable.columns.length&&(Cr(Nr,this,M$).call(this),this.ghostTable.clean())}function T$(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function M$(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function cQ(){this.calculateVisibleColumnsWidth(),this.inProgress||(Cr(Nr,this,uQ).call(this,ua(bc,this)),ap(bc,this,[]))}function hQ(t,e){e||this.recalculateAllColumnsWidth()}function dQ(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);ua(bc,this).push(...e)}function nH(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function fQ(){ap(Yu,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),ap(aM,this,!0)}function gQ(t){if(!ua(aM,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);ua(bc,this).push(...e)}const _l={horizontal:"horizontal",vertical:"vertical"};function mQ(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function pQ(t){const e={};return t===!0?(e.directions=Object.keys(_l),e.autoInsertRow=!0):xe(t)?(le(t.autoInsertRow)?t.direction===_l.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(_l)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function wQ(t,e){vQ(t,e),e.add(t)}function vQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vu(t,e,n){return(e=CQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CQ(t){var e=yQ(t,"string");return typeof e=="symbol"?e:e+""}function yQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ph(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("modifyAutofillRange");re.getSingleton().register("beforeAutofill");re.getSingleton().register("afterAutofill");const rH="autofill",bQ=20,SQ=["fillHandle"],RQ="insert_row_below",EQ=200;var Cu=new WeakSet;class _Q extends qe{constructor(){super(...arguments),wQ(this,Cu),vu(this,"addingStarted",!1),vu(this,"mouseDownOnCellCorner",!1),vu(this,"mouseDragOutside",!1),vu(this,"handleDraggedCells",0),vu(this,"directions",[]),vu(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return rH}static get PLUGIN_PRIORITY(){return bQ}static get SETTING_KEYS(){return[rH,...SQ]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>ph(Cu,this,MQ).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>ph(Cu,this,TQ).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>ph(Cu,this,IQ).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return M(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),M(a,c=>{const h=[];M(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=mQ(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=o.clone(),v=this.hot._createCellRange(h,h,d),y=this.hot.runHooks("beforeAutofill",f,g,v,c);if(y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let E=y;const C=y;if(["up","left"].indexOf(c)>-1&&!(C.length===1&&C[0].length===0))if(E=[],c==="up"){const T=d.row-h.row+1,A=T%C.length;for(let F=0;F<T;F++)E.push(C[(F+(C.length-A))%C.length])}else{const T=d.col-h.col+1,A=T%C[0].length;for(let F=0;F<C.length;F++){E.push([]);for(let I=0;I<T;I++)E[F].push(C[F][(I+(C[F].length-A))%C[F].length])}}this.hot.populateFromArray(h.row,h.col,E,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",E,g,v,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(_l.vertical)&&this.directions.includes(_l.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(_l.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(_l.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(RQ,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},EQ)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Wt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Wt(s)||!Wt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Be(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=On(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+en(this.hot.table),i=On(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+qt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>ph(Cu,this,PQ).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>ph(Cu,this,OQ).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=pQ(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function TQ(){this.selectAdjacent()&&this.fillIn()}function MQ(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function IQ(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function PQ(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function OQ(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function xQ(t,e){I$(t,e),e.add(t)}function iH(t,e,n){I$(t,e),e.set(t,n)}function I$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yu(t,e,n){return(e=AQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AQ(t){var e=HQ(t,"string");return typeof e=="symbol"?e:e+""}function HQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function P$(t,e,n){return t.set(wo(t,e),n),n}function lp(t,e){return t.get(wo(t,e))}function wo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Db="autoRowSize",NQ=40,DQ="autoRowSize";var Bd=new WeakMap,lM=new WeakMap,ns=new WeakSet;class fd extends qe{static get PLUGIN_KEY(){return Db}static get PLUGIN_PRIORITY(){return NQ}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),xQ(this,ns),yu(this,"headerHeight",null),yu(this,"ghostTable",new sM(this.hot)),yu(this,"samplesGenerator",new Ow((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),yu(this,"inProgress",!1),yu(this,"measuredRows",0),yu(this,"rowHeightsMap",new Ia),iH(this,Bd,[]),iH(this,lM,!1),this.hot.rowIndexMapper.registerMap(DQ,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>wo(ns,this,oH).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[Db];return e===!0||xe(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wo(ns,e,FQ).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wo(ns,e,$Q).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wo(ns,e,WQ).call(e,...i)}),this.addHook("beforeRender",()=>wo(ns,this,LQ).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>wo(ns,this,VQ).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>wo(ns,this,oH).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}fe(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Ld(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+fd.CALCULATION_STEP,i)},e,n),r=r+fd.CALCULATION_STEP+1,r<i?o=kd(s):(Ld(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Db];let n=fd.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return xe(e)&&(n=e.syncLimit,C0(n)?n=W0(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{fe(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function kQ(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function LQ(){this.calculateVisibleRowsHeight(),this.inProgress||(wo(ns,this,kQ).call(this,lp(Bd,this)),P$(Bd,this,[]))}function oH(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function FQ(t,e){e||this.recalculateAllRowsHeight()}function $Q(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);lp(Bd,this).push(...e)}function VQ(){this.recalculateAllRowsHeight(),P$(lM,this,!0)}function WQ(t){if(!lp(lM,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);lp(Bd,this).push(...e)}const{getListWithInsertedItems:BQ,getListWithRemovedItems:jQ}=MF("physicallyIndexed");class UQ extends Jl{constructor(){super(e=>e)}insert(e,n){const r=g_(this.indexedValues,n);this.indexedValues=BQ(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=jQ(this.indexedValues,e);this.indexedValues=f_(n,e),super.remove(e)}}const{getListWithInsertedItems:zQ,getListWithRemovedItems:YQ}=MF("physicallyIndexed");class GQ extends Jl{constructor(){super(e=>e)}insert(e,n){this.indexedValues=zQ(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=YQ(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function qQ(t,e){KQ(t,e),e.add(t)}function KQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XQ(t,e,n){return(e=ZQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZQ(t){var e=QQ(t,"string");return typeof e=="symbol"?e:e+""}function QQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JQ(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const sH="bindRowsWithHeaders",eJ=210,tJ="loose",aH=new Map([["loose",UQ],["strict",GQ]]);var lH=new WeakSet;class nJ extends qe{constructor(){super(...arguments),qQ(this,lH),XQ(this,"headerIndexes",null)}static get PLUGIN_KEY(){return sH}static get PLUGIN_PRIORITY(){return eJ}isEnabled(){return!!this.hot.getSettings()[sH]}enablePlugin(){var e;if(this.enabled)return;const n=(e=aH.get(this.getSetting()))!==null&&e!==void 0?e:aH.get(tJ);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>JQ(lH,this,rJ).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function rJ(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function iJ(t,e){O$(t,e),e.add(t)}function oJ(t,e,n){O$(t,e),e.set(t,n)}function O$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uH(t,e,n){return(e=sJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sJ(t){var e=aJ(t,"string");return typeof e=="symbol"?e:e+""}function aJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cH(t,e){return t.get(ec(t,e))}function kb(t,e,n){return t.set(ec(t,e),n),n}function ec(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _m="collapsibleColumns",lJ=290,uJ=["nestedHeaders"],hc="collapsibleIndicator",hH=_m,dH=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var bu=new WeakMap,wh=new WeakSet;class cJ extends qe{constructor(){super(...arguments),iJ(this,wh),uH(this,"nestedHeadersPlugin",null),uH(this,"headerStateManager",null),oJ(this,bu,null)}static get PLUGIN_KEY(){return _m}static get PLUGIN_PRIORITY(){return lJ}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[_m,...uJ]}isEnabled(){return!!this.hot.getSettings()[_m]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||et("You need to configure the Nested Headers plugin in order to use collapsible headers."),kb(bu,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>ec(wh,this,fJ).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ec(wh,e,gJ).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ec(wh,e,hJ).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>ec(wh,this,dJ).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),kb(bu,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:hH,relativeToGroup:Pa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(hH)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};fe(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;fe(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${hc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${hc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${hc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!dH.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Ca(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;M(r,f=>{var g;let{row:v,col:y}=f;const{collapsible:E,isCollapsed:C}=(g=this.headerStateManager.getHeaderSettings(v,y))!==null&&g!==void 0?g:{};if(!E||C&&n==="collapse"||!C&&n==="expand")return i=!1,!1});const o=[],s=[];i&&M(r,f=>{let{row:g,col:v}=f;const{colspanCompensation:y,affectedColumns:E,rollbackModification:C}=this.headerStateManager.triggerNodeModification(n,g,v);y>0&&(s.push(...E),o.push(C))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=uL([...a,...s]):n==="expand"&&(l=Ca(a,f=>!s.includes(f)));const u=dH.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){M(o,f=>{f()});return}this.hot.batchExecution(()=>{M(s,f=>{cH(bu,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&s.includes(g)){const y=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,E=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;y!==null&&E!==null&&this.hot.selectCell(y,E)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return cH(bu,this).getHiddenIndexes()}destroy(){kb(bu,this,null),super.destroy()}}function hJ(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${hc}`);if(Zl(e,[li("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),q(u,hc),e.querySelector("div:first-child").appendChild(u)),pe(u,["collapsed","expanded"]),s?(q(u,"collapsed"),ba(u,"+"),l&&ye(e,...li(!1))):(q(u,"expanded"),ba(u,"-"),l&&ye(e,...li(!0))),l&&ye(u,...Xl());else{var c;(c=u)===null||c===void 0||c.remove()}}function dJ(t,e){we(t.target,hc)&&(we(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):we(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),vi(t))}function fJ(){this.updatePlugin()}function gJ(t,e){e||this.updatePlugin()}function qa(t,e,n){return(e=mJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mJ(t){var e=pJ(t,"string");return typeof e=="symbol"?e:e+""}function pJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const wJ=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],vJ=!1,CJ=!0,yJ=!0;class bJ{constructor(e,n){qa(this,"hot",void 0),qa(this,"sortingStates",new bw),qa(this,"sortEmptyCells",vJ),qa(this,"indicator",CJ),qa(this,"headerAction",yJ),qa(this,"compareFunctionFactory",void 0),qa(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){xe(e)&&Ae(e,(n,r)=>{wJ.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return xe(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(le(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function x$(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?To:Wt(i)?Wt(o)?To:s&&t==="asc"?$t:Vt:Wt(o)?s&&t==="asc"?Vt:$t:isNaN(i)&&!isNaN(o)?t==="asc"?Vt:$t:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?$t:Vt:i>o?t==="asc"?Vt:$t:To}}const A$="default";function SJ(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return To;if(a){if(Wt(r))return t==="asc"?$t:Vt;if(Wt(i))return t==="asc"?Vt:$t}return isNaN(o)?Vt:isNaN(s)?$t:o<s?t==="asc"?$t:Vt:o>s?t==="asc"?Vt:$t:To}}const RJ="numeric";function EJ(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Wt(s),u=Wt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Vt;if(l===!1&&u)return $t}return d===!1&&f?t==="asc"?$t:Vt:d&&f===!1?t==="asc"?Vt:$t:d===!1&&f===!1?x$(t,e,n)(s,a):c===i&&h===r?t==="asc"?$t:Vt:c===r&&h===i?t==="asc"?Vt:$t:To}}const _J="checkbox";function TJ(t,e,n){return F$(t,e.dateFormat,n)}const MJ="date";function IJ(t,e,n){return F$(t,e.timeFormat,n)}const PJ="time",{register:Rf,getItem:fH,hasItem:OJ}=Yi("sorting.compareFunctionFactory"),{register:H$,getItem:xJ}=Yi("sorting.mainSortComparator");function N$(t){return OJ(t)?fH(t):fH(A$)}Rf(_J,EJ);Rf(MJ,TJ);Rf(A$,x$);Rf(RJ,SJ);Rf(PJ,IJ);const To=0,$t=-1,Vt=1;function AJ(t,e){const n=xJ(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const up="asc",cp="desc",D$="colHeader";function HJ(t){if(xe(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[up,cp].includes(n)}function NJ(t){if(t.some(n=>HJ(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function gH(t){if(t!==cp)return t===up?cp:up}function k$(t){return t.querySelector(`.${D$}`)}function L$(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function uM(t,e,n){return t===-1&&e>=0&&Sa(n)===!1}function F$(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return To;if(Wt(r))return Wt(i)?To:o&&t==="asc"?$t:Vt;if(Wt(i))return o&&t==="asc"?Vt:$t;const s=X(r,e),a=X(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?$t:Vt:a.isBefore(s)?t==="asc"?Vt:$t:To:$t:Vt}}function DJ(t,e){et(st`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const kJ="ascending",LJ="descending",$$="indicatorDisabled",V$="columnSorting",W$="sortAction",B$=new Map([[up,kJ],[cp,LJ]]);function FJ(t,e,n,r){const i=[V$];if(r&&i.push(W$),n===!1)return i.push($$),i;const o=t.getSortOrderOfColumn(e);return le(o)&&i.push(B$.get(o)),i}function $J(){return Array.from(B$.values()).concat(W$,$$,V$)}function VJ(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:N$(u.type))(l,u,d)(c,h)}(0)}}function WJ(t,e){BJ(t,e),e.add(t)}function BJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wg(t,e,n){return(e=jJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jJ(t){var e=UJ(t,"string");return typeof e=="symbol"?e:e+""}function UJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const hp="columnSorting",zJ=50,dp="append",YJ="replace",mH=hp;H$(hp,VJ);re.getSingleton().register("beforeColumnSort");re.getSingleton().register("afterColumnSort");const vh=new WeakMap;var Cl=new WeakSet;class j$ extends qe{constructor(){super(...arguments),WJ(this,Cl),wg(this,"columnStatesManager",null),wg(this,"columnMetaCache",null),wg(this,"pluginKey",hp),wg(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return hp}static get PLUGIN_PRIORITY(){return zJ}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(vh.has(this.hot)&&vh.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),DJ(vh.get(this.hot),this.pluginKey);return}this.enabled||(vh.set(this.hot,this.pluginKey),this.columnStatesManager=new bJ(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Ia(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Gu(Cl,this,GJ).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Gu(Cl,e,KJ).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Gu(Cl,this,XR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Gu(Cl,e,qJ).call(e,...r)}),this.hot.view&&Gu(Cl,this,XR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=k$(r);L$(n,r)===!1||i===null||this.updateHeaderClasses(i)};vh.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:Pa,position:"before",group:mH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mH)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new IF),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return NJ(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Be(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return le(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Be(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(le(n)){const i=gH(n);return le(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:gH()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dp;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Pt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===dp)return[...o.slice(0,r),...o.slice(r+1),s];if(n===YJ)return[...o.slice(0,r),s,...o.slice(r+1)]}return le(s)?o.concat(s):o}getPluginColumnConfig(e){if(xe(e)){const n=e[this.pluginKey];if(xe(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):ot(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Be(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Be(n,u=>u[0]);AJ(n,this.pluginKey,Be(e,u=>u.sortOrder),Be(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Be(n,u=>u[0]),a=new Map(Be(o,(u,c)=>[u,s[c]])),l=Be(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(xe(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||xe(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(pe(e,$J()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];q(e,FJ(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&we(e.target,D$)}onAfterOnCellMouseDown(e,n){if(uM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function XR(){const t=this.getAllSavedSortSettings();if(xe(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function GJ(t,e){const n=k$(e);if(L$(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);ye(e,...aq(s?`${s}ending`:"none"))}}function qJ(t){t===!0&&this.hot.view&&Gu(Cl,this,XR).call(this)}function KJ(t,e,n,r){uM(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Ka(t,e,n){return(e=XJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XJ(t){var e=ZJ(t,"string");return typeof e=="symbol"?e:e+""}function ZJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QJ{constructor(e,n){Ka(this,"plugin",void 0),Ka(this,"hot",void 0),Ka(this,"endpoints",[]),Ka(this,"settings",void 0),Ka(this,"settingsType","array"),Ka(this,"currentEndpoint",null),Ka(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),M(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();M(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;M(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?M(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):M(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){M(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];M(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),M(i,o=>{let s=[];M(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,M(e.ranges,r=>{M(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],M(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],M(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],M(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&M(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),M(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){et("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function Lb(t){return t==null||isNaN(t)}function JJ(t,e){eee(t,e),e.add(t)}function eee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tee(t,e,n){return(e=nee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nee(t){var e=ree(t,"string");return typeof e=="symbol"?e:e+""}function ree(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Fb="columnSummary",iee=220;var Ch=new WeakSet;class oee extends qe{constructor(){super(...arguments),JJ(this,Ch),tee(this,"endpoints",null)}static get PLUGIN_KEY(){return Fb}static get PLUGIN_PRIORITY(){return iee}isEnabled(){return!!this.hot.getSettings()[Fb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Fb],this.endpoints=new QJ(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vg(Ch,e,see).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vg(Ch,e,lee).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vg(Ch,e,aee).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vg(Ch,e,uee).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ae(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=Lb(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ae(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=Lb(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=Lb(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ae(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(st`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function see(){this.endpoints.initEndpoints()}function aee(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function lee(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function uee(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function cee(t,e){U$(t,e),e.add(t)}function $b(t,e,n){U$(t,e),e.set(t,n)}function U$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qu(t,e){return t.get(cM(t,e))}function ZR(t,e,n){return t.set(cM(t,e),n),n}function cM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fp=new WeakMap,Cg=new WeakMap,yg=new WeakMap,pH=new WeakSet;class z${constructor(){cee(this,pH),$b(this,fp,!0),$b(this,Cg,null),$b(this,yg,new ResizeObserver(e=>cM(pH,this,hee).call(this,e)))}setObservedElement(e){ZR(Cg,this,e)}unobserve(){qu(yg,this).unobserve(qu(Cg,this))}observe(){ZR(fp,this,!0),qu(yg,this).observe(qu(Cg,this))}destroy(){qu(yg,this).disconnect()}}function hee(t){if(qu(fp,this)||!Array.isArray(t)||!t.length){ZR(fp,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}ct(z$,xn);function Xa(t,e,n){dee(t,e),e.set(t,n)}function dee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ht(t,e){return t.get(Y$(t,e))}function Ko(t,e,n){return t.set(Y$(t,e),n),n}function Y$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Za=new WeakMap,Vb=new WeakMap,Xo=new WeakMap,Ds=new WeakMap,ks=new WeakMap,bg=new WeakMap,Su=new WeakMap;class Tl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var r=this;Xa(this,Za,void 0),Xa(this,Vb,!1),Xa(this,Xo,null),Xa(this,Ds,void 0),Xa(this,ks,void 0),Xa(this,bg,!0),Xa(this,Su,new z$),Ko(Za,this,e),Ko(Vb,this,n),Ko(Ds,this,this.createEditor()),Ko(ks,this,ht(Ds,this).style),ht(Su,this).setObservedElement(this.getInputElement()),ht(Su,this).addLocalHook("resize",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){ht(ks,this).left=`${e}px`,ht(ks,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:qt(this.getInputElement()),height:en(this.getInputElement())}}observeSize(){ht(Su,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){ht(ks,this).display="block",Ko(bg,this,!1)}hide(){ht(Su,this).unobserve(),ht(bg,this)||(ht(ks,this).display="none"),Ko(bg,this,!0)}isVisible(){return ht(ks,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return ht(Za,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=ht(Za,this).createElement("div"),n=ht(Za,this).createElement("textarea");return e.style.display="none",Ko(Xo,this,ht(Za,this).createElement("div")),ht(Xo,this).setAttribute("dir",ht(Vb,this)?"rtl":"ltr"),q(ht(Xo,this),Tl.CLASS_EDITOR_CONTAINER),ht(Za,this).body.appendChild(ht(Xo,this)),q(e,Tl.CLASS_EDITOR),q(n,Tl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),ht(Xo,this).appendChild(e),e}getInputElement(){return ht(Ds,this).querySelector(`.${Tl.CLASS_INPUT}`)}getEditorElement(){return ht(Ds,this)}destroy(){const e=ht(Xo,this)?ht(Xo,this).parentNode:null;ht(Ds,this).parentNode.removeChild(ht(Ds,this)),Ko(Ds,this,null),Ko(ks,this,null),ht(Su,this).destroy(),e&&e.removeChild(ht(Xo,this))}}ct(Tl,xn);function Wb(t,e,n){return(e=fee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fee(t){var e=gee(t,"string");return typeof e=="symbol"?e:e+""}function gee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const mee=250,pee=250;class G${constructor(e){Wb(this,"wasLastActionShow",!0),Wb(this,"showDebounced",null),Wb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},pee)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mee;this.showDebounced=ff(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}ct(G$,xn);function wee(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function vee(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Qa(t,e){const n={};return M(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Ks(t,e,n,r,i){M(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Cee(s,a,e,n,r,i)})})}function Cee(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=wee(s.className,r):a=vee(s.className,r)),o(t,e,"className",a)}function q$(t){return`<span class="selected">✓</span>${t}`}function Tm(t,e){let n=!1;return Array.isArray(t)&&M(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function xw(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const De="---------";function yee(){return{name:De}}const ti="alignment";function bee(){return{key:ti,name(){return this.getTranslatedPhrase($_)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${ti}:left`,name(){return this.getTranslatedPhrase(V_)},callback(){const t=this.getSelectedRange(),e=Qa(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Ks(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${ti}:center`,name(){return this.getTranslatedPhrase(W_)},callback(){const t=this.getSelectedRange(),e=Qa(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Ks(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${ti}:right`,name(){return this.getTranslatedPhrase(B_)},callback(){const t=this.getSelectedRange(),e=Qa(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Ks(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${ti}:justify`,name(){return this.getTranslatedPhrase(j_)},callback(){const t=this.getSelectedRange(),e=Qa(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Ks(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:De},{key:`${ti}:top`,name(){return this.getTranslatedPhrase(U_)},callback(){const t=this.getSelectedRange(),e=Qa(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Ks(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${ti}:middle`,name(){return this.getTranslatedPhrase(z_)},callback(){const t=this.getSelectedRange(),e=Qa(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Ks(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${ti}:bottom`,name(){return this.getTranslatedPhrase(Y_)},callback(){const t=this.getSelectedRange(),e=Qa(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Ks(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Aw="clear_column";function See(){return{key:Aw,name(){return this.getTranslatedPhrase(__)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const Ef="col_left";function Ree(){return{key:Ef,name(){return this.getTranslatedPhrase(C_)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const _f="col_right";function Eee(){return{key:_f,name(){return this.getTranslatedPhrase(y_)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Tf="make_read_only";function _ee(){return{key:Tf,checkable:!0,ariaChecked(){return Tm(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(np)},name(){let t=this.getTranslatedPhrase(np);return Tm(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=q$(t)),t},callback(){const t=this.getSelectedRange(),e=Tm(t,(n,r)=>this.getCellMeta(n,r).readOnly);M(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Hw="redo";function Tee(){return{key:Hw,name(){return this.getTranslatedPhrase(E_)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Mf="remove_col";function Mee(){return{key:Mf,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(S_,e)},callback(){this.alter("remove_col",c6(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Nw="remove_row";function Iee(){return{key:Nw,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(b_,e)},callback(){this.alter("remove_row",h6(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Dw="row_above";function Pee(){return{key:Dw,name(){return this.getTranslatedPhrase(w_)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const kw="row_below";function Oee(){return{key:kw,name(){return this.getTranslatedPhrase(v_)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const jd="no_items";function xee(){return{key:jd,name(){return this.getTranslatedPhrase(p_)},disabled:!0,isCommand:!1}}const Lw="undo";function Aee(){return{key:Lw,name(){return this.getTranslatedPhrase(R_)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Hee=[Dw,kw,Ef,_f,Aw,Nw,Mf,Lw,Hw,Tf,ti,De,jd],Nee={[De]:yee,[jd]:xee,[Dw]:Pee,[kw]:Oee,[Ef]:Ree,[_f]:Eee,[Aw]:See,[Nw]:Iee,[Mf]:Mee,[Lw]:Aee,[Hw]:Tee,[Tf]:_ee,[ti]:bee};function K$(){const t={};return Ae(Nee,(e,n)=>{t[n]=e()}),t}function Dee(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(k_):this.getTranslatedPhrase(D_)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function kee(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(L_)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Lee(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(F_);return Tm(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Mm))?q$(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Mm);t.updateCommentMeta(n,r,{[Mm]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Fee(t,e){X$(t,e),e.add(t)}function Ru(t,e,n){X$(t,e),e.set(t,n)}function X$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $ee(t,e,n){return(e=Vee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vee(t){var e=Wee(t,"string");return typeof e=="symbol"?e:e+""}function Wee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ca(t,e,n){return t.set(fr(t,e),n),n}function Pe(t,e){return t.get(fr(t,e))}function fr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gp="comments",Bee=60,as="comment",Jh="value",Z$="style",Mm="readOnly",yh=gp,QR=`plugin:${gp}`;var lt=new WeakMap,go=new WeakMap,Fw=new WeakMap,Im=new WeakMap,JR=new WeakMap,mp=new WeakMap,Tr=new WeakSet;class jee extends qe{constructor(){super(...arguments),Fee(this,Tr),$ee(this,"range",{}),Ru(this,lt,null),Ru(this,go,null),Ru(this,Fw,!1),Ru(this,Im,!1),Ru(this,JR,null),Ru(this,mp,"")}static get PLUGIN_KEY(){return gp}static get PLUGIN_PRIORITY(){return Bee}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[gp]}enablePlugin(){var e=this;this.enabled||(Pe(lt,this)||(ca(lt,this,new Tl(this.hot.rootDocument,this.hot.isRtl())),Pe(lt,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fr(Tr,e,Zee).call(e,...r)})),Pe(go,this)||ca(go,this,new G$(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>fr(Tr,this,qee).call(this,n,a)),this.addHook("afterScroll",()=>fr(Tr,this,Qee).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>fr(Tr,this,wH).call(this,n)),this.addHook("beforeCompositionStart",n=>fr(Tr,this,wH).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fr(Tr,e,Jee).call(e,...r)}),Pe(go,this).addLocalHook("hide",()=>this.hide()),Pe(go,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Pe(go,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(QR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();ca(Im,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(QR),this.hot._registerTimeout(()=>{ca(Im,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:yh}),r.addShortcut({keys:[["Escape"]],callback:()=>{Pe(lt,this).setValue(Pe(mp,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Pe(lt,this).isVisible()&&Pe(lt,this).isFocused(),group:yh}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Pe(lt,this).isVisible()&&Pe(lt,this).isFocused(),group:yh}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{Pe(lt,this).setValue(Pe(lt,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:yh})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(yh)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>fr(Tr,this,Yee).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>fr(Tr,this,Uee).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>fr(Tr,this,Gee).call(this)),this.eventManager.addEventListener(n,"focus",()=>fr(Tr,this,Xee).call(this)),this.eventManager.addEventListener(n,"blur",()=>fr(Tr,this,Kee).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>fr(Tr,this,zee).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=ya(e.target,"TD","TBODY");return!!(n&&we(n,"htCommentCell")&&ya(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Pe(lt,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Jh]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,as),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Jh)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Jh)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Pe(go,this).cancelHiding(),Pe(lt,this).setValue((e=i[as]?i[as][Jh]:null)!==null&&e!==void 0?e:""),Pe(lt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Pe(lt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Pe(lt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;Pe(lt,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:s,col:a},!0),v=this.getCommentMeta(i,o,Z$);v?Pe(lt,this).setSize(v.width,v.height):Pe(lt,this).resetSize();const y=c?0:f.getColumnWidth(a),E=l&&!u?en(g):0,{left:C,top:T,width:A,height:F}=g.getBoundingClientRect(),{width:I,height:O}=Pe(lt,this).getSize(),{innerWidth:Y,innerHeight:U}=this.hot.rootWindow,W=this.hot.rootDocument.documentElement,Z=bn(this.hot.rootDocument),Q=I0(this.hot.rootWindow)?Z:0,oe=P0(this.hot.rootWindow)?Z:0;let te=C+h.scrollX+y,ae=T+h.scrollY+E;this.hot.isRtl()&&(te-=I+y),this.hot.isLtr()&&C+A+I>Y-Q?te=C+h.scrollX-I-1:this.hot.isRtl()&&te<-(W.scrollWidth-W.clientWidth)&&(te=C+h.scrollX+y+1),T+O>U-oe&&(ae-=O-F+1),Pe(lt,this).setPosition(te,ae),Pe(lt,this).setReadOnlyState(this.getCommentMeta(i,o,Mm)),Pe(lt,this).observeSize()}focusEditor(){Pe(lt,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[as];let o;i?(o=Un(i),gf(o,r)):o=r,this.hot.setCellMeta(e,n,as,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[as])return i[as][r]}addToContextMenu(e){e.items.push({name:De},Dee(this),kee(this),Lee(this))}getEditorInputElement(){return Pe(lt,this).getInputElement()}destroy(){var e,n;(e=Pe(lt,this))===null||e===void 0||e.destroy(),(n=Pe(go,this))===null||n===void 0||n.destroy(),super.destroy()}}function Uee(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Pe(Fw,this)&&!this.targetIsCommentTextArea(t)){const e=ya(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function zee(t){t.stopPropagation()}function Yee(t){const{rootDocument:e}=this.hot;if(!(Pe(Fw,this)||Pe(lt,this).isFocused()||we(t.target,"wtBorder")||Pe(JR,this)===t.target||!Pe(lt,this)))if(ca(JR,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Pe(go,this).show(n)}else ga(t.target,e)&&!this.targetIsCommentTextArea(t)&&Pe(go,this).hide()}function Gee(){ca(Fw,this,!1)}function qee(t,e){e[as]&&e[as][Jh]&&q(t,e.commentedCellClassName)}function Kee(){ca(mp,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Xee(){ca(mp,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(QR)}function Zee(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[Z$]:{width:t,height:e}})}function wH(t){Pe(lt,this).isFocused()&&vi(t)}function Qee(){Pe(Im,this)||this.hide()}function Jee(){const t=Pe(lt,this).getEditorElement();pe(t,/ht-theme-.*/g),q(t,this.hot.getCurrentThemeName())}function Bb(t,e,n){return(e=ete(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ete(t){var e=tte(t,"string");return typeof e=="symbol"?e:e+""}function tte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Q${constructor(e){Bb(this,"hot",void 0),Bb(this,"commands",{}),Bb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=nte(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Jt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),M(u,c=>c.apply(this.hot,r))}}function nte(t,e){let n;return M(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function jb(t,e,n){return(e=rte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rte(t){var e=ite(t,"string");return typeof e=="symbol"?e:e+""}function ite(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;jb(this,"hot",void 0),jb(this,"predefinedItems",K$()),jb(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ae(e,(r,i)=>{let o="";r.name===De?(n[De]=r,o=De):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return ote(e,this.defaultOrderPattern,this.predefinedItems)}}function ote(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),xe(i)?Ae(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),xe(o)?tn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):M(i,(o,s)=>{let a=n[o];!a&&Hee.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),xe(o)&&tn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function Ls(t,e,n){return(e=ste(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ste(t){var e=ate(t,"string");return typeof e=="symbol"?e:e+""}function ate(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lte{constructor(e,n){Ls(this,"top",void 0),Ls(this,"topRelative",void 0),Ls(this,"left",void 0),Ls(this,"leftRelative",void 0),Ls(this,"scrollTop",void 0),Ls(this,"scrollLeft",void 0),Ls(this,"cellHeight",void 0),Ls(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function bh(t,e,n){ute(t,e),e.set(t,n)}function ute(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ie(t,e){return t.get(eV(t,e))}function Sg(t,e,n){return t.set(eV(t,e),n),n}function eV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gn=new WeakMap,lr=new WeakMap,ur=new WeakMap,Ub=new WeakMap,Eu=new WeakMap;class cte{constructor(e){bh(this,Gn,void 0),bh(this,lr,void 0),bh(this,ur,void 0),bh(this,Ub,!1),bh(this,Eu,{above:0,below:0,left:0,right:0}),Sg(Ub,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ie(Eu,this)[e]=n,this}setElement(e){return Sg(Gn,this,e),this}setParentElement(e){return Sg(lr,this,e),this}updatePosition(e){Sg(ur,this,new lte(e,Ie(Gn,this).ownerDocument.defaultView)),Ie(Ub,this)?(Ie(ur,this).fitsBelow(Ie(Gn,this))?this.setPositionBelowCursor():Ie(ur,this).fitsAbove(Ie(Gn,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ie(Gn,this).dir==="rtl"?Ie(ur,this).fitsOnLeft(Ie(Gn,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ie(ur,this).fitsOnRight(Ie(Gn,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ie(Eu,this).above+Ie(ur,this).top-Ie(Gn,this).offsetHeight;if(Ie(lr,this)){const r=Ie(lr,this).ownerDocument.defaultView.getComputedStyle(Ie(lr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Ie(ur,this).top+Ie(ur,this).cellHeight-Ie(Gn,this).scrollHeight+i+o}Ie(Gn,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Ie(Eu,this).below+Ie(ur,this).top+1;if(Ie(lr,this)){const r=Ie(lr,this).ownerDocument.defaultView.getComputedStyle(Ie(lr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Ie(ur,this).top-i-o-1}Ie(Gn,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ie(ur,this).left;if(Ie(lr,this)){const n=Ie(lr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Ie(lr,this).querySelector(".htCore")).borderRightWidth,10);e+=Ie(ur,this).cellWidth+r}else e+=Ie(Eu,this).right;Ie(Gn,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ie(Eu,this).left+Ie(ur,this).left-Ie(Gn,this).offsetWidth;if(Ie(lr,this)){const n=Ie(lr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Ie(lr,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Ie(Gn,this).style.left=`${e}px`}}function tV(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=ze(e,-1,g()-1);function a(y,E){const C=g()-1;return y<0&&(y=C),y>C&&(y=0),o.has(y)?-1:(o.add(y),r(y,!1)===!1&&(y=a(E===1?++y:--y,E)),y)}function l(y){y>-1&&y<g()&&r(y,!0)!==!1&&(s=y)}function u(){return s}function c(){g()>0&&(o.clear(),s=a(0,1))}function h(){g()>0&&(o.clear(),s=a(g()-1,-1))}function d(){g()>0&&(o.clear(),s=a(++s,1))}function f(){g()>0&&(o.clear(),s=a(--s,-1))}function g(){return Math.max(n(),0)}function v(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:g,clear:v}}function hte(t){return Be(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function eE(t){return Jt(t,"submenu")}function tE(t){return new RegExp(De,"i").test(t.name)}function Pm(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function vH(t){return Jt(t,"disableSelection")}function dte(t){return we(t,"htSeparator")}function fte(t){return we(t,"htSubmenu")}function gte(t){return we(t,"htDisabled")}function mte(t){return we(t,"htSelectionDisabled")}function pte(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function nV(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function wte(t,e){let n=t.slice(0);return n.reverse(),n=nV(n,e),n.reverse(),n}function vte(t){const e=[];return M(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Cte(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:De,n=t.slice(0);return n=nV(n,e),n=wte(n,e),n=vte(n),n}function yte(t){return t.checkable===!0}function bte(t){return tV({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||dte(r)||gte(r)||mte(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Ste(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const rV="menu",CH=rV;function Rte(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(Ste(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:rV})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${CH}:${u}`:CH}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function Ete(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Oo(n),q(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Pm(a,t)&&!vH(a)&&!tE(a);ye(n,[...yte(a)?[Q2(),Hd(c),wL(h)]:[Z2(),Hd(u)],...d?[Kl(-1)]:[],...Pm(a,t)?[oq()]:[],...eE(a)?[li(!1)]:[]])}n.className="",n.appendChild(l),tE(a)?q(n,"htSeparator"):typeof a.renderer=="function"?(q(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Ql(l,u),Pm(a,t)?q(n,"htDisabled"):vH(a)?q(n,"htSelectionDisabled"):eE(a)&&q(n,"htSubmenu")}}function zb(t,e,n){_te(t,e),e.set(t,n)}function _te(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eo(t,e,n){return(e=Tte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tte(t){var e=Mte(t,"string");return typeof e=="symbol"?e:e+""}function Mte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yb(t,e,n){return t.set(iV(t,e),n),n}function Ja(t,e){return t.get(iV(t,e))}function iV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const yH=215;var Sh=new WeakMap,Rg=new WeakMap,Eg=new WeakMap;class $c{get tableBorderWidth(){return Ja(Eg,this)===void 0&&this.hotMenu&&Yb(Eg,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Ja(Eg,this)}constructor(e,n){var r=this;eo(this,"hot",void 0),eo(this,"options",void 0),eo(this,"eventManager",new di(this)),eo(this,"container",void 0),eo(this,"positioner",void 0),eo(this,"hotMenu",null),eo(this,"hotSubMenus",{}),eo(this,"parentMenu",void 0),eo(this,"menuItems",null),eo(this,"origOutsideClickDeselects",null),zb(this,Sh,void 0),zb(this,Rg,void 0),zb(this,Eg,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:yH,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new cte(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{if(!o){var s;(s=this.hotMenu)===null||s===void 0||s.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Nl(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Ja(Sh,this)}getKeyboardShortcutsCtrl(){return Ja(Rg,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=ff(a=>this.openSubMenu(a),300),n=this.options.minWidth||yH;let r=!1,i=Ca(this.menuItems,a=>(a.key===jd&&(r=!0),pte(a,this.hot)));if(i.length<1&&!r)i.push(K$()[jd]);else if(i.length===0)return;i=Cte(i,De);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return le(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Ete(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{Ja(Sh,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),OR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!OR()||!Sa(a))&&o&&this.hasSelectedItem()&&(Eo()||L0()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Yb(Sh,this,bte(this.hotMenu)),Yb(Rg,this,Rte(this)),Ja(Rg,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Ja(Sh,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);ye(r,[li(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!fte(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new $c(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&ye(n,[li(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&ye(i,[li(!1)])}}closeAllSubMenus(){M(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?hte(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||tE(e)||Pm(e,this.hot)||eE(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:n}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,i=n.hider.style,o=n.holder.style,s=parseInt(i.width,10),a=mn(r,(l,u,c)=>{const d=this.hotMenu.getCell(c,0)?en(this.hotMenu.getCell(c,0)):0;return l+(u.name===De?1:d)},0);e.isClassicTheme()?(o.width=`${s+3}px`,o.height=`${a+3}px`):(o.width=`${s}px`,o.height=`${a}px`),i.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(ot(r)&&(r=r.call(this.hot),r===null||Pt(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),q(i,`htMenu handsontable ${this.options.className}`),r&&q(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&ye(this.hotMenu.rootElement,[X2(),Kl(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ga(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ga(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&we(e.target,"htCore")&&ga(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}ct($c,xn);function Ite(t,e){Pte(t,e),e.add(t)}function Pte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gb(t,e,n){return(e=Ote(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ote(t){var e=xte(t,"string");return typeof e=="symbol"?e:e+""}function xte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _g(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ed="contextMenu",Ate=70,bH=ed;re.getSingleton().register("afterContextMenuDefaultOptions");re.getSingleton().register("beforeContextMenuShow");re.getSingleton().register("afterContextMenuShow");re.getSingleton().register("afterContextMenuHide");re.getSingleton().register("afterContextMenuExecute");var Rh=new WeakSet;class $w extends qe{constructor(){super(...arguments),Ite(this,Rh),Gb(this,"commandExecutor",new Q$(this.hot)),Gb(this,"itemsFactory",null),Gb(this,"menu",null)}static get PLUGIN_KEY(){return ed}static get PLUGIN_PRIORITY(){return Ate}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Dw,kw,De,Ef,_f,De,Nw,Mf,De,Lw,Hw,De,Tf,De,ti]}isEnabled(){return!!this.hot.getSettings()[ed]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[ed];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new $c(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>_g(Rh,this,Nte).call(this)),this.menu.addLocalHook("afterOpen",()=>_g(Rh,this,Dte).call(this)),this.menu.addLocalHook("afterClose",()=>_g(Rh,this,kte).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>_g(Rh,this,Hte).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=xw(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:bH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(bH)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;Ae(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new J$(this.hot,$w.DEFAULT_ITEMS);const e=this.hot.getSettings()[ed],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),M(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Hte(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),we(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(we(o,"current")&&we(o,"wtBorder"))))return;const s=xw(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Nte(){this.hot.runHooks("beforeContextMenuShow",this)}function Dte(){this.hot.runHooks("afterContextMenuShow",this)}function kte(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}$w.SEPARATOR={name:De};function Lte(t){return{key:"copy",name(){return this.getTranslatedPhrase(T_)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Fte(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?ze(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(P_,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function $te(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?ze(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(I_,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Vte(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?ze(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(M_,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Wte(t){return{key:"cut",name(){return this.getTranslatedPhrase(O_)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class Bte{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class jte{constructor(){this.clipboardData=new Bte}preventDefault(){}composedPath(){return[]}}function Ute(t,e){oV(t,e),e.add(t)}function _u(t,e,n){oV(t,e),e.set(t,n)}function oV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xn(t,e){return t.get(tc(t,e))}function Tu(t,e,n){return t.set(tc(t,e),n),n}function tc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fs=new WeakMap,qb=new WeakMap,Eh=new WeakMap,nE=new WeakMap,rE=new WeakMap,_h=new WeakMap,Th=new WeakSet;class zte{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;Ute(this,Th),_u(this,Fs,void 0),_u(this,qb,void 0),_u(this,Eh,void 0),_u(this,nE,void 0),_u(this,rE,void 0),_u(this,_h,void 0),Tu(qb,this,n),Tu(Eh,this,r),Tu(nE,this,i),Tu(rE,this,o),Tu(_h,this,s)}setSelectedRange(e){Tu(Fs,this,e)}getCellsRange(){if(Xn(qb,this).call(this)===0||Xn(Eh,this).call(this)===0)return null;const{row:e,col:n}=Xn(Fs,this).getTopStartCorner(),{row:r,col:i}=Xn(Fs,this).getBottomEndCorner(),o=tc(Th,this,Yte).call(this,e,r),s=tc(Th,this,Kb).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Xn(Eh,this).call(this)===0||Xn(_h,this).call(this)===0)return null;const{col:e}=Xn(Fs,this).getTopStartCorner(),{col:n}=Xn(Fs,this).getBottomEndCorner(),r=tc(Th,this,Kb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Xn(Eh,this).call(this)===0||Xn(_h,this).call(this)===0)return null;const{col:e}=Xn(Fs,this).getTopStartCorner(),{col:n}=Xn(Fs,this).getBottomEndCorner(),r=tc(Th,this,Kb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-Xn(_h,this).call(this),startCol:e,endRow:-1,endCol:r}}}function Kb(t,e){return Math.min(e,Math.max(t+Xn(rE,this).call(this)-1,t))}function Yte(t,e){return Math.min(e,Math.max(t+Xn(nE,this).call(this)-1,t))}function sV(t){const e=[],n=[];return M(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);fe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);fe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Gte(t,e){aV(t,e),e.add(t)}function $s(t,e,n){aV(t,e),e.set(t,n)}function aV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mh(t,e,n){return(e=qte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qte(t){var e=Kte(t,"string");return typeof e=="symbol"?e:e+""}function Kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vr(t,e){return t.get(yr(t,e))}function Pi(t,e,n){return t.set(yr(t,e),n),n}function yr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("afterCopyLimit");re.getSingleton().register("modifyCopyableRange");re.getSingleton().register("beforeCut");re.getSingleton().register("afterCut");re.getSingleton().register("beforePaste");re.getSingleton().register("afterPaste");re.getSingleton().register("beforeCopy");re.getSingleton().register("afterCopy");const Xb="copyPaste",Xte=80,Zte=["fragmentSelection"],SH=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var iE=new WeakMap,oE=new WeakMap,sE=new WeakMap,Mu=new WeakMap,Tg=new WeakMap,Mg=new WeakMap,Iu=new WeakMap,pp=new WeakMap,Dr=new WeakSet;class Qte extends qe{constructor(){super(...arguments),Gte(this,Dr),Mh(this,"columnsLimit",1/0),Mh(this,"rowsLimit",1/0),Mh(this,"pasteMode","overwrite"),Mh(this,"uiContainer",this.hot.rootDocument.body),$s(this,iE,!1),$s(this,oE,!1),$s(this,sE,!1),$s(this,Mu,"cells-only"),$s(this,Tg,!1),$s(this,Mg,!1),$s(this,Iu,new zte({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),$s(this,pp,!1),Mh(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Xb}static get SETTING_KEYS(){return[Xb,...Zte]}static get PLUGIN_PRIORITY(){return Xte}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Xb]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Pi(iE,this,this.getSetting("copyColumnHeaders")),Pi(oE,this,this.getSetting("copyColumnGroupHeaders")),Pi(sE,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>yr(Dr,this,tne).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return yr(Dr,r,nne).call(r,...o)}),this.addHook("afterSelectionEnd",()=>yr(Dr,this,rne).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),Fd()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return yr(Dr,r,ine).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return yr(Dr,r,one).call(r,...o)}),this.addHook("afterSelection",()=>yr(Dr,this,sne).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Pi(Mu,this,e),Pi(Tg,this,!0),yr(Dr,this,RH).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Pi(Mg,this,!0),yr(Dr,this,RH).call(this,"cut")}getRangedCopyableData(e){return hd(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=sV(e);return M(r,o=>{const s=[];M(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new jte;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}vr(Iu,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);vr(Mu,this)==="column-headers-only"?n.set("headers",vr(Iu,this).getMostBottomColumnHeadersRange()):(vr(Mu,this)==="with-column-headers"?n.set("headers",vr(Iu,this).getMostBottomColumnHeadersRange()):vr(Mu,this)==="with-column-group-headers"&&n.set("headers",vr(Iu,this).getAllColumnHeadersRange()),n.set("cells",vr(Iu,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:g,visualRow:v}=this.hot.getCellMeta(c,a);if(c=v+1,g===!0)continue;d=v,h=a;const y=[],E=o.length%r;for(;y.length<i||h<=u;){const{skipColumnOnPaste:C,visualCol:T}=this.hot.getCellMeta(s,h);if(h=T+1,C===!0)continue;f=T;const A=y.length%i;y.push(e[E][A])}o.push(y)}return Pi(pp,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!vr(Tg,this)||this.isEditorOpened()||_o(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!ad(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Pi(Tg,this,!1);const o=this.getRangedData(this.copyableRanges),s=yr(Dr,this,Jte).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=hd(o);if(e&&e.clipboardData){const u=NR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[SH,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}Pi(Mu,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!vr(Mg,this)||this.isEditorOpened()||_o(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!ad(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Pi(Mg,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=hd(o);if(e&&e.clipboardData){const l=NR(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[SH,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||_o(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!ad(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=sw(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=QL(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=p6(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function RH(t){if(Fd()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&OL(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Jte(t){const{rows:e}=sV(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function ene(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&x0(r)}}}function lV(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&A0(r)}}}function tne(t){t.items.push({name:"---------"},Lte(this)),vr(iE,this)&&t.items.push(Vte(this)),vr(oE,this)&&t.items.push($te(this)),vr(sE,this)&&t.items.push(Fte(this)),t.items.push(Wte(this))}function nne(t,e,n,r,i){vr(pp,this)&&(i.value=!0),Pi(pp,this,!1)}function rne(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function ine(){yr(Dr,this,lV).call(this)}function one(){yr(Dr,this,ene).call(this)}function sne(){yr(Dr,this,lV).call(this)}function uV(t,e){return`border_row${t}col${e}`}function td(){return{width:1,color:"#000"}}function ms(){return{hide:!0}}function ane(){return{width:1,color:"#000",cornerVisible:!1}}function Zb(t){if(le(t.start)||le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(le(t.end)||le(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Ih(t){return le(t.start)&&(t.left=t.start),le(t.end)&&(t.right=t.end),t}function Qb(t,e){return{id:uV(t,e),border:ane(),row:t,col:e,top:ms(),bottom:ms(),start:ms(),end:ms()}}function lne(t,e){return Jt(e,"border")&&e.border&&(t.border=e.border),Jt(e,"top")&&le(e.top)&&(e.top?(xe(e.top)||(e.top=td()),t.top=e.top):(e.top=ms(),t.top=e.top)),Jt(e,"bottom")&&le(e.bottom)&&(e.bottom?(xe(e.bottom)||(e.bottom=td()),t.bottom=e.bottom):(e.bottom=ms(),t.bottom=e.bottom)),Jt(e,"start")&&le(e.start)&&(e.start?(xe(e.start)||(e.start=td()),t.start=e.start):(e.start=ms(),t.start=e.start)),Jt(e,"end")&&le(e.end)&&(e.end?(xe(e.end)||(e.end=td()),t.end=e.end):(e.end=ms(),t.end=e.end)),t}function Es(t,e){let n=!1;return M(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!Jt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function Vw(t){return`<span class="selected">✓</span>${t}`}function une(t){return t.some(e=>le(e.left)||le(e.right))}function cne(t){return t.some(e=>le(e.start)||le(e.end))}const hne=new Map([["left","start"],["right","end"]]);function dne(t){var e;return(e=hne.get(t))!==null&&e!==void 0?e:t}function fne(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(X_);return Es(this,"bottom")&&(e=Vw(e)),e},callback(e,n){const r=Es(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function gne(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(Z_);return Es(this,e)&&(n=Vw(n)),n},callback(n,r){const i=Es(this,e);t.prepareBorder(r,e,i)}}}function mne(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Q_)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Es(this)}}}function pne(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(K_);return Es(this,e)&&(n=Vw(n)),n},callback(n,r){const i=Es(this,e);t.prepareBorder(r,e,i)}}}function wne(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(q_);return Es(this,"top")&&(e=Vw(e)),e},callback(e,n){const r=Es(this,"top");t.prepareBorder(n,"top",r)}}}function vne(t,e){Cne(t,e),e.add(t)}function Cne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yne(t,e,n){return(e=bne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bne(t){var e=Sne(t,"string");return typeof e=="symbol"?e:e+""}function Sne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Om="customBorders",Rne=90;var Jb=new WeakSet;class Ene extends qe{constructor(){super(...arguments),vne(this,Jb),yne(this,"savedBorders",[])}static get PLUGIN_KEY(){return Om}static get PLUGIN_PRIORITY(){return Rne}isEnabled(){return!!this.hot.getSettings()[Om]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>EH(Jb,this,_ne).call(this,e)),this.addHook("init",()=>EH(Jb,this,Tne).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Zb(n));const o=vc(e),s=Wd(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});M(e,a=>{s(a).forAll((l,u)=>{M(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,dne(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=vc(e),r=Wd(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return M(e,o=>{r(o).forAll((s,a)=>{M(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(Ih(l))})})}),i}clearBorders(e){e?this.setBorders(e):(M(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Qb(e,n);r&&(a=lne(a,r),M(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Ih(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);fe(e.from.row,r,o=>{fe(e.from.col,i,s=>{const a=Qb(o,s);let l=0;o===e.from.row&&Jt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&Jt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&Jt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&Jt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Ih(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=uV(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Qb(e,n):o=Zb(o),i?(o[r]=ms(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Ih(o)))):(o[r]=td(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Ih(o)))}prepareBorder(e,n,r){M(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":fe(o.col,s.col,a=>{fe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":fe(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":fe(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":fe(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":fe(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){M(e,n=>{const r=Zb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return mn([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Be(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){M(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){M(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Be(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):M(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return M(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return M(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):M(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);M(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Om];if(Array.isArray(e)){const n=Un(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=une(e),r=cne(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function _ne(t){this.hot.getSettings()[Om]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(G_)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[wne(this),pne(this),fne(this),gne(this),mne(this)]}})}function Tne(){this.changeBorderSettings()}function Mne(t,e){Ine(t,e),e.add(t)}function Ine(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eS(t,e,n){return(e=Pne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pne(t){var e=One(t,"string");return typeof e=="symbol"?e:e+""}function One(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _H(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const TH="dragToScroll",xne=100;var tS=new WeakSet;class Ane extends qe{constructor(){super(...arguments),Mne(this,tS),eS(this,"boundaries",null),eS(this,"callback",null),eS(this,"listening",!1)}static get PLUGIN_KEY(){return TH}static get PLUGIN_PRIORITY(){return xne}isEnabled(){return!!this.hot.getSettings()[TH]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>_H(tS,this,MH).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>_H(tS,this,MH).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=Nl(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function MH(t){if(Sa(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function Hne(t,e){cV(t,e),e.add(t)}function Nne(t,e,n){cV(t,e),e.set(t,n)}function cV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nS(t,e,n){return(e=Dne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dne(t){var e=kne(t,"string");return typeof e=="symbol"?e:e+""}function kne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lne(t,e){return t.get(ni(t,e))}function hV(t,e,n){return t.set(ni(t,e),n),n}function ni(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("afterDropdownMenuDefaultOptions");re.getSingleton().register("beforeDropdownMenuShow");re.getSingleton().register("afterDropdownMenuShow");re.getSingleton().register("afterDropdownMenuHide");re.getSingleton().register("afterDropdownMenuExecute");const xm="dropdownMenu",Fne=230,Ud="changeType",rS=xm;var Ww=new WeakMap,Ai=new WeakSet;class Bw extends qe{static get PLUGIN_KEY(){return xm}static get PLUGIN_PRIORITY(){return Fne}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Ef,_f,De,Mf,De,Aw,De,Tf,De,ti]}constructor(e){super(e),Hne(this,Ai),nS(this,"commandExecutor",new Q$(this.hot)),nS(this,"itemsFactory",null),nS(this,"menu",null),Nne(this,Ww,!1),this.hot.addHook("afterGetColHeader",(n,r)=>ni(Ai,this,Vne).call(this,n,r))}isEnabled(){return this.hot.getSettings()[xm]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new J$(this.hot,Bw.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ni(Ai,e,Yne).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ni(Ai,e,zne).call(e,...o)});const n=this.hot.getSettings()[xm],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new $c(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>ni(Ai,this,Wne).call(this)),this.menu.addLocalHook("afterOpen",()=>ni(Ai,this,Bne).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>ni(Ai,this,jne).call(this,o)),this.menu.addLocalHook("afterClose",()=>ni(Ai,this,Une).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),M(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=xw(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${Ud}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:rS},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:rS}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(rS)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>ni(Ai,this,$ne).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ae(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function dV(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function $ne(t){if(we(t.target,Ud)){const e=xw(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),hV(Ww,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function Vne(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${Ud}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Ud,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(ye(s,[Xl(),Hd(" ")]),ye(e,[gL("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function Wne(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Bne(){this.hot.runHooks("afterDropdownMenuShow",this),ni(Ai,this,dV).call(this,this.menu)}function jne(t){ni(Ai,this,dV).call(this,t)}function Une(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function zne(t){return Lne(Ww,this)?null:t}function Yne(t){we(t.target,Ud)&&hV(Ww,this,!0)}Bw.SEPARATOR={name:De};function IH(t,e,n){return(e=Gne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gne(t){var e=qne(t,"string");return typeof e=="symbol"?e:e+""}function qne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kne{constructor(e){IH(this,"hot",void 0),IH(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return fe(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(fe(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();fe(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();fe(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function PH(t,e,n){return(e=Xne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xne(t){var e=Zne(t,"string");return typeof e=="symbol"?e:e+""}function Zne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hM{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){PH(this,"dataProvider",void 0),PH(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=ji(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=tn(ji(hM.DEFAULT_OPTIONS),n),n=tn(n,e),n.filename=y0(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function Qne(t,e){Jne(t,e),e.add(t)}function Jne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fV="\r",ere='"',tre=`
`,nre="=",rre="+",ire="-",ore="@",sre="	";var iS=new WeakSet;class are extends hM{constructor(){super(...arguments),Qne(this,iS)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Be(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),M(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=bt(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=OH(iS,this,ure).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=OH(iS,this,lre).call(this,i)),(n||i.indexOf(fV)>=0||i.indexOf(ere)>=0||i.indexOf(tre)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function lre(t){return t.startsWith(nre)||t.startsWith(rre)||t.startsWith(ire)||t.startsWith(ore)||t.startsWith(sre)||t.startsWith(fV)?`'${t}`:t}function ure(t,e){return e.test(t)?`'${t}`:t}const cre="csv",aE={[cre]:are};function hre(t,e,n){return typeof aE[t]=="function"?new aE[t](e,n):null}const dre="exportFile",fre=240;class gre extends qe{static get PLUGIN_KEY(){return dre}static get PLUGIN_PRIORITY(){return fre}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!aE[e])throw new Error(`Export format type "${e}" is not supported.`);return hre(e,new Kne(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Pu(t,e,n){return(e=mre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mre(t){var e=pre(t,"string");return typeof e=="symbol"?e:e+""}function pre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class If{constructor(e,n){let{id:r,stateless:i=!0}=n;Pu(this,"hot",void 0),Pu(this,"id",void 0),Pu(this,"elements",[]),Pu(this,"hidden",!1),Pu(this,"stateId",""),Pu(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new bw)}getElements(){return this.elements}reset(){M(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),M(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ct(If,xn);const zd={};function Ra(t,e){if(!zd[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=zd[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function Ml(t){if(!zd[t])throw Error(`Filter condition "${t}" does not exist.`);return zd[t].descriptor}function on(t,e,n){n.key=t,zd[t]={condition:e,descriptor:n}}const _n="none";function wre(){return!0}on(_n,wre,{name:Sw,inputsCount:0,showOperators:!1});const gd="empty";function vre(t){return Wt(t.value)}on(gd,vre,{name:oT,inputsCount:0,showOperators:!0});const Am="not_empty";function Cre(t,e){return!Ra(gd,e)(t)}on(Am,Cre,{name:sT,inputsCount:0,showOperators:!0});const md="eq";function yre(t,e){let[n]=e;return bt(t.value).toLocaleLowerCase(t.meta.locale)===bt(n)}on(md,yre,{name:aT,inputsCount:1,showOperators:!0});const Hm="neq";function bre(t,e){return!Ra(md,e)(t)}on(Hm,bre,{name:lT,inputsCount:1,showOperators:!0});const gV="gt";function Sre(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}on(gV,Sre,{name:fT,inputsCount:1,showOperators:!0});const mV="gte";function Rre(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}on(mV,Rre,{name:gT,inputsCount:1,showOperators:!0});const pV="lt";function Ere(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}on(pV,Ere,{name:mT,inputsCount:1,showOperators:!0});const wV="lte";function _re(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}on(wV,_re,{name:pT,inputsCount:1,showOperators:!0});const dM="date_after";function Tre(t,e){let[n]=e;const r=X(t.value,t.meta.dateFormat),i=X(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}on(dM,Tre,{name:CT,inputsCount:1,showOperators:!0});const fM="date_before";function Mre(t,e){let[n]=e;const r=X(t.value,t.meta.dateFormat),i=X(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}on(fM,Mre,{name:yT,inputsCount:1,showOperators:!0});const wp="between";function Ire(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Ra(fM,[o]),a=Ra(dM,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}on(wp,Ire,{name:wT,inputsCount:2,showOperators:!0});const vV="not_between";function Pre(t,e){return!Ra(wp,e)(t)}on(vV,Pre,{name:vT,inputsCount:2,showOperators:!0});const CV="begins_with";function Ore(t,e){let[n]=e;return bt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(bt(n))}on(CV,Ore,{name:uT,inputsCount:1,showOperators:!0});const yV="ends_with";function xre(t,e){let[n]=e;return bt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(bt(n))}on(yV,xre,{name:cT,inputsCount:1,showOperators:!0});const gM="contains";function Are(t,e){let[n]=e;return bt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(bt(n))>=0}on(gM,Are,{name:hT,inputsCount:1,showOperators:!0});const bV="not_contains";function Hre(t,e){return!Ra(gM,e)(t)}on(bV,Hre,{name:dT,inputsCount:1,showOperators:!0});const SV="date_tomorrow";function Nre(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().subtract(-1,"days").startOf("day"),"d"):!1}on(SV,Nre,{name:ST,inputsCount:0});const RV="date_today";function Dre(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().startOf("day"),"d"):!1}on(RV,Dre,{name:bT,inputsCount:0});const EV="date_yesterday";function kre(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().subtract(1,"days").startOf("day"),"d"):!1}on(EV,kre,{name:RT,inputsCount:0});kL();function Lre(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Pf(t){const e=new Set(t);return function(n){return e.has(n)}}function mM(t){return t??""}function lE(t){return Array.from(new Set(t)).map(e=>mM(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function xH(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Pf(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:Lre(a,n)};r&&r(u),i.push(u)}),i}const Il="by_value";function Fre(t,e){let[n]=e;return n(t.value)}on(Il,Fre,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Pf(e)]},showOperators:!1});const Yd={};function $re(t){if(!Yd[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Yd[t].func;return function(n,r){return e(n,r)}}function Vre(t){return Yd[t].name}function pM(t,e,n){Yd[t]={name:e,func:n}}const pa="conjunction",Wre=TT;function Bre(t,e){return t.every(n=>n.func(e))}pM(pa,Wre,Bre);const vp="disjunction",jre=Rw;function Ure(t,e){return t.some(n=>n.func(e))}pM(vp,jre,Ure);const wM="disjunctionWithExtraCondition",zre=Rw;function Yre(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}pM(wM,zre,Yre);const Gre="numeric",_V="text",qre="date",AH={[Gre]:[_n,De,gd,Am,De,md,Hm,De,gV,mV,pV,wV,wp,vV],[_V]:[_n,De,gd,Am,De,md,Hm,De,CV,yV,De,gM,bV],[qre]:[_n,De,gd,Am,De,md,Hm,De,fM,dM,wp,De,SV,RV,EV]};function Kre(t){const e=[];let n=t;return AH[n]||(n=_V),M(AH[n],r=>{let i;r===De?i={name:De}:i=ji(Ml(r)),e.push(i)}),e}function Ph(t,e,n){return(e=Xre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xre(t){var e=Zre(t,"string");return typeof e=="symbol"?e:e+""}function Zre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const oS="built",sS="building",HH=["click","input","keydown","keypress","keyup","focus","blur","change"];let Vi=class TV{static get DEFAULTS(){return ji({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Ph(this,"hot",void 0),Ph(this,"eventManager",new di(this)),Ph(this,"options",void 0),Ph(this,"_element",void 0),Ph(this,"buildState",void 0),this.hot=e,this.options=tn(TV.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===sS?this._element:this.buildState===oS?(this.update(),this._element):(this.buildState=sS,this.build(),this.buildState=oS,this._element)}isBuilt(){return this.buildState===oS}translateIfPossible(e){return typeof e=="string"&&e.startsWith(rr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=sS),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&q(this._element,this.options.className),this.options.children.length)M(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ae(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),M(HH,r=>e(n,r))}else M(HH,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};ct(Vi,xn);function Qre(t,e){MV(t,e),e.add(t)}function Jre(t,e,n){MV(t,e),e.set(t,n)}function MV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ig(t,e){return t.get(vM(t,e))}function eie(t,e,n){return t.set(vM(t,e),n),n}function vM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ou=new WeakMap,NH=new WeakSet;class wa extends Vi{static get DEFAULTS(){return ji({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,tn(wa.DEFAULTS,n)),Qre(this,NH),Jre(this,Ou,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>vM(NH,this,tie).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");eie(Ou,this,this._element.firstChild),q(this._element,"htUIInput"),q(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Ig(Ou,this).type=this.options.type,Ig(Ou,this).placeholder=this.translateIfPossible(this.options.placeholder),Ig(Ou,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Ig(Ou,this).focus()}}function tie(t){this.options.value=t.target.value}function nie(t,e){IV(t,e),e.add(t)}function Oh(t,e,n){IV(t,e),e.set(t,n)}function IV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xu(t,e,n){return t.set(pd(t,e),n),n}function Nt(t,e){return t.get(pd(t,e))}function pd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wn=new WeakMap,Pg=new WeakMap,Og=new WeakMap,aS=new WeakMap,xg=new WeakMap,Ag=new WeakSet;class Gd extends Vi{static get DEFAULTS(){return ji({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,tn(Gd.DEFAULTS,n)),nie(this,Ag),Oh(this,wn,null),Oh(this,Pg,[]),Oh(this,Og,void 0),Oh(this,aS,void 0),Oh(this,xg,void 0),this.registerHooks()}getMenu(){return Nt(wn,this)}registerHooks(){this.addLocalHook("click",()=>pd(Ag,this,oie).call(this))}setItems(e){xu(Pg,this,this.translateNames(e)),Nt(wn,this)&&Nt(wn,this).setMenuItems(Nt(Pg,this))}translateNames(e){return M(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),xu(wn,this,new $c(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Nt(wn,this).setMenuItems(Nt(Pg,this));const e=new Vi(this.hot,{className:"htUISelectCaption"}),n=new Vi(this.hot,{className:"htUISelectDropdown"});xu(Og,this,e),xu(aS,this,e.element),xu(xg,this,n),this.hot.getSettings().ariaTags&&(ye(n.element,[Xl()]),ye(this._element,[fL()])),M([e,n],r=>this._element.appendChild(r.element)),Nt(wn,this).addLocalHook("select",r=>pd(Ag,this,rie).call(this,r)),Nt(wn,this).addLocalHook("afterClose",()=>pd(Ag,this,iie).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Nt(wn,this).hot.getTranslatedPhrase(Sw),Nt(aS,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Nt(wn,this)&&(Nt(wn,this).open(),Nt(wn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Nt(wn,this).getNavigator().toFirstItem(),Nt(wn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Nt(wn,this)&&Nt(wn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Nt(wn,this)&&(Nt(wn,this).destroy(),xu(wn,this,null)),Nt(Og,this)&&Nt(Og,this).destroy(),Nt(xg,this)&&Nt(xg,this).destroy(),super.destroy()}}function rie(t){t.name!==De&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function iie(){this.runLocalHooks("afterClose")}function oie(){this.openOptions()}function sie(t,e){aie(t,e),e.add(t)}function aie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DH(t,e,n){return(e=lie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lie(t){var e=uie(t,"string");return typeof e=="symbol"?e:e+""}function uie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lS=new WeakSet;class uE extends If{constructor(e,n){super(e,{id:n.id,stateless:!1}),sie(this,lS),DH(this,"name",""),DH(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Gd(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new wa(this.hot,{placeholder:AT})),this.elements.push(new wa(this.hot,{placeholder:HT})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>kH(lS,this,cie).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),M(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>kH(lS,this,hie).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=ji(e.command);n.name.startsWith(Bt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),M(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Ml(_n),n=[];return M(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Ml(e?e.name:_n);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||M(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Gd)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof wa)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&q(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||M(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Ml(_n)];if(e!==null){const{visualIndex:r}=e;n=Kre(this.hot.getDataType(0,r,this.hot.countRows(),r))}M(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function cie(t){M(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function hie(t){Nc(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),vi(t))}function LH(t,e,n){die(t,e),e.set(t,n)}function die(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xh(t,e){return t.get(PV(t,e))}function FH(t,e,n){return t.set(PV(t,e),n),n}function PV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Au=new WeakMap,uS=new WeakMap;class Cp extends Vi{static get DEFAULTS(){return ji({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,tn(Cp.DEFAULTS,n)),LH(this,Au,void 0),LH(this,uS,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),FH(uS,this,e),FH(Au,this,this._element.firstChild),xh(Au,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(xh(uS,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?xh(Au,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(xh(Au,this).checked=e)}focus(){this.isBuilt()&&xh(Au,this).focus()}}function fie(t,e){gie(t,e),e.add(t)}function gie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mie(t,e,n){return(e=pie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pie(t){var e=wie(t,"string");return typeof e=="symbol"?e:e+""}function wie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vie(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const $H=0;var VH=new WeakSet;class Cie extends If{constructor(e,n){super(e,{id:n.id,stateless:!1}),fie(this,VH),mie(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuOperators"),M(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[pa,vp];M(e,n=>{const r=new Cp(this.hot,{name:"operator",label:{htmlFor:n,textContent:Vre(n)},value:n,checked:n===e[$H],id:n});r.addLocalHook("change",i=>vie(VH,this,yie).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(st`Radio button with index ${e} doesn't exist.`);M(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Cp&&n.isChecked());return e?e.getValue():pa}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&M(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pa,n=arguments.length>1?arguments[1]:void 0,r=e;r===wM&&(r=vp),this.state.setValueAtIndex(n,r)}reset(){this.setChecked($H)}}function yie(t){this.setState(t.target.value)}function bie(t,e,n){Sie(t,e),e.set(t,n)}function Sie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cS(t,e){return t.get(OV(t,e))}function Rie(t,e,n){return t.set(OV(t,e),n),n}function OV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ah=new WeakMap;class qd extends Vi{static get DEFAULTS(){return ji({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,tn(qd.DEFAULTS,n)),bie(this,Ah,void 0)}build(){super.build(),Rie(Ah,this,this._element.firstChild)}update(){this.isBuilt()&&(cS(Ah,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&cS(Ah,this).focus()}activate(){cS(Ah,this).click()}}function Eie(t,e){xV(t,e),e.add(t)}function Hu(t,e,n){xV(t,e),e.set(t,n)}function xV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Te(t,e){return t.get(nc(t,e))}function _i(t,e,n){return t.set(nc(t,e),n),n}function nc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const WH="multipleSelect.itemBox";var Hi=new WeakMap,zt=new WeakMap,hS=new WeakMap,Zo=new WeakMap,Vs=new WeakMap,Ws=new WeakMap,Hh=new WeakSet;class Kd extends Vi{static get DEFAULTS(){return ji({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,tn(Kd.DEFAULTS,n)),Eie(this,Hh),Hu(this,Hi,[]),Hu(this,zt,void 0),Hu(this,hS,void 0),Hu(this,Zo,void 0),Hu(this,Vs,void 0),Hu(this,Ws,void 0),_i(Zo,this,new wa(this.hot,{placeholder:xT,className:"htUIMultipleSelectSearch"})),_i(Vs,this,new qd(this.hot,{textContent:MT,className:"htUISelectAll"})),_i(Ws,this,new qd(this.hot,{textContent:IT,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Te(zt,this)}registerHooks(){Te(Zo,this).addLocalHook("keydown",e=>nc(Hh,this,Tie).call(this,e)),Te(Zo,this).addLocalHook("input",e=>nc(Hh,this,_ie).call(this,e)),Te(Vs,this).addLocalHook("click",e=>nc(Hh,this,Mie).call(this,e)),Te(Ws,this).addLocalHook("click",e=>nc(Hh,this,Iie).call(this,e))}setItems(e){var n;_i(Hi,this,e),(n=Te(zt,this))===null||n===void 0||n.loadData(Te(Hi,this))}setLocale(e){_i(hS,this,e)}getLocale(){return Te(hS,this)}getItems(){return[...Te(Hi,this)]}getValue(){return Oie(Te(Hi,this))}getSearchInputElement(){return Te(Zo,this)}getSelectAllElement(){return Te(Vs,this)}getClearAllElement(){return Te(Ws,this)}isSelectedAllValues(){return Te(Hi,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new Vi(this.hot,{className:"htUISelectionControls",children:[Te(Vs,this),Te(Ws,this)]});this._element.appendChild(Te(Zo,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=Te(zt,this))===null||s===void 0||s.destroy(),q(o,"htUIMultipleSelectHot"),_i(zt,this,new this.hot.constructor(o,{data:Te(Hi,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Te(zt,this).listen()},modifyColWidth:u=>{const c=Te(zt,this).container.scrollWidth-bn(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Te(zt,this).init(),this.hot.addHook("afterSetTheme",(u,c)=>{c||Te(zt,this).useTheme(u)});const l=Te(zt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:WH}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Te(zt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:WH})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Te(zt,this).listen()}reset(){Te(Zo,this).reset(),Te(Vs,this).reset(),Te(Ws,this).reset()}update(){this.isBuilt()&&(Te(zt,this).loadData(Pie(Te(Hi,this),this.options.value)),super.update())}destroy(){var e;(e=Te(zt,this))===null||e===void 0||e.destroy(),Te(Zo,this).destroy(),Te(Ws,this).destroy(),Te(Vs,this).destroy(),_i(Zo,this,null),_i(Ws,this,null),_i(Vs,this,null),_i(zt,this,null),_i(Hi,this,null),super.destroy()}}function _ie(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Te(Hi,this)]:n=Te(Hi,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Te(zt,this).loadData(n)}function Tie(t){this.runLocalHooks("keydown",t,this),H0(Nc,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),vi(t),Te(zt,this).listen(),Te(zt,this).selectCell(0,0))}function Mie(t){const e=[];t.preventDefault(),Te(zt,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(l_(n,r)[0])}),Te(zt,this).setSourceDataAtCell(e)}function Iie(t){const e=[];t.preventDefault(),Te(zt,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(l_(n,r)[0])}),Te(zt,this).setSourceDataAtCell(e)}function Pie(t,e){const n=Pf(e);return t.map(r=>(r.checked=n(r.value),r))}function Oie(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function xie(t,e){Aie(t,e),e.add(t)}function Aie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hie(t,e,n){return(e=Nie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nie(t){var e=Die(t,"string");return typeof e=="symbol"?e:e+""}function Die(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Nh=new WeakSet;class kie extends If{constructor(e,n){super(e,{id:n.id,stateless:!1}),xie(this,Nh),Hie(this,"name",""),this.name=n.name,this.elements.push(new Kd(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Hg(Nh,this,Lie).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Hg(Nh,this,Fie).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Il){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?_n:Il},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=Ca(i,h=>h.name===Il),u={},c=this.hot.getTranslatedPhrase(rp);if(l){const h=s(r,a),d=Be(h,C=>C.value),f=new Map(h.map(C=>[C.value,this.hot.getCellMeta(C.meta.visualRow,C.meta.visualCol)])),g=lE(d);o&&(l.args[0]=o);const v=[],y=xH(g,l.args[0],c,C=>{C.checked&&v.push(C.value),Hg(Nh,this,BH).call(this,C,f)}),E=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,E).locale,u.args=[v],u.command=Ml(Il),u.itemsSnapshot=y}else u.args=[],u.command=Ml(_n);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Kd)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||M(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(rp),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=lE(r),s=xH(o,o,e,l=>{Hg(Nh,this,BH).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Be(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:mM(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function Lie(t){Nc(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),vi(t))}function BH(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Fie(t,e){switch(e.type){case"numeric":return C$(t,e);default:return t}}var AV;function $ie(t,e){Vie(t,e),e.add(t)}function Vie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wie(t,e,n){return(e=Bie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bie(t){var e=jie(t,"string");return typeof e=="symbol"?e:e+""}function jie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Uie(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jH=new WeakSet;class Xd extends If{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),$ie(this,jH),Wie(this,"name",""),this.name=n.name,this.elements.push(new wa(this.hot,{type:"button",value:PT,className:"htUIButton htUIButtonOK",identifier:Xd.BUTTON_OK})),this.elements.push(new wa(this.hot,{type:"button",value:OT,className:"htUIButton htUIButtonCancel",identifier:Xd.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){M(this.elements,e=>{e.addLocalHook("click",(n,r)=>Uie(jH,this,zie).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuActionBar"),M(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}AV=Xd;function zie(t,e){e.options.identifier===AV.BUTTON_OK?this.accept():this.cancel()}function dS(t,e,n){return(e=Yie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yie(t){var e=Gie(t,"string");return typeof e=="symbol"?e:e+""}function Gie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const UH="ConditionCollection.filteringStates";class CM{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;dS(this,"hot",void 0),dS(this,"isMapRegistrable",void 0),dS(this,"filteringStates",new bw),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(UH,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:pa;return e.length?$re(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:pa,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(st`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Pt(Yd[r]))throw new Error(st`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Ra(a,s)}]},i):u.push({name:a,args:s,func:Ra(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(UH),this.filteringStates=null,this.clearLocalHooks()}}ct(CM,xn);function zH(t,e,n){return(e=qie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qie(t){var e=Kie(t,"string");return typeof e=="symbol"?e:e+""}function Kie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HV{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];zH(this,"conditionCollection",void 0),zH(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return M(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return M(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return M(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function Xie(t,e){Zie(t,e),e.add(t)}function Zie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function el(t,e,n){return(e=Qie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qie(t){var e=Jie(t,"string");return typeof e=="symbol"?e:e+""}function Jie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ng=new WeakSet;class NV{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Xie(this,Ng),el(this,"hot",void 0),el(this,"conditionCollection",void 0),el(this,"columnDataFactory",void 0),el(this,"changes",[]),el(this,"grouping",!1),el(this,"latestEditedColumnPosition",-1),el(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>fS(Ng,this,eoe).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>fS(Ng,this,toe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>fS(Ng,this,noe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,M(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=AL(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new CM(r.hot,!1),g=[].concat(c,d);f.importAllConditions(g);const v=r.columnDataFactory(h);let y;f.isEmpty()?y=v:y=new HV(f,C=>r.columnDataFactory(C)).filter(),y=Be(y,C=>C.meta.visualRow);const E=Pf(y);return f.destroy(),Ca(v,C=>E(C.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ae(this,(e,n)=>{this[n]=null})}}function eoe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function toe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function noe(){M(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}ct(NV,xn);function roe(t){return tV({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Kd)return r;if(i.element&&!Dl(i.element))return!1;i.focus()}})}const Dh="filters";function ioe(t,e){let n=-1,r;const i=roe(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(Dh),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof Vi&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Dh),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Dh)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const v=r.getNavigator();v.getCurrentPage()>-1&&(n=v.getCurrentPage()),v.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const v=e[i.getCurrentPage()];v instanceof Gd&&(v.openOptions(),g.preventDefault()),v instanceof qd&&(v.activate(),g.preventDefault()),v instanceof Vi||g.preventDefault()}}],Dh)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(Dh)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function ooe(t,e){DV(t,e),e.add(t)}function gS(t,e,n){DV(t,e),e.set(t,n)}function DV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kh(t,e,n){return(e=soe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function soe(t){var e=aoe(t,"string");return typeof e=="symbol"?e:e+""}function aoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nm(t,e,n){return t.set(gr(t,e),n),n}function ri(t,e){return t.get(gr(t,e))}function gr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cE="filters",loe=250,YH=cE;var rs=new WeakMap,hE=new WeakMap,Rl=new WeakMap,Mr=new WeakSet;class uoe extends qe{static get PLUGIN_KEY(){return cE}static get PLUGIN_PRIORITY(){return loe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,ooe(this,Mr),kh(this,"dropdownMenuPlugin",null),kh(this,"conditionCollection",null),kh(this,"conditionUpdateObserver",null),kh(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),kh(this,"filtersRowsMap",null),gS(this,rs,void 0),gS(this,hE,new WeakSet),gS(this,Rl,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return gr(Mr,n,poe).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[cE]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Cf),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootDocument.body,i=a=>(a.addLocalHook("accept",()=>gr(Mr,this,GH).call(this,"accept")),a.addLocalHook("cancel",()=>gr(Mr,this,GH).call(this,"cancel")),a.addLocalHook("change",l=>gr(Mr,this,moe).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(ET)}:`,s=()=>`${this.hot.getTranslatedPhrase(_T)}:`;if(!this.components.get("filter_by_condition")){const a=new uE(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>gr(Mr,this,qH).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Cie(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new uE(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>gr(Mr,this,qH).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new kie(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Xd(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new CM(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new NV(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>gr(Mr,this,woe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return gr(Mr,e,goe).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>gr(Mr,this,foe).call(this)),this.addHook("afterDropdownMenuShow",()=>gr(Mr,this,hoe).call(this)),this.addHook("afterDropdownMenuHide",()=>gr(Mr,this,doe).call(this)),this.addHook("afterChange",a=>gr(Mr,this,coe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!ri(rs,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=ri(rs,this).getMenu(),c=u.getNavigator(),h=ri(rs,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];Nm(rs,this,ioe(this.dropdownMenuPlugin.menu,a));const l=u=>{ri(rs,this).listen(),u.preventDefault(),Nc(u.keyCode,"TAB")&&(u.shiftKey?ri(rs,this).toPreviousItem():ri(rs,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:YH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(YH)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:pa;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,ri(Rl,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Be(n.filter(),u=>u.meta.visualRow);const l=Pf(i);fe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),M(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),Nm(Rl,this,this.exportConditions())}else s!==!1&&!r?(Nm(Rl,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(ri(Rl,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return M(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(o,n),v=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g},value:mM(v)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=lE(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===vp&&n.command.key!==_n&&r.command.key!==_n&&i.command.key!==_n?o=wM:i.command.key!==_n&&(n.command.key===_n||r.command.key===_n)&&(o=pa),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new HV(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return M(i,s=>{M(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function coe(t){t&&M(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function hoe(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function doe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function foe(){const t=this.dropdownMenuPlugin.menu;ri(hE,this).has(t)||ri(rs,this).setMenu(t),ri(hE,this).add(t)}function goe(t){t.items.push({name:De}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function GH(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==_n&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==_n&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==_n&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function moe(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===uE&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function qH(){this.setListeningDropdownMenu()}function poe(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?q(e,"htFiltersActive"):pe(e,"htFiltersActive")}function woe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&Nm(Rl,this,ri(Rl,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===Il),s=n.filter(a=>a.name!==Il);if(o.length>=2||s.length>=3)et(st`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const kV="internal-use-in-handsontable",dE={licenseKey:kV,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function LV(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Wn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function FV(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function voe(t){var e;const n=t[Wn],r=FV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=LV(t);return{...dE,...r,...i}}function Coe(t){var e;const n=t[Wn],r=FV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=LV(t);return{...r,...i}}function yoe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function jw(){const t="engine_relationship",e=Yi(Wn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function yM(){const t="shared_engine_usage",e=Yi(Wn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function boe(t){const e=t.getSettings(),n=e[Wn],r=n==null?void 0:n.engine;if(n===!0||Pt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Soe((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Pt(r.hyperformula)){const o=jw(),s=yM().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:kV}),(r.getConfig().leapYear1900!==dE.leapYear1900||dw(r.getConfig().nullDate,dE.nullDate)===!1)&&et(st`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Soe(t,e,n){const r=e[Wn],i=voe(e),o=jw(),s=yM();Roe(t,r.functions),Eoe(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),_oe(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function KH(t){var e;const n=jw(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function XH(t,e){if(t){const n=jw(),r=n.get(t),i=yM(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Roe(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){et(s.message)}})}function Eoe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){et(r.message)}}}function _oe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){et(a.message)}}),t.resumeEvaluation())}function Toe(t,e){return(Pt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const $V="DD/MM/YYYY";function Moe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Ioe(t){return Moe(t)?t.substr(1):t}function Poe(t){return typeof t=="string"&&t.startsWith("=")}function bM(t,e){return typeof t=="string"&&e==="date"}function VV(t,e){return X(t,e,!0).isValid()}function WV(t,e){return X(t,e,!0).format($V)}function Ooe(t,e){return X(t,$V,!0).format(e)}function BV(t,e){const r=new Date(Date.UTC(0,0,t+-1));return X(r).format(e)}function xoe(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function Aoe(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function Hoe(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function SM(t,e,n){const r=Aoe(t,xoe(t,e,n));return Hoe(r)}function tl(t,e,n){Noe(t,e),e.set(t,n)}function Noe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mt(t,e){return t.get(jV(t,e))}function Bs(t,e,n){return t.set(jV(t,e),n),n}function jV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Lh=new WeakMap,js=new WeakMap,Ir=new WeakMap,Dg=new WeakMap,mS=new WeakMap,pS=new WeakMap,kg=new WeakMap;class ZH{constructor(e,n,r){tl(this,Lh,void 0),tl(this,js,void 0),tl(this,Ir,void 0),tl(this,Dg,[]),tl(this,mS,[]),tl(this,pS,void 0),tl(this,kg,[]),Bs(Lh,this,e),Bs(js,this,n),Bs(Ir,this,r)}setRemovedHfIndexes(e){return Bs(kg,this,e.map(n=>{const r=Mt(js,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Mt(kg,this)}getRemovedHfIndexes(){return Mt(kg,this)}getHfIndexFromVisualIndex(e){const n=Mt(js,this).getIndexesSequence(),r=Mt(js,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${jn(Mt(Lh,this))}s`;Mt(Ir,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&Mt(Ir,this).getEngine()[r](Mt(Ir,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(Bs(mS,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),Bs(pS,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(Mt(Ir,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=SM(Mt(mS,this),Mt(pS,this),Mt(js,this).getNumberOfIndexes());Mt(Ir,this).getSheetId()===null?Mt(Ir,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${jn(Mt(Lh,this))}Order`;return n=>{if(Mt(Ir,this).isPerformingUndoRedo())return;const r=Mt(js,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=Mt(Dg,this).map(l=>r.indexOf(l)),o=Mt(Ir,this).getEngine().getSheetDimensions(Mt(Ir,this).getSheetId());let s;Mt(Lh,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);Mt(Ir,this).getEngine()[e](Mt(Ir,this).getSheetId(),i)}Bs(Dg,this,r)}}init(){Bs(Dg,this,Mt(js,this).getIndexesSequence())}}function nl(t,e,n){Doe(t,e),e.set(t,n)}function Doe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qo(t,e){return t.get(UV(t,e))}function rl(t,e,n){return t.set(UV(t,e),n),n}function UV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Lg=new WeakMap,Fg=new WeakMap,wS=new WeakMap,vS=new WeakMap,CS=new WeakMap,yS=new WeakMap,bS=new WeakMap;class koe{constructor(e,n,r){nl(this,Lg,void 0),nl(this,Fg,void 0),nl(this,wS,void 0),nl(this,vS,!1),nl(this,CS,!1),nl(this,yS,null),nl(this,bS,null),rl(Lg,this,new ZH("row",e,this)),rl(Fg,this,new ZH("column",n,this)),rl(wS,this,r)}getForAxis(e){return e==="row"?Qo(Lg,this):Qo(Fg,this)}setPerformUndo(e){rl(vS,this,e)}setPerformRedo(e){rl(CS,this,e)}isPerformingUndoRedo(){return Qo(vS,this)||Qo(CS,this)}getSheetId(){return Qo(bS,this)}getEngine(){return Qo(yS,this)}getPostponeAction(){return Qo(wS,this)}setupSyncEndpoint(e,n){rl(yS,this,e),rl(bS,this,n),Qo(Lg,this).init(),Qo(Fg,this).init()}}function Loe(t,e){zV(t,e),e.add(t)}function il(t,e,n){return(e=Foe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Foe(t){var e=$oe(t,"string");return typeof e=="symbol"?e:e+""}function $oe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SS(t,e,n){zV(t,e),e.set(t,n)}function zV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ea(t,e,n){return t.set(Xe(t,e),n),n}function Al(t,e){return t.get(Xe(t,e))}function Xe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Wn="formulas",Voe=["maxRows","maxColumns","language"],Woe=260;re.getSingleton().register("afterNamedExpressionAdded");re.getSingleton().register("afterNamedExpressionRemoved");re.getSingleton().register("afterSheetAdded");re.getSingleton().register("afterSheetRemoved");re.getSingleton().register("afterSheetRenamed");re.getSingleton().register("afterFormulasValuesUpdate");const Vc=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var _s=new WeakMap,Uw=new WeakMap,Fh=new WeakMap,Je=new WeakSet;class Boe extends qe{constructor(){var e;super(...arguments),e=this,Loe(this,Je),SS(this,_s,!1),SS(this,Uw,!1),SS(this,Fh,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Je,e,ise).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Je,e,ose).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Je,e,sse).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Je,e,ase).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Je,e,lse).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xe(Je,e,use).call(e,...r)}]]),il(this,"staticRegister",Yi("formulas")),il(this,"engine",null),il(this,"sheetId",null),il(this,"sheetName",null),il(this,"indexSyncer",null),il(this,"rowAxisSyncer",null),il(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Wn}static get PLUGIN_PRIORITY(){return Woe}static get SETTING_KEYS(){return[Wn,...Voe]}isEnabled(){return!!this.hot.getSettings()[Wn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=boe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){et("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&Xe(Je,this,wd).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,QH).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,JH).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,QH).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,JH).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,Yoe).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,Goe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,joe).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,qoe).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,eN).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,eN).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,Koe).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,Xoe).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,Joe).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,ese).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,Zoe).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,Qoe).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,tse).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,nse).call(n,...i)}),this.indexSyncer=new koe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,zoe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,rse).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xe(Je,n,Uoe).call(n,...i)}),Al(Fh,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){Al(Fh,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),XH(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Coe(this.hot.getSettings());yoe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Wn];if(le(r)&&le(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Wn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());Xe(Je,this,wd).call(this,o)}}super.updatePlugin(e)}destroy(){Al(Fh,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Ea(Fh,this,null),XH(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(le(n)&&!_F(n))return et("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return et("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return et(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){$0(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Xe(Je,this,wd).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${jn(Wn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),KH(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return le(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(le(l)===!1||le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=KH(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){et(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return bM(r,o.type)&&(VV(r,o.dateFormat)?r=WV(r,o.dateFormat):Poe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function wd(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function joe(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Vn(s)&&(s=BV(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Uoe(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:v}=h.start,{row:y,col:E}=h.end,C=y-g+1,T=E-v+1;for(let A=0;A<f.length;A+=1)for(let F=0;F<f[A].length;F+=1){const I=f[A][F],O=g+A%C,Y=v+F%T,U=this.hot.getCellMeta(O,Y);bM(I,U.type)&&(I.startsWith("'")?f[A][F]=I.slice(1):this.isFormulaCellType(O,Y,this.sheetId)===!1&&(f[A][F]=Ooe(I,U.dateFormat)))}return f}function QH(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(jn(Wn))||Ea(Uw,this,Pt(this.hot.getSettings().data))}function zoe(){if(Al(Uw,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;bM(i,s.type)&&(VV(i,a)?t[r][o]=WV(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),Ea(_s,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Ea(_s,this,!1)}function JH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(jn(Wn)))return;const r=Toe(this.engine,this.hot.getSettings()[Wn].sheetName);if(Xe(Je,this,wd).call(this,r),n!=="updateSettings")if(Al(Uw,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Ea(_s,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),Ea(_s,this,!1)}}}function Yoe(t,e,n,r){if(r!=="get"||Al(_s,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;const o=this.getCellType(i,e);if(o==="VALUE"||o==="EMPTY"){n.value=Ioe(n.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e,{skipMetaExtension:!0});l.type==="date"&&Vn(a)&&(a=BV(a,l.dateFormat)),n.value=typeof a=="object"&&a!==null?a.value:a}function Goe(t,e,n,r){if(r!=="get"||Al(_s,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function eN(t,e){if(Vc(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function qoe(t,e){if(Vc(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Vn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){et(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Koe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Xoe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Zoe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Qoe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Joe(t,e,n){if(Vc(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function ese(t,e,n){if(Vc(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function tse(t,e,n,r){if(Vc(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function nse(t,e,n,r){if(Vc(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function rse(t,e,n){var r;Ea(_s,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Ea(_s,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function ise(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function ose(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function sse(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function ase(t){this.hot.runHooks("afterSheetAdded",t)}function lse(t,e){Xe(Je,this,wd).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function use(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function cse(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(tT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function hse(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(nT,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Be(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return M(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function dse(t,e){YV(t,e),e.add(t)}function fse(t,e,n){YV(t,e),e.set(t,n)}function YV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ol(t,e){return t.get(Zs(t,e))}function tN(t,e,n){return t.set(Zs(t,e),n),n}function Zs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeHideColumns");re.getSingleton().register("afterHideColumns");re.getSingleton().register("beforeUnhideColumns");re.getSingleton().register("afterUnhideColumns");const nN="hiddenColumns",gse=310;var to=new WeakMap,sl=new WeakSet;class mse extends qe{constructor(){super(...arguments),dse(this,sl),fse(this,to,null)}static get PLUGIN_KEY(){return nN}static get PLUGIN_PRIORITY(){return gse}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[nN]}enablePlugin(){var e=this;this.enabled||(tN(to,this,new yw),ol(to,this).addLocalHook("init",()=>Zs(sl,this,bse).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ol(to,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zs(sl,e,yse).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Zs(sl,this,wse).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>Zs(sl,this,pse).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zs(sl,e,Cse).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Zs(sl,this,vse).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=ol(to,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));M(l,u=>{o[u]=!1}),i=mn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&ol(to,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{M(e,s=>{ol(to,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Be(ol(to,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return ol(to,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){tN(to,this,null),super.destroy()}}function pse(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function wse(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function vse(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return M(t,r=>{let i=!0,o=0;fe(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Cse(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),q(e,n)}function yse(t){t.items.push({name:De},cse(this),hse(this))}function bse(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Sse(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(rT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Rse(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(iT,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Be(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return M(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Ese(t,e){GV(t,e),e.add(t)}function _se(t,e,n){GV(t,e),e.set(t,n)}function GV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function al(t,e){return t.get(Qs(t,e))}function rN(t,e,n){return t.set(Qs(t,e),n),n}function Qs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeHideRows");re.getSingleton().register("afterHideRows");re.getSingleton().register("beforeUnhideRows");re.getSingleton().register("afterUnhideRows");const iN="hiddenRows",Tse=320;var no=new WeakMap,ll=new WeakSet;class Mse extends qe{constructor(){super(...arguments),Ese(this,ll),_se(this,no,null)}static get PLUGIN_KEY(){return iN}static get PLUGIN_PRIORITY(){return Tse}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[iN]}enablePlugin(){var e=this;this.enabled||(rN(no,this,new yw),al(no,this).addLocalHook("init",()=>Qs(ll,this,Hse).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,al(no,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Qs(ll,e,Ase).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Qs(ll,this,Pse).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>Qs(ll,this,Ise).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Qs(ll,e,xse).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Qs(ll,this,Ose).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=al(no,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));M(l,u=>{o[u]=!1}),i=mn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&al(no,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{M(e,s=>{al(no,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Be(al(no,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return al(no,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){rN(no,this,null),super.destroy()}}function Ise(t,e){return this.isHidden(e)?0:t}function Pse(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Ose(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return M(t,r=>{let i=!0,o=0;fe(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function xse(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),q(e,n)}function Ase(t){t.items.push({name:De},Sse(this),Rse(this))}function Hse(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Nse(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(x_)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Dse(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(A_)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function kse(t,e){qV(t,e),e.add(t)}function Lse(t,e,n){qV(t,e),e.set(t,n)}function qV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fE(t,e){return t.get(yp(t,e))}function RS(t,e,n){return t.set(yp(t,e),n),n}function yp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeColumnFreeze");re.getSingleton().register("afterColumnFreeze");re.getSingleton().register("beforeColumnUnfreeze");re.getSingleton().register("afterColumnUnfreeze");const oN="manualColumnFreeze",Fse=110;var yl=new WeakMap,ES=new WeakSet;class $se extends qe{constructor(){super(...arguments),kse(this,ES),Lse(this,yl,!1)}static get PLUGIN_KEY(){return oN}static get PLUGIN_PRIORITY(){return Fse}isEnabled(){return!!this.hot.getSettings()[oN]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>yp(ES,this,Vse).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>yp(ES,this,Wse).call(this,e,n)),super.enablePlugin())}disablePlugin(){RS(yl,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;fE(yl,this)||RS(yl,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;fE(yl,this)||RS(yl,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Vse(t){t.items.push({name:"---------"},Nse(this),Dse(this))}function Wse(t,e){if(fE(yl,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function $g(t,e,n){return(e=Bse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bse(t){var e=jse(t,"string");return typeof e=="symbol"?e:e+""}function jse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _S=0,sN=1,aN=2,Nu="px";let KV=class{constructor(e){$g(this,"hot",void 0),$g(this,"_element",null),$g(this,"state",_S),$g(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=aN}build(){this.state===_S&&(this._element=this.hot.rootDocument.createElement("div"),this.state=sN)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=_S}isAppended(){return this.state===aN}isBuilt(){return this.state>=sN}setPosition(e,n){Vn(e)&&(this._element.style.top=e+Nu),Vn(n)&&(this._element.style[this.inlineProperty]=n+Nu)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Vn(e)&&(this._element.style.width=e+Nu),Vn(n)&&(this._element.style.height=n+Nu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Vn(e)&&(this._element.style.marginTop=e+Nu),Vn(n)&&(this._element.style[`margin${jn(this.inlineProperty)}`]=n+Nu)}getOffset(){const e=this._element.style,n=`margin${jn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Use="ht__manualColumnMove--backlight";let zse=class extends KV{build(){super.build(),q(this._element,Use)}};const Yse="ht__manualColumnMove--guideline";let Gse=class extends KV{build(){super.build(),q(this._element,Yse)}};function qse(t,e){XV(t,e),e.add(t)}function Ti(t,e,n){XV(t,e),e.set(t,n)}function XV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function br(t,e,n){return t.set(Js(t,e),n),n}function he(t,e){return t.get(Js(t,e))}function Js(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeColumnMove");re.getSingleton().register("afterColumnMove");const TS="manualColumnMove",Kse=120,lN="ht__manualColumnMove",bp="show-ui",gE="on-moving--columns",mE="after-selection--columns";var Jn=new WeakMap,na=new WeakMap,ps=new WeakMap,Dm=new WeakMap,ha=new WeakMap,Zn=new WeakMap,Vg=new WeakMap,Jr=new WeakMap,Ku=new WeakMap,Sp=new WeakMap,vd=new WeakMap,ul=new WeakSet;class Xse extends qe{constructor(){super(...arguments),qse(this,ul),Ti(this,Jn,new zse(this.hot)),Ti(this,na,new Gse(this.hot)),Ti(this,ps,[]),Ti(this,Dm,0),Ti(this,ha,!1),Ti(this,Zn,{}),Ti(this,Vg,void 0),Ti(this,Jr,void 0),Ti(this,Ku,void 0),Ti(this,Sp,void 0),Ti(this,vd,void 0)}static get PLUGIN_KEY(){return TS}static get PLUGIN_PRIORITY(){return Kse}isEnabled(){return!!this.hot.getSettings()[TS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Js(ul,e,Zse).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Js(ul,e,Jse).call(e,...r)}),this.addHook("afterScrollVertically",()=>Js(ul,this,tae).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Js(ul,e,nae).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,lN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){pe(this.hot.rootElement,lN),this.unregisterEvents(),he(Jn,this).destroy(),he(na,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=he(Vg,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(br(Vg,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return br(Vg,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=mn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[TS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return fe(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(he(Jr,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,he(Jr,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=he(Jn,this).getOffset().start,u=he(Jn,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,v=qt(this.hot.rootElement),y=g.innerWidth-he(Ku,this)-v;h=g.innerWidth-he(Zn,this).eventPageX-y-(r.scrollX===void 0?i:0)}else h=he(Zn,this).eventPageX-(he(Ku,this)-(r.scrollX===void 0?i:0));if(he(Sp,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(he(Jr,this))&&(o+=i),o+=c,he(Jr,this)<0)he(vd,this)>0?he(Zn,this).col=0:he(Zn,this).col=e>0?e-1:e;else if(he(Zn,this).TD.offsetWidth/2+o<=h){const g=he(Jr,this)>=he(Dm,this)?he(Dm,this)-1:he(Jr,this);he(Zn,this).col=g+1,o+=he(Zn,this).TD.offsetWidth}else he(Zn,this).col=he(Jr,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&he(Jr,this)<he(vd,this)&&(f-=he(Ku,this)<=r.scrollX?he(Ku,this):0),he(Jn,this).setPosition(null,d),he(na,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Js(ul,this,Qse).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Js(ul,this,eae).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){he(Jn,this).build(),he(na,this).build()}destroy(){he(Jn,this).destroy(),he(na,this).destroy(),super.destroy()}}function Zse(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=we(t.target,"sortAction");if(!s||!o||he(ha,this)||t.button!==0||a){br(ha,this,!1),he(ps,this).length=0,pe(this.hot.rootElement,[gE,bp]);return}const l=he(na,this).isBuilt()&&!he(na,this).isAppended(),u=he(Jn,this).isBuilt()&&!he(Jn,this).isAppended();l&&u&&(he(na,this).appendTo(i.hider),he(Jn,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,br(ha,this,!0);const g=n.firstChild?zL(t,n.firstChild).x:t.offsetX;he(Zn,this).eventPageX=t.pageX,br(Jr,this,e.col),he(Zn,this).TD=n,he(Zn,this).col=e.col,br(ps,this,this.prepareColumnsToMoving(d,f)),br(Sp,this,!!this.hot.getSettings().rowHeaders),br(Dm,this,this.hot.countCols()),br(vd,this,this.hot.getSettings().fixedColumnsStart),br(Ku,this,On(this.hot.rootElement).left);const v=he(Sp,this)?-1:0,y=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,E=e.col<he(vd,this),C=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),T=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),A=this.getColumnsWidth(d,e.col-1)+T,F=this.getColumnsWidth(v,d-1)+(E?C:0)+A;he(Jn,this).setPosition(y,F),he(Jn,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-y),he(Jn,this).setOffset(null,-A),q(this.hot.rootElement,gE)}else pe(this.hot.rootElement,mE),br(ha,this,!1),he(ps,this).length=0}function Qse(t){he(ha,this)&&(he(Zn,this).eventPageX=t.pageX,this.refreshPositions())}function Jse(t,e,n,r){!this.hot.getSelectedRangeLast()||!he(ha,this)||(he(ps,this).indexOf(e.col)>-1?pe(this.hot.rootElement,bp):q(this.hot.rootElement,bp),r.row=!0,r.column=!0,r.cell=!0,br(Jr,this,e.col),he(Zn,this).TD=n)}function eae(){const t=he(Zn,this).col,e=he(ps,this).length;if(br(Jr,this,void 0),br(ha,this,!1),pe(this.hot.rootElement,[gE,bp,mE]),this.hot.selection.isSelectedByColumnHeader()&&q(this.hot.rootElement,mE),e<1||t===void 0)return;const n=he(ps,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(he(ps,this),t);if(he(ps,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function tae(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;he(Jn,this).setPosition(r),he(Jn,this).setSize(null,t.hider.offsetHeight-r)}function nae(){this.moveBySettingsOrLoad()}function rae(t,e){ZV(t,e),e.add(t)}function Dn(t,e,n){ZV(t,e),e.set(t,n)}function ZV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gt(t,e,n){return t.set(Ni(t,e),n),n}function ie(t,e){return t.get(Ni(t,e))}function Ni(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Rp="manualColumnResize",iae=130,uN="manualColumnWidths";var ls=new WeakMap,Wg=new WeakMap,Lr=new WeakMap,Ep=new WeakMap,So=new WeakMap,oae=new WeakMap,dc=new WeakMap,Bg=new WeakMap,dr=new WeakMap,is=new WeakMap,Vl=new WeakMap,_p=new WeakMap,Cd=new WeakMap,yd=new WeakMap,Vr=new WeakMap,bd=new WeakMap,ro=new WeakSet;class sae extends qe{static get PLUGIN_KEY(){return Rp}static get PLUGIN_PRIORITY(){return iae}constructor(e){super(e),rae(this,ro),Dn(this,ls,null),Dn(this,Wg,null),Dn(this,Lr,[]),Dn(this,Ep,null),Dn(this,So,null),Dn(this,oae,null),Dn(this,dc,null),Dn(this,Bg,null),Dn(this,dr,this.hot.rootDocument.createElement("DIV")),Dn(this,is,this.hot.rootDocument.createElement("DIV")),Dn(this,Vl,null),Dn(this,_p,!1),Dn(this,Cd,0),Dn(this,yd,null),Dn(this,Vr,void 0),Dn(this,bd,void 0),q(ie(dr,this),"manualColumnResizer"),q(ie(is,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Rp]}enablePlugin(){var e=this;this.enabled||(Gt(Vr,this,new Ia),ie(Vr,this).addLocalHook("init",()=>Ni(ro,this,aae).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ie(Vr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ni(ro,e,fae).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ni(ro,e,gae).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ni(ro,e,mae).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Gt(bd,this,ie(Vr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",uN,ie(Vr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",uN,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return ie(Vr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ie(Vr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Gt(ls,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(ie(ls,this)),i=r.col;if(i<0)return;const o=en(ie(ls,this)),s=ie(ls,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ie(ls,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ie(ls,this),r.row,r.col)),Gt(Wg,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Gt(Lr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();M(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;fe(d,f,g=>{ie(Lr,this).includes(g)||ie(Lr,this).push(g)})})}ie(Lr,this).includes(ie(Wg,this))||Gt(Lr,this,[ie(Wg,this)]),Gt(Bg,this,l.start-6),Gt(dc,this,parseInt(s.width,10)),ie(dr,this).style.top=`${l.top}px`,ie(dr,this).style[this.inlineDir]=`${ie(Bg,this)+ie(dc,this)}px`,ie(dr,this).style.height=`${o}px`,this.hot.rootElement.appendChild(ie(dr,this))}refreshHandlePosition(){ie(dr,this).style[this.inlineDir]=`${ie(Bg,this)+ie(Ep,this)}px`}setupGuidePosition(){const e=parseInt(en(ie(dr,this)),10),n=parseInt(ie(dr,this).style.top,10)+e,r=this.hot.view.getTableHeight();q(ie(dr,this),"active"),q(ie(is,this),"active"),ie(is,this).style.top=`${n}px`,this.refreshGuidePosition(),ie(is,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(ie(is,this))}refreshGuidePosition(){ie(is,this).style[this.inlineDir]=ie(dr,this).style[this.inlineDir]}hideHandleAndGuide(){pe(ie(dr,this),"active"),pe(ie(is,this),"active")}checkIfColumnHeader(e){const n=ya(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",ie(So,this),r,!0);o!==void 0&&Gt(So,this,o),this.setManualSize(r,ie(So,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ie(So,this),r,!0),i&&e()};ie(Cd,this)>=2&&(ie(Lr,this).length>1?(M(ie(Lr,this),i=>{n(i)}),e()):M(ie(Lr,this),i=>{n(i,!0)})),Gt(Cd,this,0),Gt(yd,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Ni(ro,this,lae).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Ni(ro,this,uae).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Ni(ro,this,cae).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Ni(ro,this,hae).call(this)),this.eventManager.addEventListener(ie(dr,this),"contextmenu",()=>Ni(ro,this,dae).call(this))}destroy(){super.destroy()}}function aae(){const t=this.hot.getSettings()[Rp],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{ie(Vr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{ie(Vr,this).setValueAtIndex(r,n)})},!0),Gt(bd,this,t)):t===!0&&Array.isArray(ie(bd,this))&&this.hot.batchExecution(()=>{ie(bd,this).forEach((n,r)=>{ie(Vr,this).setValueAtIndex(r,n)})},!0)}function lae(t){if(!O0(t.target)&&ie(_p,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ie(Vl,this)||this.setupHandlePosition(e))}}function uae(t){t.target.parentNode===this.hot.rootElement&&we(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ie(ls,this)),this.setupGuidePosition(),Gt(Vl,this,!0),ie(yd,this)===null&&(Gt(yd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ie(yd,this))),Gt(Cd,this,ie(Cd,this)+1),this.startX=t.pageX,Gt(So,this,ie(dc,this)))}function cae(t){if(ie(Vl,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Gt(Ep,this,ie(dc,this)+e),M(ie(Lr,this),n=>{Gt(So,this,this.setManualSize(n,ie(Ep,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function hae(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",ie(So,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ie(So,this),n,!1)};ie(Vl,this)&&(this.hideHandleAndGuide(),Gt(Vl,this,!1),ie(So,this)!==ie(dc,this)&&(ie(Lr,this).length>1?(M(ie(Lr,this),r=>{e(r)}),t()):M(ie(Lr,this),r=>{e(r,!0)})),this.setupHandlePosition(ie(ls,this)))}function dae(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ie(dr,this)),this.hot.rootElement.removeChild(ie(is,this)),Gt(Vl,this,!1),Gt(_p,this,!0),this.hot._registerImmediate(()=>{Gt(_p,this,!1)})}function fae(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=ie(Vr,this).getValueAtIndex(r);this.hot.getSettings()[Rp]&&i&&(n=i)}return n}function gae(t,e){const n=ie(Vr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function mae(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function MS(t,e,n){return(e=pae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pae(t){var e=wae(t,"string");return typeof e=="symbol"?e:e+""}function wae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const IS=0,cN=1,hN=2,Du="px";let QV=class{constructor(e){MS(this,"hot",void 0),MS(this,"_element",null),MS(this,"state",IS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=hN}build(){this.state===IS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=cN)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=IS}isAppended(){return this.state===hN}isBuilt(){return this.state>=cN}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Du),n!==void 0&&(this._element.style.left=n+Du)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Du),n&&(this._element.style.height=n+Du)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Du),n&&(this._element.style.marginLeft=n+Du)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const vae="ht__manualRowMove--backlight";class Cae extends QV{build(){super.build(),q(this._element,vae)}}const yae="ht__manualRowMove--guideline";class bae extends QV{build(){super.build(),q(this._element,yae)}}function Sae(t,e){JV(t,e),e.add(t)}function ku(t,e,n){JV(t,e),e.set(t,n)}function JV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pl(t,e,n){return t.set(ea(t,e),n),n}function _e(t,e){return t.get(ea(t,e))}function ea(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeRowMove");re.getSingleton().register("afterRowMove");const PS="manualRowMove",Rae=140,dN="ht__manualRowMove",Tp="show-ui",pE="on-moving--rows",wE="after-selection--rows";var er=new WeakMap,ra=new WeakMap,ws=new WeakMap,da=new WeakMap,Sr=new WeakMap,jg=new WeakMap,cl=new WeakSet;class Eae extends qe{constructor(){super(...arguments),Sae(this,cl),ku(this,er,new Cae(this.hot)),ku(this,ra,new bae(this.hot)),ku(this,ws,[]),ku(this,da,void 0),ku(this,Sr,{}),ku(this,jg,void 0)}static get PLUGIN_KEY(){return PS}static get PLUGIN_PRIORITY(){return Rae}isEnabled(){return!!this.hot.getSettings()[PS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ea(cl,e,_ae).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ea(cl,e,Mae).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>ea(cl,this,Pae).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ea(cl,e,Oae).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,dN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){pe(this.hot.rootElement,dN),this.unregisterEvents(),_e(er,this).destroy(),_e(ra,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=_e(jg,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(Pl(jg,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return Pl(jg,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=mn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.view.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[PS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return fe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=_e(Sr,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=_e(Sr,this).TD,a=this.hot.rootElement,l=On(a),u=mc(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=_e(Sr,this).eventPageY-d+c,g=o.hider.offsetHeight,v=o.TBODY.offsetTop,y=_e(er,this).getOffset().top,E=_e(er,this).getSize().height,C=s.offsetHeight/2,T=s.offsetHeight;let A=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const F=f>=A+C;this.isFixedRowTop(e.row)&&(A+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?_e(Sr,this).row=n>0?n-1:n:F?(_e(Sr,this).row=e.row+1,A+=e.row===0?T-1:T):_e(Sr,this).row=e.row;let I=f,O=A;f+E+y>=g?I=g-E-y:f+y<v&&(I=v+Math.abs(y)),A>=g-1&&(O=g-1),_e(er,this).setPosition(I),_e(ra,this).setPosition(O)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ea(cl,this,Tae).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ea(cl,this,Iae).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_e(er,this).build(),_e(ra,this).build()}destroy(){_e(er,this).destroy(),_e(ra,this).destroy(),super.destroy()}}function _ae(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||_e(da,this)||t.button!==0){Pl(da,this,!1),_e(ws,this).length=0,pe(this.hot.rootElement,[pE,Tp]);return}const l=_e(ra,this).isBuilt()&&!_e(ra,this).isAppended(),u=_e(er,this).isBuilt()&&!_e(er,this).isAppended();l&&u&&(_e(ra,this).appendTo(i.hider),_e(er,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,Pl(da,this,!0),_e(Sr,this).eventPageY=t.pageY,_e(Sr,this).coords=e,_e(Sr,this).TD=n,Pl(ws,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+o.getRowHeaderWidth(),v=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);_e(er,this).setPosition(null,g),_e(er,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(d,f)),_e(er,this).setOffset(-v,null),q(this.hot.rootElement,pE),this.refreshPositions()}else pe(this.hot.rootElement,wE),Pl(da,this,!1),_e(ws,this).length=0}function Tae(t){_e(da,this)&&(_e(Sr,this).eventPageY=t.pageY,this.refreshPositions())}function Mae(t,e,n,r){!this.hot.getSelectedRangeLast()||!_e(da,this)||(_e(ws,this).indexOf(e.row)>-1?pe(this.hot.rootElement,Tp):q(this.hot.rootElement,Tp),r.row=!0,r.column=!0,r.cell=!0,_e(Sr,this).coords=e,_e(Sr,this).TD=n)}function Iae(){const t=_e(Sr,this).row,e=_e(ws,this).length;if(Pl(da,this,!1),pe(this.hot.rootElement,[pE,Tp,wE]),this.hot.selection.isSelectedByRowHeader()&&q(this.hot.rootElement,wE),e<1||t===void 0)return;const n=_e(ws,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(_e(ws,this),t);if(_e(ws,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function Pae(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;_e(er,this).setPosition(null,r),_e(er,this).setSize(t.hider.offsetWidth-r)}function Oae(){this.moveBySettingsOrLoad()}function xae(t,e){eW(t,e),e.add(t)}function kn(t,e,n){eW(t,e),e.set(t,n)}function eW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ft(t,e,n){return t.set(us(t,e),n),n}function ne(t,e){return t.get(us(t,e))}function us(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Mp="manualRowResize",Aae=30,fN="manualRowHeights";var mo=new WeakMap,Ug=new WeakMap,Fr=new WeakMap,Sd=new WeakMap,ia=new WeakMap,RM=new WeakMap,fc=new WeakMap,zg=new WeakMap,Kn=new WeakMap,ho=new WeakMap,Wl=new WeakMap,Ip=new WeakMap,Rd=new WeakMap,Ed=new WeakMap,Li=new WeakMap,_d=new WeakMap,Us=new WeakSet;class Hae extends qe{static get PLUGIN_KEY(){return Mp}static get PLUGIN_PRIORITY(){return Aae}constructor(e){super(e),xae(this,Us),kn(this,mo,null),kn(this,Ug,null),kn(this,Fr,[]),kn(this,Sd,null),kn(this,ia,null),kn(this,RM,null),kn(this,fc,null),kn(this,zg,null),kn(this,Kn,this.hot.rootDocument.createElement("DIV")),kn(this,ho,this.hot.rootDocument.createElement("DIV")),kn(this,Wl,!1),kn(this,Ip,!1),kn(this,Rd,0),kn(this,Ed,null),kn(this,Li,void 0),kn(this,_d,void 0),q(ne(Kn,this),"manualRowResizer"),q(ne(ho,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Mp]}enablePlugin(){this.enabled||(Ft(Li,this,new Ia),ne(Li,this).addLocalHook("init",()=>us(Us,this,Vae).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ne(Li,this)),this.addHook("modifyRowHeight",(e,n)=>us(Us,this,$ae).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Ft(_d,this,ne(Li,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",fN,ne(Li,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",fN,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.view.getDefaultRowHeight());return ne(Li,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return ne(Sd,this)}setupHandlePosition(e){Ft(mo,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ne(mo,this)),o=i.row;if(o<0)return;const s=qt(ne(mo,this)),a=ne(mo,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ne(mo,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ne(mo,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ne(mo,this),i.row,i.col)),Ft(Ug,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Ft(Fr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();M(d,f=>{const g=f.getTopStartCorner().row,v=f.getBottomStartCorner().row;fe(g,v,y=>{ne(Fr,this).includes(y)||ne(Fr,this).push(y)})})}ne(Fr,this).includes(ne(Ug,this))||Ft(Fr,this,[ne(Ug,this)]),Ft(zg,this,c.top-6),Ft(fc,this,parseInt(a.height,10)),ne(Kn,this).style.top=`${ne(zg,this)+ne(fc,this)}px`,ne(Kn,this).style[this.inlineDir]=`${c.start}px`,ne(Kn,this).style.width=`${s}px`,this.hot.rootElement.appendChild(ne(Kn,this))}refreshHandlePosition(){ne(Kn,this).style.top=`${ne(zg,this)+ne(Sd,this)}px`}setupGuidePosition(){const e=parseInt(qt(ne(Kn,this)),10),n=parseInt(ne(Kn,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();q(ne(Kn,this),"active"),q(ne(ho,this),"active"),ne(ho,this).style.top=ne(Kn,this).style.top,ne(ho,this).style[this.inlineDir]=`${n}px`,ne(ho,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ne(ho,this))}refreshGuidePosition(){ne(ho,this).style.top=ne(Kn,this).style.top}hideHandleAndGuide(){pe(ne(Kn,this),"active"),pe(ne(ho,this),"active")}checkIfRowHeader(e){const n=ya(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ne(ia,this)<n?n:ne(ia,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Ft(ia,this,o),this.setManualSize(r,ne(ia,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ne(Rd,this)>=2&&(ne(Fr,this).length>1?(M(ne(Fr,this),i=>{n(i)}),e()):M(ne(Fr,this),i=>{n(i,!0)})),Ft(Rd,this,0),Ft(Ed,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>us(Us,this,Nae).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>us(Us,this,Dae).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>us(Us,this,kae).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>us(Us,this,Lae).call(this)),this.eventManager.addEventListener(ne(Kn,this),"contextmenu",()=>us(Us,this,Fae).call(this))}destroy(){super.destroy()}}function Nae(t){if(!O0(t.target)&&ne(Ip,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ne(Wl,this)||this.setupHandlePosition(e))}}function Dae(t){we(t.target,"manualRowResizer")&&(this.setupHandlePosition(ne(mo,this)),this.setupGuidePosition(),Ft(Wl,this,!0),ne(Ed,this)===null&&(Ft(Ed,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ne(Ed,this))),Ft(Rd,this,ne(Rd,this)+1),Ft(RM,this,t.pageY),Ft(ia,this,ne(fc,this)))}function kae(t){ne(Wl,this)&&(Ft(Sd,this,ne(fc,this)+(t.pageY-ne(RM,this))),M(ne(Fr,this),e=>{Ft(ia,this,this.setManualSize(e,ne(Sd,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Lae(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ne(Wl,this)&&(this.hideHandleAndGuide(),Ft(Wl,this,!1),ne(ia,this)!==ne(fc,this)&&(ne(Fr,this).length>1?(M(ne(Fr,this),r=>{e(r)}),t()):M(ne(Fr,this),r=>{e(r,!0)})),this.setupHandlePosition(ne(mo,this)))}function Fae(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ne(Kn,this)),this.hot.rootElement.removeChild(ne(ho,this)),Ft(Wl,this,!1),Ft(Ip,this,!0),this.hot._registerImmediate(()=>{Ft(Ip,this,!1)})}function $ae(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ne(Li,this).getValueAtIndex(r);this.hot.getSettings()[Mp]&&i&&(n=i)}return n}function Vae(){const t=this.hot.getSettings()[Mp],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ne(Li,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ne(Li,this).setValueAtIndex(r,n)}),Ft(_d,this,t)):t===!0&&Array.isArray(ne(_d,this))&&ne(_d,this).forEach((n,r)=>{ne(Li,this).setValueAtIndex(r,n)})},!0)}var gN={},mN;function Wae(){if(mN)return gN;mN=1;var t=mw();return t("flatMap"),gN}Wae();var pN={},wN={},OS,vN;function Bae(){if(vN)return OS;vN=1;var t=dn(),e=gn(),n=Ao(),r=UE();return OS=function(i,o){(!o||typeof i!="string")&&e(i);var s=r(i);return n(e(s!==void 0?t(s,i):i))},OS}var CN;function jae(){if(CN)return wN;CN=1;var t=wt(),e=dn(),n=Er(),r=gn(),i=Ao(),o=Bae(),s=GE(),a=_r(),l=_a(),u=qE(),c=Ma(),h=!l&&!u("flatMap",function(){}),d=!l&&!h&&c("flatMap",TypeError),f=l||h||d,g=s(function(){for(var v=this.iterator,y=this.mapper,E,C;;){if(C=this.inner)try{if(E=r(e(C.next,C.iterator)),!E.done)return E.value;this.inner=null}catch(T){a(v,"throw",T)}if(E=r(e(this.next,v)),this.done=!!E.done)return;try{this.inner=o(y(E.value,this.counter++),!1)}catch(T){a(v,"throw",T)}}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{flatMap:function(y){r(this);try{n(y)}catch(E){a(this,"throw",E)}return d?e(d,this,y):new g(i(this),{mapper:y,inner:null})}}),wN}var yN;function Uae(){return yN||(yN=1,jae()),pN}Uae();function zae(t,e,n){Yae(t,e),e.set(t,n)}function Yae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hl(t,e,n){return(e=Gae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gae(t){var e=qae(t,"string");return typeof e=="symbol"?e:e+""}function qae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bN(t,e){return t.get(tW(t,e))}function Yg(t,e,n){return t.set(tW(t,e),n),n}function tW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dl=new WeakMap;class po{constructor(e,n,r,i,o,s){hl(this,"row",void 0),hl(this,"col",void 0),hl(this,"rowspan",void 0),hl(this,"colspan",void 0),hl(this,"removed",!1),hl(this,"cellCoordsFactory",void 0),hl(this,"cellRangeFactory",void 0),zae(this,dl,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return st`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return st`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return st`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return st`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),Yg(dl,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,Yg(dl,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return Yg(dl,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return bN(dl,this)||Yg(dl,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),bN(dl,this)}}function Kae(t,e){Xae(t,e),e.add(t)}function Xae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gg(t,e,n){return(e=Zae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zae(t){var e=Qae(t,"string");return typeof e=="symbol"?e:e+""}function Qae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zs=new WeakSet;class Pp{constructor(e){Kae(this,zs),Gg(this,"plugin",void 0),Gg(this,"mergedCells",[]),Gg(this,"mergedCellsMatrix",new Map),Gg(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return st`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){et(Pp.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new po(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),fl(zs,this,SN).call(this,a),a):(u&&et(Pp.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),fl(zs,this,Jae).call(this,r),r):!1}clear(){M(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;fe(n,n+i,s=>{fe(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=ze(u,i,i+s-1),d=ze(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=fl(zs,this,qg).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=fl(zs,this,qg).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=fl(zs,this,qg).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=fl(zs,this,qg).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{fl(zs,this,SN).call(this,s)})}}function qg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function SN(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function Jae(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function xS(t,e,n){return(e=ele(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ele(t){var e=tle(t,"string");return typeof e=="symbol"?e:e+""}function tle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nle{constructor(e){xS(this,"plugin",void 0),xS(this,"mergedCellsCollection",void 0),xS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,g=s-f,v=this.getFarthestCollection(e,n,r,i);if(v){if(r==="down"){const y=v.row+v.rowspan-a-g;o[2]+y>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?y:0}else if(r==="right"){const y=v.col+v.colspan-l-g;o[3]+y>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?y:0}else if(r==="up"){const y=u-g-v.row+1;o[0]+y<0?o[0]+=g:o[0]-=g?y:0}else if(r==="left"){const y=c-g-v.col+1;o[1]+y<0?o[1]+=g:o[1]-=g?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),tn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,g=Math.floor(d/f)*f,v=d-g;let y=null,E=null,C=null;switch(r){case"up":y="includesVertically",C=c-v+1;break;case"left":y="includesHorizontally",C=c-v+1;break;case"down":y="includesVertically",C=h+v-1;break;case"right":y="includesHorizontally",C=h+v-1;break}return M(i,T=>{T[y](C)&&T.isFarther(E,r)&&(E=T)}),E}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return M(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(g=>{let{colspan:v}=g;return v===h.getWidth()}):!f.every(g=>{let{rowspan:v}=g;return v===h.getHeight()})}}function AS(t,e,n){return(e=rle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rle(t){var e=ile(t,"string");return typeof e=="symbol"?e:e+""}function ile(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ole{constructor(e){AS(this,"plugin",void 0),AS(this,"hot",void 0),AS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function sle(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(N_)}return this.getTranslatedPhrase(H_)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?po.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Td(t,e,n){return(e=ale(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ale(t){var e=lle(t,"string");return typeof e=="symbol"?e:e+""}function lle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RN{constructor(e){Td(this,"data",void 0),Td(this,"next",null),Td(this,"prev",null),this.data=e}}class Kg{constructor(){Td(this,"first",null),Td(this,"last",null)}push(e){const n=new RN(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new RN(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function ule(t,e){nW(t,e),e.add(t)}function gl(t,e,n){nW(t,e),e.set(t,n)}function nW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function it(t,e){return t.get(Op(t,e))}function Pr(t,e,n){return t.set(Op(t,e),n),n}function Op(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var io=new WeakMap,oo=new WeakMap,so=new WeakMap,ao=new WeakMap,vE=new WeakMap,Xg=new WeakMap,Zg=new WeakMap,HS=new WeakSet;class cle{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;ule(this,HS),gl(this,io,new Kg),gl(this,oo,new Kg),gl(this,so,null),gl(this,ao,null),gl(this,vE,null),gl(this,Xg,null),gl(this,Zg,null),Pr(vE,this,n),Pr(Xg,this,r),Pr(Zg,this,i)}getCurrentVerticalNode(){return it(ao,this).data}getFirstVerticalNode(){return it(oo,this).first.data}getNextVerticalNode(){return it(ao,this).next.data}getPrevVerticalNode(){return it(ao,this).prev.data}getCurrentHorizontalNode(){return it(so,this).data}getFirstHorizontalNode(){return it(io,this).first.data}getNextHorizontalNode(){return it(so,this).next.data}getPrevHorizontalNode(){return it(so,this).prev.data}setPrevNodeAsActive(){Pr(ao,this,it(ao,this).prev),Pr(so,this,it(so,this).prev)}setNextNodeAsActive(){Pr(ao,this,it(ao,this).next),Pr(so,this,it(so,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;Pr(io,this,new Kg);for(let s=n.row;s<=r.row;s++)if(!it(Xg,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(it(Zg,this).isHidden(a))continue;const l=Op(HS,this,EN).call(this,e,it(io,this),i,s,a);l&&Pr(so,this,l)}it(io,this).first&&(it(io,this).first.prev=it(io,this).last,it(io,this).last.next=it(io,this).first);const o=new WeakSet;Pr(oo,this,new Kg);for(let s=n.col;s<=r.col;s++)if(!it(Zg,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(it(Xg,this).isHidden(a))continue;const l=Op(HS,this,EN).call(this,e,it(oo,this),o,a,s);l&&Pr(ao,this,l)}it(oo,this).first&&(it(oo,this).first.prev=it(oo,this).last,it(oo,this).last.next=it(oo,this).first)}setActiveNode(e,n){return it(io,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Pr(so,this,r),!1}),it(oo,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Pr(ao,this,r),!1}),this}}function EN(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=it(vE,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function rW(t,e,n){const{view:r,rowIndexMapper:i}=t,o=r.getStylesHandler(),s=r.getDefaultRowHeight();let a=0;for(let u=e;u<e+n;u++)if(!i.isHidden(u)){var l;a+=(l=t.getRowHeight(u))!==null&&l!==void 0?l:s,u===0&&!o.isClassicTheme()&&(a+=1)}return a}function hle(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!xe(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),Fd()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=c,[v,y]=t.translateMergedCellToRenderable(h,g,d,f),E=t.getSetting("virtualized");if(Fd()&&d===0&&!e.getSettings().rowHeaders){const W=rW(e,h,g);i.set(l,W/g)}const C=n.getRenderableFromVisualIndex(l),T=r.getRenderableFromVisualIndex(u),A=v-C+1,F=y-T+1;let I=n.getNearestNotHiddenIndex(h,1),O=r.getNearestNotHiddenIndex(d,1);if(E){const W=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(W)||(I=Math.max(I,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(W)||(O=Math.max(O,e.getFirstRenderedVisibleColumn()))}const Y=Math.min(g,A),U=Math.min(f,F);I===l&&O===u?(a.setAttribute("rowspan",Y),a.setAttribute("colspan",U)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function dle(t,e){iW(t,e),e.add(t)}function Qg(t,e,n){iW(t,e),e.set(t,n)}function iW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NS(t,e,n){return(e=fle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fle(t){var e=gle(t,"string");return typeof e=="symbol"?e:e+""}function gle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zd(t,e,n){return t.set(at(t,e),n),n}function pt(t,e){return t.get(at(t,e))}function at(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeMergeCells");re.getSingleton().register("afterMergeCells");re.getSingleton().register("beforeUnmergeCells");re.getSingleton().register("afterUnmergeCells");const CE="mergeCells",mle=150,_N=CE;var si=new WeakMap,ai=new WeakMap,Ro=new WeakMap,TN=new WeakMap,dt=new WeakSet;class ple extends qe{constructor(){super(...arguments),dle(this,dt),NS(this,"mergedCellsCollection",null),NS(this,"autofillCalculations",null),NS(this,"selectionCalculations",null),Qg(this,si,null),Qg(this,ai,{row:0,col:0}),Qg(this,Ro,new cle({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Qg(this,TN,hle(this))}static get PLUGIN_KEY(){return CE}static get PLUGIN_PRIORITY(){return mle}static get DEFAULT_SETTINGS(){return{[E$]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[CE]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Pp(this),this.autofillCalculations=new nle(this),this.selectionCalculations=new ole(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,wle).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Cle).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,yle).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,ble).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Sle).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,IN).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,IN).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Ele).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,_le).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Tle).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,MN).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,MN).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,vle).call(e,...r)}),this.addHook("afterRenderer",function(){return pt(TN,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Rle).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Mle).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Ile).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Ple).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Ole).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,xle).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Ale).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Hle).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Nle).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Dle).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,kle).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Lle).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Fle).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,$le).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return at(dt,e,Vle).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!D0())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Dd(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=Dd(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?po.containsNegativeValues(e)?(et(po.NEGATIVE_VALUES_WARNING(e)),!1):po.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(et(po.IS_OUT_OF_BOUNDS_WARNING(e)),!1):po.isSingleCell(e)?(et(po.IS_SINGLE_CELL(e)),!1):po.containsZeroSpan(e)?(et(po.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),fe(0,s.rowspan-1,c=>{fe(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),M(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),fe(0,i.rowspan-1,o=>{fe(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:_N})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_N)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(xe(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(xe(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(xe(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(xe(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function wle(){this.generateFromSettings(),this.hot.render()}function vle(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function Cle(t){pt(ai,this).row=t.row,pt(ai,this).col=t.col}function yle(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;pt(si,this)&&(i.getRenderableFromVisualIndex(pt(si,this).row)!==null&&(n.row=pt(si,this).row),r.getRenderableFromVisualIndex(pt(si,this).col)!==null&&(n.col=pt(si,this).col),Zd(si,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function ble(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function Sle(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Zd(si,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Zd(si,this,e.clone()),n&&e.assign(n)}function MN(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),v=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[ze(g,u,h),ze(v,c,d),ze(this.hot.getLastRenderedVisibleRow(),u,h),ze(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function Rle(t){t.items.push({name:"---------"},sle(this))}function IN(){Zd(si,this,null)}function Ele(){if(pt(si,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=pt(si,this).clone().normalize();pt(Ro,this).setActiveNode(r.row,r.col),pt(ai,this).row>0||pt(ai,this).col>0?pt(Ro,this).setPrevNodeAsActive():(n==="E-W"&&pt(ai,this).col<0||e==="S-N"&&pt(ai,this).row<0)&&pt(Ro,this).setNextNodeAsActive()}function _le(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(pt(ai,this).col<0){const{rowEnd:a,colEnd:l}=pt(Ro,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(pt(ai,this).col>0){const{rowStart:a,colStart:l}=pt(Ro,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(pt(ai,this).row<0){const{rowEnd:a,colEnd:l}=pt(Ro,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(pt(ai,this).row>0){const{rowStart:a,colStart:l}=pt(Ro,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}pt(Ro,this).setActiveNode(t,e),Zd(ai,this,{row:0,col:0})}function Tle(){this.hot.getSelectedRangeLast().isHeader()||pt(Ro,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function Mle(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Ile(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Ple(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Ole(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function xle(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Ale(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Hle(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Nle(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Dle(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function kle(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);M(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function Lle(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Fle(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function $le(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function Vle(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,rW(this.hot,e,g))}),t}function Wle(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:N$(u.type))(l,u,d)(c,h);if(g===To){const v=a+1;if(typeof e[v]<"u")return s(v)}return g}(0)}}const oW="sort";function Ble(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${oW}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function jle(t){const e=t.className.split(" "),n=new RegExp(`^${oW}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function Ule(t,e,n){return(e=zle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zle(t){var e=Yle(t,"string");return typeof e=="symbol"?e:e+""}function Yle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const xp="multiColumnSorting",Gle=170,PN=xp;H$(xp,Wle);class qle extends j${constructor(){super(...arguments),Ule(this,"pluginKey",xp)}static get PLUGIN_KEY(){return xp}static get PLUGIN_PRIORITY(){return Gle}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,dp)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:Pa,position:"before",group:PN})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(PN)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),pe(e,jle(e)),this.enabled!==!1&&q(e,Ble(...r))}onAfterOnCellMouseDown(e,n){uM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,dp))):this.sort(this.getColumnNextConfig(n.col)))}}function ON(t,e,n){return(e=Kle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kle(t){var e=Xle(t,"string");return typeof e=="symbol"?e:e+""}function Xle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Zle="multipleSelectionHandles",Qle=160;class Jle extends qe{constructor(){super(...arguments),ON(this,"dragged",[]),ON(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Zle}static get PLUGIN_PRIORITY(){return Qle}isEnabled(){return Eo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(we(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(we(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(we(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(we(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function yE(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function sW(){return{label:"",isPlaceholder:!0}}function eue(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;M(t,i=>{const o=[];let s=0;n.push(o),M(i,a=>{const l=yE();if(xe(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=bt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=bt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(sW());return!u})});const r=Math.max(...Be(n,i=>i.length));return M(n,i=>{if(i.length<r){const o=Be(new Array(r-i.length),()=>yE());i.splice(i.length,0,...o)}}),n}function DS(t,e,n){tue(t,e),e.set(t,n)}function tue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mi(t,e){return t.get(aW(t,e))}function $h(t,e,n){return t.set(aW(t,e),n),n}function aW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const xN=["label","collapsible"];var Jo=new WeakMap,ml=new WeakMap,kS=new WeakMap;class nue{constructor(){DS(this,Jo,[]),DS(this,ml,0),DS(this,kS,1/0)}setColumnsLimit(e){$h(kS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];$h(Jo,this,eue(e,Mi(kS,this))),$h(ml,this,Mi(Jo,this).length)}getData(){return Mi(Jo,this)}mergeWith(e){M(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&tn(s,o,xN)})}map(e){M(Mi(Jo,this),n=>{M(n,r=>{const i=e({...r});xe(i)&&tn(r,i,xN)})})}getHeaderSettings(e,n){var r;if(e>=Mi(ml,this)||e<0)return null;const i=Mi(Jo,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Mi(ml,this)||e<0)return i;const o=Mi(Jo,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Mi(ml,this)}getColumnsCount(){return Mi(ml,this)>0?Mi(Jo,this)[0].length:0}clear(){$h(Jo,this,[]),$h(ml,this,0)}}function LS(t,e,n){return(e=rue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rue(t){var e=iue(t,"string");return typeof e=="symbol"?e:e+""}function iue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const lW="DF-pre-order";function uW(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=uW.call(this.childs[r],t,e)}return n}const oue="DF-post-order";function cW(t,e){for(let n=0;n<this.childs.length;n++)if(cW.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const hW="BF";function sue(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const aue=hW,AN=new Map([[lW,uW],[oue,cW],[hW,sue]]);class Ap{constructor(e){LS(this,"data",{}),LS(this,"parent",null),LS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new Ap({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:aue;if(!AN.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);AN.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function FS(t,e,n){lue(t,e),e.set(t,n)}function lue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qn(t,e){return t.get(dW(t,e))}function uue(t,e,n){return t.set(dW(t,e),n),n}function dW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Lu=new WeakMap,pl=new WeakMap,Fu=new WeakMap;class cue{constructor(e){FS(this,Lu,new Map),FS(this,pl,new Map),FS(this,Fu,null),uue(Fu,this,e)}getRoots(){return Array.from(qn(Lu,this).values())}getRootByColumn(e){let n;return qn(pl,this).has(e)&&(n=qn(Lu,this).get(qn(pl,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-qn(pl,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;qn(pl,this).clear(),M(qn(Lu,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)qn(pl,this).set(i,e);e+=r})}buildTree(){this.clear();const e=qn(Fu,this).getColumnsCount();let n=0;for(;n<e;){const r=qn(Fu,this).getHeaderSettings(0,n),i=new Ap;qn(Lu,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=qn(Fu,this).getHeadersSettings(r,n,i);r+=1,M(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new Ap(a),e.addChild(l)),r<qn(Fu,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){qn(Lu,this).clear(),qn(pl,this).clear()}}function fW(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function Hp(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function Np(t){return Hp(t,"origColspan")===t.data.origColspan}function EM(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Np(t))return EM(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)M(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,fW(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Np(a)&&(l.isCollapsed=Hp(a,"isCollapsed"))}),{rollbackModification:()=>_M(t),affectedColumns:Array.from(o),colspanCompensation:s}}function _M(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Np(t))return _M(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)M(o,l=>{fW(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=Hp(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Np(l)&&(u.isCollapsed=Hp(l,"isCollapsed"))}),{rollbackModification:()=>EM(t),affectedColumns:Array.from(s),colspanCompensation:a}}function hue(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(st`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function due(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(st`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const HN=new Map([["collapse",_M],["expand",EM],["hide-column",hue],["show-column",due]]);function fue(t,e,n){if(!HN.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return HN.get(t)(e,n)}function Jg(t){const e=[];return M(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=mue(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(sW());else{const f=gue(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function gue(t){const{crossHiddenColumns:e,...n}=yE(t);return n}function mue(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function $S(t,e,n){pue(t,e),e.set(t,n)}function pue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vh(t,e,n){return t.set(gW(t,e),n),n}function Dt(t,e){return t.get(gW(t,e))}function gW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lo=new WeakMap,cr=new WeakMap,wl=new WeakMap;class wue{constructor(){$S(this,lo,new nue),$S(this,cr,new cue(Dt(lo,this))),$S(this,wl,[[]])}setState(e){Dt(lo,this).setData(e);let n=!1;try{Dt(cr,this).buildTree()}catch{Dt(cr,this).clear(),Dt(lo,this).clear(),n=!0}return Vh(wl,this,Jg(Dt(cr,this).getRoots())),n}setColumnsLimit(e){Dt(lo,this).setColumnsLimit(e)}mergeStateWith(e){const n=Be(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Dt(lo,this).mergeWith(n),Dt(cr,this).buildTree(),Vh(wl,this,Jg(Dt(cr,this).getRoots()))}mapState(e){Dt(lo,this).map(e),Dt(cr,this).buildTree(),Vh(wl,this,Jg(Dt(cr,this).getRoots()))}mapNodes(e){return mn(Dt(cr,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Dt(cr,this).getNode(n,r);let o;return i&&(o=fue(e,i,r),Vh(wl,this,Jg(Dt(cr,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Dt(wl,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Dt(cr,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=Dt(cr,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},lW)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Dt(lo,this).getLayersCount()}getColumnsCount(){return Dt(lo,this).getColumnsCount()}clear(){Vh(wl,this,[]),Dt(lo,this).clear(),Dt(cr,this).clear()}}function Wh(t,e,n){return(e=vue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vue(t){var e=Cue(t,"string");return typeof e=="symbol"?e:e+""}function Cue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yue{constructor(e,n){Wh(this,"hot",void 0),Wh(this,"nestedHeaderSettingsGetter",void 0),Wh(this,"layersCount",0),Wh(this,"container",void 0),Wh(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;s&&(g+='<button class="changeType"></button>'),Ql(d,g),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function bue(t,e){mW(t,e),e.add(t)}function NN(t,e,n){return(e=Sue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sue(t){var e=Rue(t,"string");return typeof e=="symbol"?e:e+""}function Rue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bh(t,e,n){mW(t,e),e.set(t,n)}function mW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vs(t,e,n){return t.set(kt(t,e),n),n}function We(t,e){return t.get(kt(t,e))}function kt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const DN="nestedHeaders",Eue=280;var ut=new WeakMap,Ys=new WeakMap,Md=new WeakMap,zw=new WeakMap,Dp=new WeakMap,jt=new WeakSet;class _ue extends qe{constructor(){super(...arguments),bue(this,jt),Bh(this,ut,new wue),Bh(this,Ys,null),Bh(this,Md,null),Bh(this,zw,!1),Bh(this,Dp,null),NN(this,"ghostTable",new yue(this.hot,(e,n)=>this.getHeaderSettings(e,n))),NN(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return DN}static get PLUGIN_PRIORITY(){return Eue}isEnabled(){return!!this.hot.getSettings()[DN]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&et(st`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>kt(jt,this,Wue).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(jt,e,Bue).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(jt,e,Pue).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(jt,e,Oue).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(jt,e,xue).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(jt,e,Aue).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(jt,e,Hue).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(jt,e,Nue).call(e,...i)}),this.addHook("afterSelection",()=>kt(jt,this,em).call(this)),this.addHook("afterSelectionFocusSet",()=>kt(jt,this,em).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(jt,e,Tue).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>kt(jt,this,kue).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(jt,e,Fue).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(jt,e,$ue).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(jt,e,Mue).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(jt,e,Iue).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(jt,e,Due).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(jt,e,Lue).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(jt,e,Vue).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>kt(jt,this,em).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>kt(jt,this,em).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();We(ut,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=We(ut,this).setState(e)),this.detectedOverlappedHeaders&&et(st`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";We(ut,this).triggerColumnModification(i,r)}),!We(Ys,this)&&this.enabled&&vs(Ys,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";We(ut,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),We(ut,this).clear(),We(Ys,this).unsubscribe(),vs(Ys,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return We(ut,this)}getLayersCount(){return We(ut,this).getLayersCount()}getHeaderSettings(e,n){return We(ut,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),pe(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),pe(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),pe(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),pe(o,"hiddenHeader"),pe(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=We(ut,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)q(o,"hiddenHeader");else if(c>1){var g,v,y;const{wtOverlays:E}=l._wt,C=(g=E.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),T=(v=E.inlineStartOverlay)===null||v===void 0?void 0:v.clone.wtTable.THEAD.contains(o);((y=E.topOverlay)===null||y===void 0?void 0:y.clone.wtTable.THEAD.contains(o))&&u<r&&q(o,"hiddenHeaderText");const F=C||T?Math.min(c,r-i):c;F>1&&o.setAttribute("colspan",F)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const E=o.querySelector("div.relative");E&&f&&f.length>0&&(pe(E,this.hot.getColumnMeta(u).headerClassName),q(E,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=We(ut,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){vs(ut,this,null),We(Ys,this)!==null&&(We(Ys,this).unsubscribe(),vs(Ys,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return We(ut,this).getHeaderTreeNodeData(e.row,e.col)}}function em(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=We(ut,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function Tue(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=We(Dp,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(vs(Dp,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=We(ut,this).findLeftMostColumnIndex(a,l),g=We(ut,this).findRightMostColumnIndex(a,l),v=g-f+1;if(f<c&&g>h)return f;if(s){let y=null;return f>=c&&g>h?v>d?(e.value="start",y=f):(e.value="end",y=g):f<c&&g<=h&&(v>d?(e.value="end",y=g):(e.value="start",y=f)),y}return f<=c?f:g}function Mue(t,e,n){const r=We(ut,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=We(ut,this).getHeaderSettings(e,t);if(o===Z0){if(!a)return r.columnIndex}else if(o===mF&&(l>s-i||!a))return null;return t}function Iue(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const g=c+f,v=d-a;if(v===0)continue;((i=We(ut,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][v]="")}}}function Pue(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Oue(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;vs(Md,this,e.clone()),vs(zw,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(gw(t)||Sa(t)&&l||UL(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function xue(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=ze(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function Aue(){vs(zw,this,!1)}function Hue(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!We(zw,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=We(ut,this).getHeaderTreeNodeData(We(Md,this).row,We(Md,this).col);if(e.setHighlight(We(Md,this)),o>e.getWidth()||i<n||i+o-1>r){const s=We(ut,this).findTopMostEntireHeaderLevel(ze(n,i,i+o-1),ze(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Nue(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=We(ut,this).findLeftMostColumnIndex(n.row,n.col),o=We(ut,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Due(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});vs(Dp,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function kue(t){if(We(ut,this).getLayersCount()>0){t.length=0;for(let e=0;e<We(ut,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function Lue(t){const e=We(ut,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=We(ut,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Vn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?We(ut,this).getHeaderTreeNodeData(0,n).columnIndex:n}function Fue(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function $ue(t,e,n){var r;const{label:i}=(r=We(ut,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Vue(t,e){if(t<0)return this.hot.getCell(t,We(ut,this).findLeftMostColumnIndex(t,e),!0)}function Wue(){this.updatePlugin()}function Bue(t,e){e||this.updatePlugin()}function jh(t,e,n){return(e=jue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jue(t){var e=Uue(t,"string");return typeof e=="symbol"?e:e+""}function Uue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zue{constructor(e,n){jh(this,"hot",void 0),jh(this,"data",null),jh(this,"plugin",void 0),jh(this,"parentReference",new WeakMap),jh(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},fe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&M(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&M(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ae(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(M(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(fe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),fe(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];M(r,o=>{i.push(this.getDataObject(o))}),M(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function kN(t,e,n){return(e=Yue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yue(t){var e=Gue(t,"string");return typeof e=="symbol"?e:e+""}function Gue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TM{constructor(e,n){kN(this,"hot",void 0),kN(this,"plugin",void 0),this.hot=n,this.plugin=e}}class vo extends TM{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(M(l,c=>{c&&s.removeChild(c)}),q(n,vo.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",fe(0,i-1,()=>{const d=c.createElement("SPAN");q(d,vo.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&ye(c,[Xl()]),q(n,vo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(q(c,`${vo.CSS_CLASSES.button} ${vo.CSS_CLASSES.expandButton}`),u&&ye(n,[li(!1)])):(q(c,`${vo.CSS_CLASSES.button} ${vo.CSS_CLASSES.collapseButton}`),u&&ye(n,[li(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const r=this.hot.view.getStylesHandler();let i=11;r.isClassicTheme()||(i=r.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class que extends TM{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),M(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{fe(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&M(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];M(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return M(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);M(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return M(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);M(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&M(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];M(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];M(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];M(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{M(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{M(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&M(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);we(e.target,vo.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),vi(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Kue(t,e,n){Xue(t,e),e.set(t,n)}function Xue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zue(t,e,n){return(e=Que(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Que(t){var e=Jue(t,"string");return typeof e=="symbol"?e:e+""}function Jue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ece(t,e){return t.get(tce(t,e))}function tce(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var LN=new WeakMap;class nce extends TM{constructor(){super(...arguments),Zue(this,"dataManager",this.plugin.dataManager),Kue(this,LN,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(J_)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(eT)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return fe(0,e.items.length-1,r=>{if(r===0)return M(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return fe(0,e.items.length-1,n=>{const r=ece(LN,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function tm(t,e,n){return(e=rce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rce(t){var e=ice(t,"string");return typeof e=="symbol"?e:e+""}function ice(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oce{constructor(e){tm(this,"plugin",void 0),tm(this,"hot",void 0),tm(this,"dataManager",void 0),tm(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(g=>{if(!l)return!1;const v=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(v,a),v}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Pt(i)&&(et(st`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function sce(t,e){pW(t,e),e.add(t)}function FN(t,e,n){pW(t,e),e.set(t,n)}function pW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VS(t,e,n){return(e=ace(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ace(t){var e=lce(t,"string");return typeof e=="symbol"?e:e+""}function lce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function km(t,e){return t.get(Cn(t,e))}function kp(t,e,n){return t.set(Cn(t,e),n),n}function Cn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Lp="nestedRows",uce=300,$N=Lp,cce="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Yw=new WeakMap,$u=new WeakMap,En=new WeakSet;class hce extends qe{constructor(){super(...arguments),sce(this,En),VS(this,"dataManager",null),VS(this,"headersUI",null),VS(this,"collapsedRowsMap",null),FN(this,Yw,!1),FN(this,$u,!1)}static get PLUGIN_KEY(){return Lp}static get PLUGIN_PRIORITY(){return uce}isEnabled(){return!!this.hot.getSettings()[Lp]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Cf),this.dataManager=new zue(this,this.hot),this.collapsingUI=new que(this,this.hot),this.headersUI=new vo(this,this.hot),this.contextMenuUI=new nce(this,this.hot),this.rowMoveController=new oce(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cn(En,e,_ce).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cn(En,e,Tce).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cn(En,e,gce).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cn(En,e,mce).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cn(En,e,pce).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cn(En,e,fce).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cn(En,e,Cce).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cn(En,e,vce).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cn(En,e,yce).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cn(En,e,bce).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cn(En,e,Sce).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cn(En,e,Rce).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cn(En,e,wce).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cn(En,e,Ece).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cn(En,e,dce).call(e,...r)}),this.addHook("beforeLoadData",n=>Cn(En,this,VN).call(this,n)),this.addHook("beforeUpdateData",n=>Cn(En,this,VN).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:$N,relativeToGroup:Pa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup($N)}disableCoreAPIModifiers(){kp($u,this,!0)}enableCoreAPIModifiers(){kp($u,this,!1)}onModifyRowData(e){if(!km($u,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!km($u,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return km($u,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function dce(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function fce(t,e,n){this.collapsingUI.toggleState(t,e,n)}function gce(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),kp(Yw,this,!0),this.dataManager.getData().slice()}function mce(t){return this.contextMenuUI.appendOptions(t)}function pce(t,e){this.headersUI.appendLevelIndicators(t,e)}function wce(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function vce(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{kp(Yw,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Cce(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function yce(){this.collapsingUI.collapsedRowsStash.stash()}function bce(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Sce(){this.collapsingUI.collapsedRowsStash.stash()}function Rce(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Ece(){this.dataManager.rewriteCache()}function _ce(){this.headersUI.updateRowHeaderWidth()}function Tce(t,e){km(Yw,this)&&(e.skipRender=!0)}function VN(t){if(!TF(t)){$0(cce),this.hot.getSettings()[Lp]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function WS(t,e,n){return(e=Mce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mce(t){var e=Ice(t,"string");return typeof e=="symbol"?e:e+""}function Ice(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pce{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;WS(this,"rootWindow",void 0),WS(this,"prefix",void 0),WS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){M(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function Oce(t,e,n){return(e=xce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xce(t){var e=Ace(t,"string");return typeof e=="symbol"?e:e+""}function Ace(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}re.getSingleton().register("persistentStateSave");re.getSingleton().register("persistentStateLoad");re.getSingleton().register("persistentStateReset");const WN="persistentState",Hce=0;class Nce extends qe{constructor(){super(...arguments),Oce(this,"storage",void 0)}static get PLUGIN_KEY(){return WN}static get PLUGIN_PRIORITY(){return Hce}isEnabled(){return!!this.hot.getSettings()[WN]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Pce(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Dce(t,e){kce(t,e),e.add(t)}function kce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BS(t,e,n){return(e=Lce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lce(t){var e=Fce(t,"string");return typeof e=="symbol"?e:e+""}function Fce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function BN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jS="search",$ce=190,Vce="htSearchResult",Wce=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},Bce=function(t,e,n){return Pt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Pt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var US=new WeakSet;class jce extends qe{constructor(){super(...arguments),Dce(this,US),BS(this,"callback",Wce),BS(this,"queryMethod",Bce),BS(this,"searchResultClass",Vce)}static get PLUGIN_KEY(){return jS}static get PLUGIN_PRIORITY(){return $ce}isEnabled(){return this.hot.getSettings()[jS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[jS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return BN(US,e,jN).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return BN(US,e,jN).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return fe(0,i-1,l=>{fe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,g=(h.search.queryMethod||r)(e,c,h);if(g){const v={row:l,col:u,data:c};s.push(v)}d&&d(a,l,u,c,g)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){xe(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function jN(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function nm(t,e,n){return(e=Uce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uce(t){var e=zce(t,"string");return typeof e=="symbol"?e:e+""}function zce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wW{constructor(e){nm(this,"viewportWidth",void 0),nm(this,"overwriteColumnWidthFn",void 0),nm(this,"baseWidths",new Map),nm(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class Yce extends wW{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=wc?(i.push([d,g]),a+=g):f!==g&&(i.push([d,g]),o.push(d),s-=g)}),s<=wc){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,g]=h,v=g;o.includes(f)||(v=Math.round(g*l)),this.stretchedWidths.set(f,v),u=f,d<i.length-1&&(c+=v)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function UN(t,e,n){Gce(t,e),e.set(t,n)}function Gce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zS(t,e){return t.get(vW(t,e))}function rm(t,e,n){return t.set(vW(t,e),n),n}function vW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var im=new WeakMap,Uh=new WeakMap;class qce extends wW{constructor(){super(...arguments),UN(this,im,0),UN(this,Uh,-1)}prepare(e){super.prepare(e),rm(im,this,0),rm(Uh,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),rm(Uh,this,e),rm(im,this,n)}calculate(){if(zS(Uh,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+zS(im,this),0);this.stretchedWidths.set(zS(Uh,this),n)}}function Kce(t,e){CW(t,e),e.add(t)}function om(t,e,n){CW(t,e),e.set(t,n)}function CW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ut(t,e){return t.get(rc(t,e))}function YS(t,e,n){return t.set(rc(t,e),n),n}function rc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Xce="stretchColumns";var $n=new WeakMap,Vu=new WeakMap,GS=new WeakMap,sm=new WeakMap,zh=new WeakSet;class Zce{constructor(e){Kce(this,zh),om(this,$n,void 0),om(this,Vu,void 0),om(this,GS,new Map([["all",new Yce(rc(zh,this,zN).bind(this))],["last",new qce(rc(zh,this,zN).bind(this))]])),om(this,sm,"none"),YS($n,this,e),YS(Vu,this,Ut($n,this).columnIndexMapper.createAndRegisterIndexMap(Xce,"physicalIndexToValue"))}useStrategy(e){YS(sm,this,Ut(GS,this).has(e)?e:"none")}refreshStretching(){if(Ut(sm,this)==="none"){Ut(Vu,this).clear();return}Ut($n,this).batchExecution(()=>{Ut(Vu,this).clear();const e=Ut(GS,this).get(Ut(sm,this));let r=Ut($n,this).view.getViewportWidth();rc(zh,this,Qce).call(this)&&(r-=bn(Ut($n,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<Ut($n,this).countCols();i++)Ut($n,this).columnIndexMapper.isHidden(Ut($n,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,rc(zh,this,Jce).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;Ut(Vu,this).setValueAtIndex(Ut($n,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return Ut(Vu,this).getValueAtIndex(Ut($n,this).toPhysicalColumn(e))}}function Qce(){const{view:t}=Ut($n,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=Ut($n,this).countRows(),r=t.getStylesHandler().getDefaultRowHeight();let i=0,o=!1;for(let a=0;a<n;a++){var s;if(i+=((s=Ut($n,this).getRowHeight(a))!==null&&s!==void 0?s:r)+(a===0?1:0),i>e){o=!0;break}}return o}function Jce(t){var e;return(e=Ut($n,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:wc}function zN(t,e){return Ut($n,this).runHooks("beforeStretchingColumnWidth",t,e)}function ehe(t,e){yW(t,e),e.add(t)}function qS(t,e,n){yW(t,e),e.set(t,n)}function yW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KS(t,e,n){return t.set(Fp(t,e),n),n}function os(t,e){return t.get(Fp(t,e))}function Fp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const the="stretchColumns",nhe=155;var Xu=new WeakMap,am=new WeakMap,Yh=new WeakMap,XS=new WeakSet;class rhe extends qe{constructor(){super(...arguments),ehe(this,XS),qS(this,Xu,new Zce(this.hot)),qS(this,am,null),qS(this,Yh,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;os(am,this)!==null&&os(am,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),KS(am,this,i.width)})})}))}static get PLUGIN_KEY(){return the}static get PLUGIN_PRIORITY(){return nhe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(os(Xu,this).useStrategy(this.hot.getSettings().stretchH),os(Yh,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Fp(XS,e,ohe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Fp(XS,e,ihe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){os(Xu,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),os(Yh,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return os(Xu,this).getStretchedWidth(e)}destroy(){os(Yh,this).disconnect(),KS(Yh,this,null),KS(Xu,this,null),super.destroy()}}function ihe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function ohe(t){t&&os(Xu,this).refreshStretching()}function she(t,e){ahe(t,e),e.add(t)}function ahe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lm(t,e,n){return(e=lhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lhe(t){var e=uhe(t,"string");return typeof e=="symbol"?e:e+""}function uhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const che="touchScroll",hhe=200;var um=new WeakSet;class dhe extends qe{constructor(){super(...arguments),she(this,um),lm(this,"scrollbars",[]),lm(this,"clones",[]),lm(this,"lockedCollection",!1),lm(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return che}static get PLUGIN_PRIORITY(){return hhe}static get SETTING_KEYS(){return!0}isEnabled(){return N0()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>ZS(um,this,fhe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>ZS(um,this,ghe).call(this)),this.addHook("afterMomentumScroll",()=>ZS(um,this,mhe).call(this))}}function fhe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function ghe(){this.freezeOverlays=!0,M(this.clones,t=>{q(t,"hide-tween")})}function mhe(){this.freezeOverlays=!1,M(this.clones,t=>{pe(t,"hide-tween"),q(t,"show-tween")}),this.hot._registerTimeout(()=>{M(this.clones,t=>{pe(t,"show-tween")})},400),M(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function phe(t,e){whe(t,e),e.add(t)}function whe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vhe(t,e,n){return(e=Che(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Che(t){var e=yhe(t,"string");return typeof e=="symbol"?e:e+""}function yhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bhe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Lm="trimRows",She=330;var YN=new WeakSet;class Rhe extends qe{constructor(){super(...arguments),phe(this,YN),vhe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Lm}static get PLUGIN_PRIORITY(){return She}isEnabled(){return!!this.hot.getSettings()[Lm]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Cf),this.trimmedRowsMap.addLocalHook("init",()=>bhe(YN,this,Ehe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Lm];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),M(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{M(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(M(e,l=>{o[l]=!1}),i=mn(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function Ehe(){const t=this.hot.getSettings()[Lm];Array.isArray(t)&&this.hot.batchExecution(()=>{M(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function _he(t,e,n){return(e=The(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function The(t){var e=Mhe(t,"string");return typeof e=="symbol"?e:e+""}function Mhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ci{constructor(e){_he(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function cm(t,e,n){return(e=Ihe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ihe(t){var e=Phe(t,"string");return typeof e=="symbol"?e:e+""}function Phe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MM extends Ci{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),cm(this,"stateBefore",void 0),cm(this,"range",void 0),cm(this,"type",void 0),cm(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new MM({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){M(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){Ks(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function GN(t,e,n){return(e=Ohe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ohe(t){var e=xhe(t,"string");return typeof e=="symbol"?e:e+""}function xhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IM extends Ci{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),GN(this,"columns",void 0),GN(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new IM({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),SM(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function qN(t,e,n){return(e=Ahe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ahe(t){var e=Hhe(t,"string");return typeof e=="symbol"?e:e+""}function Hhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PM extends Ci{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),qN(this,"previousSortState",void 0),qN(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new PM({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function KN(t,e,n){return(e=Nhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nhe(t){var e=Dhe(t,"string");return typeof e=="symbol"?e:e+""}function Dhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OM extends Ci{constructor(e){let{index:n,amount:r}=e;super("insert_col"),KN(this,"index",void 0),KN(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new OM({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function XN(t,e,n){return(e=khe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function khe(t){var e=Lhe(t,"string");return typeof e=="symbol"?e:e+""}function Lhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xM extends Ci{constructor(e){let{index:n,amount:r}=e;super("insert_row"),XN(this,"index",void 0),XN(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new xM({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function hm(t,e,n){return(e=Fhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fhe(t){var e=$he(t,"string");return typeof e=="symbol"?e:e+""}function $he(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AM extends Ci{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),hm(this,"changes",void 0),hm(this,"selected",void 0),hm(this,"countCols",void 0),hm(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new AM({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=Un(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=Un(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function ZN(t,e,n){return(e=Vhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vhe(t){var e=Whe(t,"string");return typeof e=="symbol"?e:e+""}function Whe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HM extends Ci{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),ZN(this,"conditionsStack",void 0),ZN(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new HM({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function Bhe(t,e,n){return(e=jhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jhe(t){var e=Uhe(t,"string");return typeof e=="symbol"?e:e+""}function Uhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NM extends Ci{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),Bhe(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new NM({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function bW(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return fe(r,i,l=>{fe(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function es(t,e,n){return(e=zhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zhe(t){var e=Yhe(t,"string");return typeof e=="symbol"?e:e+""}function Yhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DM extends Ci{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),es(this,"index",void 0),es(this,"indexes",void 0),es(this,"data",void 0),es(this,"amount",void 0),es(this,"headers",void 0),es(this,"columnPositions",void 0),es(this,"rowPositions",void 0),es(this,"fixedColumnsStart",void 0),es(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return fe(l.length-1,g=>{const v=[],y=l[g];fe(u,c,E=>{v.push(y[e.toPhysicalColumn(E)])}),h.push(v)}),fe(i-1,g=>{f.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&fe(i-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new DM({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:bW(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Be(this.data[c],o));const l=Be(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),M(e.getSourceDataArray(),(c,h)=>{M(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&M(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Wu(t,e,n){return(e=Ghe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ghe(t){var e=qhe(t,"string");return typeof e=="symbol"?e:e+""}function qhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kM extends Ci{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),Wu(this,"index",void 0),Wu(this,"data",void 0),Wu(this,"fixedRowsBottom",void 0),Wu(this,"fixedRowsTop",void 0),Wu(this,"rowIndexesSequence",void 0),Wu(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=Un(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new kM({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:bW(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function QN(t,e,n){return(e=Khe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Khe(t){var e=Xhe(t,"string");return typeof e=="symbol"?e:e+""}function Xhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LM extends Ci{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),QN(this,"rows",void 0),QN(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new LM({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),SM(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function Zhe(t,e,n){return(e=Qhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qhe(t){var e=Jhe(t,"string");return typeof e=="symbol"?e:e+""}function Jhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FM extends Ci{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),Zhe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new FM({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function ede(t,e){[MM,IM,PM,OM,xM,AM,HM,NM,DM,kM,LM,FM].forEach(n=>n.startRegisteringEvents(t,e))}function tde(t,e){nde(t,e),e.add(t)}function nde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QS(t,e,n){return(e=rde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rde(t){var e=ide(t,"string");return typeof e=="symbol"?e:e+""}function ide(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const JN="undoRedo",ode="undoRedo",sde=1e3;re.getSingleton().register("beforeUndo");re.getSingleton().register("afterUndo");re.getSingleton().register("beforeRedo");re.getSingleton().register("afterRedo");const eD=new Set;var dm=new WeakSet;class ade extends qe{static get PLUGIN_KEY(){return ode}static get PLUGIN_PRIORITY(){return sde}static get SETTING_KEYS(){return!0}constructor(e){super(e),tde(this,dm),QS(this,"doneActions",[]),QS(this,"undoneActions",[]),QS(this,"ignoreNewActions",!1),ede(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return JS(dm,e,lde).call(e,...r)}),this.registerShortcuts(),JS(dm,this,ude).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),JS(dm,this,cde).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:JN};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(JN)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=Un(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=Un(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function lde(t,e){e==="loadData"&&this.clear()}function ude(){const t=e=>{eD.has(e)||(et(st`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),eD.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function cde(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function hde(){Ge(dd),Ge(_Q),Ge(fd),Ge(nJ),Ge(cJ),Ge(j$),Ge(oee),Ge(jee),Ge($w),Ge(Qte),Ge(Ene),Ge(Ane),Ge(Bw),Ge(gre),Ge(uoe),Ge(Boe),Ge(mse),Ge(Mse),Ge($se),Ge(Xse),Ge(sae),Ge(Eae),Ge(Hae),Ge(ple),Ge(qle),Ge(Jle),Ge(_ue),Ge(hce),Ge(Nce),Ge(jce),Ge(rhe),Ge(dhe),Ge(Rhe),Ge(ade)}function dde(){K5(),vZ(),MZ(),GZ(),hde()}function fde(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var eR,tR,nR,rR,iR;dde();fde(Se);Se.__GhostTable=sM;Se._getListenersCounter=oK;Se._getRegisteredMapsCounter=p9;Se.EventManager=di;const gde=[$2,Nq,t9,yZ,xq,Mq,j2,TK,Oq,z2,Lq,_K],mde=[Rq,Fq];Se.helper={};Se.dom={};M(gde,t=>{M(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Se.helper[e]=t[e])})});M(mde,t=>{M(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Se.dom[e]=t[e])})});Se.cellTypes=(eR=Se.cellTypes)!==null&&eR!==void 0?eR:{};M(b6(),t=>{Se.cellTypes[t]=$T(t)});Se.cellTypes.registerCellType=Zr;Se.cellTypes.getCellType=$T;Se.editors=(tR=Se.editors)!==null&&tR!==void 0?tR:{};M(Jq(),t=>{Se.editors[`${jn(t)}Editor`]=ep(t)});Se.editors.registerEditor=pr;Se.editors.getEditor=ep;Se.renderers=(nR=Se.renderers)!==null&&nR!==void 0?nR:{};M(WK(),t=>{const e=tp(t);t==="base"&&(Se.renderers.cellDecorator=e),Se.renderers[`${jn(t)}Renderer`]=e});Se.renderers.registerRenderer=Hr;Se.renderers.getRenderer=tp;Se.validators=(rR=Se.validators)!==null&&rR!==void 0?rR:{};M(UK(),t=>{Se.validators[`${jn(t)}Validator`]=U0(t)});Se.validators.registerValidator=Sl;Se.validators.getValidator=U0;Se.plugins=(iR=Se.plugins)!==null&&iR!==void 0?iR:{};M(j0(),t=>{Se.plugins[t]=mf(t)});Se.plugins[`${jn(qe.PLUGIN_KEY)}Plugin`]=qe;Se.plugins.registerPlugin=Ge;Se.plugins.getPlugin=mf;class SW{constructor(...e){Vo(this,"tasks");this.tasks=e}append(...e){this.tasks.push(...e)}process(e){let n=e,r=!0;for(;;){for(const i of this.tasks)(r||!i.once())&&(e=i.process(e));if(e===n)return n;n=e,r&&(r=!1)}}processAll(e){const n=[];for(const r of e){const i=this.process(r);n.push(i)}return n}}class bE{constructor(e){Vo(this,"re");e.global||(e=new RegExp(e,"g")),this.re=e}once(){return!1}process(e){return e.replaceAll(this.re,"")}}class pde{constructor(e){Vo(this,"sep");this.sep=e}once(){return!0}process(e){const n=e.indexOf(this.sep);return n===-1?e:e.substring(0,n)}}class wde{constructor(e){Vo(this,"cutset");this.cutset=e}once(){return!1}process(e){return e.replaceAll(new RegExp(`^[${this.cutset}]+|[${this.cutset}]+$`,"g"),"")}}class $p{constructor(e,n){Vo(this,"isOnce");Vo(this,"fn");this.isOnce=e,this.fn=n}once(){return this.isOnce}process(e){return this.fn(e)}}const vde=new $p(!1,t=>t.trim()),Cde=new $p(!0,t=>{const e=t.match(/\S+/g);return e?e[0]:""}),yde=new SW(new bE(/\([^)]*\)/),new bE(/（[^）]*）/));var bde=(t,e,n)=>{e()===""?n(!1):n()||n(!0)},Sde=jp('<div class="row align-items-center pb-1"><div class="col-4"><div class="form-check"><input class="form-check-input svelte-145qiqt" type="checkbox"/> <label class="form-check-label"> </label></div></div> <div class="col"><label class="visually-hidden"> </label> <input type="text" class="form-control form-control-sm svelte-145qiqt"/></div></div>'),Rde=jp('<div class="form-check"><input class="form-check-input svelte-145qiqt" type="checkbox"/> <label class="form-check-label"> </label></div>');function Bu(t,e){TE(e,!0);let n=ev(e,"placeholder",3,""),r=ev(e,"checked",15),i=ev(e,"optional",15,null);var o=FB(),s=aR(o);{var a=u=>{var c=Sde(),h=$r(c),d=$r(h),f=$r(d),g=Pn(f,2),v=$r(g),y=Pn(h,2),E=$r(y),C=$r(E),T=Pn(E,2);T.__input=[bde,i,r],lR(()=>{Aa(f,"id",e.id),f.disabled=i()==="",Aa(g,"for",e.id),Zw(v,e.id),Aa(E,"for",e.id+n()),Zw(C,n()),Aa(T,"id",e.id+n()),Aa(T,"placeholder",n())}),aI(f,r),YB(T,i),nd(u,c)},l=u=>{var c=Rde(),h=$r(c),d=Pn(h,2),f=$r(d);lR(()=>{Aa(h,"id",e.id),Aa(d,"for",e.id),Zw(f,e.id)}),aI(h,r),nd(u,c)};BB(s,u=>{i()!==null?u(a):u(l,!1)})}nd(t,o),ME()}ND(["input"]);var Ede=kB(jp(`<script src="https://cdn.jsdelivr.net/npm/opencc-js@1/dist/umd/full.min.js">
  <\/script><!>`,1)),_de=(t,e,n)=>{Ue(e,!Ve(e)),Ve(e)&&Ue(n,!1)},Tde=(t,e,n)=>{Ue(e,!Ve(e)),Ve(e)&&Ue(n,!1)},Mde=jp('<header class="navbar navbar-expand navbar-light flex-column flex-md-row svelte-lpn5ih"><a class="navbar-brand text-primary m-0 mr-md-3" href="/" style="font-size:24px">Simple Text Processing</a></header> <div class="container-fluid svelte-lpn5ih"><div class="row h-100"><div id="input" class="col-5 svelte-lpn5ih"></div> <div class="col-2 p-0 pt-5"><!> <!> <!> <br/> <div class="form-check"><input class="form-check-input" type="checkbox" id="t2s"/> <label class="form-check-label" for="t2s">繁 → 简</label></div> <div class="form-check"><input class="form-check-input" type="checkbox" id="s2t"/> <label class="form-check-label" for="s2t">简 → 繁</label></div> <br/> <!> <!> <!> <br/> <button type="button" class="btn btn-primary w-100">Process</button> <br/> <br/> <button type="button" class="btn btn-primary w-100">Copy Result</button> <br/> <br/> <button type="button" class="btn btn-danger w-100">Clear</button></div> <div id="result" class="col-5 svelte-lpn5ih"></div></div></div>',1);function Ide(t,e){TE(e,!0);let n=cn(!1),r=cn(!1),i=cn(!1),o=cn(!1),s=cn(""),a=cn(!1),l=cn(""),u=cn(!1),c=cn(""),h=cn(!0),d=cn(!1),f=cn(!1),g,v,y,E;const C=()=>{y=new $p(!0,OpenCC.Converter({from:"cn",to:"t"})),E=new $p(!0,OpenCC.Converter({from:"t",to:"cn"})),Ue(h,!1)},T=(_,H,V,G)=>{let K;try{K=JSON.parse(V)}catch{K=void 0}const b={autoColumnSize:!1,colHeaders:[H],colWidths(){return Math.floor(window.innerWidth*5/12)-50-24},columnSorting:!1,height(){return window.innerHeight-80-16},maxCols:1,rowHeaders:!0,startRows:1,tabMoves:{row:1,col:0},themeName:"ht-theme-main",licenseKey:"non-commercial-and-evaluation"};return G?(b.readOnly=!0,b.readOnlyCellClassName="",b.contextMenu=["copy"]):(b.data=K,b.minSpareRows=1,b.contextMenu=["row_above","row_below","---------","remove_row","---------","undo","redo","---------","copy","cut"]),new Se(_,b)};KB(()=>{g=T(document.getElementById("input"),"Data",localStorage.getItem("data")||"",!1),g.addHook("beforePaste",()=>g.updateSettings({readOnly:!0})),g.addHook("afterPaste",_=>{g.updateSettings({readOnly:!1});for(let H=_.length-1;H>=0;H--)if(_[H][0]!==""){g.loadData(_.slice(0,H+1));return}g.loadData([[""]])}),v=T(document.getElementById("result"),"Result","",!0)});const A=_=>_.getDataAtCol(0).filter(H=>H!==null),F=()=>{const _=new SW;if(Ve(n)&&_.append(vde),Ve(r)&&_.append(Cde),Ve(i)&&_.append(...yde.tasks),Ve(o)&&_.append(new wde(Ve(s))),Ve(a)&&_.append(new pde(Ve(l))),Ve(u)&&_.append(new bE(new RegExp(Ve(c)))),Ve(d)?_.append(y):Ve(f)&&_.append(E),!_.tasks.length){alert("No option selected.");return}Ue(h,!0);const H=_.processAll(A(g));v.loadData(H.map(V=>[V])),Ue(h,!1)},I=()=>{confirm("Clear all data and options?")&&(g.loadData([[""]]),v.loadData([[""]]),Ue(n,!1),Ue(r,!1),Ue(i,!1),Ue(o,!1),Ue(s,""),Ue(a,!1),Ue(l,""),Ue(u,!1),Ue(c,""),Ue(d,!1),Ue(f,!1),localStorage.clear())},O=async()=>{const _=A(v).join(`
`);_.trim()!==""&&(navigator.clipboard?(await navigator.clipboard.writeText(_.trim()),alert("Text has been copied to clipboard.")):alert("This function requires a secure origin. (HTTPS or localhost)"))};var Y=Mde();iI("beforeunload",sR,()=>localStorage.setItem("data",JSON.stringify(g.getData()))),NB(_=>{var H=Ede(),V=aR(H);Pn(V),iI("load",V,C),nd(_,H)});var U=Pn(aR(Y),2),W=$r(U),Z=Pn($r(W),2),Q=$r(Z);Bu(Q,{id:"TrimSpace",get checked(){return Ve(n)},set checked(_){Ue(n,_,!0)}});var oe=Pn(Q,2);Bu(oe,{id:"CutSpace",get checked(){return Ve(r)},set checked(_){Ue(r,_,!0)}});var te=Pn(oe,2);Bu(te,{id:"RemoveParentheses",get checked(){return Ve(i)},set checked(_){Ue(i,_,!0)}});var ae=Pn(te,4),ft=$r(ae);ft.__click=[_de,f,d];var be=Pn(ae,2),He=$r(be);He.__click=[Tde,d,f];var gt=Pn(be,4);Bu(gt,{id:"Trim",placeholder:"Cutset",get checked(){return Ve(o)},set checked(_){Ue(o,_,!0)},get optional(){return Ve(s)},set optional(_){Ue(s,_,!0)}});var Xt=Pn(gt,2);Bu(Xt,{id:"Cut",placeholder:"Sep",get checked(){return Ve(a)},set checked(_){Ue(a,_,!0)},get optional(){return Ve(l)},set optional(_){Ue(l,_,!0)}});var Ke=Pn(Xt,2);Bu(Ke,{id:"Remove",placeholder:"RegExp",get checked(){return Ve(u)},set checked(_){Ue(u,_,!0)},get optional(){return Ve(c)},set optional(_){Ue(c,_,!0)}});var m=Pn(Ke,4);m.__click=F;var w=Pn(m,6);w.__click=O;var p=Pn(w,6);p.__click=I,lR(()=>{oI(ft,Ve(f)),oI(He,Ve(d)),m.disabled=Ve(h),w.disabled=Ve(h),p.disabled=Ve(h)}),nd(t,Y),ME()}ND(["click"]);$B(Ide,{target:document.body})});export default Pde();
