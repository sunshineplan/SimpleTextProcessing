var SM=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var DU=SM(($U,gu)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const GR=!1;var KR=Array.isArray,RM=Array.prototype.indexOf,EM=Array.from,Eg=Object.defineProperty,us=Object.getOwnPropertyDescriptor,TM=Object.getOwnPropertyDescriptors,_M=Object.prototype,OM=Array.prototype,XR=Object.getPrototypeOf,Hw=Object.isExtensible;function ZR(t){for(var e=0;e<t.length;e++)t[e]()}function MM(){var t,e,r=new Promise((n,i)=>{t=n,e=i});return{promise:r,resolve:t,reject:e}}const yr=2,QR=4,mm=8,Es=16,Xn=32,yo=64,JR=128,Nr=256,mu=512,xt=1024,Dr=2048,xi=4096,_i=8192,bo=16384,pm=32768,wm=65536,Pw=1<<17,eE=1<<18,Ba=1<<19,IM=1<<20,Tg=1<<21,vm=1<<22,ao=1<<23,Jl=Symbol("$state"),HM=Symbol("legacy props"),PM=Symbol(""),ym=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"},xM=11;function AM(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function NM(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function DM(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function kM(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function LM(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function FM(t){throw new Error("https://svelte.dev/e/effect_orphan")}function VM(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function WM(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function BM(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function $M(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function jM(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const zM=1,UM=4,YM=8,qM=16,GM=1,KM=2,Ct=Symbol(),XM="http://www.w3.org/1999/xhtml";function tE(t){return t===this.v}function ZM(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function QM(t){return!ZM(t,this.v)}let JM=!1,kr=null;function pu(t){kr=t}function bm(t,e=!1,r){kr={p:kr,c:null,e:null,s:t,x:null,l:null}}function Cm(t){var e=kr,r=e.e;if(r!==null){e.e=null;for(var n of r)pE(n)}return kr=e.p,{}}function rE(){return!0}const eI=new WeakMap;function tI(t){var e=pe;if(e===null)return ge.f|=ao,t;if((e.f&pm)===0){if((e.f&JR)===0)throw!e.parent&&t instanceof Error&&nE(t),t;e.b.error(t)}else Sm(t,e)}function Sm(t,e){for(;e!==null;){if((e.f&JR)!==0)try{e.b.error(t);return}catch(r){t=r}e=e.parent}throw t instanceof Error&&nE(t),t}function nE(t){const e=eI.get(t);e&&(Eg(t,"message",{value:e.message}),Eg(t,"stack",{value:e.stack}))}let pi=[],wu=[];function iE(){var t=pi;pi=[],ZR(t)}function rI(){var t=wu;wu=[],ZR(t)}function nI(){return pi.length>0||wu.length>0}function oE(t){if(pi.length===0&&!Sa){var e=pi;queueMicrotask(()=>{e===pi&&iE()})}pi.push(t)}function iI(){pi.length>0&&iE(),wu.length>0&&rI()}function oI(){const t=pe.b;return t===null&&AM(),t}function Rm(t){var e=yr|Dr,r=ge!==null&&(ge.f&yr)!==0?ge:null;return pe===null||r!==null&&(r.f&Nr)!==0?e|=Nr:pe.f|=Ba,{ctx:kr,deps:null,effects:null,equals:tE,f:e,fn:t,reactions:null,rv:0,v:Ct,wv:0,parent:r??pe,ac:null}}function sI(t,e){let r=pe;r===null&&DM();var n=r.b,i=void 0,o=cE(Ct),s=null,a=!ge;return CI(()=>{try{var l=t();s&&Promise.resolve(l).catch(()=>{})}catch(g){l=Promise.reject(g)}var u=()=>l;i=s?.then(u,u)??Promise.resolve(l),s=i;var c=je,h=n.is_pending();a&&(n.update_pending_count(1),h||c.increment());const d=(g,w=void 0)=>{s=null,h||c.activate(),w?w!==ym&&(o.f|=ao,Og(o,w)):((o.f&ao)!==0&&(o.f^=ao),Og(o,g)),a&&(n.update_pending_count(-1),h||c.decrement()),lE()};if(i.then(d,g=>d(null,g||"unknown")),c)return()=>{queueMicrotask(()=>c.neuter())}}),new Promise(l=>{function u(c){function h(){c===i?l(o):u(i)}c.then(h,h)}u(i)})}function aI(t){const e=Rm(t);return e.equals=QM,e}function sE(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)fo(e[r])}}function lI(t){for(var e=t.parent;e!==null;){if((e.f&yr)===0)return e;e=e.parent}return null}function Em(t){var e,r=pe;Oi(lI(t));try{sE(t),e=ME(t)}finally{Oi(r)}return e}function aE(t){var e=Em(t);if(t.equals(e)||(t.v=e,t.wv=_E()),!Co){var r=(wi||(t.f&Nr)!==0)&&t.deps!==null?xi:xt;nr(t,r)}}function uI(t,e,r){const n=Rm;if(e.length===0){r(t.map(n));return}var i=je,o=pe,s=cI(),a=oI();Promise.all(e.map(l=>sI(l))).then(l=>{i?.activate(),s();try{r([...t.map(n),...l])}catch(u){(o.f&bo)===0&&Sm(u,o)}i?.deactivate(),lE()}).catch(l=>{a.error(l)})}function cI(){var t=pe,e=ge,r=kr,n=je;return function(){Oi(t),Sn(e),pu(r),n?.activate()}}function lE(){Oi(null),Sn(null),pu(null)}const Dc=new Set;let je=null,eu=null,xw=new Set,ho=[],Wu=null,_g=!1,Sa=!1;class ys{current=new Map;#l=new Map;#i=new Set;#e=0;#u=null;#c=!1;#r=[];#o=[];#n=[];#t=[];#s=[];#h=[];#d=[];skipped_effects=new Set;process(e){ho=[],eu=null;for(const i of e)this.#g(i);if(this.#r.length===0&&this.#e===0){this.#f();var r=this.#n,n=this.#t;this.#n=[],this.#t=[],this.#s=[],eu=je,je=null,Aw(r),Aw(n),je===null?je=this:Dc.delete(this),this.#u?.resolve()}else this.#a(this.#n),this.#a(this.#t),this.#a(this.#s);for(const i of this.#r)hs(i);for(const i of this.#o)hs(i);this.#r=[],this.#o=[]}#g(e){e.f^=xt;for(var r=e.first;r!==null;){var n=r.f,i=(n&(Xn|yo))!==0,o=i&&(n&xt)!==0,s=o||(n&_i)!==0||this.skipped_effects.has(r);if(!s&&r.fn!==null){if(i)r.f^=xt;else if((n&QR)!==0)this.#t.push(r);else if((n&xt)===0)if((n&vm)!==0){var a=r.b?.is_pending()?this.#o:this.#r;a.push(r)}else ju(r)&&((r.f&Es)!==0&&this.#s.push(r),hs(r));var l=r.first;if(l!==null){r=l;continue}}var u=r.parent;for(r=r.next;r===null&&u!==null;)r=u.next,u=u.parent}}#a(e){for(const r of e)((r.f&Dr)!==0?this.#h:this.#d).push(r),nr(r,xt);e.length=0}capture(e,r){this.#l.has(e)||this.#l.set(e,r),this.current.set(e,e.v)}activate(){je=this}deactivate(){je=null,eu=null;for(const e of xw)if(xw.delete(e),e(),je!==null)break}neuter(){this.#c=!0}flush(){ho.length>0?uE():this.#f(),je===this&&(this.#e===0&&Dc.delete(this),this.deactivate())}#f(){if(!this.#c)for(const e of this.#i)e();this.#i.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const e of this.#h)nr(e,Dr),bs(e);for(const e of this.#d)nr(e,xi),bs(e);this.#n=[],this.#t=[],this.flush()}else this.deactivate()}add_callback(e){this.#i.add(e)}settled(){return(this.#u??=MM()).promise}static ensure(){if(je===null){const e=je=new ys;Dc.add(je),Sa||ys.enqueue(()=>{je===e&&e.flush()})}return je}static enqueue(e){oE(e)}}function hI(t){var e=Sa;Sa=!0;try{for(var r;;){if(iI(),ho.length===0&&!nI()&&(je?.flush(),ho.length===0))return Wu=null,r;uE()}}finally{Sa=e}}function uE(){var t=cs;_g=!0;try{var e=0;for(Dw(!0);ho.length>0;){var r=ys.ensure();if(e++>1e3){var n,i;dI()}r.process(ho),Ri.clear()}}finally{_g=!1,Dw(t),Wu=null}}function dI(){try{VM()}catch(t){Sm(t,Wu)}}let to=null;function Aw(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var n=t[r++];if((n.f&(bo|_i))===0&&ju(n)&&(to=[],hs(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null&&n.ac===null?CE(n):n.fn=null),to?.length>0)){Ri.clear();for(const i of to)hs(i);to=[]}}to=null}}function bs(t){for(var e=Wu=t;e.parent!==null;){e=e.parent;var r=e.f;if(_g&&e===pe&&(r&Es)!==0)return;if((r&(yo|Xn))!==0){if((r&xt)===0)return;e.f^=xt}}ho.push(e)}const Ri=new Map;function cE(t,e){var r={f:0,v:t,reactions:null,equals:tE,rv:0,wv:0};return r}function st(t,e){const r=cE(t);return _I(r),r}function de(t,e,r=!1){ge!==null&&(!yn||(ge.f&Pw)!==0)&&rE()&&(ge.f&(yr|Es|vm|Pw))!==0&&!Yn?.includes(t)&&jM();let n=r?is(e):e;return Og(t,n)}function Og(t,e){if(!t.equals(e)){var r=t.v;Co?Ri.set(t,e):Ri.set(t,r),t.v=e;var n=ys.ensure();n.capture(t,r),(t.f&yr)!==0&&((t.f&Dr)!==0&&Em(t),nr(t,(t.f&Nr)===0?xt:xi)),t.wv=_E(),hE(t,Dr),pe!==null&&(pe.f&xt)!==0&&(pe.f&(Xn|yo))===0&&(Hr===null?OI([t]):Hr.push(t))}return e}function kc(t){de(t,t.v+1)}function hE(t,e){var r=t.reactions;if(r!==null)for(var n=r.length,i=0;i<n;i++){var o=r[i],s=o.f,a=(s&Dr)===0;a&&nr(o,e),(s&yr)!==0?hE(o,xi):a&&((s&Es)!==0&&to!==null&&to.push(o),bs(o))}}function is(t){if(typeof t!="object"||t===null||Jl in t)return t;const e=XR(t);if(e!==_M&&e!==OM)return t;var r=new Map,n=KR(t),i=st(0),o=lo,s=a=>{if(lo===o)return a();var l=ge,u=lo;Sn(null),Lw(o);var c=a();return Sn(l),Lw(u),c};return n&&r.set("length",st(t.length)),new Proxy(t,{defineProperty(a,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&BM();var c=r.get(l);return c===void 0?c=s(()=>{var h=st(u.value);return r.set(l,h),h}):de(c,u.value,!0),!0},deleteProperty(a,l){var u=r.get(l);if(u===void 0){if(l in a){const c=s(()=>st(Ct));r.set(l,c),kc(i)}}else de(u,Ct),kc(i);return!0},get(a,l,u){if(l===Jl)return t;var c=r.get(l),h=l in a;if(c===void 0&&(!h||us(a,l)?.writable)&&(c=s(()=>{var g=is(h?a[l]:Ct),w=st(g);return w}),r.set(l,c)),c!==void 0){var d=le(c);return d===Ct?void 0:d}return Reflect.get(a,l,u)},getOwnPropertyDescriptor(a,l){var u=Reflect.getOwnPropertyDescriptor(a,l);if(u&&"value"in u){var c=r.get(l);c&&(u.value=le(c))}else if(u===void 0){var h=r.get(l),d=h?.v;if(h!==void 0&&d!==Ct)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return u},has(a,l){if(l===Jl)return!0;var u=r.get(l),c=u!==void 0&&u.v!==Ct||Reflect.has(a,l);if(u!==void 0||pe!==null&&(!c||us(a,l)?.writable)){u===void 0&&(u=s(()=>{var d=c?is(a[l]):Ct,g=st(d);return g}),r.set(l,u));var h=le(u);if(h===Ct)return!1}return c},set(a,l,u,c){var h=r.get(l),d=l in a;if(n&&l==="length")for(var g=u;g<h.v;g+=1){var w=r.get(g+"");w!==void 0?de(w,Ct):g in a&&(w=s(()=>st(Ct)),r.set(g+"",w))}if(h===void 0)(!d||us(a,l)?.writable)&&(h=s(()=>st(void 0)),de(h,is(u)),r.set(l,h));else{d=h.v!==Ct;var v=s(()=>is(u));de(h,v)}var b=Reflect.getOwnPropertyDescriptor(a,l);if(b?.set&&b.set.call(c,u),!d){if(n&&typeof l=="string"){var E=r.get("length"),R=Number(l);Number.isInteger(R)&&R>=E.v&&de(E,R+1)}kc(i)}return!0},ownKeys(a){le(i);var l=Reflect.ownKeys(a).filter(h=>{var d=r.get(h);return d===void 0||d.v!==Ct});for(var[u,c]of r)c.v!==Ct&&!(u in a)&&l.push(u);return l},setPrototypeOf(){$M()}})}var Mg,dE,fE,gE;function fI(){if(Mg===void 0){Mg=window,dE=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;fE=us(e,"firstChild").get,gE=us(e,"nextSibling").get,Hw(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Hw(r)&&(r.__t=void 0)}}function Bu(t=""){return document.createTextNode(t)}function vu(t){return fE.call(t)}function Tm(t){return gE.call(t)}function mr(t,e){return vu(t)}function Ig(t,e){{var r=vu(t);return r instanceof Comment&&r.data===""?Tm(r):r}}function St(t,e=1,r=!1){let n=t;for(;e--;)n=Tm(n);return n}function gI(){return!1}let Nw=!1;function mI(){Nw||(Nw=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function $u(t){var e=ge,r=pe;Sn(null),Oi(null);try{return t()}finally{Sn(e),Oi(r)}}function mE(t,e,r,n=r){t.addEventListener(e,()=>$u(r));const i=t.__on_r;i?t.__on_r=()=>{i(),n(!0)}:t.__on_r=()=>n(!0),mI()}function pI(t){pe===null&&ge===null&&FM(),ge!==null&&(ge.f&Nr)!==0&&pe===null&&LM(),Co&&kM()}function wI(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function Ai(t,e,r,n=!0){var i=pe;i!==null&&(i.f&_i)!==0&&(t|=_i);var o={ctx:kr,deps:null,nodes_start:null,nodes_end:null,f:t|Dr,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{hs(o),o.f|=pm}catch(l){throw fo(o),l}else e!==null&&bs(o);if(n){var s=o;if(r&&s.deps===null&&s.teardown===null&&s.nodes_start===null&&s.first===s.last&&(s.f&Ba)===0&&(s=s.first),s!==null&&(s.parent=i,i!==null&&wI(s,i),ge!==null&&(ge.f&yr)!==0&&(t&yo)===0)){var a=ge;(a.effects??=[]).push(s)}}return o}function vI(t){const e=Ai(mm,null,!1);return nr(e,xt),e.teardown=t,e}function yI(t){pI();var e=pe.f,r=!ge&&(e&Xn)!==0&&(e&pm)===0;if(r){var n=kr;(n.e??=[]).push(t)}else return pE(t)}function pE(t){return Ai(QR|IM,t,!1)}function bI(t){ys.ensure();const e=Ai(yo|Ba,t,!0);return(r={})=>new Promise(n=>{r.outro?SE(e,()=>{fo(e),n(void 0)}):(fo(e),n(void 0))})}function CI(t){return Ai(vm|Ba,t,!0)}function wE(t,e=0){return Ai(mm|e,t,!0)}function Hg(t,e=[],r=[]){uI(e,r,n=>{Ai(mm,()=>t(...n.map(le)),!0)})}function vE(t,e=0){var r=Ai(Es|e,t,!0);return r}function Pg(t,e=!0){return Ai(Xn|Ba,t,!0,e)}function yE(t){var e=t.teardown;if(e!==null){const r=Co,n=ge;kw(!0),Sn(null);try{e.call(null)}finally{kw(r),Sn(n)}}}function bE(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&$u(()=>{i.abort(ym)});var n=r.next;(r.f&yo)!==0?r.parent=null:fo(r,e),r=n}}function SI(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Xn)===0&&fo(e),e=r}}function fo(t,e=!0){var r=!1;(e||(t.f&eE)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(RI(t.nodes_start,t.nodes_end),r=!0),bE(t,e&&!r),yu(t,0),nr(t,bo);var n=t.transitions;if(n!==null)for(const o of n)o.stop();yE(t);var i=t.parent;i!==null&&i.first!==null&&CE(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function RI(t,e){for(;t!==null;){var r=t===e?null:Tm(t);t.remove(),t=r}}function CE(t){var e=t.parent,r=t.prev,n=t.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function SE(t,e){var r=[];RE(t,r,!0),EI(r,()=>{fo(t),e&&e()})}function EI(t,e){var r=t.length;if(r>0){var n=()=>--r||e();for(var i of t)i.out(n)}else e()}function RE(t,e,r){if((t.f&_i)===0){if(t.f^=_i,t.transitions!==null)for(const s of t.transitions)(s.is_global||r)&&e.push(s);for(var n=t.first;n!==null;){var i=n.next,o=(n.f&wm)!==0||(n.f&Xn)!==0;RE(n,e,o?r:!1),n=i}}}function TI(t){EE(t,!0)}function EE(t,e){if((t.f&_i)!==0){t.f^=_i,(t.f&xt)===0&&(nr(t,Dr),bs(t));for(var r=t.first;r!==null;){var n=r.next,i=(r.f&wm)!==0||(r.f&Xn)!==0;EE(r,i?e:!1),r=n}if(t.transitions!==null)for(const o of t.transitions)(o.is_global||e)&&o.in()}}let cs=!1;function Dw(t){cs=t}let Co=!1;function kw(t){Co=t}let ge=null,yn=!1;function Sn(t){ge=t}let pe=null;function Oi(t){pe=t}let Yn=null;function _I(t){ge!==null&&(Yn===null?Yn=[t]:Yn.push(t))}let Bt=null,dr=0,Hr=null;function OI(t){Hr=t}let TE=1,Pa=0,lo=Pa;function Lw(t){lo=t}let wi=!1;function _E(){return++TE}function ju(t){var e=t.f;if((e&Dr)!==0)return!0;if((e&xi)!==0){var r=t.deps,n=(e&Nr)!==0;if(r!==null){var i,o,s=(e&mu)!==0,a=n&&pe!==null&&!wi,l=r.length;if((s||a)&&(pe===null||(pe.f&bo)===0)){var u=t,c=u.parent;for(i=0;i<l;i++)o=r[i],(s||!o?.reactions?.includes(u))&&(o.reactions??=[]).push(u);s&&(u.f^=mu),a&&c!==null&&(c.f&Nr)===0&&(u.f^=Nr)}for(i=0;i<l;i++)if(o=r[i],ju(o)&&aE(o),o.wv>t.wv)return!0}(!n||pe!==null&&!wi)&&nr(t,xt)}return!1}function OE(t,e,r=!0){var n=t.reactions;if(n!==null&&!Yn?.includes(t))for(var i=0;i<n.length;i++){var o=n[i];(o.f&yr)!==0?OE(o,e,!1):e===o&&(r?nr(o,Dr):(o.f&xt)!==0&&nr(o,xi),bs(o))}}function ME(t){var e=Bt,r=dr,n=Hr,i=ge,o=wi,s=Yn,a=kr,l=yn,u=lo,c=t.f;Bt=null,dr=0,Hr=null,wi=(c&Nr)!==0&&(yn||!cs||ge===null),ge=(c&(Xn|yo))===0?t:null,Yn=null,pu(t.ctx),yn=!1,lo=++Pa,t.ac!==null&&($u(()=>{t.ac.abort(ym)}),t.ac=null);try{t.f|=Tg;var h=t.fn,d=h(),g=t.deps;if(Bt!==null){var w;if(yu(t,dr),g!==null&&dr>0)for(g.length=dr+Bt.length,w=0;w<Bt.length;w++)g[dr+w]=Bt[w];else t.deps=g=Bt;if(!wi||(c&yr)!==0&&t.reactions!==null)for(w=dr;w<g.length;w++)(g[w].reactions??=[]).push(t)}else g!==null&&dr<g.length&&(yu(t,dr),g.length=dr);if(rE()&&Hr!==null&&!yn&&g!==null&&(t.f&(yr|xi|Dr))===0)for(w=0;w<Hr.length;w++)OE(Hr[w],t);return i!==null&&i!==t&&(Pa++,Hr!==null&&(n===null?n=Hr:n.push(...Hr))),(t.f&ao)!==0&&(t.f^=ao),d}catch(v){return tI(v)}finally{t.f^=Tg,Bt=e,dr=r,Hr=n,ge=i,wi=o,Yn=s,pu(a),yn=l,lo=u}}function MI(t,e){let r=e.reactions;if(r!==null){var n=RM.call(r,t);if(n!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[n]=r[i],r.pop())}}r===null&&(e.f&yr)!==0&&(Bt===null||!Bt.includes(e))&&(nr(e,xi),(e.f&(Nr|mu))===0&&(e.f^=mu),sE(e),yu(e,0))}function yu(t,e){var r=t.deps;if(r!==null)for(var n=e;n<r.length;n++)MI(t,r[n])}function hs(t){var e=t.f;if((e&bo)===0){nr(t,xt);var r=pe,n=cs;pe=t,cs=!0;try{(e&Es)!==0?SI(t):bE(t),yE(t);var i=ME(t);t.teardown=typeof i=="function"?i:null,t.wv=TE;var o;GR&&JM&&(t.f&Dr)!==0&&t.deps}finally{cs=n,pe=r}}}async function II(){await Promise.resolve(),hI()}function le(t){var e=t.f,r=(e&yr)!==0;if(ge!==null&&!yn){var n=pe!==null&&(pe.f&bo)!==0;if(!n&&!Yn?.includes(t)){var i=ge.deps;if((ge.f&Tg)!==0)t.rv<Pa&&(t.rv=Pa,Bt===null&&i!==null&&i[dr]===t?dr++:Bt===null?Bt=[t]:(!wi||!Bt.includes(t))&&Bt.push(t));else{(ge.deps??=[]).push(t);var o=t.reactions;o===null?t.reactions=[ge]:o.includes(ge)||o.push(ge)}}}else if(r&&t.deps===null&&t.effects===null){var s=t,a=s.parent;a!==null&&(a.f&Nr)===0&&(s.f^=Nr)}if(Co){if(Ri.has(t))return Ri.get(t);if(r){s=t;var l=s.v;return((s.f&xt)===0&&s.reactions!==null||IE(s))&&(l=Em(s)),Ri.set(s,l),l}}else r&&(s=t,ju(s)&&aE(s));if((t.f&ao)!==0)throw t.v;return t.v}function IE(t){if(t.v===Ct)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Ri.has(e)||(e.f&yr)!==0&&IE(e))return!0;return!1}function zu(t){var e=yn;try{return yn=!0,t()}finally{yn=e}}const HI=-7169;function nr(t,e){t.f=t.f&HI|e}const PI=["touchstart","touchmove"];function xI(t){return PI.includes(t)}const HE=new Set,xg=new Set;function AI(t,e,r,n={}){function i(o){if(n.capture||pa.call(e,o),!o.cancelBubble)return $u(()=>r?.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?oE(()=>{e.addEventListener(t,i,n)}):e.addEventListener(t,i,n),i}function Fw(t,e,r,n,i){var o={capture:n,passive:i},s=AI(t,e,r,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&vI(()=>{e.removeEventListener(t,s,o)})}function PE(t){for(var e=0;e<t.length;e++)HE.add(t[e]);for(var r of xg)r(t)}let Vw=null;function pa(t){var e=this,r=e.ownerDocument,n=t.type,i=t.composedPath?.()||[],o=i[0]||t.target;Vw=t;var s=0,a=Vw===t&&t.__root;if(a){var l=i.indexOf(a);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var u=i.indexOf(e);if(u===-1)return;l<=u&&(s=l)}if(o=i[s]||t.target,o!==e){Eg(t,"currentTarget",{configurable:!0,get(){return o||r}});var c=ge,h=pe;Sn(null),Oi(null);try{for(var d,g=[];o!==null;){var w=o.assignedSlot||o.parentNode||o.host||null;try{var v=o["__"+n];if(v!=null&&(!o.disabled||t.target===o))if(KR(v)){var[b,...E]=v;b.apply(o,[t,...E])}else v.call(o,t)}catch(R){d?g.push(R):d=R}if(t.cancelBubble||w===e||w===null)break;o=w}if(d){for(let R of g)queueMicrotask(()=>{throw R});throw d}}finally{t.__root=e,delete t.currentTarget,Sn(c),Oi(h)}}}function NI(t){var e;e=document.head.appendChild(Bu());try{vE(()=>t(e),eE)}finally{}}function DI(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function Ag(t,e){var r=pe;r.nodes_start===null&&(r.nodes_start=t,r.nodes_end=e)}function Uu(t,e){var r=(e&GM)!==0,n=(e&KM)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=DI(o?t:"<!>"+t),r||(i=vu(i)));var s=n||dE?document.importNode(i,!0):i.cloneNode(!0);if(r){var a=vu(s),l=s.lastChild;Ag(a,l)}else Ag(s,s);return s}}function kI(t){return()=>LI(t())}function LI(t){const e=t.nodeType===xM,r=t.tagName==="SCRIPT"?[t]:t.querySelectorAll("script"),n=pe;for(const o of r){const s=document.createElement("script");for(var i of o.attributes)s.setAttribute(i.name,i.value);s.textContent=o.textContent,(e?t.firstChild===o:t===o)&&(n.nodes_start=s),(e?t.lastChild===o:t===o)&&(n.nodes_end=s),o.replaceWith(s)}return t}function FI(){var t=document.createDocumentFragment(),e=document.createComment(""),r=Bu();return t.append(e,r),Ag(e,r),t}function Ra(t,e){t!==null&&t.before(e)}function Lc(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??=t.nodeValue)&&(t.__t=r,t.nodeValue=r+"")}function VI(t,e){return WI(t,e)}const Do=new Map;function WI(t,{target:e,anchor:r,props:n={},events:i,context:o,intro:s=!0}){fI();var a=new Set,l=h=>{for(var d=0;d<h.length;d++){var g=h[d];if(!a.has(g)){a.add(g);var w=xI(g);e.addEventListener(g,pa,{passive:w});var v=Do.get(g);v===void 0?(document.addEventListener(g,pa,{passive:w}),Do.set(g,1)):Do.set(g,v+1)}}};l(EM(HE)),xg.add(l);var u=void 0,c=bI(()=>{var h=r??e.appendChild(Bu());return Pg(()=>{if(o){bm({});var d=kr;d.c=o}i&&(n.$$events=i),u=t(h,n)||{},o&&Cm()}),()=>{for(var d of a){e.removeEventListener(d,pa);var g=Do.get(d);--g===0?(document.removeEventListener(d,pa),Do.delete(d)):Do.set(d,g)}xg.delete(l),h!==r&&h.parentNode?.removeChild(h)}});return BI.set(u,c),u}let BI=new WeakMap;function $I(t,e,r=!1){var n=t,i=null,o=null,s=Ct,a=r?wm:0,l=!1;const u=(g,w=!0)=>{l=!0,d(w,g)};var c=null;function h(){c!==null&&(c.lastChild.remove(),n.before(c),c=null);var g=s?i:o,w=s?o:i;g&&TI(g),w&&SE(w,()=>{s?o=null:i=null})}const d=(g,w)=>{if(s!==(s=g)){var v=gI(),b=n;if(v&&(c=document.createDocumentFragment(),c.append(b=Bu())),s?i??=w&&Pg(()=>w(b)):o??=w&&Pg(()=>w(b)),v){var E=je,R=s?i:o,T=s?o:i;R&&E.skipped_effects.delete(R),T&&E.skipped_effects.add(T),E.add_callback(h)}else h()}};vE(()=>{l=!1,e(u),l||d(null,null)},a)}const jI=Symbol("is custom element"),zI=Symbol("is html");function Ww(t,e){var r=xE(t);r.checked!==(r.checked=e??void 0)&&(t.checked=e)}function Fi(t,e,r,n){var i=xE(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[PM]=r),r==null?t.removeAttribute(e):typeof r!="string"&&UI(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function xE(t){return t.__attributes??={[jI]:t.nodeName.includes("-"),[zI]:t.namespaceURI===XM}}var Bw=new Map;function UI(t){var e=t.getAttribute("is")||t.nodeName,r=Bw.get(e);if(r)return r;Bw.set(e,r=[]);for(var n,i=t,o=Element.prototype;o!==i;){n=TM(i);for(var s in n)n[s].set&&r.push(s);i=XR(i)}return r}function YI(t,e,r=e){var n=new WeakSet;mE(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=Fc(t)?Vc(o):o,r(o),je!==null&&n.add(je),await II(),o!==(o=e())){var s=t.selectionStart,a=t.selectionEnd;t.value=o??"",a!==null&&(t.selectionStart=s,t.selectionEnd=Math.min(a,t.value.length))}}),zu(e)==null&&t.value&&(r(Fc(t)?Vc(t.value):t.value),je!==null&&n.add(je)),wE(()=>{var i=e();if(t===document.activeElement){var o=eu??je;if(n.has(o))return}Fc(t)&&i===Vc(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function $w(t,e,r=e){mE(t,"change",n=>{var i=n?t.defaultChecked:t.checked;r(i)}),zu(e)==null&&r(t.checked),wE(()=>{var n=e();t.checked=!!n})}function Fc(t){var e=t.type;return e==="number"||e==="range"}function Vc(t){return t===""?null:+t}let ul=!1;function qI(t){var e=ul;try{return ul=!1,[t(),ul]}finally{ul=e}}function Wc(t,e,r,n){var i=(r&YM)!==0,o=(r&qM)!==0,s=n,a=!0,l=()=>(a&&(a=!1,s=o?zu(n):n),s),u;if(i){var c=Jl in t||HM in t;u=us(t,e)?.set??(c&&e in t?R=>t[e]=R:void 0)}var h,d=!1;i?[h,d]=qI(()=>t[e]):h=t[e],h===void 0&&n!==void 0&&(h=l(),u&&(WM(),u(h)));var g;if(g=()=>{var R=t[e];return R===void 0?l():(a=!0,R)},(r&UM)===0)return g;if(u){var w=t.$$legacy;return function(R,T){return arguments.length>0?((!T||w||d)&&u(T?g():R),R):g()}}var v=!1,b=((r&zM)!==0?Rm:aI)(()=>(v=!1,g()));i&&le(b);var E=pe;return function(R,T){if(arguments.length>0){const y=T?le(b):i?is(R):R;return de(b,y),v=!0,s!==void 0&&(s=y),R}return Co&&v||(E.f&bo)!==0?b.v:le(b)}}function GI(t){kr===null&&NM(),yI(()=>{const e=zu(t);if(typeof e=="function")return e})}const KI="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(KI);var jw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},zw={},ks,Uw;function Je(){if(Uw)return ks;Uw=1;var t=function(e){return e&&e.Math===Math&&e};return ks=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof jw=="object"&&jw)||t(typeof ks=="object"&&ks)||function(){return this}()||Function("return this")(),ks}var Bc={},$c,Yw;function lt(){return Yw||(Yw=1,$c=function(t){try{return!!t()}catch{return!0}}),$c}var jc,qw;function Vr(){if(qw)return jc;qw=1;var t=lt();return jc=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),jc}var zc,Gw;function Yu(){if(Gw)return zc;Gw=1;var t=lt();return zc=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),zc}var Uc,Kw;function mt(){if(Kw)return Uc;Kw=1;var t=Yu(),e=Function.prototype.call;return Uc=t?e.bind(e):function(){return e.apply(e,arguments)},Uc}var Yc={},Xw;function XI(){if(Xw)return Yc;Xw=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return Yc.f=r?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,Yc}var qc,Zw;function qu(){return Zw||(Zw=1,qc=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),qc}var Gc,Qw;function et(){if(Qw)return Gc;Qw=1;var t=Yu(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return Gc=t?n:function(i){return function(){return r.apply(i,arguments)}},Gc}var Kc,Jw;function So(){if(Jw)return Kc;Jw=1;var t=et(),e=t({}.toString),r=t("".slice);return Kc=function(n){return r(e(n),8,-1)},Kc}var Xc,ev;function ZI(){if(ev)return Xc;ev=1;var t=et(),e=lt(),r=So(),n=Object,i=t("".split);return Xc=e(function(){return!n("z").propertyIsEnumerable(0)})?function(o){return r(o)==="String"?i(o,""):n(o)}:n,Xc}var Zc,tv;function _m(){return tv||(tv=1,Zc=function(t){return t==null}),Zc}var Qc,rv;function $a(){if(rv)return Qc;rv=1;var t=_m(),e=TypeError;return Qc=function(r){if(t(r))throw new e("Can't call method on "+r);return r},Qc}var Jc,nv;function ja(){if(nv)return Jc;nv=1;var t=ZI(),e=$a();return Jc=function(r){return t(e(r))},Jc}var eh,iv;function ut(){if(iv)return eh;iv=1;var t=typeof document=="object"&&document.all;return eh=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},eh}var th,ov;function Wr(){if(ov)return th;ov=1;var t=ut();return th=function(e){return typeof e=="object"?e!==null:t(e)},th}var rh,sv;function Ts(){if(sv)return rh;sv=1;var t=Je(),e=ut(),r=function(n){return e(n)?n:void 0};return rh=function(n,i){return arguments.length<2?r(t[n]):t[n]&&t[n][i]},rh}var nh,av;function za(){if(av)return nh;av=1;var t=et();return nh=t({}.isPrototypeOf),nh}var ih,lv;function Gu(){if(lv)return ih;lv=1;var t=Je(),e=t.navigator,r=e&&e.userAgent;return ih=r?String(r):"",ih}var oh,uv;function QI(){if(uv)return oh;uv=1;var t=Je(),e=Gu(),r=t.process,n=t.Deno,i=r&&r.versions||n&&n.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),oh=a,oh}var sh,cv;function Om(){if(cv)return sh;cv=1;var t=QI(),e=lt(),r=Je(),n=r.String;return sh=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!n(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),sh}var ah,hv;function AE(){if(hv)return ah;hv=1;var t=Om();return ah=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",ah}var lh,dv;function Mm(){if(dv)return lh;dv=1;var t=Ts(),e=ut(),r=za(),n=AE(),i=Object;return lh=n?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&r(s.prototype,i(o))},lh}var uh,fv;function Ku(){if(fv)return uh;fv=1;var t=String;return uh=function(e){try{return t(e)}catch{return"Object"}},uh}var ch,gv;function br(){if(gv)return ch;gv=1;var t=ut(),e=Ku(),r=TypeError;return ch=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")},ch}var hh,mv;function Ua(){if(mv)return hh;mv=1;var t=br(),e=_m();return hh=function(r,n){var i=r[n];return e(i)?void 0:t(i)},hh}var dh,pv;function JI(){if(pv)return dh;pv=1;var t=mt(),e=ut(),r=Wr(),n=TypeError;return dh=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!r(a=t(s,i))||e(s=i.valueOf)&&!r(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!r(a=t(s,i)))return a;throw new n("Can't convert object to primitive value")},dh}var fh={exports:{}},gh,wv;function Ro(){return wv||(wv=1,gh=!1),gh}var mh,vv;function Im(){if(vv)return mh;vv=1;var t=Je(),e=Object.defineProperty;return mh=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch{t[r]=n}return n},mh}var yv;function Hm(){if(yv)return fh.exports;yv=1;var t=Ro(),e=Je(),r=Im(),n="__core-js_shared__",i=fh.exports=e[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.43.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"}),fh.exports}var ph,bv;function NE(){if(bv)return ph;bv=1;var t=Hm();return ph=function(e,r){return t[e]||(t[e]=r||{})},ph}var wh,Cv;function _s(){if(Cv)return wh;Cv=1;var t=$a(),e=Object;return wh=function(r){return e(t(r))},wh}var vh,Sv;function Br(){if(Sv)return vh;Sv=1;var t=et(),e=_s(),r=t({}.hasOwnProperty);return vh=Object.hasOwn||function(i,o){return r(e(i),o)},vh}var yh,Rv;function DE(){if(Rv)return yh;Rv=1;var t=et(),e=0,r=Math.random(),n=t(1.1.toString);return yh=function(i){return"Symbol("+(i===void 0?"":i)+")_"+n(++e+r,36)},yh}var bh,Ev;function sn(){if(Ev)return bh;Ev=1;var t=Je(),e=NE(),r=Br(),n=DE(),i=Om(),o=AE(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||n;return bh=function(u){return r(a,u)||(a[u]=i&&r(s,u)?s[u]:l("Symbol."+u)),a[u]},bh}var Ch,Tv;function eH(){if(Tv)return Ch;Tv=1;var t=mt(),e=Wr(),r=Mm(),n=Ua(),i=JI(),o=sn(),s=TypeError,a=o("toPrimitive");return Ch=function(l,u){if(!e(l)||r(l))return l;var c=n(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||r(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},Ch}var Sh,_v;function kE(){if(_v)return Sh;_v=1;var t=eH(),e=Mm();return Sh=function(r){var n=t(r,"string");return e(n)?n:n+""},Sh}var Rh,Ov;function Pm(){if(Ov)return Rh;Ov=1;var t=Je(),e=Wr(),r=t.document,n=e(r)&&e(r.createElement);return Rh=function(i){return n?r.createElement(i):{}},Rh}var Eh,Mv;function LE(){if(Mv)return Eh;Mv=1;var t=Vr(),e=lt(),r=Pm();return Eh=!t&&!e(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7}),Eh}var Iv;function FE(){if(Iv)return Bc;Iv=1;var t=Vr(),e=mt(),r=XI(),n=qu(),i=ja(),o=kE(),s=Br(),a=LE(),l=Object.getOwnPropertyDescriptor;return Bc.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return n(!e(r.f,c,h),c[h])},Bc}var Th={},_h,Hv;function VE(){if(Hv)return _h;Hv=1;var t=Vr(),e=lt();return _h=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),_h}var Oh,Pv;function pt(){if(Pv)return Oh;Pv=1;var t=Wr(),e=String,r=TypeError;return Oh=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")},Oh}var xv;function Ni(){if(xv)return Th;xv=1;var t=Vr(),e=LE(),r=VE(),n=pt(),i=kE(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return Th.f=t?r?function(d,g,w){if(n(d),g=i(g),n(w),typeof d=="function"&&g==="prototype"&&"value"in w&&c in w&&!w[c]){var v=a(d,g);v&&v[c]&&(d[g]=w.value,w={configurable:u in w?w[u]:v[u],enumerable:l in w?w[l]:v[l],writable:!1})}return s(d,g,w)}:s:function(d,g,w){if(n(d),g=i(g),n(w),e)try{return s(d,g,w)}catch{}if("get"in w||"set"in w)throw new o("Accessors not supported");return"value"in w&&(d[g]=w.value),d},Th}var Mh,Av;function Os(){if(Av)return Mh;Av=1;var t=Vr(),e=Ni(),r=qu();return Mh=t?function(n,i,o){return e.f(n,i,r(1,o))}:function(n,i,o){return n[i]=o,n},Mh}var Ih={exports:{}},Hh,Nv;function tH(){if(Nv)return Hh;Nv=1;var t=Vr(),e=Br(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,i=e(r,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&n(r,"name").configurable);return Hh={EXISTS:i,PROPER:o,CONFIGURABLE:s},Hh}var Ph,Dv;function rH(){if(Dv)return Ph;Dv=1;var t=et(),e=ut(),r=Hm(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(i){return n(i)}),Ph=r.inspectSource,Ph}var xh,kv;function nH(){if(kv)return xh;kv=1;var t=Je(),e=ut(),r=t.WeakMap;return xh=e(r)&&/native code/.test(String(r)),xh}var Ah,Lv;function xm(){if(Lv)return Ah;Lv=1;var t=NE(),e=DE(),r=t("keys");return Ah=function(n){return r[n]||(r[n]=e(n))},Ah}var Nh,Fv;function Am(){return Fv||(Fv=1,Nh={}),Nh}var Dh,Vv;function WE(){if(Vv)return Dh;Vv=1;var t=nH(),e=Je(),r=Wr(),n=Os(),i=Br(),o=Hm(),s=xm(),a=Am(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,g,w=function(R){return g(R)?d(R):h(R,{})},v=function(R){return function(T){var y;if(!r(T)||(y=d(T)).type!==R)throw new u("Incompatible receiver, "+R+" required");return y}};if(t||o.state){var b=o.state||(o.state=new c);b.get=b.get,b.has=b.has,b.set=b.set,h=function(R,T){if(b.has(R))throw new u(l);return T.facade=R,b.set(R,T),T},d=function(R){return b.get(R)||{}},g=function(R){return b.has(R)}}else{var E=s("state");a[E]=!0,h=function(R,T){if(i(R,E))throw new u(l);return T.facade=R,n(R,E,T),T},d=function(R){return i(R,E)?R[E]:{}},g=function(R){return i(R,E)}}return Dh={set:h,get:d,has:g,enforce:w,getterFor:v},Dh}var Wv;function BE(){if(Wv)return Ih.exports;Wv=1;var t=et(),e=lt(),r=ut(),n=Br(),i=Vr(),o=tH().CONFIGURABLE,s=rH(),a=WE(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),g=t("".replace),w=t([].join),v=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),b=String(String).split("String"),E=Ih.exports=function(R,T,y){d(c(T),0,7)==="Symbol("&&(T="["+g(c(T),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),y&&y.getter&&(T="get "+T),y&&y.setter&&(T="set "+T),(!n(R,"name")||o&&R.name!==T)&&(i?h(R,"name",{value:T,configurable:!0}):R.name=T),v&&y&&n(y,"arity")&&R.length!==y.arity&&h(R,"length",{value:y.arity});try{y&&n(y,"constructor")&&y.constructor?i&&h(R,"prototype",{writable:!1}):R.prototype&&(R.prototype=void 0)}catch{}var M=l(R);return n(M,"source")||(M.source=w(b,typeof T=="string"?T:"")),R};return Function.prototype.toString=E(function(){return r(this)&&u(this).source||s(this)},"toString"),Ih.exports}var kh,Bv;function Nm(){if(Bv)return kh;Bv=1;var t=ut(),e=Ni(),r=BE(),n=Im();return kh=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&r(s,u,a),a.global)l?i[o]=s:n(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},kh}var Lh={},Fh,$v;function iH(){if($v)return Fh;$v=1;var t=Math.ceil,e=Math.floor;return Fh=Math.trunc||function(n){var i=+n;return(i>0?e:t)(i)},Fh}var Vh,jv;function Ya(){if(jv)return Vh;jv=1;var t=iH();return Vh=function(e){var r=+e;return r!==r||r===0?0:t(r)},Vh}var Wh,zv;function oH(){if(zv)return Wh;zv=1;var t=Ya(),e=Math.max,r=Math.min;return Wh=function(n,i){var o=t(n);return o<0?e(o+i,0):r(o,i)},Wh}var Bh,Uv;function sH(){if(Uv)return Bh;Uv=1;var t=Ya(),e=Math.min;return Bh=function(r){var n=t(r);return n>0?e(n,9007199254740991):0},Bh}var $h,Yv;function Ms(){if(Yv)return $h;Yv=1;var t=sH();return $h=function(e){return t(e.length)},$h}var jh,qv;function aH(){if(qv)return jh;qv=1;var t=ja(),e=oH(),r=Ms(),n=function(i){return function(o,s,a){var l=t(o),u=r(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return jh={includes:n(!0),indexOf:n(!1)},jh}var zh,Gv;function $E(){if(Gv)return zh;Gv=1;var t=et(),e=Br(),r=ja(),n=aH().indexOf,i=Am(),o=t([].push);return zh=function(s,a){var l=r(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~n(c,h)||o(c,h));return c},zh}var Uh,Kv;function Dm(){return Kv||(Kv=1,Uh=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),Uh}var Xv;function lH(){if(Xv)return Lh;Xv=1;var t=$E(),e=Dm(),r=e.concat("length","prototype");return Lh.f=Object.getOwnPropertyNames||function(i){return t(i,r)},Lh}var Yh={},Zv;function uH(){return Zv||(Zv=1,Yh.f=Object.getOwnPropertySymbols),Yh}var qh,Qv;function cH(){if(Qv)return qh;Qv=1;var t=Ts(),e=et(),r=lH(),n=uH(),i=pt(),o=e([].concat);return qh=t("Reflect","ownKeys")||function(a){var l=r.f(i(a)),u=n.f;return u?o(l,u(a)):l},qh}var Gh,Jv;function jE(){if(Jv)return Gh;Jv=1;var t=Br(),e=cH(),r=FE(),n=Ni();return Gh=function(i,o,s){for(var a=e(o),l=n.f,u=r.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},Gh}var Kh,ey;function hH(){if(ey)return Kh;ey=1;var t=lt(),e=ut(),r=/#|\.prototype\./,n=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=n.normalize=function(l){return String(l).replace(r,".").toLowerCase()},o=n.data={},s=n.NATIVE="N",a=n.POLYFILL="P";return Kh=n,Kh}var Xh,ty;function Ae(){if(ty)return Xh;ty=1;var t=Je(),e=FE().f,r=Os(),n=Nm(),i=Im(),o=jE(),s=hH();return Xh=function(a,l){var u=a.target,c=a.global,h=a.stat,d,g,w,v,b,E;if(c?g=t:h?g=t[u]||i(u,{}):g=t[u]&&t[u].prototype,g)for(w in l){if(b=l[w],a.dontCallGetSet?(E=e(g,w),v=E&&E.value):v=g[w],d=s(c?w:u+(h?".":"#")+w,a.forced),!d&&v!==void 0){if(typeof b==typeof v)continue;o(b,v)}(a.sham||v&&v.sham)&&r(b,"sham",!0),n(g,w,b,a)}},Xh}var Zh,ry;function qa(){if(ry)return Zh;ry=1;var t=Yu(),e=Function.prototype,r=e.apply,n=e.call;return Zh=typeof Reflect=="object"&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),Zh}var Qh,ny;function zE(){if(ny)return Qh;ny=1;var t=et(),e=br();return Qh=function(r,n,i){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[i]))}catch{}},Qh}var Jh,iy;function dH(){if(iy)return Jh;iy=1;var t=Wr();return Jh=function(e){return t(e)||e===null},Jh}var ed,oy;function fH(){if(oy)return ed;oy=1;var t=dH(),e=String,r=TypeError;return ed=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")},ed}var td,sy;function UE(){if(sy)return td;sy=1;var t=zE(),e=Wr(),r=$a(),n=fH();return td=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return r(l),n(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),td}var rd,ay;function gH(){if(ay)return rd;ay=1;var t=Ni().f;return rd=function(e,r,n){n in e||t(e,n,{configurable:!0,get:function(){return r[n]},set:function(i){r[n]=i}})},rd}var nd,ly;function mH(){if(ly)return nd;ly=1;var t=ut(),e=Wr(),r=UE();return nd=function(n,i,o){var s,a;return r&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&r(n,a),n},nd}var id,uy;function pH(){if(uy)return id;uy=1;var t=sn(),e=t("toStringTag"),r={};return r[e]="z",id=String(r)==="[object z]",id}var od,cy;function YE(){if(cy)return od;cy=1;var t=pH(),e=ut(),r=So(),n=sn(),i=n("toStringTag"),o=Object,s=r(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return od=t?r:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?r(u):(h=r(u))==="Object"&&e(u.callee)?"Arguments":h},od}var sd,hy;function Xu(){if(hy)return sd;hy=1;var t=YE(),e=String;return sd=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(r)},sd}var ad,dy;function wH(){if(dy)return ad;dy=1;var t=Xu();return ad=function(e,r){return e===void 0?arguments.length<2?"":r:t(e)},ad}var ld,fy;function vH(){if(fy)return ld;fy=1;var t=Wr(),e=Os();return ld=function(r,n){t(n)&&"cause"in n&&e(r,"cause",n.cause)},ld}var ud,gy;function yH(){if(gy)return ud;gy=1;var t=et(),e=Error,r=t("".replace),n=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(n);return ud=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=r(s,i,"");return s},ud}var cd,my;function bH(){if(my)return cd;my=1;var t=lt(),e=qu();return cd=!t(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",e(1,7)),r.stack!==7):!0}),cd}var hd,py;function CH(){if(py)return hd;py=1;var t=Os(),e=yH(),r=bH(),n=Error.captureStackTrace;return hd=function(i,o,s,a){r&&(n?n(i,o):t(i,"stack",e(s,a)))},hd}var dd,wy;function SH(){if(wy)return dd;wy=1;var t=Ts(),e=Br(),r=Os(),n=za(),i=UE(),o=jE(),s=gH(),a=mH(),l=wH(),u=vH(),c=CH(),h=Vr(),d=Ro();return dd=function(g,w,v,b){var E="stackTraceLimit",R=b?2:1,T=g.split("."),y=T[T.length-1],M=t.apply(null,T);if(M){var x=M.prototype;if(!d&&e(x,"cause")&&delete x.cause,!v)return M;var P=t("Error"),D=w(function(F,W){var q=l(b?W:F,void 0),L=b?new M(F):new M;return q!==void 0&&r(L,"message",q),c(L,D,L.stack,2),this&&n(x,this)&&a(L,this,D),arguments.length>R&&u(L,arguments[R]),L});if(D.prototype=x,y!=="Error"?i?i(D,P):o(D,P,{name:!0}):h&&E in M&&(s(D,M,E),s(D,M,"prepareStackTrace")),o(D,M),!d)try{x.name!==y&&r(x,"name",y),x.constructor=D}catch{}return D}},dd}var vy;function RH(){if(vy)return zw;vy=1;var t=Ae(),e=Je(),r=qa(),n=SH(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=n(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=n(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return r(u,this,arguments)}}),a("EvalError",function(u){return function(h){return r(u,this,arguments)}}),a("RangeError",function(u){return function(h){return r(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return r(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return r(u,this,arguments)}}),a("TypeError",function(u){return function(h){return r(u,this,arguments)}}),a("URIError",function(u){return function(h){return r(u,this,arguments)}}),l("CompileError",function(u){return function(h){return r(u,this,arguments)}}),l("LinkError",function(u){return function(h){return r(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return r(u,this,arguments)}}),zw}RH();var yy={},fd,by;function qE(){if(by)return fd;by=1;var t=So();return fd=Array.isArray||function(r){return t(r)==="Array"},fd}var gd,Cy;function GE(){if(Cy)return gd;Cy=1;var t=Vr(),e=qE(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return gd=i?function(o,s){if(e(o)&&!n(o,"length").writable)throw new r("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},gd}var md,Sy;function KE(){if(Sy)return md;Sy=1;var t=TypeError,e=9007199254740991;return md=function(r){if(r>e)throw t("Maximum allowed index exceeded");return r},md}var Ry;function EH(){if(Ry)return yy;Ry=1;var t=Ae(),e=_s(),r=Ms(),n=GE(),i=KE(),o=lt(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=r(h),g=arguments.length;i(d+g);for(var w=0;w<g;w++)h[d]=arguments[w],d++;return n(h,d),d}}),yy}EH();var Ey={},pd,Ty;function TH(){if(Ty)return pd;Ty=1;var t=So(),e=et();return pd=function(r){if(t(r)==="Function")return e(r)},pd}var wd,_y;function XE(){if(_y)return wd;_y=1;var t=TH(),e=br(),r=Yu(),n=t(t.bind);return wd=function(i,o){return e(i),o===void 0?i:r?n(i,o):function(){return i.apply(o,arguments)}},wd}var vd,Oy;function ZE(){return Oy||(Oy=1,vd={}),vd}var yd,My;function _H(){if(My)return yd;My=1;var t=sn(),e=ZE(),r=t("iterator"),n=Array.prototype;return yd=function(i){return i!==void 0&&(e.Array===i||n[r]===i)},yd}var bd,Iy;function QE(){if(Iy)return bd;Iy=1;var t=YE(),e=Ua(),r=_m(),n=ZE(),i=sn(),o=i("iterator");return bd=function(s){if(!r(s))return e(s,o)||e(s,"@@iterator")||n[t(s)]},bd}var Cd,Hy;function OH(){if(Hy)return Cd;Hy=1;var t=mt(),e=br(),r=pt(),n=Ku(),i=QE(),o=TypeError;return Cd=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return r(t(l,s));throw new o(n(s)+" is not iterable")},Cd}var Sd,Py;function Cr(){if(Py)return Sd;Py=1;var t=mt(),e=pt(),r=Ua();return Sd=function(n,i,o){var s,a;e(n);try{if(s=r(n,"return"),!s){if(i==="throw")throw o;return o}s=t(s,n)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},Sd}var Rd,xy;function Is(){if(xy)return Rd;xy=1;var t=XE(),e=mt(),r=pt(),n=Ku(),i=_H(),o=Ms(),s=za(),a=OH(),l=QE(),u=Cr(),c=TypeError,h=function(g,w){this.stopped=g,this.result=w},d=h.prototype;return Rd=function(g,w,v){var b=v&&v.that,E=!!(v&&v.AS_ENTRIES),R=!!(v&&v.IS_RECORD),T=!!(v&&v.IS_ITERATOR),y=!!(v&&v.INTERRUPTED),M=t(w,b),x,P,D,F,W,q,L,oe=function(J){return x&&u(x,"normal"),new h(!0,J)},G=function(J){return E?(r(J),y?M(J[0],J[1],oe):M(J[0],J[1])):y?M(J,oe):M(J)};if(R)x=g.iterator;else if(T)x=g;else{if(P=l(g),!P)throw new c(n(g)+" is not iterable");if(i(P)){for(D=0,F=o(g);F>D;D++)if(W=G(g[D]),W&&s(d,W))return W;return new h(!1)}x=a(g,P)}for(q=R?g.next:x.next;!(L=e(q,x)).done;){try{W=G(L.value)}catch(J){u(x,"throw",J)}if(typeof W=="object"&&W&&s(d,W))return W}return new h(!1)},Rd}var Ed,Ay;function JE(){if(Ay)return Ed;Ay=1;var t=Vr(),e=Ni(),r=qu();return Ed=function(n,i,o){t?e.f(n,i,r(0,o)):n[i]=o},Ed}var Ny;function MH(){if(Ny)return Ey;Ny=1;var t=Ae(),e=Is(),r=JE();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){r(o,s,a)},{AS_ENTRIES:!0}),o}}),Ey}MH();var Dy={},Td,ky;function En(){if(ky)return Td;ky=1;var t=et(),e=Set.prototype;return Td={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},Td}var _d,Ly;function Eo(){if(Ly)return _d;Ly=1;var t=En().has;return _d=function(e){return t(e),e},_d}var Od,Fy;function To(){if(Fy)return Od;Fy=1;var t=mt();return Od=function(e,r,n){for(var i=n?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=r(s.value),a!==void 0)return a},Od}var Md,Vy;function Ga(){if(Vy)return Md;Vy=1;var t=et(),e=To(),r=En(),n=r.Set,i=r.proto,o=t(i.forEach),s=t(i.keys),a=s(new n).next;return Md=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},Md}var Id,Wy;function km(){if(Wy)return Id;Wy=1;var t=En(),e=Ga(),r=t.Set,n=t.add;return Id=function(i){var o=new r;return e(i,function(s){n(o,s)}),o},Id}var Hd,By;function Ka(){if(By)return Hd;By=1;var t=zE(),e=En();return Hd=t(e.proto,"size","get")||function(r){return r.size},Hd}var Pd,$y;function Di(){return $y||($y=1,Pd=function(t){return{iterator:t,next:t.next,done:!1}}),Pd}var xd,jy;function _o(){if(jy)return xd;jy=1;var t=br(),e=pt(),r=mt(),n=Ya(),i=Di(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(r(this.keys,this.set)))},includes:function(c){return r(this.has,this.set,c)}},xd=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=n(h);if(d<0)throw new s(o);return new u(c,d)},xd}var Ad,zy;function IH(){if(zy)return Ad;zy=1;var t=Eo(),e=En(),r=km(),n=Ka(),i=_o(),o=Ga(),s=To(),a=e.has,l=e.remove;return Ad=function(c){var h=t(this),d=i(c),g=r(h);return n(h)<=d.size?o(h,function(w){d.includes(w)&&l(g,w)}):s(d.getIterator(),function(w){a(g,w)&&l(g,w)}),g},Ad}var Nd,Uy;function Oo(){if(Uy)return Nd;Uy=1;var t=Ts(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return Nd=function(n,i){var o=t("Set");try{new o()[n](e(0));try{return new o()[n](e(-1)),!1}catch{if(!i)return!0;try{return new o()[n](r(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[n](r(1/0)))}}}catch{return!1}},Nd}var Yy;function HH(){if(Yy)return Dy;Yy=1;var t=Ae(),e=IH(),r=lt(),n=Oo(),i=!n("difference",function(s){return s.size===0}),o=i||r(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),Dy}HH();var qy={},Dd,Gy;function PH(){if(Gy)return Dd;Gy=1;var t=Eo(),e=En(),r=Ka(),n=_o(),i=Ga(),o=To(),s=e.Set,a=e.add,l=e.has;return Dd=function(c){var h=t(this),d=n(c),g=new s;return r(h)>d.size?o(d.getIterator(),function(w){l(h,w)&&a(g,w)}):i(h,function(w){d.includes(w)&&a(g,w)}),g},Dd}var Ky;function xH(){if(Ky)return qy;Ky=1;var t=Ae(),e=lt(),r=PH(),n=Oo(),i=!n("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:r}),qy}xH();var Xy={},kd,Zy;function AH(){if(Zy)return kd;Zy=1;var t=Eo(),e=En().has,r=Ka(),n=_o(),i=Ga(),o=To(),s=Cr();return kd=function(l){var u=t(this),c=n(l);if(r(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},kd}var Qy;function NH(){if(Qy)return Xy;Qy=1;var t=Ae(),e=AH(),r=Oo(),n=!r("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),Xy}NH();var Jy={},Ld,eb;function DH(){if(eb)return Ld;eb=1;var t=Eo(),e=Ka(),r=Ga(),n=_o();return Ld=function(o){var s=t(this),a=n(o);return e(s)>a.size?!1:r(s,function(l){if(!a.includes(l))return!1},!0)!==!1},Ld}var tb;function kH(){if(tb)return Jy;tb=1;var t=Ae(),e=DH(),r=Oo(),n=!r("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),Jy}kH();var rb={},Fd,nb;function LH(){if(nb)return Fd;nb=1;var t=Eo(),e=En().has,r=Ka(),n=_o(),i=To(),o=Cr();return Fd=function(a){var l=t(this),u=n(a);if(r(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},Fd}var ib;function FH(){if(ib)return rb;ib=1;var t=Ae(),e=LH(),r=Oo(),n=!r("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),rb}FH();var ob={},Vd,sb;function VH(){if(sb)return Vd;sb=1;var t=Eo(),e=En(),r=km(),n=_o(),i=To(),o=e.add,s=e.has,a=e.remove;return Vd=function(u){var c=t(this),h=n(u).getIterator(),d=r(c);return i(h,function(g){s(c,g)?a(d,g):o(d,g)}),d},Vd}var Wd,ab;function eT(){return ab||(ab=1,Wd=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size!==1||n.values().next().value!==4}catch{return!1}}),Wd}var lb;function WH(){if(lb)return ob;lb=1;var t=Ae(),e=VH(),r=eT(),n=Oo(),i=!n("symmetricDifference")||!r("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),ob}WH();var ub={},Bd,cb;function BH(){if(cb)return Bd;cb=1;var t=Eo(),e=En().add,r=km(),n=_o(),i=To();return Bd=function(s){var a=t(this),l=n(s).getIterator(),u=r(a);return i(l,function(c){e(u,c)}),u},Bd}var hb;function $H(){if(hb)return ub;hb=1;var t=Ae(),e=BH(),r=eT(),n=Oo(),i=!n("union")||!r("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),ub}$H();var db={},fb={},$d,gb;function jH(){if(gb)return $d;gb=1;var t=za(),e=TypeError;return $d=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")},$d}var jd,mb;function zH(){if(mb)return jd;mb=1;var t=lt();return jd=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),jd}var zd,pb;function tT(){if(pb)return zd;pb=1;var t=Br(),e=ut(),r=_s(),n=xm(),i=zH(),o=n("IE_PROTO"),s=Object,a=s.prototype;return zd=i?s.getPrototypeOf:function(l){var u=r(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},zd}var Ud,wb;function UH(){if(wb)return Ud;wb=1;var t=BE(),e=Ni();return Ud=function(r,n,i){return i.get&&t(i.get,n,{getter:!0}),i.set&&t(i.set,n,{setter:!0}),e.f(r,n,i)},Ud}var Yd={},qd,vb;function YH(){if(vb)return qd;vb=1;var t=$E(),e=Dm();return qd=Object.keys||function(n){return t(n,e)},qd}var yb;function qH(){if(yb)return Yd;yb=1;var t=Vr(),e=VE(),r=Ni(),n=pt(),i=ja(),o=YH();return Yd.f=t&&!e?Object.defineProperties:function(a,l){n(a);for(var u=i(l),c=o(l),h=c.length,d=0,g;h>d;)r.f(a,g=c[d++],u[g]);return a},Yd}var Gd,bb;function rT(){if(bb)return Gd;bb=1;var t=Ts();return Gd=t("document","documentElement"),Gd}var Kd,Cb;function Lm(){if(Cb)return Kd;Cb=1;var t=pt(),e=qH(),r=Dm(),n=Am(),i=rT(),o=Pm(),s=xm(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},g=function(R){return l+c+a+R+l+"/"+c+a},w=function(R){R.write(g("")),R.close();var T=R.parentWindow.Object;return R=null,T},v=function(){var R=o("iframe"),T="java"+c+":",y;return R.style.display="none",i.appendChild(R),R.src=String(T),y=R.contentWindow.document,y.open(),y.write(g("document.F=Object")),y.close(),y.F},b,E=function(){try{b=new ActiveXObject("htmlfile")}catch{}E=typeof document<"u"?document.domain&&b?w(b):v():w(b);for(var R=r.length;R--;)delete E[u][r[R]];return E()};return n[h]=!0,Kd=Object.create||function(T,y){var M;return T!==null?(d[u]=t(T),M=new d,d[u]=null,M[h]=T):M=E(),y===void 0?M:e.f(M,y)},Kd}var Xd,Sb;function nT(){if(Sb)return Xd;Sb=1;var t=lt(),e=ut(),r=Wr(),n=Lm(),i=tT(),o=Nm(),s=sn(),a=Ro(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var g=!r(c)||t(function(){var w={};return c[l].call(w)!==w});return g?c={}:a&&(c=n(c)),e(c[l])||o(c,l,function(){return this}),Xd={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},Xd}var Rb;function GH(){if(Rb)return fb;Rb=1;var t=Ae(),e=Je(),r=jH(),n=pt(),i=ut(),o=tT(),s=UH(),a=JE(),l=lt(),u=Br(),c=sn(),h=nT().IteratorPrototype,d=Vr(),g=Ro(),w="constructor",v="Iterator",b=c("toStringTag"),E=TypeError,R=e[v],T=g||!i(R)||R.prototype!==h||!l(function(){R({})}),y=function(){if(r(this,h),o(this)===h)throw new E("Abstract class Iterator not directly constructable")},M=function(x,P){d?s(h,x,{configurable:!0,get:function(){return P},set:function(D){if(n(this),this===h)throw new E("You can't redefine this property");u(this,x)?this[x]=D:a(this,x,D)}}):h[x]=P};return u(h,b)||M(b,v),(T||!u(h,w)||h[w]===Object)&&M(w,y),y.prototype=h,t({global:!0,constructor:!0,forced:T},{Iterator:y}),fb}var Eb;function KH(){return Eb||(Eb=1,GH()),db}KH();var Tb={},_b={},Zd,Ob;function XH(){if(Ob)return Zd;Ob=1;var t=Nm();return Zd=function(e,r,n){for(var i in r)t(e,i,r[i],n);return e},Zd}var Qd,Mb;function ZH(){return Mb||(Mb=1,Qd=function(t,e){return{value:t,done:e}}),Qd}var Jd,Ib;function QH(){if(Ib)return Jd;Ib=1;var t=Cr();return Jd=function(e,r,n){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{n=t(e[i].iterator,r,n)}catch(o){r="throw",n=o}if(r==="throw")throw n;return n},Jd}var ef,Hb;function iT(){if(Hb)return ef;Hb=1;var t=mt(),e=Lm(),r=Os(),n=XH(),i=sn(),o=WE(),s=Ua(),a=nT().IteratorPrototype,l=ZH(),u=Cr(),c=QH(),h=i("toStringTag"),d="IteratorHelper",g="WrapForValidIterator",w="normal",v="throw",b=o.set,E=function(y){var M=o.getterFor(y?g:d);return n(e(a),{next:function(){var P=M(this);if(y)return P.nextHandler();if(P.done)return l(void 0,!0);try{var D=P.nextHandler();return P.returnHandlerResult?D:l(D,P.done)}catch(F){throw P.done=!0,F}},return:function(){var x=M(this),P=x.iterator;if(x.done=!0,y){var D=s(P,"return");return D?t(D,P):l(void 0,!0)}if(x.inner)try{u(x.inner.iterator,w)}catch(F){return u(P,v,F)}if(x.openIters)try{c(x.openIters,w)}catch(F){return u(P,v,F)}return P&&u(P,w),l(void 0,!0)}})},R=E(!0),T=E(!1);return r(T,h,"Iterator Helper"),ef=function(y,M,x){var P=function(F,W){W?(W.iterator=F.iterator,W.next=F.next):W=F,W.type=M?g:d,W.returnHandlerResult=!!x,W.nextHandler=y,W.counter=0,W.done=!1,b(this,W)};return P.prototype=M?R:T,P},ef}var tf,Pb;function oT(){if(Pb)return tf;Pb=1;var t=pt(),e=Cr();return tf=function(r,n,i,o){try{return o?n(t(i)[0],i[1]):n(i)}catch(s){e(r,"throw",s)}},tf}var rf,xb;function sT(){return xb||(xb=1,rf=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}}),rf}var nf,Ab;function Mo(){if(Ab)return nf;Ab=1;var t=Je();return nf=function(e,r){var n=t.Iterator,i=n&&n.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof r||(s=!1)}if(!s)return o},nf}var Nb;function JH(){if(Nb)return _b;Nb=1;var t=Ae(),e=mt(),r=br(),n=pt(),i=Di(),o=iT(),s=oT(),a=Ro(),l=Cr(),u=sT(),c=Mo(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),g=a||h||d,w=o(function(){for(var v=this.iterator,b=this.predicate,E=this.next,R,T,y;;){if(R=n(e(E,v)),T=this.done=!!R.done,T)return;if(y=R.value,s(v,b,[y,this.counter++],!0))return y}});return t({target:"Iterator",proto:!0,real:!0,forced:g},{filter:function(b){n(this);try{r(b)}catch(E){l(this,"throw",E)}return d?e(d,this,b):new w(i(this),{predicate:b})}}),_b}var Db;function eP(){return Db||(Db=1,JH()),Tb}eP();var kb={},Lb={},Fb;function tP(){if(Fb)return Lb;Fb=1;var t=Ae(),e=mt(),r=Is(),n=br(),i=pt(),o=Di(),s=Cr(),a=Mo(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;r(h,function(g){c(g,d++)},{IS_RECORD:!0})}}),Lb}var Vb;function rP(){return Vb||(Vb=1,tP()),kb}rP();var Wb={},Bb={},$b;function nP(){if($b)return Bb;$b=1;var t=Ae(),e=mt(),r=br(),n=pt(),i=Di(),o=iT(),s=oT(),a=Cr(),l=sT(),u=Mo(),c=Ro(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),g=c||h||d,w=o(function(){var v=this.iterator,b=n(e(this.next,v)),E=this.done=!!b.done;if(!E)return s(v,this.mapper,[b.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:g},{map:function(b){n(this);try{r(b)}catch(E){a(this,"throw",E)}return d?e(d,this,b):new w(i(this),{mapper:b})}}),Bb}var jb;function iP(){return jb||(jb=1,nP()),Wb}iP();var zb={},Ub={},of,Yb;function Fm(){if(Yb)return of;Yb=1;var t=et();return of=t([].slice),of}var sf,qb;function aT(){if(qb)return sf;qb=1;var t=TypeError;return sf=function(e,r){if(e<r)throw new t("Not enough arguments");return e},sf}var af,Gb;function oP(){if(Gb)return af;Gb=1;var t=Gu();return af=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),af}var lf,Kb;function lT(){if(Kb)return lf;Kb=1;var t=Je(),e=Gu(),r=So(),n=function(i){return e.slice(0,i.length)===i};return lf=function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),lf}var uf,Xb;function sP(){if(Xb)return uf;Xb=1;var t=lT();return uf=t==="NODE",uf}var cf,Zb;function uT(){if(Zb)return cf;Zb=1;var t=Je(),e=qa(),r=XE(),n=ut(),i=Br(),o=lt(),s=rT(),a=Fm(),l=Pm(),u=aT(),c=oP(),h=sP(),d=t.setImmediate,g=t.clearImmediate,w=t.process,v=t.Dispatch,b=t.Function,E=t.MessageChannel,R=t.String,T=0,y={},M="onreadystatechange",x,P,D,F;o(function(){x=t.location});var W=function(G){if(i(y,G)){var J=y[G];delete y[G],J()}},q=function(G){return function(){W(G)}},L=function(G){W(G.data)},oe=function(G){t.postMessage(R(G),x.protocol+"//"+x.host)};return(!d||!g)&&(d=function(J){u(arguments.length,1);var tt=n(J)?J:b(J),Ee=a(arguments,1);return y[++T]=function(){e(tt,void 0,Ee)},P(T),T},g=function(J){delete y[J]},h?P=function(G){w.nextTick(q(G))}:v&&v.now?P=function(G){v.now(q(G))}:E&&!c?(D=new E,F=D.port2,D.port1.onmessage=L,P=r(F.postMessage,F)):t.addEventListener&&n(t.postMessage)&&!t.importScripts&&x&&x.protocol!=="file:"&&!o(oe)?(P=oe,t.addEventListener("message",L,!1)):M in l("script")?P=function(G){s.appendChild(l("script"))[M]=function(){s.removeChild(this),W(G)}}:P=function(G){setTimeout(q(G),0)}),cf={set:d,clear:g},cf}var Qb;function aP(){if(Qb)return Ub;Qb=1;var t=Ae(),e=Je(),r=uT().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==r},{clearImmediate:r}),Ub}var Jb={},hf,eC;function lP(){if(eC)return hf;eC=1;var t=Je(),e=qa(),r=ut(),n=lT(),i=Gu(),o=Fm(),s=aT(),a=t.Function,l=/MSIE .\./.test(i)||n==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return hf=function(u,c){var h=c?2:1;return l?function(d,g){var w=s(arguments.length,1)>h,v=r(d)?d:a(d),b=w?o(arguments,h):[],E=w?function(){e(v,this,b)}:v;return c?u(E,g):u(E)}:u},hf}var tC;function uP(){if(tC)return Jb;tC=1;var t=Ae(),e=Je(),r=uT().set,n=lP(),i=e.setImmediate?n(r,!1):r;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),Jb}var rC;function cP(){return rC||(rC=1,aP(),uP()),zb}cP();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:cT,setPrototypeOf:nC,isFrozen:hP,getPrototypeOf:dP,getOwnPropertyDescriptor:fP}=Object;let{freeze:zt,seal:Lr,create:hT}=Object,{apply:Ng,construct:Dg}=typeof Reflect<"u"&&Reflect;zt||(zt=function(e){return e});Lr||(Lr=function(e){return e});Ng||(Ng=function(e,r,n){return e.apply(r,n)});Dg||(Dg=function(e,r){return new e(...r)});const cl=Ut(Array.prototype.forEach),gP=Ut(Array.prototype.lastIndexOf),iC=Ut(Array.prototype.pop),Ls=Ut(Array.prototype.push),mP=Ut(Array.prototype.splice),tu=Ut(String.prototype.toLowerCase),df=Ut(String.prototype.toString),oC=Ut(String.prototype.match),Fs=Ut(String.prototype.replace),pP=Ut(String.prototype.indexOf),wP=Ut(String.prototype.trim),Qr=Ut(Object.prototype.hasOwnProperty),kt=Ut(RegExp.prototype.test),Vs=vP(TypeError);function Ut(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Ng(t,e,n)}}function vP(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Dg(t,r)}}function ae(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:tu;nC&&nC(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const o=r(i);o!==i&&(hP(e)||(e[n]=o),i=o)}t[i]=!0}return t}function yP(t){for(let e=0;e<t.length;e++)Qr(t,e)||(t[e]=null);return t}function Vn(t){const e=hT(null);for(const[r,n]of cT(t))Qr(t,r)&&(Array.isArray(n)?e[r]=yP(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=Vn(n):e[r]=n);return e}function Ws(t,e){for(;t!==null;){const n=fP(t,e);if(n){if(n.get)return Ut(n.get);if(typeof n.value=="function")return Ut(n.value)}t=dP(t)}function r(){return null}return r}const sC=zt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ff=zt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),gf=zt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),bP=zt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mf=zt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),CP=zt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),aC=zt(["#text"]),lC=zt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),pf=zt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),uC=zt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),hl=zt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),SP=Lr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),RP=Lr(/<%[\w\W]*|[\w\W]*%>/gm),EP=Lr(/\$\{[\w\W]*/gm),TP=Lr(/^data-[\-\w.\u00B7-\uFFFF]+$/),_P=Lr(/^aria-[\-\w]+$/),dT=Lr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),OP=Lr(/^(?:\w+script|data):/i),MP=Lr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),fT=Lr(/^html$/i),IP=Lr(/^[a-z][.\w]*(-[.\w]+)+$/i);var cC=Object.freeze({__proto__:null,ARIA_ATTR:_P,ATTR_WHITESPACE:MP,CUSTOM_ELEMENT:IP,DATA_ATTR:TP,DOCTYPE_NAME:fT,ERB_EXPR:RP,IS_ALLOWED_URI:dT,IS_SCRIPT_OR_DATA:OP,MUSTACHE_EXPR:SP,TMPLIT_EXPR:EP});const Bs={element:1,text:3,progressingInstruction:7,comment:8,document:9},HP=function(){return typeof window>"u"?null:window},PP=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},hC=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function gT(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:HP();const e=X=>gT(X);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==Bs.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:g}=t,w=l.prototype,v=Ws(w,"cloneNode"),b=Ws(w,"remove"),E=Ws(w,"nextSibling"),R=Ws(w,"childNodes"),T=Ws(w,"parentNode");if(typeof s=="function"){const X=r.createElement("template");X.content&&X.content.ownerDocument&&(r=X.content.ownerDocument)}let y,M="";const{implementation:x,createNodeIterator:P,createDocumentFragment:D,getElementsByTagName:F}=r,{importNode:W}=n;let q=hC();e.isSupported=typeof cT=="function"&&typeof T=="function"&&x&&x.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:L,ERB_EXPR:oe,TMPLIT_EXPR:G,DATA_ATTR:J,ARIA_ATTR:tt,IS_SCRIPT_OR_DATA:Ee,ATTR_WHITESPACE:Te,CUSTOM_ELEMENT:Be}=cC;let{IS_ALLOWED_URI:Le}=cC,Ie=null;const zr=ae({},[...sC,...ff,...gf,...mf,...aC]);let be=null;const f=ae({},[...lC,...pf,...uC,...hl]);let m=Object.seal(hT(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),p=null,C=null,_=!0,O=!0,I=!1,A=!0,j=!1,B=!0,H=!1,ee=!1,ne=!1,ce=!1,Ge=!1,dt=!1,wt=!0,Tt=!1;const Ne="user-content-";let rt=!0,_t=!1,Nt={},sr=null;const In=ae({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Dt=null;const vt=ae({},["audio","video","img","source","image","track"]);let ar=null;const ti=ae({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ur="http://www.w3.org/1998/Math/MathML",Li="http://www.w3.org/2000/svg",Rr="http://www.w3.org/1999/xhtml";let un=Rr,lr=!1,ri=null;const ni=ae({},[Ur,Li,Rr],df);let cn=ae({},["mi","mo","mn","ms","mtext"]),ii=ae({},["annotation-xml"]);const Er=ae({},["title","style","font","a","script"]);let yt=null;const al=["application/xhtml+xml","text/html"],ll="text/html";let ft=null,Ao=null;const yM=r.createElement("form"),vw=function(S){return S instanceof RegExp||S instanceof Function},xc=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ao&&Ao===S)){if((!S||typeof S!="object")&&(S={}),S=Vn(S),yt=al.indexOf(S.PARSER_MEDIA_TYPE)===-1?ll:S.PARSER_MEDIA_TYPE,ft=yt==="application/xhtml+xml"?df:tu,Ie=Qr(S,"ALLOWED_TAGS")?ae({},S.ALLOWED_TAGS,ft):zr,be=Qr(S,"ALLOWED_ATTR")?ae({},S.ALLOWED_ATTR,ft):f,ri=Qr(S,"ALLOWED_NAMESPACES")?ae({},S.ALLOWED_NAMESPACES,df):ni,ar=Qr(S,"ADD_URI_SAFE_ATTR")?ae(Vn(ti),S.ADD_URI_SAFE_ATTR,ft):ti,Dt=Qr(S,"ADD_DATA_URI_TAGS")?ae(Vn(vt),S.ADD_DATA_URI_TAGS,ft):vt,sr=Qr(S,"FORBID_CONTENTS")?ae({},S.FORBID_CONTENTS,ft):In,p=Qr(S,"FORBID_TAGS")?ae({},S.FORBID_TAGS,ft):Vn({}),C=Qr(S,"FORBID_ATTR")?ae({},S.FORBID_ATTR,ft):Vn({}),Nt=Qr(S,"USE_PROFILES")?S.USE_PROFILES:!1,_=S.ALLOW_ARIA_ATTR!==!1,O=S.ALLOW_DATA_ATTR!==!1,I=S.ALLOW_UNKNOWN_PROTOCOLS||!1,A=S.ALLOW_SELF_CLOSE_IN_ATTR!==!1,j=S.SAFE_FOR_TEMPLATES||!1,B=S.SAFE_FOR_XML!==!1,H=S.WHOLE_DOCUMENT||!1,ce=S.RETURN_DOM||!1,Ge=S.RETURN_DOM_FRAGMENT||!1,dt=S.RETURN_TRUSTED_TYPE||!1,ne=S.FORCE_BODY||!1,wt=S.SANITIZE_DOM!==!1,Tt=S.SANITIZE_NAMED_PROPS||!1,rt=S.KEEP_CONTENT!==!1,_t=S.IN_PLACE||!1,Le=S.ALLOWED_URI_REGEXP||dT,un=S.NAMESPACE||Rr,cn=S.MATHML_TEXT_INTEGRATION_POINTS||cn,ii=S.HTML_INTEGRATION_POINTS||ii,m=S.CUSTOM_ELEMENT_HANDLING||{},S.CUSTOM_ELEMENT_HANDLING&&vw(S.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(m.tagNameCheck=S.CUSTOM_ELEMENT_HANDLING.tagNameCheck),S.CUSTOM_ELEMENT_HANDLING&&vw(S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(m.attributeNameCheck=S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),S.CUSTOM_ELEMENT_HANDLING&&typeof S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(m.allowCustomizedBuiltInElements=S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),j&&(O=!1),Ge&&(ce=!0),Nt&&(Ie=ae({},aC),be=[],Nt.html===!0&&(ae(Ie,sC),ae(be,lC)),Nt.svg===!0&&(ae(Ie,ff),ae(be,pf),ae(be,hl)),Nt.svgFilters===!0&&(ae(Ie,gf),ae(be,pf),ae(be,hl)),Nt.mathMl===!0&&(ae(Ie,mf),ae(be,uC),ae(be,hl))),S.ADD_TAGS&&(Ie===zr&&(Ie=Vn(Ie)),ae(Ie,S.ADD_TAGS,ft)),S.ADD_ATTR&&(be===f&&(be=Vn(be)),ae(be,S.ADD_ATTR,ft)),S.ADD_URI_SAFE_ATTR&&ae(ar,S.ADD_URI_SAFE_ATTR,ft),S.FORBID_CONTENTS&&(sr===In&&(sr=Vn(sr)),ae(sr,S.FORBID_CONTENTS,ft)),rt&&(Ie["#text"]=!0),H&&ae(Ie,["html","head","body"]),Ie.table&&(ae(Ie,["tbody"]),delete p.tbody),S.TRUSTED_TYPES_POLICY){if(typeof S.TRUSTED_TYPES_POLICY.createHTML!="function")throw Vs('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof S.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Vs('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');y=S.TRUSTED_TYPES_POLICY,M=y.createHTML("")}else y===void 0&&(y=PP(g,i)),y!==null&&typeof M=="string"&&(M=y.createHTML(""));zt&&zt(S),Ao=S}},yw=ae({},[...ff,...gf,...bP]),bw=ae({},[...mf,...CP]),bM=function(S){let k=T(S);(!k||!k.tagName)&&(k={namespaceURI:un,tagName:"template"});const Y=tu(S.tagName),Fe=tu(k.tagName);return ri[S.namespaceURI]?S.namespaceURI===Li?k.namespaceURI===Rr?Y==="svg":k.namespaceURI===Ur?Y==="svg"&&(Fe==="annotation-xml"||cn[Fe]):!!yw[Y]:S.namespaceURI===Ur?k.namespaceURI===Rr?Y==="math":k.namespaceURI===Li?Y==="math"&&ii[Fe]:!!bw[Y]:S.namespaceURI===Rr?k.namespaceURI===Li&&!ii[Fe]||k.namespaceURI===Ur&&!cn[Fe]?!1:!bw[Y]&&(Er[Y]||!yw[Y]):!!(yt==="application/xhtml+xml"&&ri[S.namespaceURI]):!1},hn=function(S){Ls(e.removed,{element:S});try{T(S).removeChild(S)}catch{b(S)}},No=function(S,k){try{Ls(e.removed,{attribute:k.getAttributeNode(S),from:k})}catch{Ls(e.removed,{attribute:null,from:k})}if(k.removeAttribute(S),S==="is")if(ce||Ge)try{hn(k)}catch{}else try{k.setAttribute(S,"")}catch{}},Cw=function(S){let k=null,Y=null;if(ne)S="<remove></remove>"+S;else{const ct=oC(S,/^[\r\n\t ]+/);Y=ct&&ct[0]}yt==="application/xhtml+xml"&&un===Rr&&(S='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+S+"</body></html>");const Fe=y?y.createHTML(S):S;if(un===Rr)try{k=new d().parseFromString(Fe,yt)}catch{}if(!k||!k.documentElement){k=x.createDocument(un,"template",null);try{k.documentElement.innerHTML=lr?M:Fe}catch{}}const Ot=k.body||k.documentElement;return S&&Y&&Ot.insertBefore(r.createTextNode(Y),Ot.childNodes[0]||null),un===Rr?F.call(k,H?"html":"body")[0]:H?k.documentElement:Ot},Sw=function(S){return P.call(S.ownerDocument||S,S,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Ac=function(S){return S instanceof h&&(typeof S.nodeName!="string"||typeof S.textContent!="string"||typeof S.removeChild!="function"||!(S.attributes instanceof c)||typeof S.removeAttribute!="function"||typeof S.setAttribute!="function"||typeof S.namespaceURI!="string"||typeof S.insertBefore!="function"||typeof S.hasChildNodes!="function")},Rw=function(S){return typeof a=="function"&&S instanceof a};function Hn(X,S,k){cl(X,Y=>{Y.call(e,S,k,Ao)})}const Ew=function(S){let k=null;if(Hn(q.beforeSanitizeElements,S,null),Ac(S))return hn(S),!0;const Y=ft(S.nodeName);if(Hn(q.uponSanitizeElement,S,{tagName:Y,allowedTags:Ie}),B&&S.hasChildNodes()&&!Rw(S.firstElementChild)&&kt(/<[/\w!]/g,S.innerHTML)&&kt(/<[/\w!]/g,S.textContent)||S.nodeType===Bs.progressingInstruction||B&&S.nodeType===Bs.comment&&kt(/<[/\w]/g,S.data))return hn(S),!0;if(!Ie[Y]||p[Y]){if(!p[Y]&&_w(Y)&&(m.tagNameCheck instanceof RegExp&&kt(m.tagNameCheck,Y)||m.tagNameCheck instanceof Function&&m.tagNameCheck(Y)))return!1;if(rt&&!sr[Y]){const Fe=T(S)||S.parentNode,Ot=R(S)||S.childNodes;if(Ot&&Fe){const ct=Ot.length;for(let Yt=ct-1;Yt>=0;--Yt){const Pn=v(Ot[Yt],!0);Pn.__removalCount=(S.__removalCount||0)+1,Fe.insertBefore(Pn,E(S))}}}return hn(S),!0}return S instanceof l&&!bM(S)||(Y==="noscript"||Y==="noembed"||Y==="noframes")&&kt(/<\/no(script|embed|frames)/i,S.innerHTML)?(hn(S),!0):(j&&S.nodeType===Bs.text&&(k=S.textContent,cl([L,oe,G],Fe=>{k=Fs(k,Fe," ")}),S.textContent!==k&&(Ls(e.removed,{element:S.cloneNode()}),S.textContent=k)),Hn(q.afterSanitizeElements,S,null),!1)},Tw=function(S,k,Y){if(wt&&(k==="id"||k==="name")&&(Y in r||Y in yM))return!1;if(!(O&&!C[k]&&kt(J,k))){if(!(_&&kt(tt,k))){if(!be[k]||C[k]){if(!(_w(S)&&(m.tagNameCheck instanceof RegExp&&kt(m.tagNameCheck,S)||m.tagNameCheck instanceof Function&&m.tagNameCheck(S))&&(m.attributeNameCheck instanceof RegExp&&kt(m.attributeNameCheck,k)||m.attributeNameCheck instanceof Function&&m.attributeNameCheck(k))||k==="is"&&m.allowCustomizedBuiltInElements&&(m.tagNameCheck instanceof RegExp&&kt(m.tagNameCheck,Y)||m.tagNameCheck instanceof Function&&m.tagNameCheck(Y))))return!1}else if(!ar[k]){if(!kt(Le,Fs(Y,Te,""))){if(!((k==="src"||k==="xlink:href"||k==="href")&&S!=="script"&&pP(Y,"data:")===0&&Dt[S])){if(!(I&&!kt(Ee,Fs(Y,Te,"")))){if(Y)return!1}}}}}}return!0},_w=function(S){return S!=="annotation-xml"&&oC(S,Be)},Ow=function(S){Hn(q.beforeSanitizeAttributes,S,null);const{attributes:k}=S;if(!k||Ac(S))return;const Y={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:be,forceKeepAttr:void 0};let Fe=k.length;for(;Fe--;){const Ot=k[Fe],{name:ct,namespaceURI:Yt,value:Pn}=Ot,Ds=ft(ct),Nc=Pn;let Mt=ct==="value"?Nc:wP(Nc);if(Y.attrName=Ds,Y.attrValue=Mt,Y.keepAttr=!0,Y.forceKeepAttr=void 0,Hn(q.uponSanitizeAttribute,S,Y),Mt=Y.attrValue,Tt&&(Ds==="id"||Ds==="name")&&(No(ct,S),Mt=Ne+Mt),B&&kt(/((--!?|])>)|<\/(style|title)/i,Mt)){No(ct,S);continue}if(Y.forceKeepAttr)continue;if(!Y.keepAttr){No(ct,S);continue}if(!A&&kt(/\/>/i,Mt)){No(ct,S);continue}j&&cl([L,oe,G],Iw=>{Mt=Fs(Mt,Iw," ")});const Mw=ft(S.nodeName);if(!Tw(Mw,Ds,Mt)){No(ct,S);continue}if(y&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!Yt)switch(g.getAttributeType(Mw,Ds)){case"TrustedHTML":{Mt=y.createHTML(Mt);break}case"TrustedScriptURL":{Mt=y.createScriptURL(Mt);break}}if(Mt!==Nc)try{Yt?S.setAttributeNS(Yt,ct,Mt):S.setAttribute(ct,Mt),Ac(S)?hn(S):iC(e.removed)}catch{No(ct,S)}}Hn(q.afterSanitizeAttributes,S,null)},CM=function X(S){let k=null;const Y=Sw(S);for(Hn(q.beforeSanitizeShadowDOM,S,null);k=Y.nextNode();)Hn(q.uponSanitizeShadowNode,k,null),Ew(k),Ow(k),k.content instanceof o&&X(k.content);Hn(q.afterSanitizeShadowDOM,S,null)};return e.sanitize=function(X){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k=null,Y=null,Fe=null,Ot=null;if(lr=!X,lr&&(X="<!-->"),typeof X!="string"&&!Rw(X))if(typeof X.toString=="function"){if(X=X.toString(),typeof X!="string")throw Vs("dirty is not a string, aborting")}else throw Vs("toString is not a function");if(!e.isSupported)return X;if(ee||xc(S),e.removed=[],typeof X=="string"&&(_t=!1),_t){if(X.nodeName){const Pn=ft(X.nodeName);if(!Ie[Pn]||p[Pn])throw Vs("root node is forbidden and cannot be sanitized in-place")}}else if(X instanceof a)k=Cw("<!---->"),Y=k.ownerDocument.importNode(X,!0),Y.nodeType===Bs.element&&Y.nodeName==="BODY"||Y.nodeName==="HTML"?k=Y:k.appendChild(Y);else{if(!ce&&!j&&!H&&X.indexOf("<")===-1)return y&&dt?y.createHTML(X):X;if(k=Cw(X),!k)return ce?null:dt?M:""}k&&ne&&hn(k.firstChild);const ct=Sw(_t?X:k);for(;Fe=ct.nextNode();)Ew(Fe),Ow(Fe),Fe.content instanceof o&&CM(Fe.content);if(_t)return X;if(ce){if(Ge)for(Ot=D.call(k.ownerDocument);k.firstChild;)Ot.appendChild(k.firstChild);else Ot=k;return(be.shadowroot||be.shadowrootmode)&&(Ot=W.call(n,Ot,!0)),Ot}let Yt=H?k.outerHTML:k.innerHTML;return H&&Ie["!doctype"]&&k.ownerDocument&&k.ownerDocument.doctype&&k.ownerDocument.doctype.name&&kt(fT,k.ownerDocument.doctype.name)&&(Yt="<!DOCTYPE "+k.ownerDocument.doctype.name+`>
`+Yt),j&&cl([L,oe,G],Pn=>{Yt=Fs(Yt,Pn," ")}),y&&dt?y.createHTML(Yt):Yt},e.setConfig=function(){let X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};xc(X),ee=!0},e.clearConfig=function(){Ao=null,ee=!1},e.isValidAttribute=function(X,S,k){Ao||xc({});const Y=ft(X),Fe=ft(S);return Tw(Y,Fe,k)},e.addHook=function(X,S){typeof S=="function"&&Ls(q[X],S)},e.removeHook=function(X,S){if(S!==void 0){const k=gP(q[X],S);return k===-1?void 0:mP(q[X],k,1)[0]}return iC(q[X])},e.removeHooks=function(X){q[X]=[]},e.removeAllHooks=function(){q=hC()},e}var xP=gT();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var mT;function V(){return mT.apply(null,arguments)}function AP(t){mT=t}function rn(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function uo(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function ve(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Vm(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(ve(t,e))return!1;return!0}function Qt(t){return t===void 0}function Kn(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Xa(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function pT(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function vi(t,e){for(var r in e)ve(e,r)&&(t[r]=e[r]);return ve(e,"toString")&&(t.toString=e.toString),ve(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Tn(t,e,r,n){return VT(t,e,r,n,!0).utc()}function NP(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ie(t){return t._pf==null&&(t._pf=NP()),t._pf}var kg;Array.prototype.some?kg=Array.prototype.some:kg=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function Wm(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=ie(t),r=kg.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function Zu(t){var e=Tn(NaN);return t!=null?vi(ie(e),t):ie(e).userInvalidated=!0,e}var dC=V.momentProperties=[],wf=!1;function Bm(t,e){var r,n,i,o=dC.length;if(Qt(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Qt(e._i)||(t._i=e._i),Qt(e._f)||(t._f=e._f),Qt(e._l)||(t._l=e._l),Qt(e._strict)||(t._strict=e._strict),Qt(e._tzm)||(t._tzm=e._tzm),Qt(e._isUTC)||(t._isUTC=e._isUTC),Qt(e._offset)||(t._offset=e._offset),Qt(e._pf)||(t._pf=ie(e)),Qt(e._locale)||(t._locale=e._locale),o>0)for(r=0;r<o;r++)n=dC[r],i=e[n],Qt(i)||(t[n]=i);return t}function Za(t){Bm(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),wf===!1&&(wf=!0,V.updateOffset(this),wf=!1)}function nn(t){return t instanceof Za||t!=null&&t._isAMomentObject!=null}function wT(t){V.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function $r(t,e){var r=!0;return vi(function(){if(V.deprecationHandler!=null&&V.deprecationHandler(null,t),r){var n=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])ve(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}wT(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var fC={};function vT(t,e){V.deprecationHandler!=null&&V.deprecationHandler(t,e),fC[t]||(wT(e),fC[t]=!0)}V.suppressDeprecationWarnings=!1;V.deprecationHandler=null;function _n(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function DP(t){var e,r;for(r in t)ve(t,r)&&(e=t[r],_n(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Lg(t,e){var r=vi({},t),n;for(n in e)ve(e,n)&&(uo(t[n])&&uo(e[n])?(r[n]={},vi(r[n],t[n]),vi(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)ve(t,n)&&!ve(e,n)&&uo(t[n])&&(r[n]=vi({},r[n]));return r}function $m(t){t!=null&&this.set(t)}var Fg;Object.keys?Fg=Object.keys:Fg=function(t){var e,r=[];for(e in t)ve(t,e)&&r.push(e);return r};var kP={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function LP(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return _n(n)?n.call(e,r):n}function Rn(t,e,r){var n=""+Math.abs(t),i=e-n.length,o=t>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var jm=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,dl=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,vf={},ds={};function Z(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(ds[t]=i),e&&(ds[e[0]]=function(){return Rn(i.apply(this,arguments),e[1],e[2])}),r&&(ds[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function FP(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function VP(t){var e=t.match(jm),r,n;for(r=0,n=e.length;r<n;r++)ds[e[r]]?e[r]=ds[e[r]]:e[r]=FP(e[r]);return function(i){var o="",s;for(s=0;s<n;s++)o+=_n(e[s])?e[s].call(i,t):e[s];return o}}function ru(t,e){return t.isValid()?(e=yT(e,t.localeData()),vf[e]=vf[e]||VP(e),vf[e](t)):t.localeData().invalidDate()}function yT(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(dl.lastIndex=0;r>=0&&dl.test(t);)t=t.replace(dl,n),dl.lastIndex=0,r-=1;return t}var WP={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function BP(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(jm).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var $P="Invalid date";function jP(){return this._invalidDate}var zP="%d",UP=/\d{1,2}/;function YP(t){return this._ordinal.replace("%d",t)}var qP={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function GP(t,e,r,n){var i=this._relativeTime[r];return _n(i)?i(t,e,r,n):i.replace(/%d/i,t)}function KP(t,e){var r=this._relativeTime[t>0?"future":"past"];return _n(r)?r(e):r.replace(/%s/i,e)}var gC={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function jr(t){return typeof t=="string"?gC[t]||gC[t.toLowerCase()]:void 0}function zm(t){var e={},r,n;for(n in t)ve(t,n)&&(r=jr(n),r&&(e[r]=t[n]));return e}var XP={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function ZP(t){var e=[],r;for(r in t)ve(t,r)&&e.push({unit:r,priority:XP[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var bT=/\d/,Sr=/\d\d/,CT=/\d{3}/,Um=/\d{4}/,Qu=/[+-]?\d{6}/,ke=/\d\d?/,ST=/\d\d\d\d?/,RT=/\d\d\d\d\d\d?/,Ju=/\d{1,3}/,Ym=/\d{1,4}/,ec=/[+-]?\d{1,6}/,Hs=/\d+/,tc=/[+-]?\d+/,QP=/Z|[+-]\d\d:?\d\d/gi,rc=/Z|[+-]\d\d(?::?\d\d)?/gi,JP=/[+-]?\d+(\.\d{1,3})?/,Qa=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ps=/^[1-9]\d?/,qm=/^([1-9]\d|\d)/,bu;bu={};function $(t,e,r){bu[t]=_n(e)?e:function(n,i){return n&&r?r:e}}function ex(t,e){return ve(bu,t)?bu[t](e._strict,e._locale):new RegExp(tx(t))}function tx(t){return qn(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,o){return r||n||i||o}))}function qn(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function xr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function he(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=xr(e)),r}var Vg={};function Pe(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),Kn(e)&&(n=function(o,s){s[e]=he(o)}),i=t.length,r=0;r<i;r++)Vg[t[r]]=n}function Ja(t,e){Pe(t,function(r,n,i,o){i._w=i._w||{},e(r,i._w,i,o)})}function rx(t,e,r){e!=null&&ve(Vg,t)&&Vg[t](e,r._a,r,t)}function nc(t){return t%4===0&&t%100!==0||t%400===0}var At=0,zn=1,bn=2,ht=3,tn=4,Un=5,oo=6,nx=7,ix=8;Z("Y",0,0,function(){var t=this.year();return t<=9999?Rn(t,4):"+"+t});Z(0,["YY",2],0,function(){return this.year()%100});Z(0,["YYYY",4],0,"year");Z(0,["YYYYY",5],0,"year");Z(0,["YYYYYY",6,!0],0,"year");$("Y",tc);$("YY",ke,Sr);$("YYYY",Ym,Um);$("YYYYY",ec,Qu);$("YYYYYY",ec,Qu);Pe(["YYYYY","YYYYYY"],At);Pe("YYYY",function(t,e){e[At]=t.length===2?V.parseTwoDigitYear(t):he(t)});Pe("YY",function(t,e){e[At]=V.parseTwoDigitYear(t)});Pe("Y",function(t,e){e[At]=parseInt(t,10)});function Ea(t){return nc(t)?366:365}V.parseTwoDigitYear=function(t){return he(t)+(he(t)>68?1900:2e3)};var ET=xs("FullYear",!0);function ox(){return nc(this.year())}function xs(t,e){return function(r){return r!=null?(TT(this,t,r),V.updateOffset(this,e),this):xa(this,t)}}function xa(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function TT(t,e,r){var n,i,o,s,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}o=r,s=t.month(),a=t.date(),a=a===29&&s===1&&!nc(o)?28:a,i?n.setUTCFullYear(o,s,a):n.setFullYear(o,s,a)}}function sx(t){return t=jr(t),_n(this[t])?this[t]():this}function ax(t,e){if(typeof t=="object"){t=zm(t);var r=ZP(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=jr(t),_n(this[t]))return this[t](e);return this}function lx(t,e){return(t%e+e)%e}var Ze;Array.prototype.indexOf?Ze=Array.prototype.indexOf:Ze=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Gm(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=lx(e,12);return t+=(e-r)/12,r===1?nc(t)?29:28:31-r%7%2}Z("M",["MM",2],"Mo",function(){return this.month()+1});Z("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Z("MMMM",0,0,function(t){return this.localeData().months(this,t)});$("M",ke,Ps);$("MM",ke,Sr);$("MMM",function(t,e){return e.monthsShortRegex(t)});$("MMMM",function(t,e){return e.monthsRegex(t)});Pe(["M","MM"],function(t,e){e[zn]=he(t)-1});Pe(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[zn]=i:ie(r).invalidMonth=t});var ux="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),_T="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),OT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,cx=Qa,hx=Qa;function dx(t,e){return t?rn(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||OT).test(e)?"format":"standalone"][t.month()]:rn(this._months)?this._months:this._months.standalone}function fx(t,e){return t?rn(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[OT.test(e)?"format":"standalone"][t.month()]:rn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function gx(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=Tn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?e==="MMM"?(i=Ze.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Ze.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Ze.call(this._shortMonthsParse,s),i!==-1?i:(i=Ze.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Ze.call(this._longMonthsParse,s),i!==-1?i:(i=Ze.call(this._shortMonthsParse,s),i!==-1?i:null))}function mx(t,e,r){var n,i,o;if(this._monthsParseExact)return gx.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Tn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function MT(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=he(e);else if(e=t.localeData().monthsParse(e),!Kn(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,Gm(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function IT(t){return t!=null?(MT(this,t),V.updateOffset(this,!0),this):xa(this,"Month")}function px(){return Gm(this.year(),this.month())}function wx(t){return this._monthsParseExact?(ve(this,"_monthsRegex")||HT.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(ve(this,"_monthsShortRegex")||(this._monthsShortRegex=cx),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function vx(t){return this._monthsParseExact?(ve(this,"_monthsRegex")||HT.call(this),t?this._monthsStrictRegex:this._monthsRegex):(ve(this,"_monthsRegex")||(this._monthsRegex=hx),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function HT(){function t(l,u){return u.length-l.length}var e=[],r=[],n=[],i,o,s,a;for(i=0;i<12;i++)o=Tn([2e3,i]),s=qn(this.monthsShort(o,"")),a=qn(this.months(o,"")),e.push(s),r.push(a),n.push(a),n.push(s);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function yx(t,e,r,n,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,o,s),a}function Aa(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Cu(t,e,r){var n=7+e-r,i=(7+Aa(t,0,n).getUTCDay()-e)%7;return-i+n-1}function PT(t,e,r,n,i){var o=(7+r-n)%7,s=Cu(t,n,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Ea(l)+a):a>Ea(t)?(l=t+1,u=a-Ea(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Na(t,e,r){var n=Cu(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Gn(s,e,r)):i>Gn(t.year(),e,r)?(o=i-Gn(t.year(),e,r),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Gn(t,e,r){var n=Cu(t,e,r),i=Cu(t+1,e,r);return(Ea(t)-n+i)/7}Z("w",["ww",2],"wo","week");Z("W",["WW",2],"Wo","isoWeek");$("w",ke,Ps);$("ww",ke,Sr);$("W",ke,Ps);$("WW",ke,Sr);Ja(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=he(t)});function bx(t){return Na(t,this._week.dow,this._week.doy).week}var Cx={dow:0,doy:6};function Sx(){return this._week.dow}function Rx(){return this._week.doy}function Ex(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function Tx(t){var e=Na(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Z("d",0,"do","day");Z("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Z("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Z("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Z("e",0,0,"weekday");Z("E",0,0,"isoWeekday");$("d",ke);$("e",ke);$("E",ke);$("dd",function(t,e){return e.weekdaysMinRegex(t)});$("ddd",function(t,e){return e.weekdaysShortRegex(t)});$("dddd",function(t,e){return e.weekdaysRegex(t)});Ja(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:ie(r).invalidWeekday=t});Ja(["d","e","E"],function(t,e,r,n){e[n]=he(t)});function _x(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function Ox(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Km(t,e){return t.slice(e,7).concat(t.slice(0,e))}var Mx="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),xT="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ix="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Hx=Qa,Px=Qa,xx=Qa;function Ax(t,e){var r=rn(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?Km(r,this._week.dow):t?r[t.day()]:r}function Nx(t){return t===!0?Km(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function Dx(t){return t===!0?Km(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function kx(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=Tn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?e==="dddd"?(i=Ze.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Ze.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Ze.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Ze.call(this._weekdaysParse,s),i!==-1||(i=Ze.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Ze.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Ze.call(this._shortWeekdaysParse,s),i!==-1||(i=Ze.call(this._weekdaysParse,s),i!==-1)?i:(i=Ze.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Ze.call(this._minWeekdaysParse,s),i!==-1||(i=Ze.call(this._weekdaysParse,s),i!==-1)?i:(i=Ze.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function Lx(t,e,r){var n,i,o;if(this._weekdaysParseExact)return kx.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Tn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function Fx(t){if(!this.isValid())return t!=null?this:NaN;var e=xa(this,"Day");return t!=null?(t=_x(t,this.localeData()),this.add(t-e,"d")):e}function Vx(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function Wx(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=Ox(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function Bx(t){return this._weekdaysParseExact?(ve(this,"_weekdaysRegex")||Xm.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(ve(this,"_weekdaysRegex")||(this._weekdaysRegex=Hx),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function $x(t){return this._weekdaysParseExact?(ve(this,"_weekdaysRegex")||Xm.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(ve(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Px),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function jx(t){return this._weekdaysParseExact?(ve(this,"_weekdaysRegex")||Xm.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(ve(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=xx),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Xm(){function t(c,h){return h.length-c.length}var e=[],r=[],n=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Tn([2e3,1]).day(o),a=qn(this.weekdaysMin(s,"")),l=qn(this.weekdaysShort(s,"")),u=qn(this.weekdays(s,"")),e.push(a),r.push(l),n.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Zm(){return this.hours()%12||12}function zx(){return this.hours()||24}Z("H",["HH",2],0,"hour");Z("h",["hh",2],0,Zm);Z("k",["kk",2],0,zx);Z("hmm",0,0,function(){return""+Zm.apply(this)+Rn(this.minutes(),2)});Z("hmmss",0,0,function(){return""+Zm.apply(this)+Rn(this.minutes(),2)+Rn(this.seconds(),2)});Z("Hmm",0,0,function(){return""+this.hours()+Rn(this.minutes(),2)});Z("Hmmss",0,0,function(){return""+this.hours()+Rn(this.minutes(),2)+Rn(this.seconds(),2)});function AT(t,e){Z(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}AT("a",!0);AT("A",!1);function NT(t,e){return e._meridiemParse}$("a",NT);$("A",NT);$("H",ke,qm);$("h",ke,Ps);$("k",ke,Ps);$("HH",ke,Sr);$("hh",ke,Sr);$("kk",ke,Sr);$("hmm",ST);$("hmmss",RT);$("Hmm",ST);$("Hmmss",RT);Pe(["H","HH"],ht);Pe(["k","kk"],function(t,e,r){var n=he(t);e[ht]=n===24?0:n});Pe(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});Pe(["h","hh"],function(t,e,r){e[ht]=he(t),ie(r).bigHour=!0});Pe("hmm",function(t,e,r){var n=t.length-2;e[ht]=he(t.substr(0,n)),e[tn]=he(t.substr(n)),ie(r).bigHour=!0});Pe("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[ht]=he(t.substr(0,n)),e[tn]=he(t.substr(n,2)),e[Un]=he(t.substr(i)),ie(r).bigHour=!0});Pe("Hmm",function(t,e,r){var n=t.length-2;e[ht]=he(t.substr(0,n)),e[tn]=he(t.substr(n))});Pe("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[ht]=he(t.substr(0,n)),e[tn]=he(t.substr(n,2)),e[Un]=he(t.substr(i))});function Ux(t){return(t+"").toLowerCase().charAt(0)==="p"}var Yx=/[ap]\.?m?\.?/i,qx=xs("Hours",!0);function Gx(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var DT={calendar:kP,longDateFormat:WP,invalidDate:$P,ordinal:zP,dayOfMonthOrdinalParse:UP,relativeTime:qP,months:ux,monthsShort:_T,week:Cx,weekdays:Mx,weekdaysMin:Ix,weekdaysShort:xT,meridiemParse:Yx},We={},$s={},Da;function Kx(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function mC(t){return t&&t.toLowerCase().replace("_","-")}function Xx(t){for(var e=0,r,n,i,o;e<t.length;){for(o=mC(t[e]).split("-"),r=o.length,n=mC(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=ic(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&Kx(o,n)>=r-1)break;r--}e++}return Da}function Zx(t){return!!(t&&t.match("^[^/\\\\]*$"))}function ic(t){var e=null,r;if(We[t]===void 0&&typeof gu<"u"&&gu&&gu.exports&&Zx(t))try{e=Da._abbr,r=require,r("./locale/"+t),Ei(e)}catch{We[t]=null}return We[t]}function Ei(t,e){var r;return t&&(Qt(e)?r=Zn(t):r=Qm(t,e),r?Da=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Da._abbr}function Qm(t,e){if(e!==null){var r,n=DT;if(e.abbr=t,We[t]!=null)vT("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=We[t]._config;else if(e.parentLocale!=null)if(We[e.parentLocale]!=null)n=We[e.parentLocale]._config;else if(r=ic(e.parentLocale),r!=null)n=r._config;else return $s[e.parentLocale]||($s[e.parentLocale]=[]),$s[e.parentLocale].push({name:t,config:e}),null;return We[t]=new $m(Lg(n,e)),$s[t]&&$s[t].forEach(function(i){Qm(i.name,i.config)}),Ei(t),We[t]}else return delete We[t],null}function Qx(t,e){if(e!=null){var r,n,i=DT;We[t]!=null&&We[t].parentLocale!=null?We[t].set(Lg(We[t]._config,e)):(n=ic(t),n!=null&&(i=n._config),e=Lg(i,e),n==null&&(e.abbr=t),r=new $m(e),r.parentLocale=We[t],We[t]=r),Ei(t)}else We[t]!=null&&(We[t].parentLocale!=null?(We[t]=We[t].parentLocale,t===Ei()&&Ei(t)):We[t]!=null&&delete We[t]);return We[t]}function Zn(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Da;if(!rn(t)){if(e=ic(t),e)return e;t=[t]}return Xx(t)}function Jx(){return Fg(We)}function Jm(t){var e,r=t._a;return r&&ie(t).overflow===-2&&(e=r[zn]<0||r[zn]>11?zn:r[bn]<1||r[bn]>Gm(r[At],r[zn])?bn:r[ht]<0||r[ht]>24||r[ht]===24&&(r[tn]!==0||r[Un]!==0||r[oo]!==0)?ht:r[tn]<0||r[tn]>59?tn:r[Un]<0||r[Un]>59?Un:r[oo]<0||r[oo]>999?oo:-1,ie(t)._overflowDayOfYear&&(e<At||e>bn)&&(e=bn),ie(t)._overflowWeeks&&e===-1&&(e=nx),ie(t)._overflowWeekday&&e===-1&&(e=ix),ie(t).overflow=e),t}var eA=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tA=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,rA=/Z|[+-]\d\d(?::?\d\d)?/,fl=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],yf=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],nA=/^\/?Date\((-?\d+)/i,iA=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,oA={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function kT(t){var e,r,n=t._i,i=eA.exec(n)||tA.exec(n),o,s,a,l,u=fl.length,c=yf.length;if(i){for(ie(t).iso=!0,e=0,r=u;e<r;e++)if(fl[e][1].exec(i[1])){s=fl[e][0],o=fl[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,r=c;e<r;e++)if(yf[e][1].exec(i[3])){a=(i[2]||" ")+yf[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(rA.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),tp(t)}else t._isValid=!1}function sA(t,e,r,n,i,o){var s=[aA(t),_T.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function aA(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function lA(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function uA(t,e,r){if(t){var n=xT.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return ie(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function cA(t,e,r){if(t)return oA[t];if(e)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function LT(t){var e=iA.exec(lA(t._i)),r;if(e){if(r=sA(e[4],e[3],e[2],e[5],e[6],e[7]),!uA(e[1],r,t))return;t._a=r,t._tzm=cA(e[8],e[9],e[10]),t._d=Aa.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),ie(t).rfc2822=!0}else t._isValid=!1}function hA(t){var e=nA.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(kT(t),t._isValid===!1)delete t._isValid;else return;if(LT(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:V.createFromInputFallback(t)}V.createFromInputFallback=$r("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function ts(t,e,r){return t??e??r}function dA(t){var e=new Date(V.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function ep(t){var e,r,n=[],i,o,s;if(!t._d){for(i=dA(t),t._w&&t._a[bn]==null&&t._a[zn]==null&&fA(t),t._dayOfYear!=null&&(s=ts(t._a[At],i[At]),(t._dayOfYear>Ea(s)||t._dayOfYear===0)&&(ie(t)._overflowDayOfYear=!0),r=Aa(s,0,t._dayOfYear),t._a[zn]=r.getUTCMonth(),t._a[bn]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[ht]===24&&t._a[tn]===0&&t._a[Un]===0&&t._a[oo]===0&&(t._nextDay=!0,t._a[ht]=0),t._d=(t._useUTC?Aa:yx).apply(null,n),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[ht]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(ie(t).weekdayMismatch=!0)}}function fA(t){var e,r,n,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,r=ts(e.GG,t._a[At],Na(De(),1,4).year),n=ts(e.W,1),i=ts(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Na(De(),o,s),r=ts(e.gg,t._a[At],u.year),n=ts(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),n<1||n>Gn(r,o,s)?ie(t)._overflowWeeks=!0:l!=null?ie(t)._overflowWeekday=!0:(a=PT(r,n,i,o,s),t._a[At]=a.year,t._dayOfYear=a.dayOfYear)}V.ISO_8601=function(){};V.RFC_2822=function(){};function tp(t){if(t._f===V.ISO_8601){kT(t);return}if(t._f===V.RFC_2822){LT(t);return}t._a=[],ie(t).empty=!0;var e=""+t._i,r,n,i,o,s,a=e.length,l=0,u,c;for(i=yT(t._f,t._locale).match(jm)||[],c=i.length,r=0;r<c;r++)o=i[r],n=(e.match(ex(o,t))||[])[0],n&&(s=e.substr(0,e.indexOf(n)),s.length>0&&ie(t).unusedInput.push(s),e=e.slice(e.indexOf(n)+n.length),l+=n.length),ds[o]?(n?ie(t).empty=!1:ie(t).unusedTokens.push(o),rx(o,n,t)):t._strict&&!n&&ie(t).unusedTokens.push(o);ie(t).charsLeftOver=a-l,e.length>0&&ie(t).unusedInput.push(e),t._a[ht]<=12&&ie(t).bigHour===!0&&t._a[ht]>0&&(ie(t).bigHour=void 0),ie(t).parsedDateParts=t._a.slice(0),ie(t).meridiem=t._meridiem,t._a[ht]=gA(t._locale,t._a[ht],t._meridiem),u=ie(t).era,u!==null&&(t._a[At]=t._locale.erasConvertYear(u,t._a[At])),ep(t),Jm(t)}function gA(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function mA(t){var e,r,n,i,o,s,a=!1,l=t._f.length;if(l===0){ie(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=Bm({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],tp(e),Wm(e)&&(s=!0),o+=ie(e).charsLeftOver,o+=ie(e).unusedTokens.length*10,ie(e).score=o,a?o<n&&(n=o,r=e):(n==null||o<n||s)&&(n=o,r=e,s&&(a=!0));vi(t,r||e)}function pA(t){if(!t._d){var e=zm(t._i),r=e.day===void 0?e.date:e.day;t._a=pT([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),ep(t)}}function wA(t){var e=new Za(Jm(FT(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function FT(t){var e=t._i,r=t._f;return t._locale=t._locale||Zn(t._l),e===null||r===void 0&&e===""?Zu({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),nn(e)?new Za(Jm(e)):(Xa(e)?t._d=e:rn(r)?mA(t):r?tp(t):vA(t),Wm(t)||(t._d=null),t))}function vA(t){var e=t._i;Qt(e)?t._d=new Date(V.now()):Xa(e)?t._d=new Date(e.valueOf()):typeof e=="string"?hA(t):rn(e)?(t._a=pT(e.slice(0),function(r){return parseInt(r,10)}),ep(t)):uo(e)?pA(t):Kn(e)?t._d=new Date(e):V.createFromInputFallback(t)}function VT(t,e,r,n,i){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(uo(t)&&Vm(t)||rn(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=t,o._f=e,o._strict=n,wA(o)}function De(t,e,r,n){return VT(t,e,r,n,!1)}var yA=$r("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=De.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Zu()}),bA=$r("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=De.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Zu()});function WT(t,e){var r,n;if(e.length===1&&rn(e[0])&&(e=e[0]),!e.length)return De();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function CA(){var t=[].slice.call(arguments,0);return WT("isBefore",t)}function SA(){var t=[].slice.call(arguments,0);return WT("isAfter",t)}var RA=function(){return Date.now?Date.now():+new Date},js=["year","quarter","month","week","day","hour","minute","second","millisecond"];function EA(t){var e,r=!1,n,i=js.length;for(e in t)if(ve(t,e)&&!(Ze.call(js,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[js[n]]){if(r)return!1;parseFloat(t[js[n]])!==he(t[js[n]])&&(r=!0)}return!0}function TA(){return this._isValid}function _A(){return an(NaN)}function oc(t){var e=zm(t),r=e.year||0,n=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=EA(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=Zn(),this._bubble()}function nu(t){return t instanceof oc}function Wg(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function OA(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<n;s++)he(t[s])!==he(e[s])&&o++;return o+i}function BT(t,e){Z(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Rn(~~(r/60),2)+e+Rn(~~r%60,2)})}BT("Z",":");BT("ZZ","");$("Z",rc);$("ZZ",rc);Pe(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=rp(rc,t)});var MA=/([\+\-]|\d\d)/gi;function rp(t,e){var r=(e||"").match(t),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(MA)||["-",0,0],o=+(i[1]*60)+he(i[2]),o===0?0:i[0]==="+"?o:-o)}function np(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(nn(t)||Xa(t)?t.valueOf():De(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),V.updateOffset(r,!1),r):De(t).local()}function Bg(t){return-Math.round(t._d.getTimezoneOffset())}V.updateOffset=function(){};function IA(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=rp(rc,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=Bg(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?zT(this,an(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,V.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:Bg(this)}function HA(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function PA(t){return this.utcOffset(0,t)}function xA(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Bg(this),"m")),this}function AA(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=rp(QP,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function NA(t){return this.isValid()?(t=t?De(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function DA(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function kA(){if(!Qt(this._isDSTShifted))return this._isDSTShifted;var t={},e;return Bm(t,this),t=FT(t),t._a?(e=t._isUTC?Tn(t._a):De(t._a),this._isDSTShifted=this.isValid()&&OA(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function LA(){return this.isValid()?!this._isUTC:!1}function FA(){return this.isValid()?this._isUTC:!1}function $T(){return this.isValid()?this._isUTC&&this._offset===0:!1}var VA=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,WA=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function an(t,e){var r=t,n=null,i,o,s;return nu(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:Kn(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=VA.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:he(n[bn])*i,h:he(n[ht])*i,m:he(n[tn])*i,s:he(n[Un])*i,ms:he(Wg(n[oo]*1e3))*i}):(n=WA.exec(t))?(i=n[1]==="-"?-1:1,r={y:Vi(n[2],i),M:Vi(n[3],i),w:Vi(n[4],i),d:Vi(n[5],i),h:Vi(n[6],i),m:Vi(n[7],i),s:Vi(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(s=BA(De(r.from),De(r.to)),r={},r.ms=s.milliseconds,r.M=s.months),o=new oc(r),nu(t)&&ve(t,"_locale")&&(o._locale=t._locale),nu(t)&&ve(t,"_isValid")&&(o._isValid=t._isValid),o}an.fn=oc.prototype;an.invalid=_A;function Vi(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function pC(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function BA(t,e){var r;return t.isValid()&&e.isValid()?(e=np(e,t),t.isBefore(e)?r=pC(t,e):(r=pC(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function jT(t,e){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(vT(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=an(r,n),zT(this,i,t),this}}function zT(t,e,r,n){var i=e._milliseconds,o=Wg(e._days),s=Wg(e._months);t.isValid()&&(n=n??!0,s&&MT(t,xa(t,"Month")+s*r),o&&TT(t,"Date",xa(t,"Date")+o*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&V.updateOffset(t,o||s))}var $A=jT(1,"add"),jA=jT(-1,"subtract");function UT(t){return typeof t=="string"||t instanceof String}function zA(t){return nn(t)||Xa(t)||UT(t)||Kn(t)||YA(t)||UA(t)||t===null||t===void 0}function UA(t){var e=uo(t)&&!Vm(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=n.length;for(i=0;i<s;i+=1)o=n[i],r=r||ve(t,o);return e&&r}function YA(t){var e=rn(t),r=!1;return e&&(r=t.filter(function(n){return!Kn(n)&&UT(t)}).length===0),e&&r}function qA(t){var e=uo(t)&&!Vm(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||ve(t,o);return e&&r}function GA(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function KA(t,e){arguments.length===1&&(arguments[0]?zA(arguments[0])?(t=arguments[0],e=void 0):qA(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||De(),n=np(r,this).startOf("day"),i=V.calendarFormat(this,n)||"sameElse",o=e&&(_n(e[i])?e[i].call(this,r):e[i]);return this.format(o||this.localeData().calendar(i,this,De(r)))}function XA(){return new Za(this)}function ZA(t,e){var r=nn(t)?t:De(t);return this.isValid()&&r.isValid()?(e=jr(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function QA(t,e){var r=nn(t)?t:De(t);return this.isValid()&&r.isValid()?(e=jr(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function JA(t,e,r,n){var i=nn(t)?t:De(t),o=nn(e)?e:De(e);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function e1(t,e){var r=nn(t)?t:De(t),n;return this.isValid()&&r.isValid()?(e=jr(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function t1(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function r1(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function n1(t,e,r){var n,i,o;if(!this.isValid())return NaN;if(n=np(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=jr(e),e){case"year":o=iu(this,n)/12;break;case"month":o=iu(this,n);break;case"quarter":o=iu(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:xr(o)}function iu(t,e){if(t.date()<e.date())return-iu(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,o;return e-n<0?(i=t.clone().add(r-1,"months"),o=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),o=(e-n)/(i-n)),-(r+o)||0}V.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";V.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function i1(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function o1(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?ru(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):_n(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",ru(r,"Z")):ru(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function s1(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(r+n+i+o)}function a1(t){t||(t=this.isUtc()?V.defaultFormatUtc:V.defaultFormat);var e=ru(this,t);return this.localeData().postformat(e)}function l1(t,e){return this.isValid()&&(nn(t)&&t.isValid()||De(t).isValid())?an({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function u1(t){return this.from(De(),t)}function c1(t,e){return this.isValid()&&(nn(t)&&t.isValid()||De(t).isValid())?an({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function h1(t){return this.to(De(),t)}function YT(t){var e;return t===void 0?this._locale._abbr:(e=Zn(t),e!=null&&(this._locale=e),this)}var qT=$r("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function GT(){return this._locale}var Su=1e3,fs=60*Su,Ru=60*fs,KT=(365*400+97)*24*Ru;function gs(t,e){return(t%e+e)%e}function XT(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-KT:new Date(t,e,r).valueOf()}function ZT(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-KT:Date.UTC(t,e,r)}function d1(t){var e,r;if(t=jr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?ZT:XT,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=gs(e+(this._isUTC?0:this.utcOffset()*fs),Ru);break;case"minute":e=this._d.valueOf(),e-=gs(e,fs);break;case"second":e=this._d.valueOf(),e-=gs(e,Su);break}return this._d.setTime(e),V.updateOffset(this,!0),this}function f1(t){var e,r;if(t=jr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?ZT:XT,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Ru-gs(e+(this._isUTC?0:this.utcOffset()*fs),Ru)-1;break;case"minute":e=this._d.valueOf(),e+=fs-gs(e,fs)-1;break;case"second":e=this._d.valueOf(),e+=Su-gs(e,Su)-1;break}return this._d.setTime(e),V.updateOffset(this,!0),this}function g1(){return this._d.valueOf()-(this._offset||0)*6e4}function m1(){return Math.floor(this.valueOf()/1e3)}function p1(){return new Date(this.valueOf())}function w1(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function v1(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function y1(){return this.isValid()?this.toISOString():null}function b1(){return Wm(this)}function C1(){return vi({},ie(this))}function S1(){return ie(this).overflow}function R1(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Z("N",0,0,"eraAbbr");Z("NN",0,0,"eraAbbr");Z("NNN",0,0,"eraAbbr");Z("NNNN",0,0,"eraName");Z("NNNNN",0,0,"eraNarrow");Z("y",["y",1],"yo","eraYear");Z("y",["yy",2],0,"eraYear");Z("y",["yyy",3],0,"eraYear");Z("y",["yyyy",4],0,"eraYear");$("N",ip);$("NN",ip);$("NNN",ip);$("NNNN",N1);$("NNNNN",D1);Pe(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?ie(r).era=i:ie(r).invalidEra=t});$("y",Hs);$("yy",Hs);$("yyy",Hs);$("yyyy",Hs);$("yo",k1);Pe(["y","yy","yyy","yyyy"],At);Pe(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[At]=r._locale.eraYearOrdinalParse(t,i):e[At]=parseInt(t,10)});function E1(t,e){var r,n,i,o=this._eras||Zn("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=V(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=V(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function T1(t,e,r){var n,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),n=0,i=o.length;n<i;++n)if(s=o[n].name.toUpperCase(),a=o[n].abbr.toUpperCase(),l=o[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[n];break;case"NNNN":if(s===t)return o[n];break;case"NNNNN":if(l===t)return o[n];break}else if([s,a,l].indexOf(t)>=0)return o[n]}function _1(t,e){var r=t.since<=t.until?1:-1;return e===void 0?V(t.since).year():V(t.since).year()+(e-t.offset)*r}function O1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function M1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function I1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function H1(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-V(i[t].since).year())*r+i[t].offset;return this.year()}function P1(t){return ve(this,"_erasNameRegex")||op.call(this),t?this._erasNameRegex:this._erasRegex}function x1(t){return ve(this,"_erasAbbrRegex")||op.call(this),t?this._erasAbbrRegex:this._erasRegex}function A1(t){return ve(this,"_erasNarrowRegex")||op.call(this),t?this._erasNarrowRegex:this._erasRegex}function ip(t,e){return e.erasAbbrRegex(t)}function N1(t,e){return e.erasNameRegex(t)}function D1(t,e){return e.erasNarrowRegex(t)}function k1(t,e){return e._eraYearOrdinalRegex||Hs}function op(){var t=[],e=[],r=[],n=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=qn(u[i].name),a=qn(u[i].abbr),l=qn(u[i].narrow),e.push(s),t.push(a),r.push(l),n.push(s),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Z(0,["gg",2],0,function(){return this.weekYear()%100});Z(0,["GG",2],0,function(){return this.isoWeekYear()%100});function sc(t,e){Z(0,[t,t.length],0,e)}sc("gggg","weekYear");sc("ggggg","weekYear");sc("GGGG","isoWeekYear");sc("GGGGG","isoWeekYear");$("G",tc);$("g",tc);$("GG",ke,Sr);$("gg",ke,Sr);$("GGGG",Ym,Um);$("gggg",Ym,Um);$("GGGGG",ec,Qu);$("ggggg",ec,Qu);Ja(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=he(t)});Ja(["gg","GG"],function(t,e,r,n){e[n]=V.parseTwoDigitYear(t)});function L1(t){return QT.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function F1(t){return QT.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function V1(){return Gn(this.year(),1,4)}function W1(){return Gn(this.isoWeekYear(),1,4)}function B1(){var t=this.localeData()._week;return Gn(this.year(),t.dow,t.doy)}function $1(){var t=this.localeData()._week;return Gn(this.weekYear(),t.dow,t.doy)}function QT(t,e,r,n,i){var o;return t==null?Na(this,n,i).year:(o=Gn(t,n,i),e>o&&(e=o),j1.call(this,t,e,r,n,i))}function j1(t,e,r,n,i){var o=PT(t,e,r,n,i),s=Aa(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Z("Q",0,"Qo","quarter");$("Q",bT);Pe("Q",function(t,e){e[zn]=(he(t)-1)*3});function z1(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Z("D",["DD",2],"Do","date");$("D",ke,Ps);$("DD",ke,Sr);$("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Pe(["D","DD"],bn);Pe("Do",function(t,e){e[bn]=he(t.match(ke)[0])});var JT=xs("Date",!0);Z("DDD",["DDDD",3],"DDDo","dayOfYear");$("DDD",Ju);$("DDDD",CT);Pe(["DDD","DDDD"],function(t,e,r){r._dayOfYear=he(t)});function U1(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Z("m",["mm",2],0,"minute");$("m",ke,qm);$("mm",ke,Sr);Pe(["m","mm"],tn);var Y1=xs("Minutes",!1);Z("s",["ss",2],0,"second");$("s",ke,qm);$("ss",ke,Sr);Pe(["s","ss"],Un);var q1=xs("Seconds",!1);Z("S",0,0,function(){return~~(this.millisecond()/100)});Z(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Z(0,["SSS",3],0,"millisecond");Z(0,["SSSS",4],0,function(){return this.millisecond()*10});Z(0,["SSSSS",5],0,function(){return this.millisecond()*100});Z(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Z(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Z(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Z(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});$("S",Ju,bT);$("SS",Ju,Sr);$("SSS",Ju,CT);var yi,e_;for(yi="SSSS";yi.length<=9;yi+="S")$(yi,Hs);function G1(t,e){e[oo]=he(("0."+t)*1e3)}for(yi="S";yi.length<=9;yi+="S")Pe(yi,G1);e_=xs("Milliseconds",!1);Z("z",0,0,"zoneAbbr");Z("zz",0,0,"zoneName");function K1(){return this._isUTC?"UTC":""}function X1(){return this._isUTC?"Coordinated Universal Time":""}var N=Za.prototype;N.add=$A;N.calendar=KA;N.clone=XA;N.diff=n1;N.endOf=f1;N.format=a1;N.from=l1;N.fromNow=u1;N.to=c1;N.toNow=h1;N.get=sx;N.invalidAt=S1;N.isAfter=ZA;N.isBefore=QA;N.isBetween=JA;N.isSame=e1;N.isSameOrAfter=t1;N.isSameOrBefore=r1;N.isValid=b1;N.lang=qT;N.locale=YT;N.localeData=GT;N.max=bA;N.min=yA;N.parsingFlags=C1;N.set=ax;N.startOf=d1;N.subtract=jA;N.toArray=w1;N.toObject=v1;N.toDate=p1;N.toISOString=o1;N.inspect=s1;typeof Symbol<"u"&&Symbol.for!=null&&(N[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});N.toJSON=y1;N.toString=i1;N.unix=m1;N.valueOf=g1;N.creationData=R1;N.eraName=O1;N.eraNarrow=M1;N.eraAbbr=I1;N.eraYear=H1;N.year=ET;N.isLeapYear=ox;N.weekYear=L1;N.isoWeekYear=F1;N.quarter=N.quarters=z1;N.month=IT;N.daysInMonth=px;N.week=N.weeks=Ex;N.isoWeek=N.isoWeeks=Tx;N.weeksInYear=B1;N.weeksInWeekYear=$1;N.isoWeeksInYear=V1;N.isoWeeksInISOWeekYear=W1;N.date=JT;N.day=N.days=Fx;N.weekday=Vx;N.isoWeekday=Wx;N.dayOfYear=U1;N.hour=N.hours=qx;N.minute=N.minutes=Y1;N.second=N.seconds=q1;N.millisecond=N.milliseconds=e_;N.utcOffset=IA;N.utc=PA;N.local=xA;N.parseZone=AA;N.hasAlignedHourOffset=NA;N.isDST=DA;N.isLocal=LA;N.isUtcOffset=FA;N.isUtc=$T;N.isUTC=$T;N.zoneAbbr=K1;N.zoneName=X1;N.dates=$r("dates accessor is deprecated. Use date instead.",JT);N.months=$r("months accessor is deprecated. Use month instead",IT);N.years=$r("years accessor is deprecated. Use year instead",ET);N.zone=$r("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",HA);N.isDSTShifted=$r("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",kA);function Z1(t){return De(t*1e3)}function Q1(){return De.apply(null,arguments).parseZone()}function t_(t){return t}var ye=$m.prototype;ye.calendar=LP;ye.longDateFormat=BP;ye.invalidDate=jP;ye.ordinal=YP;ye.preparse=t_;ye.postformat=t_;ye.relativeTime=GP;ye.pastFuture=KP;ye.set=DP;ye.eras=E1;ye.erasParse=T1;ye.erasConvertYear=_1;ye.erasAbbrRegex=x1;ye.erasNameRegex=P1;ye.erasNarrowRegex=A1;ye.months=dx;ye.monthsShort=fx;ye.monthsParse=mx;ye.monthsRegex=vx;ye.monthsShortRegex=wx;ye.week=bx;ye.firstDayOfYear=Rx;ye.firstDayOfWeek=Sx;ye.weekdays=Ax;ye.weekdaysMin=Dx;ye.weekdaysShort=Nx;ye.weekdaysParse=Lx;ye.weekdaysRegex=Bx;ye.weekdaysShortRegex=$x;ye.weekdaysMinRegex=jx;ye.isPM=Ux;ye.meridiem=Gx;function Eu(t,e,r,n){var i=Zn(),o=Tn().set(n,e);return i[r](o,t)}function r_(t,e,r){if(Kn(t)&&(e=t,t=void 0),t=t||"",e!=null)return Eu(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=Eu(t,n,r,"month");return i}function sp(t,e,r,n){typeof t=="boolean"?(Kn(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,Kn(e)&&(r=e,e=void 0),e=e||"");var i=Zn(),o=t?i._week.dow:0,s,a=[];if(r!=null)return Eu(e,(r+o)%7,n,"day");for(s=0;s<7;s++)a[s]=Eu(e,(s+o)%7,n,"day");return a}function J1(t,e){return r_(t,e,"months")}function eN(t,e){return r_(t,e,"monthsShort")}function tN(t,e,r){return sp(t,e,r,"weekdays")}function rN(t,e,r){return sp(t,e,r,"weekdaysShort")}function nN(t,e,r){return sp(t,e,r,"weekdaysMin")}Ei("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=he(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});V.lang=$r("moment.lang is deprecated. Use moment.locale instead.",Ei);V.langData=$r("moment.langData is deprecated. Use moment.localeData instead.",Zn);var xn=Math.abs;function iN(){var t=this._data;return this._milliseconds=xn(this._milliseconds),this._days=xn(this._days),this._months=xn(this._months),t.milliseconds=xn(t.milliseconds),t.seconds=xn(t.seconds),t.minutes=xn(t.minutes),t.hours=xn(t.hours),t.months=xn(t.months),t.years=xn(t.years),this}function n_(t,e,r,n){var i=an(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function oN(t,e){return n_(this,t,e,1)}function sN(t,e){return n_(this,t,e,-1)}function wC(t){return t<0?Math.floor(t):Math.ceil(t)}function aN(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,o,s,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=wC($g(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=xr(t/1e3),n.seconds=i%60,o=xr(i/60),n.minutes=o%60,s=xr(o/60),n.hours=s%24,e+=xr(s/24),l=xr(i_(e)),r+=l,e-=wC($g(l)),a=xr(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function i_(t){return t*4800/146097}function $g(t){return t*146097/4800}function lN(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=jr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+i_(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round($g(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function Qn(t){return function(){return this.as(t)}}var o_=Qn("ms"),uN=Qn("s"),cN=Qn("m"),hN=Qn("h"),dN=Qn("d"),fN=Qn("w"),gN=Qn("M"),mN=Qn("Q"),pN=Qn("y"),wN=o_;function vN(){return an(this)}function yN(t){return t=jr(t),this.isValid()?this[t+"s"]():NaN}function Io(t){return function(){return this.isValid()?this._data[t]:NaN}}var bN=Io("milliseconds"),CN=Io("seconds"),SN=Io("minutes"),RN=Io("hours"),EN=Io("days"),TN=Io("months"),_N=Io("years");function ON(){return xr(this.days()/7)}var Wn=Math.round,os={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function MN(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function IN(t,e,r,n){var i=an(t).abs(),o=Wn(i.as("s")),s=Wn(i.as("m")),a=Wn(i.as("h")),l=Wn(i.as("d")),u=Wn(i.as("M")),c=Wn(i.as("w")),h=Wn(i.as("y")),d=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||s<=1&&["m"]||s<r.m&&["mm",s]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(d=d||c<=1&&["w"]||c<r.w&&["ww",c]),d=d||u<=1&&["M"]||u<r.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=n,MN.apply(null,d)}function HN(t){return t===void 0?Wn:typeof t=="function"?(Wn=t,!0):!1}function PN(t,e){return os[t]===void 0?!1:e===void 0?os[t]:(os[t]=e,t==="s"&&(os.ss=e-1),!0)}function xN(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=os,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},os,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),o=IN(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var bf=Math.abs;function ko(t){return(t>0)-(t<0)||+t}function ac(){if(!this.isValid())return this.localeData().invalidDate();var t=bf(this._milliseconds)/1e3,e=bf(this._days),r=bf(this._months),n,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(n=xr(t/60),i=xr(n/60),t%=60,n%=60,o=xr(r/12),r%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=ko(this._months)!==ko(a)?"-":"",c=ko(this._days)!==ko(a)?"-":"",h=ko(this._milliseconds)!==ko(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(r?u+r+"M":"")+(e?c+e+"D":"")+(i||n||t?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(t?h+s+"S":"")):"P0D"}var fe=oc.prototype;fe.isValid=TA;fe.abs=iN;fe.add=oN;fe.subtract=sN;fe.as=lN;fe.asMilliseconds=o_;fe.asSeconds=uN;fe.asMinutes=cN;fe.asHours=hN;fe.asDays=dN;fe.asWeeks=fN;fe.asMonths=gN;fe.asQuarters=mN;fe.asYears=pN;fe.valueOf=wN;fe._bubble=aN;fe.clone=vN;fe.get=yN;fe.milliseconds=bN;fe.seconds=CN;fe.minutes=SN;fe.hours=RN;fe.days=EN;fe.weeks=ON;fe.months=TN;fe.years=_N;fe.humanize=xN;fe.toISOString=ac;fe.toString=ac;fe.toJSON=ac;fe.locale=YT;fe.localeData=GT;fe.toIsoString=$r("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ac);fe.lang=qT;Z("X",0,0,"unix");Z("x",0,0,"valueOf");$("x",tc);$("X",JP);Pe("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});Pe("x",function(t,e,r){r._d=new Date(he(t))});//! moment.js
V.version="2.30.1";AP(De);V.fn=N;V.min=CA;V.max=SA;V.now=RA;V.utc=Tn;V.unix=Z1;V.months=J1;V.isDate=Xa;V.locale=Ei;V.invalid=Zu;V.duration=an;V.isMoment=nn;V.weekdays=tN;V.parseZone=Q1;V.localeData=Zn;V.isDuration=nu;V.monthsShort=eN;V.weekdaysMin=nN;V.defineLocale=Qm;V.updateLocale=Qx;V.locales=Jx;V.weekdaysShort=rN;V.normalizeUnits=jr;V.relativeTimeRounding=HN;V.relativeTimeThreshold=PN;V.calendarFormat=GA;V.prototype=N;V.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var vC={},yC={},bC;function AN(){if(bC)return yC;bC=1;var t=Ae(),e=Is(),r=br(),n=pt(),i=Di(),o=Cr(),s=Mo(),a=qa(),l=lt(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(g){n(this);try{r(g)}catch(R){o(this,"throw",R)}var w=arguments.length<2,v=w?void 0:arguments[1];if(h)return a(h,this,w?[g]:[g,v]);var b=i(this),E=0;if(e(b,function(R){w?(w=!1,v=R):v=g(v,R,E),E++},{IS_RECORD:!0}),w)throw new u("Reduce of empty iterator with no initial value");return v}}),yC}var CC;function NN(){return CC||(CC=1,AN()),vC}NN();function DN(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function SC(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function Cf(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Ho(t,e,r,n){let i=-1,o=t,s=r;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function ap(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(s+=1,o[s]=a),r+=1}return o}function Mi(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];s+=1,o[s]=e(a,r,n),r+=1}return o}function z(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function RC(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let o=n;return z(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function EC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function wr(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Ho(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return o+l+u},"").trim()}function lp(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ue(t){return typeof t<"u"}function $t(t){return typeof t>"u"}function go(t){return t===null||t===""||$t(t)}function kN(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const wa="length",Ta=t=>parseInt(t,16),TC=t=>parseInt(t,10),Tu=(t,e,r)=>t.substr(e,r),_a=t=>t.codePointAt(0)-65,jg=t=>`${t}`.replace(/\-/g,""),LN=t=>Ta(Tu(jg(t),Ta("12"),_a("F")))/(Ta(Tu(jg(t),_a("B"),~~![][wa]))||9),FN=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let _C=!1;const OC={invalid:()=>wr`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return wr`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>wr`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},MC={invalid:()=>wr`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return wr`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>wr`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function VN(t,e){const r=!go(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.1.0";let o,s="invalid",a="invalid";t=jg(t||"");const l=WN(t);if(r||n||l)if(l){const u=V("15/09/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=LN(t);o=V((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else n?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(FN()&&(s="valid",a="valid"),!_C&&s!=="valid"&&(OC[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](OC[s]({keyValidityDate:o,hotVersion:i})),_C=!0),a!=="valid"&&e&&MC[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=MC[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function WN(t){let e=[][wa],r=e;if(t[wa]!==_a("Z"))return!1;for(let n="",i="B<H4P+".split(""),o=_a(i.shift());o;o=_a(i.shift()||"A"))--o<""[wa]?r=r|(TC(`${TC(Ta(n)+(Ta(Tu(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=Tu(t,o,o?i[wa]===1?9:8:6);return r===e}function zg(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,o=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=r.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function Ug(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}function lc(t){return t[0].toUpperCase()+t.substr(1)}function s_(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function BN(t){if(typeof t!="string")return!1;try{const e=JSON.parse(t);return typeof e=="object"&&e!==null}catch{return!1}}function $N(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function a_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function l_(t,e){return xP.sanitize(t,e)}const Po=t=>["tabindex",t],jN=()=>["role","treegrid"],bi=()=>["role","presentation"],zN=()=>["role","gridcell"],UN=()=>["role","gridcell button"],YN=()=>["role","rowheader"],u_=()=>["role","rowgroup"],qN=()=>["role","columnheader"],c_=()=>["role","row"],GN=()=>["role","menu"],KN=()=>["role","menuitem"],XN=()=>["role","menuitemcheckbox"],ZN=()=>["scope","col"],QN=()=>["scope","row"],_u=t=>["aria-label",t],JN=()=>["aria-hidden","true"],eD=function(){return["aria-disabled",arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0]},tD=()=>["aria-multiselectable","true"],h_=t=>["aria-rowcount",t],uc=t=>["aria-colcount",t],d_=t=>["aria-rowindex",t],up=t=>["aria-colindex",t],ou=t=>["aria-expanded",t],IC=()=>["aria-readonly","true"],HC=()=>["aria-invalid","true"],rD=t=>["aria-checked",t],f_=()=>["aria-selected","true"];var PC={},Sf,xC;function nD(){if(xC)return Sf;xC=1;var t=et(),e=qE(),r=ut(),n=So(),i=Xu(),o=t([].push);return Sf=function(s){if(r(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||n(c)==="Number"||n(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(g,w){if(d)return d=!1,w;if(e(this))return w;for(var v=0;v<h;v++)if(l[v]===g)return w}}},Sf}var AC;function iD(){if(AC)return PC;AC=1;var t=Ae(),e=Ts(),r=qa(),n=mt(),i=et(),o=lt(),s=ut(),a=Mm(),l=Fm(),u=nD(),c=Om(),h=String,d=e("JSON","stringify"),g=i(/./.exec),w=i("".charAt),v=i("".charCodeAt),b=i("".replace),E=i(1.1.toString),R=/[\uD800-\uDFFF]/g,T=/^[\uD800-\uDBFF]$/,y=/^[\uDC00-\uDFFF]$/,M=!c||o(function(){var F=e("Symbol")("stringify detection");return d([F])!=="[null]"||d({a:F})!=="{}"||d(Object(F))!=="{}"}),x=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),P=function(F,W){var q=l(arguments),L=u(W);if(!(!s(L)&&(F===void 0||a(F))))return q[1]=function(oe,G){if(s(L)&&(G=n(L,this,h(oe),G)),!a(G))return G},r(d,null,q)},D=function(F,W,q){var L=w(q,W-1),oe=w(q,W+1);return g(T,F)&&!g(y,oe)||g(y,F)&&!g(T,L)?"\\u"+E(v(F,0),16):F};return d&&t({target:"JSON",stat:!0,arity:3,forced:M||x},{stringify:function(W,q,L){var oe=l(arguments),G=r(M?P:d,null,oe);return x&&typeof G=="string"?b(G,R,D):G}}),PC}iD();function ka(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Me(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=ka(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[ka(r[0])]:e[n]=[]:e[n]=null)})),e}function oD(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Ii(t,e,r){const n=Array.isArray(r);return Me(e,(i,o)=>{(n===!1||r.includes(o))&&(t[o]=i)}),t}function g_(t,e){Me(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),g_(t[n],e[n])):t[n]=e[n]})}function Hi(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Ye(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return z(r,i=>{t.MIXINS.push(i.MIXIN_NAME),Me(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,g=w=>{let v=w;return(Array.isArray(v)||Qe(v))&&(v=Hi(v)),v};return function(){return this[d]===void 0&&(this[d]=g(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function m_(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Qe(t){return Object.prototype.toString.call(t)==="[object Object]"}function Jn(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function Me(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function Yg(t,e){const r=e.split(".");let n=t;return Me(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function Rf(t,e,r){if(typeof e!="string")return;const n=e.split(".");let i=t;n.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==n.length-1?(Fr(i,o)||(i[o]={}),i=i[o]):i[o]=r)})}function cp(t){if(!Qe(t))return 0;const e=function(r){let n=0;return Qe(r)?Me(r,(i,o)=>{o!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function pr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function Fr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function su(t,e){if(typeof t!="object"||t===null)return e;if(typeof e!="object"||e===null)return t;const r={};return Object.keys(e).forEach(n=>{typeof e[n]=="object"&&e[n]!==null&&!Array.isArray(e[n])?r[n]=su(t[n],e[n]):r[n]=Fr(t,n)&&t[n]!==void 0?t[n]:e[n]}),Object.keys(t).forEach(n=>{Fr(r,n)||(r[n]=t[n])}),r}function qg(t){return window.requestAnimationFrame(t)}function NC(t){window.cancelAnimationFrame(t)}function sD(){return"ontouchstart"in window}function aD(){return typeof window<"u"}const Pr=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},ki={chrome:Pr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Pr(t=>/CriOS/.test(t)),edge:Pr(t=>/Edge/.test(t)),edgeWebKit:Pr(t=>/EdgiOS/.test(t)),firefox:Pr(t=>/Firefox/.test(t)),firefoxWebKit:Pr(t=>/FxiOS/.test(t)),mobile:Pr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Pr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},el={mac:Pr(t=>/^Mac/.test(t)),win:Pr(t=>/^Win/.test(t)),linux:Pr(t=>/^Linux/.test(t)),ios:Pr(t=>/iPhone|iPad|iPod/i.test(t))};function lD(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Me(ki,r=>{let{test:n}=r;return void n(t,e)})}function uD(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Me(el,e=>{let{test:r}=e;return void r(t)})}aD()&&(lD(),uD());function cD(){return ki.chrome.value}function hD(){return ki.chromeWebKit.value}function Ef(){return ki.firefox.value}function dD(){return ki.firefoxWebKit.value}function hp(){return ki.safari.value}function fD(){return ki.edge.value}function Ci(){return ki.mobile.value}function p_(){return el.ios.value}function w_(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&el.mac.value}function DC(){return el.win.value}function kC(){return el.mac.value}function gD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function au(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function mD(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function La(t){return mD(t)&&t.parent}function v_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==r;){const{nodeType:s,nodeName:a}=o;if(s===n&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function gl(t,e,r){const n=[];let i=t;for(;i&&(i=v_(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=n.length;return o?n[o-1]:null}function pD(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(o=>e.test(o));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function ms(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function wD(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function Wi(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function y_(t){return!t||!t.length?[]:t.filter(e=>!!e)}function b_(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&r.push(i),!o})),{regexFree:n,regexes:r}}function me(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function K(t,e){typeof e=="string"&&(e=e.split(" ")),e=y_(e),e.length>0&&t.classList.add(...e)}function Oe(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=b_(e,!0);r=y_(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Re(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function tl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=b_(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function C_(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)C_(e[r])}}function Cs(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const vD=/(<(.*)>|&(.*);)/;function S_(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;vD.test(e)?t.innerHTML=r?l_(e):e:rl(t,e)}function rl(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Cs(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Fa(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Fa(n.host.impl);if(n.host)return Fa(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function yD(t){const r=t.ownerDocument.defaultView;let n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function Ar(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,s+=r.pageYOffset||n.scrollTop),{left:o,top:s}}function R_(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function dp(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function fp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?R_(e):t.scrollTop}function E_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?dp(e):t.scrollLeft}function Ou(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=r.getComputedStyle(i),n.includes(o)||n.includes(s)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(o))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(o)))return i;i=i.parentNode}return r}function bD(t){return t.scrollHeight-t.clientHeight}function CD(t){return t.scrollWidth-t.clientWidth}function Mu(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return n;n=n.parentNode}return r}function LC(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function rr(t){return t.offsetWidth}function ir(t){return t.getBoundingClientRect().height}function Oa(t){return t.clientHeight||t.innerHeight}function T_(t){return t.clientWidth||t.innerWidth}function SD(t){return t.selectionStart?t.selectionStart:0}function FC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function __(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=o}}}let Tf;function RD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");hp()&&!Ci()&&r.classList.add("htScrollbarSafariTest"),r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.getBoundingClientRect().width;r.style.overflow="scroll";let i=e.getBoundingClientRect().width;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),parseFloat((n-i).toFixed(3))}function jt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Tf===void 0&&(Tf=RD(t)),Tf}function ED(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function TD(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function gp(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function cc(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function lu(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function O_(t){return lu(t)&&t.hasAttribute("data-hot-input")===!1}function _D(t,e){new IntersectionObserver((n,i)=>{n.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function M_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),o=n.defaultView.getSelection();Re(t,"contenteditable",!0),r&&Re(t,...JN()),e&&K(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function I_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&Oe(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function OD(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;M_(t,r),e(),I_(t,r)}function co(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}function Se(t){return typeof t=="function"}function H_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,s)},e),n}return i}function MD(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,r.concat(s))}}function Gg(t,e,r,n,i,o,s,a){return ue(a)?t.call(e,r,n,i,o,s,a):ue(s)?t.call(e,r,n,i,o,s):ue(o)?t.call(e,r,n,i,o):ue(i)?t.call(e,r,n,i):ue(n)?t.call(e,r,n):ue(r)?t.call(e,r):t.call(e)}const Q={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Ef()?182:174,AUDIO_MUTE:Ef()?181:173,AUDIO_UP:Ef()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},ID=[Q.ALT,Q.ARROW_DOWN,Q.ARROW_LEFT,Q.ARROW_RIGHT,Q.ARROW_UP,Q.AUDIO_DOWN,Q.AUDIO_MUTE,Q.AUDIO_UP,Q.BACKSPACE,Q.CAPS_LOCK,Q.DELETE,Q.END,Q.ENTER,Q.ESCAPE,Q.F1,Q.F2,Q.F3,Q.F4,Q.F5,Q.F6,Q.F7,Q.F8,Q.F9,Q.F10,Q.F11,Q.F12,Q.F13,Q.F14,Q.F15,Q.F16,Q.F17,Q.F18,Q.F19,Q.HOME,Q.INSERT,Q.MEDIA_NEXT,Q.MEDIA_PLAY_PAUSE,Q.MEDIA_PREV,Q.MEDIA_STOP,Q.NULL,Q.NUM_LOCK,Q.PAGE_DOWN,Q.PAGE_UP,Q.PAUSE,Q.SCROLL_LOCK,Q.SHIFT,Q.TAB];function HD(t){return ID.includes(t)}function PD(t){return[Q.CONTROL,Q.COMMAND_LEFT,Q.COMMAND_RIGHT,Q.COMMAND_FIREFOX].includes(t)}function xD(t,e){const r=e.split("|");let n=!1;return z(r,i=>{if(t===Q[i])return n=!0,!1}),n}function hc(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function ro(t){return t.isImmediatePropagationEnabled===!1}function Iu(t){return t.button===2}function P_(t){return t.button===0}function on(){ue(console)&&console.warn(...arguments)}function AD(t){ue(console)&&console.warn(`Deprecated: ${t}`)}function ND(){ue(console)&&console.error(...arguments)}const no=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],_f=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Of=new Map([[]]);var VC={},Mf,WC;function DD(){if(WC)return Mf;WC=1;var t=Ms();return Mf=function(e,r,n){for(var i=0,o=arguments.length>2?n:t(r),s=new e(o);o>i;)s[i]=r[i++];return s},Mf}var If,BC;function kD(){if(BC)return If;BC=1;var t=Je();return If=function(e,r){var n=t[e],i=n&&n.prototype;return i&&i[r]},If}var Hf,$C;function mp(){if($C)return Hf;$C=1;var t=sn(),e=Lm(),r=Ni().f,n=t("unscopables"),i=Array.prototype;return i[n]===void 0&&r(i,n,{configurable:!0,value:e(null)}),Hf=function(o){i[n][o]=!0},Hf}var jC;function LD(){if(jC)return VC;jC=1;var t=Ae(),e=et(),r=br(),n=ja(),i=DD(),o=kD(),s=mp(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&r(c);var h=n(this),d=i(a,h);return l(d,c)}}),s("toSorted"),VC}LD();var zC={},UC={},YC;function FD(){if(YC)return UC;YC=1;var t=Ae(),e=mt(),r=Is(),n=br(),i=pt(),o=Di(),s=Cr(),a=Mo(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,w){if(c(g,d++))return w(g)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),UC}var qC;function VD(){return qC||(qC=1,FD()),zC}VD();function WD(t,e){x_(t,e),e.add(t)}function Pf(t,e,r){x_(t,e),e.set(t,r)}function x_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GC(t,e,r){return t.set(Hu(t,e),r),r}function bt(t,e){return t.get(Hu(t,e))}function Hu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const BD=100;var hr=new WeakMap,rs=new WeakMap,xf=new WeakMap,Af=new WeakSet;class KC{constructor(){WD(this,Af),Pf(this,hr,new Map),Pf(this,rs,new Map),Pf(this,xf,new Set),no.forEach(e=>Hu(Af,this,XC).call(this,e))}getHooks(e){var r;return(r=bt(hr,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};bt(hr,this).has(e)||(Hu(Af,this,XC).call(this,e),no.push(e));const i=bt(hr,this).get(e);if(i.find(u=>u.callback===r))return;const o=Number.isInteger(n.orderIndex)?n.orderIndex:0,s=!!n.runOnce,a=!!n.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=r,l=!0)}if(!l){i.push({callback:r,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=bt(xf,this).has(e);!u&&o!==0&&(u=!0,bt(xf,this).add(e)),u&&i.length>1&&bt(hr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return bt(hr,this).has(e)&&bt(hr,this).get(e).length>0}remove(e,r){if(!bt(hr,this).has(e))return!1;const n=bt(hr,this).get(e),i=n.find(o=>o.callback===r);if(i){let o=bt(rs,this).get(e);return i.skip=!0,o+=1,o>BD&&(bt(hr,this).set(e,n.filter(s=>!s.skip)),o=0),bt(rs,this).set(e,o),!0}return!1}destroy(){bt(hr,this).clear(),bt(rs,this).clear(),GC(hr,this,null),GC(rs,this,null)}}function XC(t){bt(hr,this).set(t,[]),bt(rs,this).set(t,0)}function $D(t,e,r){return(e=jD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jD(t){var e=zD(t,"string");return typeof e=="symbol"?e:e+""}function zD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const UD=wr`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class we{constructor(){$D(this,"globalBucket",new KC)}static getSingleton(){return qD()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new KC),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?z(r,o=>this.add(e,o,n)):(_f.has(e)&&on(a_(UD,{hookName:e,removedInVersion:_f.get(e)})),Of.has(e)&&on(Of.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?z(r,o=>this.once(e,o,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?z(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,o,s,a,l){{const u=this.getBucket().getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Gg(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Gg(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback,e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||no.push(e)}deregister(e){this.isRegistered(e)&&no.splice(no.indexOf(e),1)}isDeprecated(e){return Of.has(e)||_f.has(e)}isRegistered(e){return no.indexOf(e)>=0}getRegistered(){return no}}const YD=new we;function qD(){return YD}const so=new Map;function xo(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";so.has(t)||so.set(t,new Map);const e=so.get(t);function r(l,u){e.set(l,u)}function n(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){so.delete(t),e.clear()}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:s,clear:a}}function GD(t,e){var r;return so==null||(r=so.get(t.guid))===null||r===void 0?void 0:r.get(e)}const Kg=new WeakMap,{register:KD,getItem:A_,hasItem:N_}=xo("editors");function XD(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},we.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function ZD(t,e){let r;if(typeof t=="function")Kg.get(t)||D_(null,t),r=Kg.get(t);else if(typeof t=="string")r=A_(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function ZC(t){if(typeof t=="function")return t;if(!N_(t))throw Error(`No registered editor found under "${t}" name`);return A_(t).getConstructor()}function D_(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new XD(e);typeof t=="string"&&KD(t,r),Kg.set(e,r)}function QD(t,e,r){return(e=JD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JD(t){var e=ek(t,"string");return typeof e=="symbol"?e:e+""}function ek(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;QD(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){n.call(this,tk(s))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(r,o,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===r&&s.element===e){if(n&&n!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const o={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;n.createEvent?(s=n.createEvent("MouseEvents"),s.initMouseEvent(r,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,n.body.parentNode)):s=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${r}`,s)}}function tk(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),hc(this)},t}function rk(t,e){nk(t,e),e.add(t)}function nk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bi(t,e,r){return(e=ik(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ik(t){var e=ok(t,"string");return typeof e=="symbol"?e:e+""}function ok(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ml=new WeakSet;class Xg{constructor(e,r,n){rk(this,ml),Bi(this,"hot",void 0),Bi(this,"tableMeta",void 0),Bi(this,"selection",void 0),Bi(this,"eventManager",void 0),Bi(this,"destroyed",!1),Bi(this,"activeEditor",void 0),Bi(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new Pi(e),this.hot.addHook("afterDocumentKeyDown",i=>Nf(ml,this,QC).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>Nf(ml,this,QC).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>Nf(ml,this,sk).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,o=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let s=n,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=ZD(u,this.hot),this.activeEditor.prepare(n,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeActive();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeActive();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(n))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function QC(t){const e=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!e||e.highlight.isHeader()||ro(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!HD(r)&&!PD(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function sk(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const JC=new WeakMap;Xg.getInstance=function(t,e,r){let n=JC.get(t);return n||(n=new Xg(t,e,r),JC.set(t,n)),n};function ak(t,e){k_(t,e),e.add(t)}function zs(t,e,r){k_(t,e),e.set(t,r)}function k_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(t,e){return t.get(jn(t,e))}function Us(t,e,r){return t.set(jn(t,e),r),r}function jn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const ps=Object.freeze({CELL:"cell",MIXED:"mixed"});var it=new WeakMap,pl=new WeakMap,wl=new WeakMap,vl=new WeakMap,yl=new WeakMap,mi=new WeakSet;class lk{constructor(e){var r=this;ak(this,mi),zs(this,it,void 0),zs(this,pl,void 0),zs(this,wl,1),zs(this,vl,null),zs(this,yl,new Map);const n=e.getSettings();Us(it,this,e),Us(pl,this,n.imeFastEdit?ps.MIXED:ps.CELL),xe(it,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return jn(mi,r,ck).call(r,...o)}),xe(it,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return jn(mi,r,eS).call(r,...o)}),xe(it,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return jn(mi,r,eS).call(r,...o)}),xe(it,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return jn(mi,r,uk).call(r,...o)})}getFocusMode(){return xe(pl,this)}setFocusMode(e){Object.values(ps).includes(e)?Us(pl,this,e):on(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return xe(wl,this)}setRefocusDelay(e){Us(wl,this,e)}setRefocusElementGetter(e){Us(vl,this,e)}getRefocusElement(){var e;return typeof xe(vl,this)=="function"?xe(vl,this).call(this):(e=xe(it,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,o;const s=(i=xe(it,this).getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=xe(it,this).runHooks("modifyFocusedElement",s.row,s.col,n);co(a)||(a=n),a&&!((o=xe(it,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?r(e):jn(mi,this,pp).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xe(wl,this);if(xe(it,this).getSettings().imeFastEdit&&!((e=xe(it,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=xe(it,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),xe(yl,this).has(r)||xe(yl,this).set(r,H_(()=>{if(!xe(it,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},r)),xe(yl,this).get(r)()}}}function pp(t){var e;const r=(e=xe(it,this).getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||!xe(it,this).selection.isCellVisible(r)){t(null);return}const n=xe(it,this).getCell(r.row,r.col,!0);n===null?xe(it,this).addHookOnce("afterScroll",()=>{t(xe(it,this).getCell(r.row,r.col,!0))}):t(n)}function eS(){jn(mi,this,pp).call(this,t=>{const{activeElement:e}=xe(it,this).rootDocument;e&&O_(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function uk(){jn(mi,this,pp).call(this,t=>{this.getFocusMode()===ps.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function ck(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?ps.MIXED:ps.CELL)}var tS={},Df,rS;function hk(){if(rS)return Df;rS=1;var t=Wr(),e=So(),r=sn(),n=r("match");return Df=function(i){var o;return t(i)&&((o=i[n])!==void 0?!!o:e(i)==="RegExp")},Df}var kf,nS;function dk(){if(nS)return kf;nS=1;var t=Je(),e=lt(),r=t.RegExp,n=!e(function(){var i=!0;try{r(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,g){Object.defineProperty(o,d,{get:function(){return s+=g,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(o);return h!==a||s!==a});return kf={correct:n},kf}var Lf,iS;function fk(){if(iS)return Lf;iS=1;var t=pt();return Lf=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r},Lf}var Ff,oS;function gk(){if(oS)return Ff;oS=1;var t=mt(),e=Br(),r=za(),n=dk(),i=fk(),o=RegExp.prototype;return Ff=n.correct?function(s){return s.flags}:function(s){return!n.correct&&r(o,s)&&!e(s,"flags")?t(i,s):s.flags},Ff}var Vf,sS;function mk(){if(sS)return Vf;sS=1;var t=et(),e=_s(),r=Math.floor,n=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return Vf=function(l,u,c,h,d,g){var w=c+l.length,v=h.length,b=a;return d!==void 0&&(d=e(d),b=s),i(g,b,function(E,R){var T;switch(n(R,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,w);case"<":T=d[o(R,1,-1)];break;default:var y=+R;if(y===0)return E;if(y>v){var M=r(y/10);return M===0?E:M<=v?h[M-1]===void 0?n(R,1):h[M-1]+n(R,1):E}T=h[y-1]}return T===void 0?"":T})},Vf}var aS;function pk(){if(aS)return tS;aS=1;var t=Ae(),e=mt(),r=et(),n=$a(),i=ut(),o=Wr(),s=hk(),a=Xu(),l=Ua(),u=gk(),c=mk(),h=sn(),d=Ro(),g=h("replace"),w=TypeError,v=r("".indexOf),b=r("".replace),E=r("".slice),R=Math.max;return t({target:"String",proto:!0},{replaceAll:function(y,M){var x=n(this),P,D,F,W,q,L,oe,G,J,tt,Ee=0,Te="";if(o(y)){if(P=s(y),P&&(D=a(n(u(y))),!~v(D,"g")))throw new w("`.replaceAll` does not allow non-global regexes");if(F=l(y,g),F)return e(F,y,x,M);if(d&&P)return b(a(x),y,M)}for(W=a(x),q=a(y),L=i(M),L||(M=a(M)),oe=q.length,G=R(1,oe),J=v(W,q);J!==-1;)tt=L?a(M(q,J,W)):c(q,W,J,[],void 0,M),Te+=E(W,Ee,J)+tt,Ee=J+oe,J=J+G>W.length?-1:v(W,q,J+G);return Ee<W.length&&(Te+=E(W,Ee)),Te}}),tS}pk();const L_={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},wk=new RegExp(Object.keys(L_).map(t=>`(${t})`).join("|"),"gi");function vk(t){return(t&&t.nodeName||"")==="TABLE"}function lS(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const g=e&&d===0,w=[];for(let b=0;b<s;b+=1){const E=!g&&r&&b===0;let R="";if(g)R=`<th>${t.getColHeader(b-c)}</th>`;else if(E)R=`<th>${t.getRowHeader(d-h)}</th>`;else{const T=i[d][b],{hidden:y,rowspan:M,colspan:x}=t.getCellMeta(d-h,b-c);if(!y){const P=[];if(M&&P.push(`rowspan="${M}"`),x&&P.push(`colspan="${x}"`),go(T))R=`<td ${P.join(" ")}></td>`;else{const D=T.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");R=`<td ${P.join(" ")}>${D}</td>`}}}w.push(R)}const v=["<tr>",...w,"</tr>"].join("");g?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function uS(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],o=i.length,s=[];n===0&&r.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=go(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}r.push("<tr>",...s,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function cS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let o=t;if(typeof o=="string"){const T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,y=>{const M=y.match(/<td\b[^>]*?>/g)[0],x=/<p.*?>/g,P=y.substring(M.length,y.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(x,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${M}${P}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),o=i.querySelector("table")}if(!o||!vk(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((T,y)=>T+y.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,g=0,w=0;if(o.tHead){const T=Array.from(o.tHead.rows).filter(y=>{const M=y.querySelector("td")!==null;return M&&h.push(y),!M});g=T.length,d=g>0,g>1?r.nestedHeaders=Array.from(T).reduce((y,M)=>{const x=Array.from(M.cells).reduce((P,D,F)=>{if(a&&F===0)return P;const{colSpan:W,innerHTML:q}=D,L=W>1?{label:q,colspan:W}:q;return P.push(L),P},[]);return y.push(x),y},[]):d&&(r.colHeaders=Array.from(T[0].children).reduce((y,M,x)=>(a&&x===0||y.push(M.innerHTML),y),[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((T,y)=>(T.push(...Array.from(y.rows)),T),[]),...c];w=v.length;const b=new Array(w);for(let T=0;T<w;T++)b[T]=new Array(u);const E=[],R=[];for(let T=0;T<w;T++){const y=v[T],M=Array.from(y.cells),x=M.length;for(let P=0;P<x;P++){const D=M[P],{nodeName:F,innerHTML:W,rowSpan:q,colSpan:L}=D,oe=b[T].findIndex(G=>G===void 0);if(F==="TD"){if(q>1||L>1){for(let Ee=T;Ee<T+q;Ee++)if(Ee<w)for(let Te=oe;Te<oe+L;Te++)b[Ee][Te]=null;const J=D.getAttribute("style");J&&J.includes("mso-ignore:colspan")||E.push({col:oe,row:T,rowspan:q,colspan:L})}let G="";s&&/excel/gi.test(s.content)?G=W.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):G=W.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),b[T][oe]=G.replace(wk,J=>L_[J])}else R.push(W)}}return E.length&&(r.mergeCells=E),R.length&&(r.rowHeaders=R),b.length&&(r.data=b),r}function yk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Rt(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function hS(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function bk(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function He(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}function ws(t){return Number.isInteger(t)&&t>=0}const Zg="asc",Ck="desc",dS=new Map([[Zg,[-1,1]],[Ck,[1,-1]]]),Sk=t=>`The priority '${t}' is already declared in a map.`,Rk=t=>`The priority '${t}' is not a number.`;function Ek(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=Se(t)?t:Sk,e=Se(e)?e:Rk;function n(o,s){if(!yk(o))throw new Error(e(o));if(r.has(o))throw new Error(t(o));r.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zg;const[s,a]=dS.get(o)||dS.get(Zg);return[...r].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:n,getItems:i}}const Tk=t=>`The id '${t}' is already declared in a map.`;function dc(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Se(t)?t:Tk;function r(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function n(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,g]=h;return u===g?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:r,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:n}}const _k=t=>`'${t}' value is already declared in a unique set.`;function Ok(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Se(t)?t:_k;function r(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const wp=t=>`There is already registered "${t}" plugin.`,Mk=t=>`There is already registered plugin on priority "${t}".`,Ik=t=>`The priority "${t}" is not a number.`,F_=Ek({errorPriorityExists:Mk,errorPriorityNaN:Ik}),V_=Ok({errorItemExists:wp}),Qg=dc({errorIdExists:wp});function W_(){return[...F_.getItems(),...V_.getItems()]}function vp(t){const e=lc(t);return Qg.getItem(e)}function Hk(t){return!!vp(t)}function Wf(t,e,r){[t,e,r]=xk(t,e,r),vp(t)===void 0&&Pk(t,e,r)}function Pk(t,e,r){const n=lc(t);if(Qg.hasItem(n))throw new Error(wp(n));r===void 0?V_.addItem(n):F_.addItem(r,n),Qg.addItem(n,e)}function xk(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:Ak,getItem:Nk,hasItem:B_}=xo("renderers");function fS(t){if(typeof t=="function")return t;if(!B_(t))throw Error(`No registered renderer found under "${t}" name`);return Nk(t)}function Dk(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Ak(t,e)}const{register:kk,getItem:Lk,hasItem:$_}=xo("validators");function Fk(t){if(typeof t=="function")return t;if(!$_(t))throw Error(`No registered validator found under "${t}" name`);return Lk(t)}function Vk(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),kk(t,e)}var gS={},mS;function Wk(){if(mS)return gS;mS=1;var t=Ae(),e=_s(),r=Ms(),n=Ya(),i=mp();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=r(a),u=n(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),gS}Wk();var pS={},wS;function Bk(){if(wS)return pS;wS=1;var t=Ae(),e=et(),r=$a(),n=Ya(),i=Xu(),o=lt(),s=e("".charAt),a=o(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(r(this)),h=c.length,d=n(u),g=d>=0?d:h+d;return g<0||g>=h?void 0:s(c,g)}}),pS}Bk();function Ys(t,e,r){return(e=$k(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $k(t){var e=jk(t,"string");return typeof e=="symbol"?e:e+""}function jk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zk{constructor(){Ys(this,"count",0),Ys(this,"startColumn",null),Ys(this,"endColumn",null),Ys(this,"startPosition",null),Ys(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=r,a=i>0?o+1:o;n>=i&&n+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const w=u[this.endColumn]+c-u[this.startColumn-1];if(w<=i&&(this.startColumn-=1),w>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i,d=n+i-h,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||n>u.at(-1)||-1*n-i>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function qs(t,e,r){return(e=Uk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uk(t){var e=Yk(t,"string");return typeof e=="symbol"?e:e+""}function Yk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qk{constructor(){qs(this,"count",0),qs(this,"startRow",null),qs(this,"endRow",null),qs(this,"startPosition",null),qs(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=r;n>=i&&n+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const c=n+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Gs(t,e,r){return(e=Gk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gk(t){var e=Kk(t,"string");return typeof e=="symbol"?e:e+""}function Kk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j_{constructor(){Gs(this,"count",0),Gs(this,"startColumn",null),Gs(this,"endColumn",null),Gs(this,"startPosition",null),Gs(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o}=r;n<=i&&(this.startColumn=e);const s=i>0?o+1:o;n>=i&&n<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,g>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i;n+i-h<-1*o||n>u.at(-1)+c||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Ks(t,e,r){return(e=Xk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Xk(t){var e=Zk(t,"string");return typeof e=="symbol"?e:e+""}function Zk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class z_{constructor(){Ks(this,"count",0),Ks(this,"startRow",null),Ks(this,"endRow",null),Ks(this,"startPosition",null),Ks(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o}=r;n<=i&&(this.startRow=e),n>=i&&n<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-o<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Xs(t,e,r){return(e=Qk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qk(t){var e=Jk(t,"string");return typeof e=="symbol"?e:e+""}function Jk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eL{constructor(){Xs(this,"count",0),Xs(this,"startColumn",0),Xs(this,"endColumn",0),Xs(this,"startPosition",0),Xs(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function Zs(t,e,r){return(e=tL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tL(t){var e=rL(t,"string");return typeof e=="symbol"?e:e+""}function rL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nL{constructor(){Zs(this,"count",0),Zs(this,"startRow",0),Zs(this,"endRow",0),Zs(this,"startPosition",0),Zs(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function vS(t,e,r){return(e=iL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iL(t){var e=oL(t,"string");return typeof e=="symbol"?e:e+""}function oL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sL extends j_{constructor(){super(...arguments),vS(this,"columnStartOffset",0),vS(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof n=="function"){const s=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=o[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function yS(t,e,r){return(e=aL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aL(t){var e=lL(t,"string");return typeof e=="symbol"?e:e+""}function lL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uL extends z_{constructor(){super(...arguments),yS(this,"rowStartOffset",0),yS(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof n=="function"){const s=this.startRow,a=this.endRow;n(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=o[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function bS(t,e,r){return(e=cL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cL(t){var e=hL(t,"string");return typeof e=="symbol"?e:e+""}function hL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class U_{constructor(e){bS(this,"calculationTypes",[]),bS(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Yr(t,e,r){return(e=dL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dL(t){var e=fL(t,"string");return typeof e=="symbol"?e:e+""}function fL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yp=50;class gL extends U_{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(r),Yr(this,"viewportWidth",0),Yr(this,"scrollOffset",0),Yr(this,"zeroBasedScrollOffset",0),Yr(this,"totalColumns",0),Yr(this,"columnWidthFn",null),Yr(this,"columnWidth",0),Yr(this,"overrideFn",null),Yr(this,"inlineStartOffset",0),Yr(this,"totalCalculatedWidth",0),Yr(this,"startPositions",[]),Yr(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?yp:r}}function Tr(t,e,r){return(e=mL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mL(t){var e=pL(t,"string");return typeof e=="symbol"?e:e+""}function pL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wL extends U_{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(r),Tr(this,"viewportHeight",0),Tr(this,"scrollOffset",0),Tr(this,"zeroBasedScrollOffset",0),Tr(this,"totalRows",0),Tr(this,"rowHeightFn",null),Tr(this,"rowHeight",0),Tr(this,"overrideFn",null),Tr(this,"horizontalScrollbarHeight",0),Tr(this,"innerViewportHeight",0),Tr(this,"totalCalculatedHeight",0),Tr(this,"startPositions",[]),Tr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function vL(t,e,r){yL(t,e),e.set(t,r)}function yL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CS(t,e,r){return(e=bL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bL(t){var e=CL(t,"string");return typeof e=="symbol"?e:e+""}function CL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lo(t,e){return t.get(Y_(t,e))}function SS(t,e,r){return t.set(Y_(t,e),r),r}function Y_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var An=new WeakMap;class mo{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;CS(this,"row",null),CS(this,"col",null),vL(this,An,!1),SS(An,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Lo(An,this)}isSouthEastOf(e){return this.row>=e.row&&(Lo(An,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Lo(An,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Lo(An,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Lo(An,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof mo&&SS(An,this,e.isRtl()),this}clone(){return new mo(this.row,this.col,Lo(An,this))}toObject(){return{row:this.row,col:this.col}}}function SL(t,e,r){RL(t,e),e.set(t,r)}function RL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bf(t,e,r){return(e=EL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EL(t){var e=TL(t,"string");return typeof e=="symbol"?e:e+""}function TL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _r(t,e){return t.get(q_(t,e))}function _L(t,e,r){return t.set(q_(t,e),r),r}function q_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var qt=new WeakMap;class nl{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Bf(this,"highlight",null),Bf(this,"from",null),Bf(this,"to",null),SL(this,qt,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),_L(qt,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=r&&o.row>=r&&i.col<=n&&o.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,s.row),u=Math.min(n.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),g=this._createCellCoords(c,h);return this.from=d,this.to=g,this.setDirection(o),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return _r(qt,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return _r(qt,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return _r(qt,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return _r(qt,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return _r(qt,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return _r(qt,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return _r(qt,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return _r(qt,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof mo))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(_r(qt,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(_r(qt,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&n.push(this._createCellCoords(i,o));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)e.row===i&&e.col===o?n.push(e):r.row===i&&r.col===o?n.push(r):n.push(this._createCellCoords(i,o));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let o=r.col;o<=n.col;o++)if(e(i,o)===!1)return}clone(){return new nl(this.highlight,this.from,this.to,_r(qt,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new mo(e,r,_r(qt,this))}}function dn(t,e,r){OL(t,e),e.set(t,r)}function OL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U(t,e){return t.get(G_(t,e))}function oi(t,e,r){return t.set(G_(t,e),r),r}function G_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Or=new WeakMap,$f=new WeakMap,gt=new WeakMap,Fo=new WeakMap,bl=new WeakMap,qr=new WeakMap,jf=new WeakMap,Qs=new WeakMap,$i=new WeakMap,fn=new WeakMap;let K_=class{constructor(e,r,n,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;dn(this,Or,void 0),dn(this,$f,void 0),dn(this,gt,void 0),dn(this,Fo,void 0),dn(this,bl,void 0),dn(this,qr,void 0),dn(this,jf,void 0),dn(this,Qs,void 0),dn(this,$i,[null,null]),dn(this,fn,[null,null]),oi(Or,this,n),oi($f,this,r),oi(gt,this,o),oi(Fo,this,s),oi(bl,this,a),oi(qr,this,i),oi(jf,this,e),this.registerEvents()}registerEvents(){U(qr,this).addEventListener(U(gt,this).holder,"contextmenu",n=>this.onContextMenu(n)),U(qr,this).addEventListener(U(gt,this).TABLE,"mouseover",n=>this.onMouseOver(n)),U(qr,this).addEventListener(U(gt,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{U(qr,this).addEventListener(U(gt,this).holder,"touchstart",n=>this.onTouchStart(n)),U(qr,this).addEventListener(U(gt,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),U(qr,this).addEventListener(U(gt,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||U(Or,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,U(Or,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{U(qr,this).addEventListener(U(gt,this).holder,"mouseup",n=>this.onMouseUp(n)),U(qr,this).addEventListener(U(gt,this).holder,"mousedown",n=>this.onMouseDown(n))};Ci()?e():(sD()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(U(Qs,this)&&n){const[i,o]=[n.row,U(Qs,this).from.row],[s,a]=[n.col,U(Qs,this).from.col];return i===o&&s===a}return!1}parentCell(e){const r={},n=U(gt,this).TABLE,i=gl(e,["TD","TH"],n);return i?(r.coords=U(gt,this).getCoords(i),r.TD=i):me(e,"wtBorder")&&me(e,"current")?(r.coords=U(Fo,this).getFocusSelection().cellRange.highlight,r.TD=U(gt,this).getCell(r.coords)):me(e,"wtBorder")&&me(e,"area")&&U(Fo,this).getAreaSelection().cellRange&&(r.coords=U(Fo,this).getAreaSelection().cellRange.to,r.TD=U(gt,this).getCell(r.coords)),r}onMouseDown(e){const r=U($f,this).rootDocument.activeElement,n=MD(gD,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const o=this.parentCell(i);me(i,"corner")?U(Or,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&U(Or,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(U(fn,this)[0]=o.TD,clearTimeout(U($i,this)[0]),U($i,this)[0]=setTimeout(()=>{U(fn,this)[0]=null},1e3))}onContextMenu(e){if(U(Or,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!U(Or,this).has("onCellMouseOver"))return;const r=U(gt,this).TABLE,n=gl(e.target,["TD","TH"],r),i=U(bl,this)||this;n&&n!==i.lastMouseOver&&ms(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,U(gt,this).getCoords(n),n))}onMouseOut(e){if(!U(Or,this).has("onCellMouseOut"))return;const r=U(gt,this).TABLE,n=gl(e.target,["TD","TH"],r),i=gl(e.relatedTarget,["TD","TH"],r),o=U(bl,this)||this;n&&n!==i&&ms(n,r)&&(this.callListener("onCellMouseOut",e,U(gt,this).getCoords(n),n),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&U(Or,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===U(fn,this)[0]&&r.TD===U(fn,this)[1]?(me(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),U(fn,this)[0]=null,U(fn,this)[1]=null):r.TD===U(fn,this)[0]&&(U(fn,this)[1]=r.TD,clearTimeout(U($i,this)[1]),U($i,this)[1]=setTimeout(()=>{U(fn,this)[1]=null},500)))}onTouchStart(e){oi(Qs,this,U(Fo,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,o=ue(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&U(Or,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];p_()&&(hD()||dD())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const o=U(Or,this).getSettingPure(e);o&&o(r,n,i,U(jf,this).call(this))}destroy(){clearTimeout(U($i,this)[0]),clearTimeout(U($i,this)[1]),U(qr,this).destroy()}};function zf(t,e,r){return(e=ML(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ML(t){var e=IL(t,"string");return typeof e=="symbol"?e:e+""}function IL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HL{constructor(e,r,n){zf(this,"offset",void 0),zf(this,"total",void 0),zf(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Uf(t,e,r){return(e=PL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PL(t){var e=xL(t,"string");return typeof e=="symbol"?e:e+""}function xL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AL{constructor(e,r,n){Uf(this,"offset",void 0),Uf(this,"total",void 0),Uf(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Cl(t,e,r){return(e=NL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NL(t){var e=DL(t,"string");return typeof e=="symbol"?e:e+""}function DL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kL{constructor(){Cl(this,"currentSize",0),Cl(this,"nextSize",0),Cl(this,"currentOffset",0),Cl(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const LL=0,RS=1,Jg=2;function Yf(t,e,r){return(e=FL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FL(t){var e=VL(t,"string");return typeof e=="symbol"?e:e+""}function VL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WL{constructor(){Yf(this,"size",new kL),Yf(this,"workingSpace",LL),Yf(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=RS,e.workingSpace=Jg,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Jg,e.workingSpace=RS,this.sharedSize=e.getViewSize()}}var ES={},qf,TS;function BL(){if(TS)return qf;TS=1;var t=Ku(),e=TypeError;return qf=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))},qf}var _S;function $L(){if(_S)return ES;_S=1;var t=Ae(),e=_s(),r=Ms(),n=GE(),i=BL(),o=KE(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=r(h),g=arguments.length;if(g){o(d+g);for(var w=d;w--;){var v=w+g;w in h?h[v]=h[w]:i(h,v)}for(var b=0;b<g;b++)h[b]=arguments[b]}return n(h,d+g)}}),ES}$L();function jL(t,e,r){return(e=zL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zL(t){var e=UL(t,"string");return typeof e=="symbol"?e:e+""}function UL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OS{constructor(e,r){jL(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function YL(t,e,r){return(e=qL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qL(t){var e=GL(t,"string");return typeof e=="symbol"?e:e+""}function GL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KL{constructor(e){YL(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new OS(o,r),l=new OS(s,n),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(Jg)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),n<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const g=a.prepend(d);u.push(["insert_before",d,h,g])}else u.push(["none",d])}return u}}function Vo(t,e,r){return(e=XL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XL(t){var e=ZL(t,"string");return typeof e=="symbol"?e:e+""}function ZL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X_{constructor(e,r){Vo(this,"rootNode",void 0),Vo(this,"nodesPool",void 0),Vo(this,"sizeSet",new WL),Vo(this,"collectedNodes",[]),Vo(this,"viewDiffer",new KL(this.sizeSet)),Vo(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(o)),r.removeChild(this.nodesPool(s));break;case"replace":r.replaceChild(a,this.nodesPool(o));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class Z_ extends X_{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function MS(t,e,r){return(e=QL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QL(t){var e=JL(t,"string");return typeof e=="symbol"?e:e+""}function JL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eF{constructor(e){MS(this,"nodeType",void 0),MS(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function Js(t,e,r){return(e=tF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tF(t){var e=rF(t,"string");return typeof e=="symbol"?e:e+""}function rF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class il{constructor(e,r){Js(this,"nodesPool",null),Js(this,"nodeType",void 0),Js(this,"rootNode",void 0),Js(this,"table",null),Js(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new eF(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function IS(t,e,r){return(e=nF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nF(t){var e=iF(t,"string");return typeof e=="symbol"?e:e+""}function iF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oF extends il{constructor(){super("TH"),IS(this,"orderViews",new WeakMap),IS(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new Z_(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(n).setOffset(0).start();for(let h=n-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),tl(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Re(d,[YN(),QN(),up(h+1),Po(-1)]),r[h](a,d,h)}u.end()}}}class sF extends il{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Cs(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Re(this.rootNode,[u_()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&Re(s,[c_(),d_(r+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),tl(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Re(u,[up(a+1+this.table.rowHeadersCount),Po(-1),qN(),...a>=0?[ZN()]:[UN(),_u("Select whole grid")]]),n[r](l,u,r)}}}}let HS=!1;class aF extends il{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!HS&&e>1e3&&(HS=!0,on(wr`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+r].style.width=`${s}px`}const n=this.rootNode.firstChild;n&&K(n,"rowHeader")}}function lF(t,e,r){return(e=uF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uF(t){var e=cF(t,"string");return typeof e=="symbol"?e:e+""}function cF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Wo={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let PS=!1;class hF extends il{constructor(e){super("TR",e),lF(this,"orderView",void 0),this.orderView=new X_(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!PS&&e>1e3&&(PS=!0,on(wr`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Re(this.rootNode,[u_()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;Re(o,[c_(),d_(s+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(s+1)%2===0?me(o,Wo.rowEven)||(Oe(o,Wo.rowOdd),K(o,Wo.rowEven)):me(o,Wo.rowOdd)||(Oe(o,Wo.rowEven),K(o,Wo.rowOdd))}this.orderView.end()}}function xS(t,e,r){return(e=dF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dF(t){var e=fF(t,"string");return typeof e=="symbol"?e:e+""}function fF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gF extends il{constructor(){super("TD"),xS(this,"orderViews",new WeakMap),xS(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new Z_(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(r).setOffset(0).start();for(let d=0;d<r;d++){c.render();const g=this.table.renderedColumnToSource(d),w=c.getCurrentNode();if(me(w,"hide")||(w.className=""),w.removeAttribute("style"),w.removeAttribute("dir"),tl(w,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,g,w),this.table.isAriaEnabled()){var o,s;Re(w,[...w.hasAttribute("role")?[]:[zN()],Po(-1),up(g+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function nt(t,e,r){return(e=mF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mF(t){var e=pF(t,"string");return typeof e=="symbol"?e:e+""}function pF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wF{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};nt(this,"rootNode",void 0),nt(this,"rootDocument",void 0),nt(this,"rowHeaders",null),nt(this,"columnHeaders",null),nt(this,"colGroup",null),nt(this,"rows",null),nt(this,"cells",null),nt(this,"rowFilter",null),nt(this,"columnFilter",null),nt(this,"rowUtils",null),nt(this,"columnUtils",null),nt(this,"rowsToRender",0),nt(this,"columnsToRender",0),nt(this,"rowHeaderFunctions",[]),nt(this,"rowHeadersCount",0),nt(this,"columnHeaderFunctions",[]),nt(this,"columnHeadersCount",0),nt(this,"cellRenderer",void 0),nt(this,"activeOverlayName",void 0),nt(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(n),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class vF{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new wF(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new oF,columnHeaders:new sF(r),colGroup:new aF(n),rows:new hF(i),cells:new gF}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Gf(t,e,r){return(e=yF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yF(t){var e=bF(t,"string");return typeof e=="symbol"?e:e+""}function bF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CF{constructor(e,r){Gf(this,"dataAccessObject",void 0),Gf(this,"wtSettings",void 0),Gf(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<n;o++){let s=Array.isArray(r)?r[o]:r;s=s??i,this.headerWidths.set(o,s)}}}}function AS(t,e,r){return(e=SF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SF(t){var e=RF(t,"string");return typeof e=="symbol"?e:e+""}function RF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EF{constructor(e,r){AS(this,"dataAccessObject",void 0),AS(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function gn(t,e,r){return(e=TF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TF(t){var e=_F(t,"string");return typeof e=="symbol"?e:e+""}function _F(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class As{constructor(e,r,n,i,o){gn(this,"wtSettings",null),gn(this,"domBindings",void 0),gn(this,"TBODY",null),gn(this,"THEAD",null),gn(this,"COLGROUP",null),gn(this,"hasTableHeight",!0),gn(this,"hasTableWidth",!0),gn(this,"isTableVisible",!1),gn(this,"tableOffset",0),gn(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,C_(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new EF(this.dataAccessObject,this.wtSettings),this.columnUtils=new CF(this.dataAccessObject,this.wtSettings),this.tableRenderer=new vF({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!me(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Re(n,[bi()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!me(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Re(n,[bi()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!me(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",this.isMaster&&Re(n,[Po(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Re(n.parentNode,[bi()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Re(n,[bi()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,o=r.getSetting("totalRows"),s=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,u=r.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Ar(this.holder),h=i.createCalculators(h),l&&!r.getSetting("fixedColumnsStart"))){const g=n.inlineStartOverlay.getScrollPosition(),w=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,w!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Ar(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=Math.max(this.getFirstRenderedRow(),0),w=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new AL(g,o,c),this.columnFilter=new HL(w,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),v=b.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Cn)||this.is(Ti))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Cn))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Cn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,o=this.getColumnHeaderHeight(n),s=this.getColumnHeader(r,n),s&&(a=Oa(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(n[o]){if(!r[o]||r[o].childNodes.length===0)return;r[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Cn))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const o=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[o]&&(r.oversizedRows[o]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const o=this.getRow(r);if(!o&&r>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var o;r=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[n];o&&r.push(o)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a?.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o?.childNodes[i];s&&r.push(s)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=v_(r,["TD","TH"])),r===null)return null;const n=r.parentNode;if(!n)return null;const i=n.parentNode;let o=wD(n),s=r.cellIndex;Wi(vo,r,this.wtRootElement)||Wi(po,r,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Wi(Ti,r,this.wtRootElement)||Wi(Cn,r,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),Wi(vo,r,this.wtRootElement)||Wi(wo,r,this.wtRootElement)||Wi(Ti,r,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=this.wtSettings.getSetting("stylesHandler"),n=e*r.getDefaultRowHeight(),i=Oa(this.TBODY)-1,o=r.areCellsBorderBox(),s=o?ir:Oa,a=o?0:1,l=o?1:0;let u,c,h,d,g;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),g=d.querySelector("th");const w=h===0?l:0;g?c=s(g):c=s(d)-a,(!u&&r.getDefaultRowHeight()<c-w||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return rr(this.TABLE)}getHeight(){return ir(this.TABLE)}getTotalWidth(){const e=rr(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=ir(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Fa(this.TABLE)}_modifyRowHeaderWidth(e){let r=Se(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const OF="stickyRowsBottom",bp={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Jn(bp,"MIXIN_NAME",OF,{writable:!1,enumerable:!1});const MF="stickyColumnsStart",fc={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Jn(fc,"MIXIN_NAME",MF,{writable:!1,enumerable:!1});class Cp extends As{constructor(e,r,n,i){super(e,r,n,i,Ti)}}Ye(Cp,bp);Ye(Cp,fc);const po="top",Cn="bottom",wo="inline_start",vo="top_inline_start_corner",Ti="bottom_inline_start_corner",Q_=[po,Cn,wo,vo,Ti],IF=new Map([[po,`ht_clone_${po}`],[Cn,`ht_clone_${Cn}`],[wo,`ht_clone_${wo} ht_clone_left`],[vo,`ht_clone_${vo} ht_clone_top_left_corner`],[Ti,`ht_clone_${Ti} ht_clone_bottom_left_corner`]]);function HF(t,e){PF(t,e),e.add(t)}function PF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xF(t,e,r){return(e=AF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AF(t){var e=NF(t,"string");return typeof e=="symbol"?e:e+""}function NF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ea=new WeakSet;class DF{constructor(e){HF(this,ea),xF(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),o=this.scrollViewportVertically(e.row,n);return i||o}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const o=pr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),h}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const o=pr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=r==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():r==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Sl(ea,this,DS).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Sl(ea,this,DS).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Sl(ea,this,NS).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Sl(ea,this,NS).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function NS(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(r.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=n.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Ar(n.wtRootElement).left;const u=Math.abs(E_(s,s));if(l>u){const c=T_(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=r.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function DS(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Ar(r.wtRootElement),a=fp(o,o);if(s.top>a){const l=Oa(o);let u=n.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Mr(t,e,r){return(e=kF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kF(t){var e=LF(t,"string");return typeof e=="symbol"?e:e+""}function LF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sp{get eventManager(){return new Pi(this)}constructor(e,r){Mr(this,"wtTable",void 0),Mr(this,"wtScroll",void 0),Mr(this,"wtViewport",void 0),Mr(this,"wtOverlays",void 0),Mr(this,"selectionManager",void 0),Mr(this,"wtEvent",void 0),Mr(this,"guid",`wt_${s_()}`),Mr(this,"drawInterrupted",!1),Mr(this,"drawn",!1),Mr(this,"activeOverlayName","master"),Mr(this,"domBindings",void 0),Mr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new DF(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){rl(n,e[r])}])}}createCellCoords(e,r){return new mo(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new nl(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||yD(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function kS(t,e,r){return(e=FF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FF(t){var e=VF(t,"string");return typeof e=="symbol"?e:e+""}function VF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WF extends Sp{constructor(e,r,n){super(e,r),kS(this,"cloneSource",void 0),kS(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new K_(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function BF(t,e,r){return(e=$F(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $F(t){var e=jF(t,"string");return typeof e=="symbol"?e:e+""}function jF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ol{constructor(e,r,n,i,o){BF(this,"wtSettings",null),Jn(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Mu(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Mu(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Ou(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){on(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),s=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!r)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+jt())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:n.start+s,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=s.horizontal-o.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(Q_.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=n.createElement("div"),s=n.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${IF.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,r.getSetting("ariaTags")&&Re(o,[bi()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===po||u==="vertical"&&this.type===wo?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Ou(e.TABLE),new WF(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,o=e.parentNode.style;[n,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class zF extends ol{constructor(e,r,n,i,o,s){super(e,r,Ti,n,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Cp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${o}px`,r.style.bottom=`${s}px`}else cc(r),this.repositionOverlay();let n=ir(this.clone.wtTable.TABLE);const i=rr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=jt(n)),i.style.bottom=`${o}px`}}const UF="calculatedColumns",gc={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Jn(gc,"MIXIN_NAME",UF,{writable:!1,enumerable:!1});class Rp extends As{constructor(e,r,n,i){super(e,r,n,i,Cn)}}Ye(Rp,bp);Ye(Rp,gc);function YF(t,e,r){return(e=qF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qF(t){var e=GF(t,"string");return typeof e=="symbol"?e:e+""}function GF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KF extends ol{constructor(e,r,n,i){super(e,r,Cn,n,i),YF(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Rp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=jt(n)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(dp(r),top),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<r;){const l=n.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=jt(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=ir(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;r&&o.offsetHeight!==o.clientHeight&&(s=jt(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=s,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return fp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((n||r===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=me(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(K(s,"innerBorderBottom"),o=!a):(Oe(s,"innerBorderBottom"),o=a)}return o}}const XF="calculatedRows",Ep={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Jn(Ep,"MIXIN_NAME",XF,{writable:!1,enumerable:!1});class Tp extends As{constructor(e,r,n,i){super(e,r,n,i,wo)}}Ye(Tp,Ep);Ye(Tp,fc);const ZF="localHooks",On={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},removeLocalHook(t,e){if(this._localHooks[t]){const r=this._localHooks[t].indexOf(e);r>-1&&this._localHooks[t].splice(r,1)}return this},runLocalHooks(t,e,r,n,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Gg(this._localHooks[t][l],this,e,r,n,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Jn(On,"MIXIN_NAME",ZF,{writable:!1,enumerable:!1});let J_=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};Ye(J_,On);const QF="active-header",e0="header",_p="area",Pu="focus",JF="fill",eV="row",tV="column",rV="custom-selection",Op=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var LS={},FS;function nV(){if(FS)return LS;FS=1;var t=mp();return t("flat"),LS}nV();function iV(t,e){t0(t,e),e.add(t)}function VS(t,e,r){t0(t,e),e.set(t,r)}function t0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $e(t,e){return t.get(Ma(t,e))}function WS(t,e,r){return t.set(Ma(t,e),r),r}function Ma(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Xr=new WeakMap,It=new WeakMap,Rl=new WeakSet;class oV{constructor(){iV(this,Rl),VS(this,Xr,void 0),VS(this,It,void 0)}setActiveOverlay(e){return WS(It,this,e),this}setActiveSelection(e){return WS(Xr,this,e),this}scan(){const e=$e(Xr,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,o]=$e(Xr,this).getCorners(),{wtTable:s}=$e(It,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<n||h>o)){for(let d=-l;d<0;d++){if(d<r||d>i)continue;const g=d+l;let w=s.getColumnHeader(h,g);const v=$e(It,this).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:$e(Xr,this).settings.selectionType,columnCursor:u,selectionWidth:o-n+1});v!==null&&(v!==h&&(w=s.getColumnHeader(v,g)),e(w))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,o]=$e(Xr,this).getCorners(),{wtTable:s}=$e(It,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<r||h>i)){for(let d=-l;d<0;d++){if(d<n||d>o)continue;const g=d+l;let w=s.getRowHeader(h,g);const v=$e(It,this).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:$e(Xr,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});v!==null&&(v!==h&&(w=s.getRowHeader(v,g)),e(w))}u+=1}}}scanCellsRange(e){const{wtTable:r}=$e(It,this);Ma(Rl,this,sV).call(this,(n,i)=>{const o=r.getCell($e(It,this).createCellCoords(n,i)),s=$e(It,this).getSetting("onAfterDrawSelection",n,i,$e(Xr,this).settings.layerLevel);typeof s=="string"&&K(o,s),e(o)})}scanRowsInCellsRange(e){const[r,,n]=$e(Xr,this).getCorners(),{wtTable:i}=$e(It,this);Ma(Rl,this,BS).call(this,(o,s)=>{if(o>=r&&o<=n){const a=i.getCell($e(It,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=$e(Xr,this).getCorners(),{wtTable:i}=$e(It,this);Ma(Rl,this,BS).call(this,(o,s)=>{if(s>=r&&s<=n){const a=i.getCell($e(It,this).createCellCoords(o,s));e(a)}})}}function sV(t){let[e,r,n,i]=$e(Xr,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:o}=$e(It,this),s=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),s){if(r=Math.max(r,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),n=Math.min(n,o.getLastRenderedRow()),i<r||n<e)return}else{const a=o.getCell($e(It,this).createCellCoords(e,r));if(!co(a))return}for(let a=e;a<=n;a+=1)for(let l=r;l<=i;l+=1)t(a,l)}function BS(t){const{wtTable:e}=$e(It,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<n;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class $S{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Op(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),hc(e);const n=this,i=this.wot.rootDocument.body,o=r.getBoundingClientRect();r.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],u=r.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ci()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=r.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:r}=this.wot,n=r.getSetting("stylesHandler"),i=n.getCSSVariableValue("cell-mobile-handle-size"),o=n.getCSSVariableValue("cell-mobile-handle-border-radius"),s=n.getCSSVariableValue("cell-mobile-handle-background-color"),a=n.getCSSVariableValue("cell-mobile-handle-border-width"),l=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};Me(h,(g,w)=>{this.selectionHandles.styles.bottomHitArea[w]=g,this.selectionHandles.styles.topHitArea[w]=g});const d=n.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};Me(d,(g,w)=>{this.selectionHandles.styles.bottom[w]=g,this.selectionHandles.styles.top[w]=g}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),w=parseInt(u.width,10),v=parseInt(c.width,10),b=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(n-w-1,10)}px`,u[l]=`${parseInt(i-w-1,10)}px`,c.top=`${parseInt(n-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const R=Math.min(parseInt(i+o,10),b-w-g*2),T=Math.min(parseInt(i+o-v/4,10),b-v-g*2);h[l]=`${R}px`,d[l]=`${T}px`;const y=Math.min(parseInt(n+s,10),E-w-g*2),M=Math.min(parseInt(n+s-v/4,10),E-v-g*2);h.top=`${y}px`,d.top=`${M}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,r)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,o]=e;if(r<0&&i<0||n<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=r!==i||n!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),g=s.getFirstRenderedColumn(),w=s.getLastRenderedColumn();if(g<0&&w<0||h<0&&d<0){this.disappear();return}let v;if(u){if(n=Math.max(n,g),o=Math.min(o,w),r=Math.max(r,h),i=Math.min(i,d),o<n||i<r){this.disappear();return}v=s.getCell(this.wot.createCellCoords(r,n))}else if(v=s.getCell(this.wot.createCellCoords(r,n)),!co(v)){this.disappear();return}const b=u?s.getCell(this.wot.createCellCoords(i,o)):v,E=Ar(v),R=u?Ar(b):E,T=Ar(s.TABLE),y=E.top,M=E.left,x=this.wot.wtSettings.getSetting("rtlMode");let P=0,D=0;if(x){const Te=rr(s.TABLE),Be=rr(v),Le=l.innerWidth-T.left-Te;D=M+Be-R.left,P=l.innerWidth-M-Be-Le-1}else D=R.left+rr(b)-M,P=M-T.left-1;if(this.isEntireColumnSelected(r,i)){const Te=r,Be=this.getDimensionsFromHeader("columns",n,o,Te,T);let Le=null;Be&&([Le,P,D]=Be),Le&&(v=Le)}let F=y-T.top-1,W=R.top+ir(b)-y;if(this.isEntireRowSelected(n,o)){const Te=n,Be=this.getDimensionsFromHeader("rows",r,i,Te,T);let Le=null;Be&&([Le,F,W]=Be),Le&&(v=Le)}const q=l.getComputedStyle(v);parseInt(q.borderTopWidth,10)>0&&(F+=1,W=W>0?W-1:0),parseInt(q[x?"borderRightWidth":"borderLeftWidth"],10)>0&&(P+=1,D=D>0?D-1:0);const L=x?"right":"left",oe=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${F}px`,this.topStyle[L]=`${P}px`,this.topStyle.width=`${D+oe}px`,this.topStyle.display="block",this.startStyle.top=`${F}px`,this.startStyle[L]=`${P}px`,this.startStyle.height=`${W+oe}px`,this.startStyle.display="block",this.bottomStyle.top=`${F+W-parseInt(this.bottomStyle.height,10)+oe}px`,this.bottomStyle[L]=`${P}px`,this.bottomStyle.width=`${D+oe}px`,this.bottomStyle.display="block",this.endStyle.top=`${F}px`,this.endStyle[L]=`${P+D-parseInt(this.endStyle.width,10)+oe}px`,this.endStyle.height=`${W+oe}px`,this.endStyle.display="block";let G=this.settings.border.cornerVisible;G=typeof G=="function"?G(this.settings.layerLevel):G;const J=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[tt,Ee]=[i,o];if(J&&Array.isArray(J)&&([,,tt,Ee]=J),Ci()||!G||this.isPartRange(tt,Ee))this.cornerStyle.display="none";else{this.cornerStyle.top=`${F+W+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[L]=`${P+D+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Te=Mu(s.TABLE);const Be=Te===l;Be&&(Te=a.documentElement);const Le=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Ie=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),zr=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const be=Be?b.getBoundingClientRect().left:b.offsetLeft;let f=!1,m=0;if(x?(m=be-parseInt(this.cornerDefaultStyle.width,10)/2,f=m<0):(m=be+rr(b)+parseInt(this.cornerDefaultStyle.width,10)/2,f=m>=T_(Te)),f){const p=Math.floor(P+D+this.cornerCenterPointOffset-Ie-Le);c?(this.cornerStyle[L]=`${p}px`,this.cornerStyle[x?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[L]=`${p-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(Be?b.getBoundingClientRect().top:b.offsetTop)+ir(b)+parseInt(this.cornerDefaultStyle.height,10)/2>=Oa(Te)){const p=Math.floor(F+W+this.cornerCenterPointOffset-zr-Le);c?(this.cornerStyle.top=`${p}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${p-1}px`}this.cornerStyle.display="block"}Ci()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,F,P,D,W)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,g=null,w=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return ir(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return rr(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const b=this.wot.getSetting("columnHeaders").length;if(w=l(r,b-i),v=l(n,b-i),!w||!v)return!1;const E=Ar(w),R=Ar(v);return w&&v&&(h=E[g]-o[g]-1,d=R[g]+u(v)-E[g]),[w,h,d]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?K(this[e],"hidden"):(me(this[e],"hidden")&&Oe(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?K(this[e],"hidden"):Oe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ci()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function aV(t,e){r0(t,e),e.add(t)}function Bo(t,e,r){r0(t,e),e.set(t,r)}function r0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function se(t,e){return t.get(Mp(t,e))}function jS(t,e,r){return t.set(Mp(t,e),r),r}function Mp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ht=new WeakMap,Jt=new WeakMap,Kf=new WeakMap,va=new WeakMap,Xf=new WeakMap,ji=new WeakMap,zS=new WeakSet;class lV{constructor(e){aV(this,zS),Bo(this,Ht,void 0),Bo(this,Jt,void 0),Bo(this,Kf,new oV),Bo(this,va,new WeakMap),Bo(this,Xf,new WeakSet),Bo(this,ji,new Map),jS(Jt,this,e)}setActiveOverlay(e){return jS(Ht,this,e),se(Kf,this).setActiveOverlay(se(Ht,this)),se(va,this).has(se(Ht,this))||se(va,this).set(se(Ht,this),new Set),this}getFocusSelection(){return se(Jt,this)!==null?se(Jt,this).getFocus():null}getAreaSelection(){return se(Jt,this)!==null?se(Jt,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(se(ji,this).has(e)){const n=se(ji,this).get(e);if(n.has(se(Ht,this)))return n.get(se(Ht,this));const i=new $S(se(Ht,this),e.settings);return n.set(se(Ht,this),i),i}const r=new $S(se(Ht,this),e.settings);return se(ji,this).set(e,new Map([[se(Ht,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=se(ji,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){se(ji,this).get(e).forEach(r=>r.destroy()),se(ji,this).delete(e)}render(e){if(se(Jt,this)===null)return;e&&Mp(zS,this,uV).call(this);const r=Array.from(se(Jt,this)),n=new Map,i=new Map;for(let o=0;o<r.length;o++){const s=r[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;se(Xf,this).has(s)||(se(Xf,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h?.disappear();continue}a&&se(Kf,this).setActiveSelection(s).scan().forEach(w=>{if(n.has(w)){const v=n.get(w);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else n.set(w,new Map([[a,1]]));l&&(i.has(w)||i.set(w,[]),w.nodeName==="TH"&&i.get(w).push(...l))});const d=s.getCorners();se(Ht,this).getSetting("onBeforeDrawBorders",d,c),h?.appear(d)}n.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>se(va,this).get(se(Ht,this)).add(u)),K(s,l),s.nodeName==="TD"&&Array.isArray((a=se(Jt,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Re(s,se(Jt,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Re(o,[...i.get(o)])})}}function uV(){const t=se(va,this).get(se(Ht,this)),e=se(Ht,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const o=se(Ht,this).wtTable.TABLE.querySelectorAll(`.${r}`);let s=[];Array.isArray((n=se(Jt,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(s=se(Jt,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=se(Jt,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...se(Jt,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)Oe(o[a],r),tl(o[a],s)}),t.clear()}class cV extends ol{constructor(e,r,n,i){super(e,r,wo,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Tp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),gp(n,`${o}px`,"0px")):(o=this.getScrollPosition(),cc(n));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){const o=r.scrollX;r.scrollTo(e,R_(r)),n=o!==r.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,n=o!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<r;)o+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(u-=jt(n)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=rr(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=Op(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!me(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(r){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(c=jt(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,CD(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(E_(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),s=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";s?Oe(n,"emptyRows"):K(n,"emptyRows");let l=!1;if(!a){if(o&&!i.length)K(n,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=me(n,"innerBorderInlineStart");e?(K(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(Oe(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const hV="stickyRowsTop",Ip={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Jn(Ip,"MIXIN_NAME",hV,{writable:!1,enumerable:!1});class Hp extends As{constructor(e,r,n,i){super(e,r,n,i,vo)}}Ye(Hp,Ip);Ye(Hp,fc);function US(t,e,r){return(e=dV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dV(t){var e=fV(t,"string");return typeof e=="symbol"?e:e+""}function fV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gV extends ol{constructor(e,r,n,i,o,s){super(e,r,vo,n,i),US(this,"topOverlay",void 0),US(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Hp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();gp(e,`${i}px`,`${o}px`)}else cc(e);let r=ir(this.clone.wtTable.TABLE);const n=rr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class Pp extends As{constructor(e,r,n,i){super(e,r,n,i,po)}}Ye(Pp,Ip);Ye(Pp,gc);function mV(t,e,r){return(e=pV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pV(t){var e=wV(t,"string");return typeof e=="symbol"?e:e+""}function wV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vV extends ol{constructor(e,r,n,i){super(e,r,po,n,i),mV(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Pp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),gp(e,"0px",`${i}px`)}else i=this.getScrollPosition(),cc(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(dp(r),e),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<r;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?n:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=jt(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=ir(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=Op(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,s=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!me(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(r){const d=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();d>g&&(r=!1)}if(r&&s.offsetHeight!==s.clientHeight&&(h=jt(this.domBindings.rootDocument)),r){const d=i.getSetting("fixedRowsBottom"),g=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(g-d,g),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,bD(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return fp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,o=n.getSetting("totalColumns"),s=n.getSetting("preventOverflow")==="horizontal";o?Oe(i,"emptyColumns"):K(i,"emptyColumns");let a=!1;if(!r&&!s){const l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=n.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=me(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(K(i,"innerBorderTop"),a=!h):(Oe(i,"innerBorderTop"),a=h)}}return a}}function El(t,e,r){yV(t,e),e.set(t,r)}function yV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nn(t,e,r){return(e=bV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bV(t){var e=CV(t,"string");return typeof e=="symbol"?e:e+""}function CV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zi(t,e,r){return t.set(n0(t,e),r),r}function Dn(t,e){return t.get(n0(t,e))}function n0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var $o=new WeakMap,Tl=new WeakMap,jo=new WeakMap,_l=new WeakMap;class SV{constructor(e,r,n,i,o,s){Nn(this,"wot",null),El(this,$o,[]),Nn(this,"topOverlay",null),Nn(this,"bottomOverlay",null),Nn(this,"inlineStartOverlay",null),Nn(this,"topInlineStartCornerOverlay",null),Nn(this,"bottomInlineStartCornerOverlay",null),Nn(this,"browserLineHeight",void 0),Nn(this,"wtSettings",null),El(this,Tl,!1),El(this,jo,0),El(this,_l,null),Nn(this,"resizeObserver",new ResizeObserver(c=>{qg(()=>{!Array.isArray(c)||!c.length||(zi(jo,this,Dn(jo,this)+1),Dn(jo,this)===300&&(on("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Dn(_l,this)!==null&&clearTimeout(Dn(_l,this)),zi(_l,this,setTimeout(()=>{zi(jo,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=jt(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Ou(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...Dn($o,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),o=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new vV(...e),this.bottomOverlay=new KF(...e),this.inlineStartOverlay=new cV(...e),this.topInlineStartCornerOverlay=new gV(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new zF(...e,this.bottomOverlay,this.inlineStartOverlay),zi($o,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){zi(Tl,this,Dn($o,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),Dn($o,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Dn($o,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=r.devicePixelRatio&&r.devicePixelRatio>1,s=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!cD())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(r,"resize",()=>{qg(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{zi(jo,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==r&&o!==r&&!e.target.contains(i)||n!==r&&o!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){if(e.ctrlKey)return;const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==n&&s!==n&&!s.contains(o),l=i!==n&&s!==n&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=xD(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),o=this.scrollHorizontally(n);return i||o}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Dn(Tl,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),zi(Tl,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Ou(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight(),u=this.wtSettings.getSetting("externalRowCalculator")?0:1,c=l+this.topOverlay.sumCellSizes(0,s)+u,h=a+this.inlineStartOverlay.sumCellSizes(0,o),g=r.hider.style,w=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,c-r.holder.clientHeight),v=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,h-r.holder.clientWidth),b=w()?1:0,E=v()?1:0;g.width=`${h+E}px`,g.height=`${c+b}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return z(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];z(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function YS(t,e,r){return(e=RV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RV(t){var e=EV(t,"string");return typeof e=="symbol"?e:e+""}function EV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TV{constructor(e){YS(this,"settings",{}),YS(this,"defaults",Object.freeze(this.getDefaults())),Me(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);rl(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,r){return r===void 0?Me(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,o){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,o):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class xp extends As{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Mu(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=LC(e,"height",r),o=LC(e,"overflow",r),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?n.insertBefore(d,e.nextElementSibling):n.appendChild(d);const g=parseInt(r.getComputedStyle(d).height,10);n.removeChild(d),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Fa(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",o=e.getSetting("columnHeaders").length;if(o&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);r.hasOversizedColumnHeadersMarked[n]=!0}}}Ye(xp,Ep);Ye(xp,gc);class _V{constructor(e,r,n,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new nL:new uL],["fullyVisible",()=>new qk],["partiallyVisible",()=>new z_]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new eL:new sL],["fullyVisible",()=>new zk],["partiallyVisible",()=>new j_]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=ir(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const i=this.domBindings.rootDocument.documentElement;return i.scrollWidth>i.clientWidth}const{hider:e}=this.wtTable,r=e.offsetWidth,n=this.hasVerticalScroll()?jt():0;return r>this.getWorkspaceWidth()-n}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return Ar(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=ir(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=r.length;i<o;i++)n?(this.rowHeaderWidth+=rr(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),c=r.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),n.holder.clientHeight===n.holder.offsetHeight?o=0:o=jt(this.domBindings.rootDocument),new wL({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:r.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>n.getRowHeight(h),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=r.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=jt(this.domBindings.rootDocument)),new gL({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const o=n.getResultsFor("fullyVisible"),s=n.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o,s)}if(e&&!r.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible"),s=i.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o,s)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,r){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:i}=e;const{startRow:o,endRow:s}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(o)&&!this.wtTable.isRowAfterRenderedRows(s))return!0;n=o,i=s}const{startRow:a,endRow:l,rowStartOffset:u,rowEndOffset:c}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),n<a||n===a&&n>0?!1:!(i>l||i===l&&i<h)}areAllProposedVisibleColumnsAlreadyRendered(e,r){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:i}=e;const{startColumn:o,endColumn:s}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(o)&&!this.wtTable.isColumnAfterRenderedColumns(s))return!0;n=o,i=s}const{startColumn:a,endColumn:l,columnStartOffset:u,columnEndOffset:c}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),n<a||n===a&&n>0?!1:!(i>l||i===l&&i<h)}resetHasOversizedColumnHeadersMarked(){Me(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class OV extends Sp{constructor(e,r){super(e,new TV(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new xp(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new _V(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new lV(this.wtSettings.getSetting("selections")),this.wtEvent=new K_(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new SV(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];Me(e,(i,o)=>{this.wtSettings.getSetting(o).length&&n.push(i),r.push(i)}),Oe(this.wtTable.wtRootElement.parentNode,r),K(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!Q_.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Ap{constructor(e){e instanceof Sp?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new Ap(r);return()=>n},this._wot=new OV(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,o){return this._wot.wtSettings.getSetting(e,r,n,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function qS(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=r||n&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function MV(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(o(u-1,r.col)):s&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}function GS(t){let{isLeftClick:e,selection:r,cellRangeMapper:n}=t;if(!e||r.settings.selectionMode!=="multiple")return;const i=r.getSelectedRange(),o=i.clone().map(a=>n.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!r.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),r.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),r.refresh())}}const IV=new Map([["touchstart",qS],["touchend",GS],["mousedown",qS],["mouseover",MV],["mouseup",GS]]);function Zf(t,e){IV.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:P_(t)||t.type==="touchstart",isRightClick:Iu(t),...e})}const i0=new WeakMap,Np=Symbol("rootInstance");function HV(t){i0.set(t,!0)}function PV(t){return t===Np}function eo(t){return i0.has(t)}function xV(t,e){o0(t,e),e.add(t)}function si(t,e,r){o0(t,e),e.set(t,r)}function o0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ai(t,e,r){return(e=AV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AV(t){var e=NV(t,"string");return typeof e=="symbol"?e:e+""}function NV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ke(t,e){return t.get(vs(t,e))}function Gt(t,e,r){return t.set(vs(t,e),r),r}function vs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Qf=new WeakMap,Ol=new WeakMap,Ml=new WeakMap,kn=new WeakMap,Gr=new WeakMap,Jf=new WeakMap,eg=new WeakMap,zo=new WeakMap,ya=new WeakSet;class DV{constructor(e){xV(this,ya),ai(this,"hot",void 0),ai(this,"eventManager",void 0),ai(this,"settings",void 0),ai(this,"THEAD",void 0),ai(this,"TBODY",void 0),ai(this,"_wt",void 0),ai(this,"activeWt",void 0),si(this,Qf,0),si(this,Ol,0),ai(this,"postponedAdjustElementsSize",!1),si(this,Ml,!1),si(this,kn,void 0),si(this,Gr,void 0),si(this,Jf,0),si(this,eg,0),si(this,zo,null),this.hot=e,this.eventManager=new Pi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),vs(ya,this,LV).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),K(e,"handsontable"),Gt(Gr,this,r.createElement("TABLE")),K(Ke(Gr,this),"htCore"),this.hot.getSettings().tableClassName&&K(Ke(Gr,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Re(Ke(Gr,this),[bi()]),Re(e,[jN(),h_(-1),uc(this.hot.countCols()),tD()])),this.THEAD=r.createElement("THEAD"),Ke(Gr,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),Ke(Gr,this).appendChild(this.TBODY),this.hot.table=Ke(Gr,this),this.hot.container.insertBefore(Ke(Gr,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:e,rootElement:r,rootDocument:n,selection:i,rootWindow:o}=this.hot,s=n.documentElement;this.eventManager.addEventListener(r,"mousedown",l=>{Gt(Ml,this,!0),this.isTextSelectionAllowed(l.target)||(FC(o),l.preventDefault(),o.focus())}),this.eventManager.addEventListener(r,"mouseup",()=>{Gt(Ml,this,!1)}),this.eventManager.addEventListener(r,"mousemove",l=>{Ke(Ml,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&FC(o),l.preventDefault())}),this.eventManager.addEventListener(s,"keyup",l=>{i.isInProgress()&&!l.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",l=>{var u;i.isInProgress()&&P_(l)&&i.finish(),Gt(kn,this,!1);const c=O_(n.activeElement),h=(u=n.querySelector(".ht-dialog"))===null||u===void 0?void 0:u.contains(n.activeElement);lu(n.activeElement)&&!c||h||(c||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!(e??r).contains(l.target)&&!Iu(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",l=>{i.isInProgress()&&Iu(l)&&(i.finish(),Gt(kn,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),Gt(kn,this,!1)}),this.eventManager.addEventListener(s,"mousedown",l=>{const u=l.target,c=l.x||l.clientX,h=l.y||l.clientY;let d=l.target;if(Ke(kn,this)||!r||!this.hot.view)return;const{holder:g}=this._wt.wtTable;if(d===g){const v=jt(n);if(n.elementFromPoint(c+v,h)!==g||n.elementFromPoint(c,h+v)!==g)return}else for(;d!==s;){if(d===null){if(l.isTargetWebComponent)break;return}if(d===r)return;d=d.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=La(o);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=La(a);this.eventManager.addEventListener(Ke(Gr,this),"selectstart",l=>{this.settings.fragmentSelection||lu(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const o=n.getNearestNotHiddenIndex(e,r),s=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return r<0?a=s+1:r>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&K(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Oe(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Ke(Gr,this),isDataViewInstance:()=>eo(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Gt(Ol,this,o.length),this.hot.getSettings().ariaTags&&vs(ya,this,s0).call(this)===this.hot.countCols()&&vs(ya,this,kV).call(this,Ke(Ol,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Gt(Qf,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const g=this.hot.getCellMeta(h,d),w=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,w);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,g)),this.hot.runHooks("beforeRenderer",a,l,u,w,v,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,w,v,g),this.hot.runHooks("afterRenderer",a,l,u,w,v,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Fa(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Gt(kn,this,!0),Gt(zo,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!ro(o)&&(Zf(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Gt(kn,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!ro(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!ro(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!ro(o)&&(Ke(kn,this)&&(!Ke(zo,this)||Ke(zo,this).x!==o.clientX||Ke(zo,this).y!==o.clientY)&&Zf(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,Gt(zo,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(ro(o)||this.hot.isDestroyed)&&(Zf(o,{coords:u,selection:this.hot.selection,cellRangeMapper:GD(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,g=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(g)){const[w,v,b,E]=g;return[w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,b>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(b,-1)):b,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,g]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Ap(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var r,n;if(lu(e))return!0;const i=ms(e,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&i)return!0;const o=(r=(n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingleCell())!==null&&r!==void 0?r:!1;return!!(this.settings.fragmentSelection==="cell"&&o&&i||!this.settings.fragmentSelection&&this.isCellEdited()&&o)}isMouseDown(){return Ke(kn,this)}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!me(n,"relative")){Cs(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,o=n.createElement("div"),s=n.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),r.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(r.firstChild){const s=r.firstChild;me(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,n,i),s.className="",K(s,["relative",...o()])):(Cs(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Re(a,...bi()),Re(l,...bi())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=r;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(me(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(r):me(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(r))),o>-1?S_(e,n(r,i)):(rl(e," "),K(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){Gt(Jf,this,e),Gt(eg,this,r)}getLastSize(){return{width:Ke(Jf,this),height:Ke(eg,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Ke(Qf,this)}getRowHeadersCount(){return Ke(Ol,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function s0(){return parseInt(this.hot.rootElement.getAttribute(uc()[0]),10)}function kV(t){const e=vs(ya,this,s0).call(this)+t;Re(this.hot.rootElement,...uc(e))}function LV(){const t=this.hot.rootElement;this.hasVerticalScroll()?K(t,"htHasScrollY"):Oe(t,"htHasScrollY"),this.isVerticallyScrollableByWindow()?K(t,"htVerticallyScrollableByWindow"):Oe(t,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?K(t,"htHasScrollX"):Oe(t,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?K(t,"htHorizontallyScrollableByWindow"):Oe(t,"htHorizontallyScrollableByWindow")}var KS={},XS={},ZS;function FV(){if(ZS)return XS;ZS=1;var t=Ae(),e=mt(),r=Is(),n=br(),i=pt(),o=Di(),s=Cr(),a=Mo(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return!r(h,function(g,w){if(!c(g,d++))return w()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),XS}var QS;function VV(){return QS||(QS=1,FV()),KS}VV();const WV="ABCDEFGHIJKLMNOPQRSTUVWXYZ",JS=WV.length;function BV(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%JS,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/JS,10);return r}function a0(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Qe(t[0])&&(e=cp(t[0]))),e}function ta(t,e,r){return(e=$V(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $V(t){var e=jV(t,"string");return typeof e=="symbol"?e:e+""}function jV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zV{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];ta(this,"hot",void 0),ta(this,"data",void 0),ta(this,"dataType","array"),ta(this,"colToProp",()=>{}),ta(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return z(this.data,(n,i)=>{const o=this.getAtCell(i,e);r.push(o)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=r===void 0&&n===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):Rt(r,n,u=>{l[u-r]=this.getAtPhysicalCell(e,u,a)});else if(Qe(a)||Se(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;Rt(0,c,h=>{const d=this.colToProp(h);if(h>=(r||0)&&h<=(n||c)&&!Number.isInteger(d)){const g=this.getAtPhysicalCell(e,d,a);i?l.push(g):s?Rf(l,d,g):l[d]=g}})}else Me(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Rf(l,c,h):l[c]=h});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=pr(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:Rf(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?Yg(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const o=pr(i);this.hot.runHooks("modifySourceData",e,r,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||r===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,r.row),s=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const u=[];return Rt(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,n):this.getAtRow(c,s,l,n))}),u}getCopyable(e,r){const n=this.propToCol(r);return this.hot.getCellMeta(e,n).copyable?this.getAtCell(this.hot.toPhysicalRow(e),n):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return a0(this.data)}destroy(){this.data=null,this.hot=null}}var eR={},tR={},rR;function UV(){if(rR)return tR;rR=1;var t=Ae(),e=mt(),r=Is(),n=br(),i=pt(),o=Di(),s=Cr(),a=Mo(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,w){if(c(g,d++))return w()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),tR}var nR;function YV(){return nR||(nR=1,UV()),eR}YV();function iR(t,e,r){return(e=qV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qV(t){var e=GV(t,"string");return typeof e=="symbol"?e:e+""}function GV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;iR(this,"indexedValues",[]),iR(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Se(this.initValueOrFn)?Rt(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):Rt(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Ye(sl,On);function l0(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((o,s)=>Se(n)?n(o,s):n),...i===void 0?[]:t.slice(i)]}function u0(t,e){return ap(t,(r,n)=>e.includes(n)===!1)}class mc extends sl{insert(e,r){this.indexedValues=l0(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=u0(this.indexedValues,e),super.remove(e)}}class c0 extends mc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Ho(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function h0(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function xu(t,e){return ap(t,r=>e.includes(r)===!1)}function d0(t,e){return Mi(t,r=>r-e.filter(n=>n<r).length)}function f0(t,e){const r=e[0],n=e.length;return Mi(t,i=>i>=r?i+n:i)}function KV(t,e,r){return(e=XV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XV(t){var e=ZV(t,"string");return typeof e=="symbol"?e:e+""}function ZV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QV extends sl{constructor(){super(...arguments),KV(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=xu(this.orderOfIndexes,[e]),Se(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=l0(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=f0(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=u0(this.indexedValues,e),this.orderOfIndexes=xu(this.orderOfIndexes,e),this.orderOfIndexes=d0(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class g0 extends mc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Ho(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}class JV extends sl{constructor(){super(e=>e)}insert(e,r){const n=f0(this.indexedValues,r);this.indexedValues=h0(n,e,r),super.insert(e,r)}remove(e){const r=xu(this.indexedValues,e);this.indexedValues=d0(r,e),super.remove(e)}}const oR=new Map([["hiding",c0],["index",sl],["linkedPhysicalIndexToValue",QV],["physicalIndexToValue",mc],["trimming",g0]]);function eW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!oR.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(oR.get(t))(e)}function tW(t,e,r){return(e=rW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rW(t){var e=nW(t,"string");return typeof e=="symbol"?e:e+""}function nW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dp{constructor(){tW(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);ue(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return $t(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}Ye(Dp,On);function tg(t,e,r){return(e=iW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iW(t){var e=oW(t,"string");return typeof e=="symbol"?e:e+""}function oW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sR extends Dp{constructor(e,r){super(),tg(this,"mergedValuesCache",[]),tg(this,"aggregationFunction",void 0),tg(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=Mi(this.get(),o=>o.getValues()),n=[],i=ue(r[0])&&r[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(r[a][o]);n.push(s)}return Mi(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return ue(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function sW(t,e,r){aW(t,e),e.set(t,r)}function aW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lW(t,e,r){return t.set(m0(t,e),r),r}function uW(t,e){return t.get(m0(t,e))}function m0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var rg=new WeakMap;class p0{constructor(){sW(this,rg,[])}subscribe(e){return this.addLocalHook("change",e),this._write(uW(rg,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){lW(rg,this,e)}}Ye(p0,On);function aR(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function ra(t,e,r){cW(t,e),e.set(t,r)}function cW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ir(t,e){return t.get(w0(t,e))}function Il(t,e,r){return t.set(w0(t,e),r),r}function w0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Hl=new WeakMap,na=new WeakMap,Pl=new WeakMap,xl=new WeakMap,Al=new WeakMap;class hW{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ra(this,Hl,new Set),ra(this,na,[]),ra(this,Pl,[]),ra(this,xl,!1),ra(this,Al,!1),Il(Al,this,e??!1)}createObserver(){const e=new p0;return Ir(Hl,this).add(e),e.addLocalHook("unsubscribe",()=>{Ir(Hl,this).delete(e)}),e._writeInitialChanges(aR(Ir(na,this),Ir(Pl,this))),e}emit(e){let r=Ir(Pl,this);(!Ir(xl,this)||Ir(na,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(Ir(Al,this)):Il(na,this,new Array(e.length).fill(Ir(Al,this))),Ir(xl,this)||(Il(xl,this,!0),r=Ir(na,this)));const n=aR(r,e);Ir(Hl,this).forEach(i=>i._write(n)),Il(Pl,this,e)}}function Lt(t,e,r){return(e=dW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dW(t){var e=fW(t,"string");return typeof e=="symbol"?e:e+""}function fW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class em{constructor(){Lt(this,"indexesSequence",new JV),Lt(this,"trimmingMapsCollection",new sR(e=>e.some(r=>r===!0),!1)),Lt(this,"hidingMapsCollection",new sR(e=>e.some(r=>r===!0),!1)),Lt(this,"variousMapsCollection",new Dp),Lt(this,"hidingChangesObservable",new hW({initialIndexValue:!1})),Lt(this,"notTrimmedIndexesCache",[]),Lt(this,"notHiddenIndexesCache",[]),Lt(this,"isBatched",!1),Lt(this,"indexesSequenceChanged",!1),Lt(this,"indexesChangeSource",void 0),Lt(this,"trimmedIndexesChanged",!1),Lt(this,"hiddenIndexesChanged",!1),Lt(this,"renderablePhysicalIndexesCache",[]),Lt(this,"fromPhysicalToVisualIndexesCache",new Map),Lt(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,eW(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof g0?this.trimmingMapsCollection.register(e,r):r instanceof c0?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return ue(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return ue(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return ue(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return ue(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return r>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=Mi(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=xu(this.getIndexesSequence(),n),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(r+o<i){const u=a[r];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(h0(s,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=ue(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=Mi(new Array(r).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=n==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}Ye(em,On);function gW(t,e){return Me(e,(r,n)=>{$t(t[n])&&(t[n]=r)}),t}function v0(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function y0(t){ue(t)&&ND(wr`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function mW(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}function b0(t,e){return Array.isArray(t)?t.map(r=>b0(r,e)):a_(t,e)}const{register:pW,getValues:wW}=xo("phraseFormatters");function C0(t,e){pW(t,e)}function vW(){return wW()}C0("pluralize",mW);C0("substitute",b0);const S0="ContextMenu:items",te=S0,kp=`${te}.noItems`,Lp=`${te}.insertRowAbove`,Fp=`${te}.insertRowBelow`,Vp=`${te}.insertColumnOnTheLeft`,Wp=`${te}.insertColumnOnTheRight`,Bp=`${te}.removeRow`,$p=`${te}.removeColumn`,jp=`${te}.undo`,zp=`${te}.redo`,Au=`${te}.readOnly`,Up=`${te}.clearColumn`,Yp=`${te}.copy`,qp=`${te}.copyWithHeaders`,Gp=`${te}.copyWithGroupHeaders`,Kp=`${te}.copyHeadersOnly`,Xp=`${te}.cut`,R0=`${te}.freezeColumn`,E0=`${te}.unfreezeColumn`,T0=`${te}.mergeCells`,_0=`${te}.unmergeCells`,O0=`${te}.addComment`,M0=`${te}.editComment`,I0=`${te}.removeComment`,H0=`${te}.readOnlyComment`,Zp=`${te}.align`,Qp=`${te}.align.left`,Jp=`${te}.align.center`,ew=`${te}.align.right`,tw=`${te}.align.justify`,rw=`${te}.align.top`,nw=`${te}.align.middle`,iw=`${te}.align.bottom`,P0=`${te}.borders`,x0=`${te}.borders.top`,A0=`${te}.borders.right`,N0=`${te}.borders.bottom`,D0=`${te}.borders.left`,k0=`${te}.borders.remove`,L0=`${te}.nestedHeaders.insertChildRow`,F0=`${te}.nestedHeaders.detachFromParent`,V0=`${te}.hideColumn`,W0=`${te}.showColumn`,B0=`${te}.hideRow`,$0=`${te}.showRow`,or="Filters:",qe=`${or}conditions`,j0=`${qe}.none`,z0=`${qe}.isEmpty`,U0=`${qe}.isNotEmpty`,Y0=`${qe}.isEqualTo`,q0=`${qe}.isNotEqualTo`,G0=`${qe}.beginsWith`,K0=`${qe}.endsWith`,X0=`${qe}.contains`,Z0=`${qe}.doesNotContain`,yW=`${qe}.byValue`,Q0=`${qe}.greaterThan`,J0=`${qe}.greaterThanOrEqualTo`,eO=`${qe}.lessThan`,tO=`${qe}.lessThanOrEqualTo`,rO=`${qe}.isBetween`,nO=`${qe}.isNotBetween`,iO=`${qe}.after`,oO=`${qe}.before`,sO=`${qe}.today`,aO=`${qe}.tomorrow`,lO=`${qe}.yesterday`,uO=`${or}labels.filterByCondition`,cO=`${or}labels.filterByValue`,hO=`${or}labels.conjunction`,dO=`${or}labels.disjunction`,fO=`${or}values.blankCells`,gO=`${or}buttons.selectAll`,mO=`${or}buttons.clear`,pO=`${or}buttons.ok`,wO=`${or}buttons.cancel`,vO=`${or}buttons.placeholder.search`,yO=`${or}buttons.placeholder.value`,bO=`${or}buttons.placeholder.secondValue`,Mn="Pagination:",CO=`${Mn}section.pagination`,SO=`${Mn}.pageSize.auto`,RO=`${Mn}section.pageSize`,EO=`${Mn}section.counter`,TO=`${Mn}section.navigation`,_O=`${Mn}firstPage`,OO=`${Mn}prevPage`,MO=`${Mn}nextPage`,IO=`${Mn}lastPage`,ow="CheckboxRenderer:",HO=`${ow}checked`,PO=`${ow}unchecked`,xO="Loading:",AO=`${xO}title`,bW=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:HO,CHECKBOX_RENDERER_NAMESPACE:ow,CHECKBOX_UNCHECKED:PO,CONTEXTMENU_ITEMS_ADD_COMMENT:O0,CONTEXTMENU_ITEMS_ALIGNMENT:Zp,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:iw,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Jp,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:tw,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:Qp,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:nw,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:ew,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:rw,CONTEXTMENU_ITEMS_BORDERS:P0,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:N0,CONTEXTMENU_ITEMS_BORDERS_LEFT:D0,CONTEXTMENU_ITEMS_BORDERS_RIGHT:A0,CONTEXTMENU_ITEMS_BORDERS_TOP:x0,CONTEXTMENU_ITEMS_CLEAR_COLUMN:Up,CONTEXTMENU_ITEMS_COPY:Yp,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Kp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:Gp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:qp,CONTEXTMENU_ITEMS_CUT:Xp,CONTEXTMENU_ITEMS_EDIT_COMMENT:M0,CONTEXTMENU_ITEMS_FREEZE_COLUMN:R0,CONTEXTMENU_ITEMS_HIDE_COLUMN:V0,CONTEXTMENU_ITEMS_HIDE_ROW:B0,CONTEXTMENU_ITEMS_INSERT_LEFT:Vp,CONTEXTMENU_ITEMS_INSERT_RIGHT:Wp,CONTEXTMENU_ITEMS_MERGE_CELLS:T0,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:F0,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:L0,CONTEXTMENU_ITEMS_NO_ITEMS:kp,CONTEXTMENU_ITEMS_READ_ONLY:Au,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:H0,CONTEXTMENU_ITEMS_REDO:zp,CONTEXTMENU_ITEMS_REMOVE_BORDERS:k0,CONTEXTMENU_ITEMS_REMOVE_COLUMN:$p,CONTEXTMENU_ITEMS_REMOVE_COMMENT:I0,CONTEXTMENU_ITEMS_REMOVE_ROW:Bp,CONTEXTMENU_ITEMS_ROW_ABOVE:Lp,CONTEXTMENU_ITEMS_ROW_BELOW:Fp,CONTEXTMENU_ITEMS_SHOW_COLUMN:W0,CONTEXTMENU_ITEMS_SHOW_ROW:$0,CONTEXTMENU_ITEMS_UNDO:jp,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:E0,CONTEXTMENU_ITEMS_UNMERGE_CELLS:_0,CONTEXT_MENU_ITEMS_NAMESPACE:S0,FILTERS_BUTTONS_CANCEL:wO,FILTERS_BUTTONS_CLEAR:mO,FILTERS_BUTTONS_OK:pO,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:vO,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:bO,FILTERS_BUTTONS_PLACEHOLDER_VALUE:yO,FILTERS_BUTTONS_SELECT_ALL:gO,FILTERS_CONDITIONS_AFTER:iO,FILTERS_CONDITIONS_BEFORE:oO,FILTERS_CONDITIONS_BEGINS_WITH:G0,FILTERS_CONDITIONS_BETWEEN:rO,FILTERS_CONDITIONS_BY_VALUE:yW,FILTERS_CONDITIONS_CONTAINS:X0,FILTERS_CONDITIONS_EMPTY:z0,FILTERS_CONDITIONS_ENDS_WITH:K0,FILTERS_CONDITIONS_EQUAL:Y0,FILTERS_CONDITIONS_GREATER_THAN:Q0,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:J0,FILTERS_CONDITIONS_LESS_THAN:eO,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:tO,FILTERS_CONDITIONS_NAMESPACE:qe,FILTERS_CONDITIONS_NONE:j0,FILTERS_CONDITIONS_NOT_BETWEEN:nO,FILTERS_CONDITIONS_NOT_CONTAIN:Z0,FILTERS_CONDITIONS_NOT_EMPTY:U0,FILTERS_CONDITIONS_NOT_EQUAL:q0,FILTERS_CONDITIONS_TODAY:sO,FILTERS_CONDITIONS_TOMORROW:aO,FILTERS_CONDITIONS_YESTERDAY:lO,FILTERS_DIVS_FILTER_BY_CONDITION:uO,FILTERS_DIVS_FILTER_BY_VALUE:cO,FILTERS_LABELS_CONJUNCTION:hO,FILTERS_LABELS_DISJUNCTION:dO,FILTERS_NAMESPACE:or,FILTERS_VALUES_BLANK_CELLS:fO,LOADING_NAMESPACE:xO,LOADING_TITLE:AO,PAGINATION_COUNTER_SECTION:EO,PAGINATION_FIRST_PAGE:_O,PAGINATION_LAST_PAGE:IO,PAGINATION_NAMESPACE:Mn,PAGINATION_NAV_SECTION:TO,PAGINATION_NEXT_PAGE:MO,PAGINATION_PAGE_SIZE_AUTO:SO,PAGINATION_PAGE_SIZE_SECTION:RO,PAGINATION_PREV_PAGE:OO,PAGINATION_SECTION:CO},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const NO={languageCode:"en-US",[kp]:"No available options",[Lp]:"Insert row above",[Fp]:"Insert row below",[Vp]:"Insert column left",[Wp]:"Insert column right",[Bp]:["Remove row","Remove rows"],[$p]:["Remove column","Remove columns"],[jp]:"Undo",[zp]:"Redo",[Au]:"Read only",[Up]:"Clear column",[Zp]:"Alignment",[Qp]:"Left",[Jp]:"Center",[ew]:"Right",[tw]:"Justify",[rw]:"Top",[nw]:"Middle",[iw]:"Bottom",[R0]:"Freeze column",[E0]:"Unfreeze column",[P0]:"Borders",[x0]:"Top",[A0]:"Right",[N0]:"Bottom",[D0]:"Left",[k0]:"Remove border(s)",[O0]:"Add comment",[M0]:"Edit comment",[I0]:"Delete comment",[H0]:"Read-only comment",[T0]:"Merge cells",[_0]:"Unmerge cells",[Yp]:"Copy",[qp]:["Copy with header","Copy with headers"],[Gp]:["Copy with group header","Copy with group headers"],[Kp]:["Copy header only","Copy headers only"],[Xp]:"Cut",[L0]:"Insert child row",[F0]:"Detach from parent",[V0]:["Hide column","Hide columns"],[W0]:["Show column","Show columns"],[B0]:["Hide row","Hide rows"],[$0]:["Show row","Show rows"],[j0]:"None",[z0]:"Is empty",[U0]:"Is not empty",[Y0]:"Is equal to",[q0]:"Is not equal to",[G0]:"Begins with",[K0]:"Ends with",[X0]:"Contains",[Z0]:"Does not contain",[Q0]:"Greater than",[J0]:"Greater than or equal to",[eO]:"Less than",[tO]:"Less than or equal to",[rO]:"Is between",[nO]:"Is not between",[iO]:"After",[oO]:"Before",[sO]:"Today",[aO]:"Tomorrow",[lO]:"Yesterday",[fO]:"Blank cells",[uO]:"Filter by condition",[cO]:"Filter by value",[hO]:"And",[dO]:"Or",[gO]:"Select all",[mO]:"Clear",[pO]:"OK",[wO]:"Cancel",[vO]:"Search",[yO]:"Value",[bO]:"Second value",[CO]:"Pagination",[RO]:"Page size",[SO]:"Auto",[EO]:"[start] - [end] of [total]",[TO]:"Page [currentPage] of [totalPages]",[_O]:"Go to first page",[OO]:"Go to previous page",[MO]:"Go to next page",[IO]:"Go to last page",[HO]:"Checked",[PO]:"Unchecked",[AO]:"Loading..."},CW=bW,tm=NO.languageCode,{register:SW,getItem:DO,hasItem:RW,getValues:EW}=xo("languagesDictionaries");kO(NO);function kO(t,e){let r=t,n=e;return Qe(t)&&(n=t,r=n.languageCode),TW(r,n),SW(r,Hi(n)),Hi(n)}function TW(t,e){t!==tm&&gW(e,DO(tm))}function LO(t){return sw(t)?Hi(DO(t)):null}function sw(t){return RW(t)}function _W(){return EW()}function FO(t,e,r){const n=LO(t);if(n===null)return null;const i=n[e];if($t(i))return null;const o=OW(i,r);return Array.isArray(o)?o[0]:o}function OW(t,e){return vW().reduce((r,n)=>n(r,e),t)}function MW(t){let e=v0(t);return sw(e)||(e=tm,y0(t)),e}function IW(t,e,r){return(e=HW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HW(t){var e=PW(t,"string");return typeof e=="symbol"?e:e+""}function PW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ei extends J_{constructor(e,r){super(e,null),IW(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),o=this.getNearestNotHiddenCoords(n,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=r,o=n),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(r,n,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function ng(t){let{activeHeaderClassName:e,...r}=t;return new ei({className:e,...r,selectionType:QF})}function xW(t){let{areaCornerVisible:e,...r}=t;return new ei({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:_p})}function AW(t){let{...e}=t;return new ei({className:"highlight",...e,selectionType:_p})}function NW(t){let{columnClassName:e,...r}=t;return new ei({className:e,...r,selectionType:tV})}function DW(t){let{cellCornerVisible:e,...r}=t;return new ei({className:"current",headerAttributes:[f_()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:Pu})}function kW(t){let{border:e,visualCellRange:r,...n}=t;return new ei({...e,...n,selectionType:rV},r)}function LW(t){let{...e}=t;return new ei({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:JF})}function lR(t){let{headerClassName:e,...r}=t;return new ei({className:e,...r,selectionType:e0})}function FW(t){let{rowClassName:e,...r}=t;return new ei({className:e,...r,selectionType:eV})}function VW(t,e){WW(t,e),e.add(t)}function WW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kt(t,e,r){return(e=BW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BW(t){var e=$W(t,"string");return typeof e=="symbol"?e:e+""}function $W(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ln(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var mn=new WeakSet;class jW{constructor(e){VW(this,mn),Kt(this,"options",void 0),Kt(this,"layerLevel",0),Kt(this,"focus",void 0),Kt(this,"fill",void 0),Kt(this,"layeredAreas",new Map),Kt(this,"areas",new Map),Kt(this,"rowHeaders",new Map),Kt(this,"columnHeaders",new Map),Kt(this,"activeRowHeaders",new Map),Kt(this,"activeColumnHeaders",new Map),Kt(this,"activeCornerHeaders",new Map),Kt(this,"rowHighlights",new Map),Kt(this,"columnHighlights",new Map),Kt(this,"customSelections",[]),this.options=e,this.focus=DW(e),this.fill=LW(e)}isEnabledFor(e,r){let n=e;e===Pu&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Ln(mn,this,Fn).call(this,this.layeredAreas,xW)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Ln(mn,this,Fn).call(this,this.areas,AW)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Ln(mn,this,Fn).call(this,this.rowHeaders,lR)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Ln(mn,this,Fn).call(this,this.columnHeaders,lR)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Ln(mn,this,Fn).call(this,this.activeRowHeaders,ng)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Ln(mn,this,Fn).call(this,this.activeColumnHeaders,ng)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Ln(mn,this,Fn).call(this,this.activeCornerHeaders,ng)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Ln(mn,this,Fn).call(this,this.rowHighlights,FW)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Ln(mn,this,Fn).call(this,this.columnHighlights,NW)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(kW({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),z(this.areas.values(),e=>void e.clear()),z(this.layeredAreas.values(),e=>void e.clear()),z(this.rowHeaders.values(),e=>void e.clear()),z(this.columnHeaders.values(),e=>void e.clear()),z(this.activeRowHeaders.values(),e=>void e.clear()),z(this.activeColumnHeaders.values(),e=>void e.clear()),z(this.activeCornerHeaders.values(),e=>void e.clear()),z(this.rowHighlights.values(),e=>void e.clear()),z(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Fn(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function uR(t,e,r){return(e=zW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zW(t){var e=UW(t,"string");return typeof e=="symbol"?e:e+""}function UW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aw{constructor(e){uR(this,"ranges",[]),uR(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((n,i)=>n.includes(e)&&r(n,i))}findAll(e){const r=[];return this.ranges.forEach((n,i)=>{n.isEqual(e)&&r.push({range:n,layer:i})}),r}remove(e){return this.ranges=this.ranges.filter(r=>!e.some(n=>n.isEqual(r))),this}removeLayers(e){return this.ranges=this.ranges.filter((r,n)=>!e.includes(n)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new aw(this.createCellRange);return e.ranges=this.ranges.map(r=>r.clone()),e}map(e){return this.ranges=this.ranges.map((r,n)=>e(r,n)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function YW(t,e){VO(t,e),e.add(t)}function qW(t,e,r){return(e=GW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GW(t){var e=KW(t,"string");return typeof e=="symbol"?e:e+""}function KW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ig(t,e,r){VO(t,e),e.set(t,r)}function VO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function at(t,e){return t.get(Ce(t,e))}function ss(t,e,r){return t.set(Ce(t,e),r),r}function Ce(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Bn=new WeakMap,io=new WeakMap,vr=new WeakMap,_e=new WeakSet;class lw{constructor(e,r){YW(this,_e),ig(this,Bn,void 0),ig(this,io,0),ig(this,vr,{x:0,y:0}),qW(this,"tableApi",void 0),ss(Bn,this,e),this.tableApi=r}setActiveLayerIndex(e){ss(io,this,e)}getCurrentSelection(){return at(Bn,this).peekByIndex(at(io,this))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;ss(vr,this,this.calculateOffset());const i=this.tableApi.createCellCoords(e,r);let o=this.getCurrentSelection().highlight;const s=this.tableApi.visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){let{width:u,height:c}=Ce(_e,this,rm).call(this);const{row:h,col:d}=Ce(_e,this,fR).call(this,o),g=this.tableApi.fixedRowsBottom(),w=this.tableApi.minSpareRows(),v=this.tableApi.minSpareCols(),b=this.tableApi.autoWrapRow(),E=this.tableApi.autoWrapCol(),R=this.tableApi.createCellCoords(h+i.row,d+i.col);if(R.row>=c){const M=pr(n&&w>0&&g===0),x=R.col+1,P=x>=u,D=this.tableApi.createCellCoords(R.row-c,P?x-u:x);if(this.runLocalHooks("beforeColumnWrap",M,Ce(_e,this,Uo).call(this,D),P),M.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(E){if(this.shouldSwitchSelectionLayer()&&P&&at(Bn,this).size()>1){Ce(_e,this,cR).call(this);const F=Ce(_e,this,Nl).call(this,"forward");F!==null&&D.assign(F)}R.assign(D)}}else if(R.row<0){const M=pr(E),x=R.col-1,P=x<0,D=this.tableApi.createCellCoords(c+R.row,P?u+x:x);if(this.runLocalHooks("beforeColumnWrap",M,Ce(_e,this,Uo).call(this,D),P),E){if(this.shouldSwitchSelectionLayer()&&P&&at(Bn,this).size()>1){Ce(_e,this,hR).call(this);const F=Ce(_e,this,Nl).call(this,"backward");F!==null&&D.assign(F)}R.assign(D)}}if({width:u,height:c}=Ce(_e,this,rm).call(this),R.col>=u){const M=pr(n&&v>0),x=R.row+1,P=x>=c,D=this.tableApi.createCellCoords(P?x-c:x,R.col-u);if(this.runLocalHooks("beforeRowWrap",M,Ce(_e,this,Uo).call(this,D),P),M.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(b){if(this.shouldSwitchSelectionLayer()&&P&&at(Bn,this).size()>1){Ce(_e,this,cR).call(this);const F=Ce(_e,this,Nl).call(this,"forward");F!==null&&D.assign(F)}R.assign(D)}}else if(R.col<0){const M=pr(b),x=R.row-1,P=x<0,D=this.tableApi.createCellCoords(P?c+x:x,u+R.col);if(this.runLocalHooks("beforeRowWrap",M,Ce(_e,this,Uo).call(this,D),P),b){if(this.shouldSwitchSelectionLayer()&&P&&at(Bn,this).size()>1){Ce(_e,this,hR).call(this);const F=Ce(_e,this,Nl).call(this,"backward");F!==null&&D.assign(F)}R.assign(D)}}const{rowDir:T,colDir:y}=Ce(_e,this,dR).call(this,R);a=T,l=y,o=Ce(_e,this,Uo).call(this,R)}return this.runLocalHooks("afterTransformStart",o,a,l),{selectionLayer:at(io,this),visualCoords:o}}transformEnd(e,r){ss(vr,this,this.calculateOffset());const n=this.tableApi.createCellCoords(e,r),i=this.getCurrentSelection(),o=this.tableApi.visualToRenderableCoords(i.highlight),s=Ce(_e,this,uu).call(this,i.to.row,i.from.row),a=Ce(_e,this,cu).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=Ce(_e,this,fR).call(this,i.highlight),g=this.tableApi.createCellCoords(s+n.row,a+n.col),w=i.getTopStartCorner(),v=i.getTopEndCorner(),b=i.getBottomEndCorner();if(n.col<0&&a>=d&&g.col<d){const y=g.col-d;g.col=Ce(_e,this,cu).call(this,w.col,v.col)+y}else if(n.col>0&&a<=d&&g.col>d){const y=Ce(_e,this,cu).call(this,v.col,w.col),M=Math.max(g.col-y,1);g.col=y+M}if(n.row<0&&s>=h&&g.row<h){const y=g.row-h;g.row=Ce(_e,this,uu).call(this,w.row,b.row)+y}else if(n.row>0&&s<=h&&g.row>h){const y=Ce(_e,this,uu).call(this,b.row,w.row),M=Math.max(g.row-y,1);g.row=y+M}const{rowDir:E,colDir:R}=Ce(_e,this,dR).call(this,g);u=E,c=R;const T=Ce(_e,this,Uo).call(this,g);n.row===0&&n.col!==0?l.col=T.col:n.row!==0&&n.col===0?l.row=T.row:(l.row=T.row,l.col=T.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),{selectionLayer:at(io,this),visualCoords:l}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function cR(){const t=at(io,this)+1;this.setActiveLayerIndex(t>=at(Bn,this).size()?0:t),ss(vr,this,this.calculateOffset())}function hR(){const t=at(io,this)-1;this.setActiveLayerIndex(t<0?at(Bn,this).size()-1:t),ss(vr,this,this.calculateOffset())}function dR(t){const{width:e,height:r}=Ce(_e,this,rm).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function rm(){return{width:at(vr,this).x+this.countRenderableColumns(),height:at(vr,this).y+this.countRenderableRows()}}function Nl(t){if(!["forward","backward"].includes(t))return null;const e=this.getCurrentSelection().getTopStartCorner(),r=this.getCurrentSelection().getBottomEndCorner(),[n,i,o,s]=t==="forward"?[e.row,r.row,e.col,r.col]:[r.row,e.row,r.col,e.col],a=Ce(_e,this,uu).call(this,n,i),l=Ce(_e,this,cu).call(this,o,s);return a===null||l===null?null:this.tableApi.createCellCoords(a,l)}function uu(t,e){const r=this.tableApi.findFirstNonHiddenRenderableRow(t,e);return r===null?null:at(vr,this).y+r}function cu(t,e){const r=this.tableApi.findFirstNonHiddenRenderableColumn(t,e);return r===null?null:at(vr,this).x+r}function fR(t){const{row:e,col:r}=this.tableApi.visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(at(vr,this).y+e,at(vr,this).x+r)}function Uo(t){const e=t.clone();return e.col=t.col-at(vr,this).x,e.row=t.row-at(vr,this).y,this.tableApi.renderableToVisualCoords(e)}Ye(lw,On);class XW extends lw{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class ZW extends lw{calculateOffset(){const e=this.getCurrentSelection(),{row:r,col:n}=e.getOuterTopStartCorner(),i=this.tableApi.countRenderableColumnsInRange(0,n-1),o=this.tableApi.countRenderableRowsInRange(0,r-1),s=e.highlight.isHeader(),a=s?Math.abs(n):0,l=s?Math.abs(r):0;return{x:n<0?a:-i,y:r<0?l:-o}}countRenderableRows(){const e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){const e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}const pc=0,wc=1,WO=2,uw=3,QW=[uw,WO],JW=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],og=Symbol("root"),gR=Symbol("child");function vc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:og;if(e!==og&&e!==gR)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===og;let i=pc;if(r){const o=t[0];t.length===0?i=wc:n&&o instanceof nl?i=uw:n&&Array.isArray(o)?i=vc(o,gR):t.length>=2&&t.length<=4&&!t.some((a,l)=>!JW[l].includes(typeof a))&&(i=WO)}return i}function cw(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!QW.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===uw;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),$t(u)&&(u=a),$t(c)&&(c=l),!n){const w=a,v=l,b=u,E=c;a=Math.min(w,b),l=Math.min(v,E),u=Math.max(w,b),c=Math.max(v,E)}const h=s?o.highlight.clone():e(a,l),d=e(a,l),g=e(u,c);return r(h,d,g)}}function eB(t){const e=vc(t.getSelected());if(e===pc||e===wc)return[];const r=cw(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;z(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.col,0),c=l.col-u+1;z(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return Ho(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function tB(t){const e=vc(t.getSelected());if(e===pc||e===wc)return[];const r=cw(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;z(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.row,0),c=l.row-u+1;z(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return Ho(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Ui(t,e,r){rB(t,e),e.set(t,r)}function rB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yi(t,e,r){return(e=nB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nB(t){var e=iB(t,"string");return typeof e=="symbol"?e:e+""}function iB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ve(t,e){return t.get(BO(t,e))}function ur(t,e,r){return t.set(BO(t,e),r),r}function BO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var cr=new WeakMap,Yo=new WeakMap,Dl=new WeakMap,li=new WeakMap,kl=new WeakMap,ia=new WeakMap,Ll=new WeakMap;class $O{constructor(e,r){var n=this;Yi(this,"settings",void 0),Yi(this,"tableProps",void 0),Yi(this,"inProgress",!1),Yi(this,"selectedRange",new aw((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Yi(this,"highlight",void 0),Ui(this,cr,void 0),Ui(this,Yo,void 0),Yi(this,"selectedByRowHeader",new Set),Yi(this,"selectedByColumnHeader",new Set),Ui(this,Dl,!1),Ui(this,li,!1),Ui(this,kl,"unknown"),Ui(this,ia,-1),Ui(this,Ll,0),this.settings=e,this.tableProps=r,this.highlight=new jW({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[f_()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),ur(cr,this,new XW(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),ur(Yo,this,new ZW(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Ve(cr,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformStart",...o)}),Ve(cr,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformStart",...o)}),Ve(cr,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformEnd",...o)}),Ve(cr,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformEnd",...o)}),Ve(cr,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertRowRequire",...o)}),Ve(cr,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertColRequire",...o)}),Ve(cr,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeRowWrap",...o)}),Ve(cr,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeColumnWrap",...o)}),Ve(Yo,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformFocus",...o)}),Ve(Yo,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(Ve(Ll,this))}getActiveSelectionLayerIndex(){return Ve(Ll,this)}setActiveSelectionLayerIndex(e){ur(Ll,this,e)}markSource(e){ur(kl,this,e)}markEndSource(){ur(kl,this,"unknown")}getSelectionSource(){return Ve(kl,this)}setExpectedLayers(e){ur(ia,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,ur(ia,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=$t(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();ur(li,this,!1),ur(Dl,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!o||o&&!s&&$t(r))&&(this.selectedRange.clear(),z(this.highlight.getAreas(),l=>void l.clear()),z(this.highlight.getLayeredAreas(),l=>void l.clear()),z(this.highlight.getRowHeaders(),l=>void l.clear()),z(this.highlight.getColumnHeaders(),l=>void l.clear()),z(this.highlight.getActiveRowHeaders(),l=>void l.clear()),z(this.highlight.getActiveColumnHeaders(),l=>void l.clear()),z(this.highlight.getActiveCornerHeaders(),l=>void l.clear()),z(this.highlight.getRowHighlights(),l=>void l.clear()),z(this.highlight.getColumnHighlights(),l=>void l.clear())),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r);const n=e.clone(),i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((i>0||o>0)&&(i===0&&n.col<0&&!s||o===0&&n.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const a=this.getActiveSelectedRange();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),c=a.getVerticalDirection(),h=this.isMultiple();a.setTo(n),h&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),h&&(c!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}i>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,r),this.applyAndCommit(this.getActiveSelectedRange(),r);const l=Ve(ia,this)===-1||this.selectedRange.size()===Ve(ia,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),g.clear(),this.highlight.isEnabledFor(_p,e.highlight)&&(this.isMultiple()||r>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),r===1)){const w=this.selectedRange.peekByIndex(r-1);this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(w.from).commit().syncWith(w),this.highlight.createLayeredArea().add(w.from).commit().syncWith(w),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(e0,e.highlight)){if(!e.isSingleHeader()){const b=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),R=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),T=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(b).commit(),l.add(R).commit(),d.add(b).commit(),g.add(R).commit()):(a.add(b).add(E).commit(),l.add(R).add(T).commit(),d.add(b).add(E).commit(),g.add(R).add(T).commit())}const w=!Ve(li,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),v=!Ve(li,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());w&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),w&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r),Ve(cr,this).setActiveLayerIndex(r),Ve(Yo,this).setActiveLayerIndex(r);const n=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Pu,n.highlight)&&i.add(n.highlight).commit().syncWith(n),this.inProgress||(ur(Dl,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{visualCoords:i}=Ve(cr,this).transformStart(e,r,n);this.setRangeStart(i)}transformEnd(e,r){const{visualCoords:n,selectionLayer:i}=Ve(cr,this).transformEnd(e,r);this.setRangeEnd(n,i)}transformFocus(e,r){const{selectionLayer:n,visualCoords:i}=Ve(Yo,this).transformStart(e,r);this.setRangeFocus(i.normalize(),n)}shiftRows(e,r){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(He(i.row+h,c,a-1),i.col),g=this.tableProps.createCellCoords(He(o.row+r,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(He(s.row+r,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,He(i.col+h,c,a-1)),g=this.tableProps.createCellCoords(o.row,He(o.col+r,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,He(s.col+r,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const r=pr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}isFocusSelectionChanged(){return this.isSelected()&&Ve(Dl,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,c=r?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getActiveSelectedRange())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:g}=i;d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(h=this.tableProps.createCellCoords(He(d.row,u,o-1),He(d.col,c,s-1)));const w=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.runLocalHooks("beforeSelectAll",w,v,h),this.setRangeStartOnly(w,void 0,h),ur(li,this,g),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.runLocalHooks("afterSelectAll",w,v,h),this.finish()}selectCells(e){var r=this;const n=vc(e);if(n===wc)return!1;if(n===pc)throw new Error(wr`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=cw(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),z(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof r=="string"?this.tableProps.propToCol(r):r,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let g=0,w=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(g=He(n.row,u,s-1),w=He(n.col,Math.min(i,o),Math.max(i,o))):(g=He(n,u,s-1),w=i);const v=this.tableProps.createCellCoords(g,w),b=l===0?0:He(v.row,u,-1),E=s-1,R=this.tableProps.createCellCoords(b,i),T=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",R,T,v),this.setRangeStartOnly(R,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectColumns",R,T,v),this.finish()}return d}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(h=He(n.row,Math.min(e,r),Math.max(e,r)),d=He(n.col,a,o-1)):(h=e,d=He(n,a,o-1));const g=this.tableProps.createCellCoords(h,d),w=s===0?0:He(g.col,a,-1),v=o-1,b=this.tableProps.createCellCoords(e,w),E=this.tableProps.createCellCoords(r,v);this.runLocalHooks("beforeSelectRows",b,E,g),this.setRangeStartOnly(b,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",b,E,g),this.finish()}return c}importSelection(e){let{ranges:r,activeRange:n,activeSelectionLayer:i,selectedByRowHeader:o,selectedByColumnHeader:s,disableHeadersHighlight:a}=e;r.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!0,ur(li,this,a),this.selectedByRowHeader=new Set(o),this.selectedByColumnHeader=new Set(s),this.setActiveSelectionLayerIndex(0),r.forEach((l,u)=>{this.selectedRange.push(l),this.applyAndCommit(l,u)}),this.setRangeFocus(n.highlight,i),ur(li,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:Ve(li,this)}}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(n.length),n.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=r-1;u.assign({row:He(u.row,this.settings.navigableHeaders?-1/0:0,c),col:He(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:He(a.row,-1/0,c),col:He(a.col,-1/0,h)}),l.assign({row:He(l.row,-1/0,c),col:He(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.getActiveSelectedRange();this.highlight.isEnabledFor(Pu,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),g.commit()}this.highlight.useLayerLevel(r)}}Ye($O,On);const mR=/^(\r\n|\n\r|\r|\n)/,oB=/^[^\t\r\n]+/,pR=/^\t/;function sB(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(pR))t=t.replace(pR,""),r+=1,e[n][r]="";else if(t.match(mR))t=t.replace(mR,""),r=0,n+=1,e[n]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(oB);o=s?s[0]:"",t=t.slice(o.length)}e[n][r]=o}return e}function Nu(t){let e,r,n,i,o="",s;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(o+="	"),s=t[e][n],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==r-1&&(o+=`
`)}return o}function sg(t,e){const{instance:r,visualRow:n,visualCol:i,valueSetter:o}=e;return Se(o)?o.call(r,t,n,i,e):t}function aB(t,e){const{instance:r,visualRow:n,visualCol:i,valueGetter:o}=e;return Se(o)?o.call(r,t,n,i,e):t}function qi(t,e,r){return(e=lB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lB(t){var e=uB(t,"string");return typeof e=="symbol"?e:e+""}function uB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class as{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){qi(this,"hot",void 0),qi(this,"metaManager",void 0),qi(this,"tableMeta",void 0),qi(this,"dataSource",void 0),qi(this,"duckSchema",void 0),qi(this,"colToPropCache",void 0),qi(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,o=0,s=!1;if(typeof r=="function"){const a=cp(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=s?r(n):r[n];if(Qe(a)){if(typeof a.data<"u"){const l=s?o:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return a0(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,o=n,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Me(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&ue(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(ue(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?ka(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<r&&o+a<c;){let w=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?w=Hi(this.getSchema()):(w=[],Rt(h-1,()=>w.push(null))):this.hot.dataType==="function"?w=this.tableMeta.dataSchema(l+a):(w={},g_(w,this.getSchema())),d.push(w),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(s,r)),this.hot.runHooks("afterCreateRow",g,a,n),{delta:a,startPhysicalIndex:s}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,r,n)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let g=0;for(let w=d;g<r&&l+g<s;w++){if(typeof c!="number"||c>=l+g)if(u>0)for(let v=0;v<u;v+=1)typeof o[v]>"u"&&(o[v]=[]),o[v].push(null);else o.push([null]);else for(let v=0;v<u;v++)o[v].splice(w,0,null);g+=1}return g>0&&(e==null?this.metaManager.createColumn(null,g):n!=="auto"&&this.metaManager.createColumn(d,r)),this.hot.columnIndexMapper.insertIndexes(c,g,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),g,n),this.refreshDuckSchema(),{delta:g,startPhysicalIndex:d}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const o=this.visualRowsToPhysical(i,r),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,n)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=ue(this.tableMeta.columns)||ue(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,r),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,r,o,n)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],r),h===0&&this.metaManager.removeColumn(o[0],r);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,o,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];SC(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return DN(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),o}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];SC(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),o}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const o=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>n.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const o=this.hot.runHooks("modifyRowData",n);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Fr(i,r))a=i[r];else if(s&&typeof r=="string"&&r.indexOf(".")>-1){let c=i;if(!c)return null;const h=r.split(".");for(let d=0,g=h.length;d<g;d++)if(c=c[h[d]],typeof c>"u")return null;a=c}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));const l=this.propToCol(r),u=this.hot.toPhysicalColumn(l);if(ws(n)&&ws(u)&&(a=aB(a,this.metaManager.getCellMeta(n,u,{visualRow:e,visualColumn:l,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const c=pr(a);this.hot.runHooks("modifyData",e,l,c,"get"),c.isTouched()&&(a=c.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let o=n,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=pr(o);this.hot.runHooks("modifyData",e,this.propToCol(r),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&Fr(s,r))s[r]=o;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let u=s,c=0,h;const d=r.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],o);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;s[r]=o}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let o=(n+e)%n,s=r,a;for(;o<n&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let o=(n+e)%n,s=r;for(;o<n&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,as.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=n===as.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(o=Math.min(e.row,r.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,r.col);s<=d&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,r){return Nu(this.getRange(e,r,as.DESTINATION_RENDERER))}getCopyableText(e,r){return Nu(this.getRange(e,r,as.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:cB,getItem:hB,hasItem:jO}=xo("cellTypes");function dB(t){if(!jO(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return hB(t)}function fB(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&D_(t,r),n&&Dk(t,n),i&&Vk(t,i),cB(t,e)}function gB(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Fr(e,t)}function yc(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?dB(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Me(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Qe(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Me(n,(o,s)=>{if(gB(s,r)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Ii(t,i)}function mB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}oD(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function hu(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Fl(t){return t==null}const zO=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),go(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),go(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),m_(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function wR(t,e,r){return(e=pB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pB(t){var e=wB(t,"string");return typeof e=="symbol"?e:e+""}function wB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vB(){return class{}}class yB{constructor(e){wR(this,"metaCtor",vB()),wR(this,"meta",void 0),this.meta=this.metaCtor.prototype,Ii(this.meta,zO()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;Ii(this.meta,e),yc(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function bB(t,e,r){return(e=CB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CB(t){var e=SB(t,"string");return typeof e=="symbol"?e:e+""}function SB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RB{constructor(e){bB(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){Ii(this.meta,e),yc(this.meta,e,e)}}function Vl(t,e,r){return(e=EB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EB(t){var e=TB(t,"string");return typeof e=="symbol"?e:e+""}function TB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Du{constructor(e){Vl(this,"valueFactory",void 0),Vl(this,"data",[]),Vl(this,"index",[]),Vl(this,"holes",new Set),this.valueFactory=e}obtain(e){hu(()=>ws(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;hu(()=>ws(e)||Fl(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let s=0;s<r;s++)n.push(i+s),this.data.push(void 0);const o=Fl(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...n,...this.index.slice(o)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;hu(()=>ws(e)||Fl(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(Fl(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const o=n[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function vR(t,e,r){return(e=_B(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _B(t){var e=OB(t,"string");return typeof e=="symbol"?e:e+""}function OB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const MB=["data","width"];class IB{constructor(e){vR(this,"globalMeta",void 0),vR(this,"metas",new Du(()=>this._createMeta())),this.globalMeta=e,this.metas=new Du(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);Ii(n,r),yc(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return mB(this.globalMeta.getMetaConstructor(),MB).prototype}}function yR(t,e,r){return(e=HB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HB(t){var e=PB(t,"string");return typeof e=="symbol"?e:e+""}function PB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xB{constructor(e){yR(this,"columnMeta",void 0),yR(this,"metas",new Du(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);Ii(i,n),yc(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var o;const s=this.metas.obtain(e).obtain(r);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(n),s[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)ue(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){hu(()=>ws(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Du(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class UO{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new yB(e),this.tableMeta=new RB(this.globalMeta),this.columnMeta=new IB(this.globalMeta),this.cellMeta=new xB(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){const i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Ye(UO,On);function bR(t,e,r,n){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=n,h=lc(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Se(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new as(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const w=g.getSchema();t=[];let v,b=0,E=0;for(b=0,E=d.startRows;b<E;b++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)v=Hi(w),t.push(v);else if(i.dataType==="array")v=Hi(w[0]),t.push(v);else{v=[];for(let R=0,T=d.startCols;R<T;R++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),r(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.view.adjustElementsSize(),i.render()),i.getSettings().ariaTags&&Re(i.rootElement,[h_(-1),uc(i.countCols()+(i.view?i.countRowHeaders():0))])}function CR(t,e,r){return(e=AB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AB(t){var e=NB(t,"string");return typeof e=="symbol"?e:e+""}function NB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DB{constructor(e){var r=this;CR(this,"metaManager",void 0),CR(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),we.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Fr(e,"type")?e.type:null;let c=Se(e.cells)?e.cells(n,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function kB(t,e,r){LB(t,e),e.set(t,r)}function LB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ag(t,e,r){return(e=FB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FB(t){var e=VB(t,"string");return typeof e=="symbol"?e:e+""}function VB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WB(t,e){return t.get(BB(t,e))}function BB(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var SR=new WeakMap;class $B{constructor(e){ag(this,"metaManager",void 0),ag(this,"usageTracker",new Set),ag(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),kB(this,SR,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(r,l,o),s&&this.installPropWatcher(i,l,o)):n&&(this.installPropWatcher(r,l,WB(SR,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,o,s),this[r]=o},enumerable:!0,configurable:!0})}}const YO="gridDefault",qO="editorManager.handlingEditor",jB={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},zB="hooksRefRegisterer",GO={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){z(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Me(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Jn(GO,"MIXIN_NAME",zB,{writable:!1,enumerable:!1});function Kr(t,e,r){return(e=UB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UB(t){var e=YB(t,"string");return typeof e=="symbol"?e:e+""}function YB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const qB="base",ot=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class hw{static get EDITOR_TYPE(){return qB}constructor(e){Kr(this,"hot",void 0),Kr(this,"state",ot.VIRGIN),Kr(this,"_opened",!1),Kr(this,"_fullEditMode",!1),Kr(this,"_closeCallback",null),Kr(this,"TD",null),Kr(this,"row",null),Kr(this,"col",null),Kr(this,"prop",null),Kr(this,"originalValue",null),Kr(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,o,s){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:ot.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,o,s;if(r){const l=this.hot.getSelectedRangeActive(),u=l.getTopStartCorner(),c=l.getBottomEndCorner();n=u.row,i=u.col,o=c.row,s=c.col}else[n,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,o,s,"edit")}beginEditing(e,r){if(this.state!==ot.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=ot.EDITING,this.isInFullEditMode()){const l=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,u=typeof e=="string"?e:lp(l);this.setValue(u)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),n.view.scrollViewport(n._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,r,n){let i;if(n){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),n(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===ot.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===ot.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=ot.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=ot.FINISHED,this.discardEditor(s)}):(this.state=ot.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=ot.FINISHED,this.discardEditor()}discardEditor(e){this.state===ot.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=ot.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=ot.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===ot.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Ar(r),a=rr(r),l=Ar(this.hot.rootElement),u=rr(this.hot.rootElement),c=n.topOverlay.holder,h=n.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,w=o.innerWidth-l.left-u,{wtTable:v}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,b=v.name,E=["master","inline_start"].includes(b)?d:0,R=["master","top","bottom"].includes(b)?g:0,T=s.top===l.top?0:1;let y=s.top-l.top-T-E,M=0;this.hot.isRtl()?M=o.innerWidth-s.left-a-w-1+R:M=s.left-l.left-1-R,["top","top_inline_start_corner"].includes(b)&&(y+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(M+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const x=this.hot.hasColHeaders(),P=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),D=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),W=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(x&&P<=0||P===W)&&(y+=1),D<=0&&(M+=1);const q=i.rowsRenderCalculator.startPosition,L=i.columnsRenderCalculator.startPosition,oe=Math.abs(n.inlineStartOverlay.getScrollPosition()),G=n.topOverlay.getScrollPosition(),J=jt(this.hot.rootDocument);let tt=r.offsetTop;if(["inline_start","master"].includes(b)&&(tt+=q-G),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:_,wtTable:O}=n.bottomOverlay.clone;tt+=_.getWorkspaceHeight()-O.getHeight()-J}let Ee=r.offsetLeft;this.hot.isRtl()?(Ee>=0?Ee=v.getWidth()-r.offsetLeft:Ee=Math.abs(Ee),Ee+=L-oe-a):["top","master","bottom"].includes(b)&&(Ee+=L-oe);const Te=o.getComputedStyle(this.TD),Be=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Le=parseInt(Te[Be],10)>0?0:1,Ie=parseInt(Te.borderTopWidth,10)>0?0:1,zr=rr(r)+Le,be=ir(r)+Ie,f=ED(c)?J:0,m=TD(h)?J:0,p=this.hot.view.maximumVisibleElementWidth(Ee)-f+Le,C=Math.max(this.hot.view.maximumVisibleElementHeight(tt)-m+Ie,this.hot.stylesHandler.getDefaultRowHeight());return{top:y,start:M,height:be,maxHeight:C,width:zr,maxWidth:p}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}Ye(hw,GO);const GB={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===ot.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},KB={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},XB={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},ZB={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeActive();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},QB={name:"editorOpen",callback(t,e,r){const{selection:n}=t,i=t._getEditorManager(),o=t.getSelectedRange(),s=t.getSelectedRangeActive(),{highlight:a}=s;if((o.some(l=>n.isMultiple(l))||o.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const l=t.getSettings(),u=typeof l.enterMoves=="function"?l.enterMoves(e):l.enterMoves;r.includes("shift")?n.transformFocus(-u.row,-u.col):n.transformFocus(u.row,u.col);return}a.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),hc(e))}};function JB(){return[jB,GB,KB,XB,ZB,QB]}const e$={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},t$={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),o=r.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},r$={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},n$={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},i$={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}},o$={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},s$={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},a$={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},l$={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},u$={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},c$={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},h$={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}},d$={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},f$={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.max(n.row-t.countVisibleRows(),0),o=r.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function g$(){return[e$,t$,r$,n$,i$,o$,s$,a$,l$,u$,c$,h$,d$,f$]}const m$={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},p$={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+n;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}},w$={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-s.row,-s.col):r.transformStart(-s.row,-s.col),r.markEndSource()}},v$={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(s.row,s.col):r.transformStart(s.row,s.col),r.markEndSource()}},y$={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},b$={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},C$={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}},S$={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},R$={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeActive().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},E$={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeActive().highlight.row,o=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},T$={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeActive().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},_$={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeActive().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},O$={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}},M$={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},I$={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},H$={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+n;o=o===0?-1:-o,i===-n?o=-1:i+o<n&&(o=-(i+n)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}};function P$(){return[m$,p$,w$,v$,y$,b$,C$,S$,R$,E$,T$,_$,O$,M$,I$,H$]}const x$={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},A$={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeActive(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(r,n),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},N$={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},D$={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},k$={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},L$=[...JB(),...g$(),...P$(),x$,A$,N$,D$,k$];function KO(t){const e={};return L$.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function F$(t){const e=t.getShortcutManager().addContext("editor"),r=KO(t),n={group:qO};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>r.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>r.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function V$(t){const e=t.getShortcutManager().addContext("grid"),r=KO(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return ue(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:YO};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:qO,runOnlyIf:()=>ue(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeActive())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeActive())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeActive())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function W$(t){[V$,F$].forEach(e=>e(t))}function B$(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=RR(t),i=RR(t);return n.addEventListener("focus",()=>r?.onFocus("from_above")),i.addEventListener("focus",()=>r?.onFocus("from_below")),e.prepend(n),e.append(i),{focus(o){o==="from_above"?n.focus():i.focus()},activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function RR(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Re(r,[_u("Focus catcher")]),r}function $$(t){return e=>{if(!e)return null;const{rowIndexMapper:r,columnIndexMapper:n}=t;if(r.isHidden(e.row)||n.isHidden(e.col))return null;const i=zg(t),o=Ug(t);return e.row=He(e.row,i.row,o.row),e.col=He(e.col,i.col,o.col),e}}function j$(t){const e=$$(t);let r;const{activate:n,deactivate:i}=B$(t,t.rootGridElement,{onFocus(h){if(h==="from_above"){var d;const w=(d=e(r))!==null&&d!==void 0?d:zg(t),v=t.runHooks("modifyFocusOnTabNavigation","from_above",w);w&&v!==!1&&t.selectCell(w.row,w.col)}else{var g;const w=(g=e(r))!==null&&g!==void 0?g:Ug(t),v=t.runHooks("modifyFocusOnTabNavigation","from_below",w);w&&v!==!1&&t.selectCell(w.row,w.col)}t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>{const h=t.getShortcutManager().getActiveContextName(),d=t.getShortcutManager().getContext(h);d?.scope==="table"&&i()}),t.addHook("afterUnlisten",()=>{const h=t.getShortcutManager().getActiveContextName(),d=t.getShortcutManager().getContext(h);d?.scope==="table"&&n()}),t.addHook("afterSelection",(h,d,g,w,v)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,v.value=!0),s){var b;r=(b=t.getSelectedRangeActive())===null||b===void 0?void 0:b.highlight}}),t.addHook("beforeRowWrap",(h,d,g)=>{o.wrapped=!0,o.flipped=g});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:YO,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeActive()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:g}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||g&&o.wrapped&&o.flipped||!g&&o.wrapped)return g&&o.wrapped&&o.flipped&&(r=h.shiftKey?zg(t):Ug(t)),u(),!1;h.preventDefault()},position:"after"}])}function Ns(t){co(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function bc(t){const{selection:e,view:r}=t,n=t.getSelectedRangeActive(),i=e.getSelectionSource(),o=r.getFirstFullyVisibleColumn(),s=r.getLastFullyVisibleColumn(),a=n.getTopStartCorner().col,l=n.getBottomEndCorner().col,u=a<=o,c=l>=s,h=r.getFirstFullyVisibleRow(),d=r.getLastFullyVisibleRow(),g=n.getTopStartCorner().row,w=n.getBottomEndCorner().row,v=g<=h,b=w>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?n.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:v&&b?n.highlight.row:v?g:b?w:E.row}}}function z$(t){return e=>{const r=bc(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const n=!!t.getSettings().colHeaders;Ns(t.getCell(n?-1:0,r,!0))})}}function U$(){return()=>{}}function Y$(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const r=t.getSelectedRangeActive();if(!r)return;const{row:n,col:i}=r.highlight;Ns(t.getCell(n,i,!0))})}}function q$(t){return e=>{const r=bc(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;Ns(t.getCell(i,o,!0))})}}function G$(t){return e=>{const r=bc(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;Ns(t.getCell(i,o,!0))})}}function K$(t){return e=>{const r=bc(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const n=!!t.getSettings().rowHeaders;Ns(t.getCell(r,n?-1:0,!0))})}}function X$(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e,o=()=>{Ns(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&n>=0)t.scrollViewportTo({row:n},o);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},o)}}}function Z$(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var o;if(r||n){r=!1;return}let s;e.isFocusSelectionChanged()?s=Y$(t):e.isSelectedByCorner()?s=U$():e.isSelectedByRowHeader()?s=K$(t):e.isSelectedByColumnHeader()?s=z$(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=q$(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=X$(t):e.getSelectedRange().size()>1&&(s=G$(t)),(o=s)===null||o===void 0||o(i)}}}const ER=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Wl=t=>t.map(e=>{const r=e.toLowerCase();return ER.has(r)?ER.get(r):r}).sort().join("+"),Q$=t=>t.split("+"),TR=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),lg=t=>{let{which:e,key:r}=t;if(TR.has(e))return TR.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},XO=Symbol("shortcut-context");function nm(t){return Qe(t)&&t.__kindOf===XO}const J$=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const r=dc({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:u,callback:c,group:h,runOnlyIf:d=()=>!0,captureCtrl:g=!1,preventDefault:w=!0,stopPropagation:v=!1,relativeToGroup:b,position:E,forwardToContext:R}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if($t(h))throw new Error("You need to define the shortcut's group.");if(Se(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(wr`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const T={callback:c,group:h,runOnlyIf:d,captureCtrl:g,preventDefault:w,stopPropagation:v};ue(b)&&(T.relativeToGroup=b,T.position=E),nm(R)&&(T.forwardToContext=R),u.forEach(y=>{const M=Wl(y);if(r.hasItem(M)){const P=r.getItem(M);let D=P.findIndex(F=>F.group===b);D!==-1?E==="before"?D-=1:D+=1:D=P.length,P.splice(D,0,T)}else r.addItem(M,[T])})},i=function(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(h=>{Me(c,(d,g)=>{Object.prototype.hasOwnProperty.call(h,g)===!1&&(h[g]=c[g])}),n(h)})},o=u=>{const c=Wl(u);r.removeItem(c)};return{__kindOf:XO,scope:e,addShortcut:n,addShortcuts:i,getShortcuts:u=>{const c=Wl(u),h=r.getItem(c);return ue(h)?h.slice():[]},hasShortcut:u=>{const c=Wl(u);return r.hasItem(c)},removeShortcutsByKeys:o,removeShortcutsByGroup:u=>{r.getItems().forEach(h=>{let[d,g]=h;const w=g.filter(v=>v.group!==u);w.length===0?o(Q$(d)):(g.length=0,g.push(...w))})}}};function ej(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const tj=["meta","alt","shift","control"],oa=ej(),sa=[];let Bl=0;function rj(t,e,r,n,i){const o=g=>tj.includes(g),s=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return g.altKey&&v.push("alt"),w&&(g.ctrlKey||g.metaKey)?v.push("control/meta"):(g.ctrlKey&&v.push("control"),g.metaKey&&v.push("meta")),g.shiftKey&&v.push("shift"),v},a=g=>{if(e(g)===!1||r(g)===!1||g.keyCode===229||typeof g.key!="string"||ro(g))return;const v=lg(g);let b=[];o(v)||(b=s(g));const E=[v].concat(b);!i(g,E)&&(kC()&&b.includes("meta")||!kC()&&b.includes("control"))&&i(g,[v].concat(s(g,!0))),n(g)},l=g=>{if(typeof g.key=="string"){const w=lg(g);o(w)&&oa.press(w)}},u=g=>{if(typeof g.key=="string"){const w=lg(g);o(w)&&oa.release(w)}},c=()=>{oa.releaseAll()};return{mount:()=>{let g=t;for(Bl+=1;g;)Bl===1&&(g.document.documentElement.addEventListener("keydown",l),sa.push({event:"keydown",listener:l}),g.document.documentElement.addEventListener("keyup",u),sa.push({event:"keyup",listener:u})),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=La(g)},unmount:()=>{let g=t;for(Bl-=1;g;){if(Bl===0){for(let w=0;w<sa.length;w++){const{event:v,listener:b}=sa[w];g.document.documentElement.removeEventListener(v,b)}sa.length=0}g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=La(g)}},isPressed:g=>oa.isPressed(g),releasePressedKeys:()=>oa.releaseAll()}}const nj=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const o=dc({errorIdExists:v=>`The "${v}" context name is already registered.`});let s="grid";const a=function(v){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const E=J$(v,b);return o.addItem(v,E),E},l=()=>s,u=v=>o.getItem(v),c=v=>{if(!o.hasItem(v))throw new Error(wr`You've tried to activate the "${v}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=v};let h=!1;const d=function(v,b){let E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const R=nm(E)?E:u(E);let T=!1;if(!R.hasShortcut(b))return T;const y=R.getShortcuts(b);for(let M=0;M<y.length;M++){const{callback:x,runOnlyIf:P,preventDefault:D,stopPropagation:F,captureCtrl:W,forwardToContext:q}=y[M];if(P(v)===!0){if(h=W,T=x(v,b)===!1,h=!1,D&&v.preventDefault(),F&&(hc(v),v.stopPropagation()),T)break;q&&d(v,b,q)}}return T},w=rj(e,v=>{const b=l(),E=nm(b)?b:u(b);return r(v,E.scope)},n,i,d);return w.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(w.isPressed("control")||w.isPressed("meta")),releasePressedKeys:()=>w.releasePressedKeys(),destroy:()=>w.unmount()}};function _R(t){const{classNames:e}=pD(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function ij(t,e){ZO(t,e),e.add(t)}function ui(t,e,r){ZO(t,e),e.set(t,r)}function ZO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ue(t,e){return t.get(en(t,e))}function gr(t,e,r){return t.set(en(t,e),r),r}function en(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const OR=23;var pn=new WeakMap,ku=new WeakMap,dw=new WeakMap,im=new WeakMap,gi=new WeakMap,ba=new WeakMap,Va=new WeakMap,aa=new WeakMap,vn=new WeakSet;class oj{constructor(e){let{rootElement:r,rootDocument:n,onThemeChange:i=()=>{}}=e;ij(this,vn),ui(this,pn,void 0),ui(this,ku,void 0),ui(this,dw,void 0),ui(this,im,void 0),ui(this,gi,!0),ui(this,ba,{}),ui(this,Va,{}),ui(this,aa,void 0),gr(ku,this,r),gr(im,this,n),gr(aa,this,i)}isClassicTheme(){return Ue(gi,this)}getCSSVariableValue(e){var r;if(Ue(gi,this))return null;if(Ue(ba,this)[`--ht-${e}`])return Ue(ba,this)[`--ht-${e}`];const n=(r=en(vn,this,lj).call(this,`--ht-${e}`))!==null&&r!==void 0?r:en(vn,this,QO).call(this,`--ht-${e}`);if(n!==null)return Ue(ba,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=Ue(Va,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(Ue(gi,this))return OR;const e=en(vn,this,sj).call(this);return e||OR}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){gr(pn,this,void 0),gr(gi,this,!0),Ue(aa,this).call(this,Ue(pn,this)),en(vn,this,ug).call(this);return}if(e&&e!==Ue(pn,this)){if(!/ht-theme-.*/.test(e)){on(`Invalid theme name: ${e}. Please provide a valid theme name.`),gr(pn,this,void 0),gr(gi,this,!1),Ue(aa,this).call(this,Ue(pn,this)),en(vn,this,ug).call(this);return}Ue(pn,this)&&en(vn,this,uj).call(this),gr(pn,this,e),gr(gi,this,!1),Ue(aa,this).call(this,Ue(pn,this)),en(vn,this,ug).call(this)}}getThemeName(){return Ue(pn,this)}}function sj(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function ug(){this.isClassicTheme()||gr(dw,this,getComputedStyle(Ue(ku,this)));const t=en(vn,this,aj).call(this,["box-sizing","border-bottom-width"]);Ue(Va,this).td={...Ue(Va,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function aj(t){const e=Ue(im,this),r=Ue(ku,this),n=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),n.appendChild(i),r.appendChild(n);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),r.removeChild(n),u}function lj(t){const e=Math.ceil(parseFloat(en(vn,this,QO).call(this,t)));return Number.isNaN(e)?null:e}function QO(t){const e=Ue(dw,this).getPropertyValue(t);return e===""?null:e}function uj(){gr(Va,this,{}),gr(ba,this,{}),gr(gi,this,!0)}function cj(t,e){JO(t,e),e.add(t)}function MR(t,e,r){JO(t,e),e.set(t,r)}function JO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IR(t,e){return t.get(Ss(t,e))}function HR(t,e,r){return t.set(Ss(t,e),r),r}function Ss(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var om=new WeakMap,sm=new WeakMap,Ia=new WeakSet;class hj{constructor(e){let{rowIndexMapper:r,columnIndexMapper:n}=e;cj(this,Ia),MR(this,om,void 0),MR(this,sm,void 0),HR(om,this,r),HR(sm,this,n)}toRenderable(e){const r=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,i=Ss(Ia,this,PR).call(this,e.from,r,n);if(i===null)return null;const o=Ss(Ia,this,PR).call(this,e.to,-r,-n);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function PR(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const n=Ss(Ia,this,xR).call(this,IR(om,this),t.row,e);if(n===null)return null;const i=Ss(Ia,this,xR).call(this,IR(sm,this),t.col,r);return i===null?null:t.clone().assign({row:n,col:i})}function xR(t,e,r){return e<0?e:t.getNearestNotHiddenIndex(e,r)}let $n=null,du=0;function dj(t){const e=t.ownerDocument;if(!$n){$n=e.createElement("div"),$n.setAttribute("role","status"),$n.setAttribute("aria-live","assertive"),$n.setAttribute("aria-atomic","true");const r=$n.style;r.position="absolute",r.width="1px",r.height="1px",r.margin="-1px",r.overflow="hidden",r.clipPath="rect(0 0 0 0)",r.whiteSpace="nowrap",t.appendChild($n)}du+=1}function fj(){du!==0&&(du===1&&($n.remove(),$n=null),du-=1)}let cg=null;const $l=new WeakSet,hg=new Map;function eM(t,e){var r,n,i=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const a=new Pi(s);let l,u,c,h,d,g,w=!0;const v={...e.initialState,...e};PV(o)&&HV(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=eo(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,eo(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),K(this.rootElement,["ht-wrapper","handsontable"]),K(this.rootWrapperElement,"ht-root-wrapper"),K(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),K(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const b=(r=v?.layoutDirection)!==null&&r!==void 0?r:"inherit",E=["rtl","ltr"].includes(b)?b:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",E),(n=this.rootWrapperElement)===null||n===void 0||n.setAttribute("dir",E),this.isRtl=function(){return E==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},this.stylesHandler=new oj({rootElement:s.rootElement,rootDocument:s.rootDocument,onThemeChange:f=>{eo(this)&&(Oe(this.rootWrapperElement,/ht-theme-.*/g),Oe(this.rootPortalElement,/ht-theme-.*/g),f&&(K(this.rootWrapperElement,f),K(this.rootPortalElement,f),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||on(`The "${f}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),v.language=MW(v.language);const R=Object.fromEntries(Object.entries(v).filter(f=>{let[m]=f;return!(we.getSingleton().isRegistered(m)||we.getSingleton().isDeprecated(m))})),T=new UO(s,R,[DB,$B]),y=T.getTableMeta(),M=T.getGlobalMeta(),x=dc();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${s_()}`,hg.set(this.guid,this),this.columnIndexMapper=new em,this.rowIndexMapper=new em,this.columnIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterColumnSequenceChange",f)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterRowSequenceChange",f)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",f=>{s.runHooks("beforeCompositionStart",f)}),u=new zV(s);const P=xo(this.guid);P.register("cellRangeMapper",new hj({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const D=f=>{const{row:m,col:p}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,p>=0?s.columnIndexMapper.getRenderableFromVisualIndex(p):p)},F=f=>{const{row:m,col:p}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,p>=0?s.columnIndexMapper.getVisualFromRenderableIndex(p):p)},W=(f,m)=>{const p=m>f?1:-1,C=Math.min(f,m),_=Math.max(f,m),O=s.rowIndexMapper.getNearestNotHiddenIndex(f,p);return O===null||p===1&&O>_||p===-1&&O<C?null:O>=0?s.rowIndexMapper.getRenderableFromVisualIndex(O):O},q=(f,m)=>{const p=m>f?1:-1,C=Math.min(f,m),_=Math.max(f,m),O=s.columnIndexMapper.getNearestNotHiddenIndex(f,p);return O===null||p===1&&O>_||p===-1&&O<C?null:O>=0?s.columnIndexMapper.getRenderableFromVisualIndex(O):O};let L=new $O(y,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:f=>l.propToCol(f),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(f,m)=>s._createCellCoords(f,m),createCellRange:(f,m,p)=>s._createCellRange(f,m,p),visualToRenderableCoords:D,renderableToVisualCoords:F,findFirstNonHiddenRenderableRow:W,findFirstNonHiddenRenderableColumn:q,isDisabledCellSelection:(f,m)=>f<0||m<0?s.getSettings().disableVisualSelection:s.getCellMeta(f,m).disableVisualSelection});this.selection=L;const oe=f=>{let{hiddenIndexesChanged:m}=f;this.forceFullRender=!0,m&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",oe),this.rowIndexMapper.addLocalHook("cacheUpdated",oe),this.selection.addLocalHook("afterSetRangeEnd",(f,m)=>{const p=pr(!1),C=this.selection.getSelectedRange(),{from:_,to:O}=C.current(),I=C.size()-1;this.runHooks("afterSelection",_.row,_.col,O.row,O.col,p,I),this.runHooks("afterSelectionByProp",_.row,s.colToProp(_.col),O.row,s.colToProp(O.col),p,I),m&&(!p.isTouched()||p.isTouched()&&!p.value)&&g.scrollTo(f);const A=L.isSelectedByRowHeader(),j=L.isSelectedByColumnHeader();A&&j?K(this.rootElement,["ht__selection--rows","ht__selection--columns"]):A?(Oe(this.rootElement,"ht__selection--columns"),K(this.rootElement,"ht__selection--rows")):j?(Oe(this.rootElement,"ht__selection--rows"),K(this.rootElement,"ht__selection--columns")):Oe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(L.getSelectionSource())||h.closeEditor(null),L.getSelectionSource()!=="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",f=>{this.runHooks("beforeSelectionFocusSet",f.row,f.col)}),this.selection.addLocalHook("afterSetFocus",f=>{const m=pr(!1);this.runHooks("afterSelectionFocusSet",f.row,f.col,m),(!m.isTouched()||m.isTouched()&&!m.value)&&g.scrollTo(f),h.closeEditor(),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",f=>{const m=f.length-1,{from:p,to:C}=f[m];this.runHooks("afterSelectionEnd",p.row,p.col,C.row,C.col,m),this.runHooks("afterSelectionEndByProp",p.row,s.colToProp(p.col),C.row,s.colToProp(C.col),m),L.getSelectionSource()==="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",f=>{const m=this.runHooks("afterIsMultipleSelection",f.value);f.value&&(f.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),s.view.render(),Oe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterSelectRows",...m)}).addLocalHook("beforeSelectAll",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSelectAll",...m)}).addLocalHook("afterSelectAll",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterSelectAll",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("modifyTransformFocus",...m)}).addLocalHook("afterModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterModifyTransformFocus",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",f=>this.alter("insert_row_above",f,1,"auto")).addLocalHook("insertColRequire",f=>this.alter("insert_col_start",f,1,"auto")),c={alter(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,C=arguments.length>3?arguments[3]:void 0,_=arguments.length>4?arguments[4]:void 0;const O=I=>{if(I.length===0)return[];const A=[...I];return A.sort((B,H)=>{let[ee]=B,[ne]=H;return ee===ne?0:ee>ne?1:-1}),Ho(A,(B,H)=>{let[ee,ne]=H;const ce=B[B.length-1],[Ge,dt]=ce,wt=Ge+dt;if(ee<=wt){const Tt=Math.max(ne-(wt-ee),0);ce[1]+=Tt}else B.push([ee,ne]);return B},[A[0]])};switch(f){case"insert_row_below":case"insert_row_above":const I=s.countSourceRows();if(y.maxRows===I)return;const A=f==="insert_row_below"?"below":"above";m=m??(A==="below"?I:0);const{delta:j,startPhysicalIndex:B}=l.createRow(m,p,{source:C,mode:A});L.shiftRows(s.toVisualRow(B),j);break;case"insert_col_start":case"insert_col_end":const H=f==="insert_col_end"?"end":"start";m=m??(H==="end"?s.countSourceCols():0);const{delta:ee,startPhysicalIndex:ne}=l.createCol(m,p,{source:C,mode:H});if(ee){if(Array.isArray(y.colHeaders)){const dt=[s.toVisualColumn(ne),0];dt.length+=ee,Array.prototype.splice.apply(y.colHeaders,dt)}L.shiftColumns(s.toVisualColumn(ne),ee)}break;case"remove_row":const ce=dt=>{let wt=0;z(dt,Tt=>{let[Ne,rt]=Tt;const _t=go(Ne)?s.countRows()-1:Math.max(Ne-wt,0);if(Number.isInteger(Ne)&&(Ne=Math.max(Ne-wt,0)),!l.removeRow(Ne,rt,C))return;if(L.isSelected()){const{row:vt}=s.getSelectedRangeActive().highlight;vt>=Ne&&vt<=Ne+rt-1&&h.closeEditor(!0)}const sr=s.countRows(),In=y.fixedRowsTop;In>=_t+1&&(y.fixedRowsTop-=Math.min(rt,In-_t));const Dt=y.fixedRowsBottom;if(Dt&&_t>=sr-Dt&&(y.fixedRowsBottom-=Math.min(rt,Dt)),sr===0)L.deselect();else if(C==="ContextMenu.removeRow"){const vt=L.getSelectedRange(),ar=vt.pop();vt.clear().set(ar.from).current().setTo(ar.to),L.refresh()}else L.shiftRows(Ne,-rt);wt+=rt})};Array.isArray(m)?ce(O(m)):ce([[m,p]]);break;case"remove_col":const Ge=dt=>{let wt=0;z(dt,Tt=>{let[Ne,rt]=Tt;const _t=go(Ne)?s.countCols()-1:Math.max(Ne-wt,0);let Nt=s.toPhysicalColumn(_t);if(Number.isInteger(Ne)&&(Ne=Math.max(Ne-wt,0)),!l.removeCol(Ne,rt,C))return;if(L.isSelected()){const{col:vt}=s.getSelectedRangeActive().highlight;vt>=Ne&&vt<=Ne+rt-1&&h.closeEditor(!0)}if(s.countCols()===0)L.deselect();else if(C==="ContextMenu.removeColumn"){const vt=L.getSelectedRange(),ar=vt.pop();vt.clear().set(ar.from).current().setTo(ar.to),L.refresh()}else L.shiftColumns(Ne,-rt);const Dt=y.fixedColumnsStart;Dt>=_t+1&&(y.fixedColumnsStart-=Math.min(rt,Dt-_t)),Array.isArray(y.colHeaders)&&(typeof Nt>"u"&&(Nt=-1),y.colHeaders.splice(Nt,rt)),wt+=rt})};Array.isArray(m)?Ge(O(m)):Ge([[m,p]]);break;default:throw new Error(`There is no such action "${f}"`)}_||c.adjustRowsAndCols(),s.view.adjustElementsSize(),s.view.render()},adjustRowsAndCols(){const f=y.minRows,m=y.minSpareRows,p=y.minCols,C=y.minSpareCols;if(f){const _=s.countRows();_<f&&l.createRow(_,f-_,{source:"auto"})}if(m){const _=s.countEmptyRows(!0);if(_<m){const O=m-_,I=Math.min(O,y.maxRows-s.countSourceRows());l.createRow(s.countRows(),I,{source:"auto"})}}{let _;(p||C)&&(_=s.countEmptyCols(!0));let O=s.countCols();if(p&&!y.columns&&O<p){const I=p-O;_+=I,l.createCol(O,I,{source:"auto"})}if(C&&!y.columns&&s.dataType==="array"&&_<C){O=s.countCols();const I=C-_,A=Math.min(I,y.maxCols-O);l.createCol(O,A,{source:"auto"})}}},populateFromArray(f,m,p,C,_){let O,I,A,j;const B=[],H={},ee=[],ne=f.row,ce=f.col;if(I=m.length,I===0)return!1;let Ge=0,dt=0;switch(Qe(p)&&(Ge=p.col-ce+1,dt=p.row-ne+1),_){case"shift_down":const Tt=Cf(m),Ne=Tt.length,rt=Math.max(Ne,Ge),_t=s.getData().slice(ne),Nt=Cf(_t).slice(ce,ce+rt);for(A=0;A<rt;A+=1)if(A<Ne){for(O=0,I=Tt[A].length;O<dt-I;O+=1)Tt[A].push(Tt[A][O%I]);A<Nt.length?ee.push(Tt[A].concat(Nt[A])):ee.push(Tt[A].concat(new Array(_t.length).fill(null)))}else ee.push(Tt[A%Ne].concat(Nt[A]));s.populateFromArray(ne,ce,Cf(ee));break;case"shift_right":const sr=m.length,In=Math.max(sr,dt),Dt=s.getData().slice(ne).map(lr=>lr.slice(ce));for(O=0;O<In;O+=1)if(O<sr){for(A=0,j=m[O].length;A<Ge-j;A+=1)m[O].push(m[O][A%j]);if(O<Dt.length)for(let lr=0;lr<Dt[O].length;lr+=1)m[O].push(Dt[O][lr]);else m[O].push(...new Array(Dt[0].length).fill(null))}else m.push(m[O%I].slice(0,In).concat(Dt[O]));s.populateFromArray(ne,ce,m);break;case"overwrite":default:H.row=f.row,H.col=f.col;let vt=0,ar=0,ti=!0,Ur;const Li=function(ri){let ni=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const cn=m[ri%m.length];return ni!==null?cn[ni%cn.length]:cn},Rr=m.length,un=p?p.row-f.row+1:0;for(p?I=un:I=Math.max(Rr,un),O=0;O<I&&!(p&&H.row>p.row&&un>Rr||!y.allowInsertRow&&H.row>s.countRows()-1||H.row>=y.maxRows);O++){const lr=O-vt,ri=Li(lr).length,ni=p?p.col-f.col+1:0;if(p?j=ni:j=Math.max(ri,ni),H.col=f.col,Ur=s.getCellMeta(H.row,H.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&Ur.skipRowOnPaste){vt+=1,H.row+=1,I+=1;continue}for(ar=0,A=0;A<j;A++){var wt;if(p&&H.col>p.col&&ni>ri||!y.allowInsertColumn&&H.col>s.countCols()-1||H.col>=y.maxCols)break;if(Ur=s.getCellMeta(H.row,H.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&Ur.skipColumnOnPaste){ar+=1,H.col+=1,j+=1;continue}if(Ur.readOnly&&C!=="UndoRedo.undo"){H.col+=1;continue}const cn=A-ar,ii=!!Ur.valueSetter;let Er=Li(lr,cn),yt=(wt=s.getSourceDataAtCell(H.row,H.col))!==null&&wt!==void 0?wt:null;if(Er!==null&&typeof Er=="object"){if(Array.isArray(Er)&&yt===null&&(yt=[]),!ii&&(typeof yt!="object"||yt===null))ti=!1;else if(yt!==null){const al=ka(Array.isArray(yt)?yt:yt[0]||yt),ll=ka(Array.isArray(Er)?Er:Er[0]||Er);ii||m_(al,ll)||Array.isArray(al)&&Array.isArray(ll)?Er=Hi(Er):ti=!1}}else!ii&&yt!==null&&typeof yt=="object"&&(ti=!1);ti&&B.push([H.row,H.col,Er]),ti=!0,H.col+=1}H.row+=1}s.setDataAtCell(B,null,null,C||"populateFromArray");break}}};function G(f){const m=v0(f);sw(m)?(s.runHooks("beforeLanguageChange",m),M.language=m,s.runHooks("afterLanguageChange",m)):y0(f)}function J(f,m){const p=f==="className"?s.rootElement:s.table;if(w)K(p,m);else{let C=[],_=[];M[f]&&(C=Array.isArray(M[f])?M[f]:EC(M[f])),m&&(_=Array.isArray(m)?m:EC(m));const O=RC(C,_),I=RC(_,C);O.length&&Oe(p,O),I.length&&K(p,I)}M[f]=m}this.init=function(){u.setData(y.data),s.runHooks("beforeInit"),(Ci()||w_())&&K(s.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new DV(this),h=Xg.getInstance(s,y,L),g=Z$(s),d=new lk(s),eo(this)&&(j$(s),dj(s.rootPortalElement),VN(v.licenseKey,this.rootWrapperElement)),s.runHooks("init"),this.render(),w&&s.rootElement.offsetParent===null&&_D(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.view.adjustElementsSize(),s.render()}),typeof w=="object"&&(s.runHooks("afterChange",w[0],w[1]),w=!1),s.runHooks("afterInit")};function tt(){let f=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,f=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&f===!1&&(f=!0,this.onQueueEmpty(this.valid))}}}function Ee(f,m,p){if(!f.length){p();return}const C=s.getActiveEditor(),_=new tt;let O=!0;_.onQueueEmpty=()=>{C&&O&&C.cancelChanges(),p()};for(let I=f.length-1;I>=0;I--){const[A,j,,B]=f[I],H=l.propToCol(j);let ee;Number.isInteger(H)?ee=s.getCellMeta(A,H):ee={...Object.getPrototypeOf(y),...y},s.getCellValidator(ee)&&(_.addValidatorToQueue(),s.validateCell(B,ee,function(ne,ce){return function(Ge){if(typeof Ge!="boolean")throw new Error("Validation error: result is not boolean");Ge===!1&&ce.allowInvalid===!1&&(O=!1,f.splice(ne,1),ce.valid=!0),_.removeValidatorFormQueue()}}(I,ee),m))}_.checkIfQueueIsEmpty()}function Te(f,m){for(let C=f.length-1;C>=0;C--){let _=!1;if(f[C]===null){f.splice(C,1);continue}if(!((f[C][2]===null||f[C][2]===void 0)&&(f[C][3]===null||f[C][3]===void 0))){if(y.allowInsertRow)for(;f[C][0]>s.countRows()-1;){const{delta:O}=l.createRow(void 0,void 0,{source:"auto"});if(O===0){_=!0;break}}if(s.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;l.propToCol(f[C][1])>s.countCols()-1;){const{delta:O}=l.createCol(void 0,void 0,{source:"auto"});if(O===0){_=!0;break}}_||l.set(f[C][0],f[C][1],f[C][3])}}if(f.length>0){c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",f,m),h.closeEditor(),s.view.adjustElementsSize(),s.render(),h.prepareEditor(),s.runHooks("afterChange",f,m||"edit");const C=s.getActiveEditor();C&&ue(C.refreshValue)&&C.refreshValue()}else s.render()}this._createCellCoords=function(f,m){return s.view._wt.createCellCoords(f,m)},this._createCellRange=function(f,m,p){return s.view._wt.createCellRange(f,m,p)},this.validateCell=function(f,m,p,C){let _=s.getCellValidator(m);function O(I){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){p(I);return}const j=m.visualCol,B=m.visualRow,H=s.getCell(B,j,!0);if(H&&H.nodeName!=="TH"){const ee=s.rowIndexMapper.getRenderableFromVisualIndex(B),ne=s.columnIndexMapper.getRenderableFromVisualIndex(j);s.view._wt.getSetting("cellRenderer",ee,ne,H)}p(I)}kN(_)&&(_=function(I){return function(A,j){j(I.test(A))}}(_)),Se(_)?(f=s.runHooks("beforeValidate",f,m.visualRow,m.prop,C),s._registerImmediate(()=>{_.call(m,f,I=>{s&&(I=s.runHooks("afterValidate",I,f,m.visualRow,m.prop,C),m.valid=I,O(I),s.runHooks("postAfterValidate",I,f,m.visualRow,m.prop,C))})})):s._registerImmediate(()=>{m.valid=!0,O(m.valid,!1)})};function Be(f,m,p){return Array.isArray(f)?f:[[f,m,p]]}function Le(f,m){const p=s.runHooks("beforeChange",f,m||"edit"),C=f.filter(O=>O!==null);if(p===!1||C.length===0){var _;return(_=s.getActiveEditor())===null||_===void 0||_.cancelChanges(),[]}for(let O=C.length-1;O>=0;O--){const[I,A,,j]=C[O],B=l.propToCol(A);let H;Number.isInteger(B)?H=s.getCellMeta(I,B):H={...Object.getPrototypeOf(y),...y},C[O][3]=sg(j,H)}return C}this.setDataAtCell=function(f,m,p,C){const _=Be(f,m,p),O=[];let I=C,A,j,B;for(A=0,j=_.length;A<j;A++){const[ee,ne,ce]=_[A];if(typeof _[A]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof ne!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");ne>=this.countCols()?B=ne:B=l.colToProp(ne),O.push([ee,B,u.getAtCell(this.toPhysicalRow(ee),ne),ce])}!I&&typeof f=="object"&&(I=m);const H=Le(O,I);s.runHooks("afterSetDataAtCell",H,I),Ee(H,I,()=>{Te(H,I)})},this.setDataAtRowProp=function(f,m,p,C){const _=Be(f,m,p),O=[];let I=C,A,j;for(A=0,j=_.length;A<j;A++){const[H,ee,ne]=_[A];O.push([H,ee,u.getAtCell(this.toPhysicalRow(H),ee),ne])}!I&&typeof f=="object"&&(I=m);const B=Le(O,C);s.runHooks("afterSetDataAtRowProp",B,I),Ee(B,I,()=>{Te(B,I)})},this.listen=function(){s&&!s.isListening()&&(hg.forEach(f=>{s!==f&&f.unlisten()}),cg=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(cg=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return cg===s.guid},this.destroyEditor=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(f),s.view.render(),m&&L.isSelected()&&h.prepareEditor()},this.populateFromArray=function(f,m,p,C,_,O,I){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const A=typeof C=="number"?s._createCellCoords(C,_):null;return c.populateFromArray(s._createCellCoords(f,m),p,A,O,I)},this.spliceCol=function(f,m,p){for(var C=arguments.length,_=new Array(C>3?C-3:0),O=3;O<C;O++)_[O-3]=arguments[O];return l.spliceCol(f,m,p,..._)},this.spliceRow=function(f,m,p){for(var C=arguments.length,_=new Array(C>3?C-3:0),O=3;O<C;O++)_[O-3]=arguments[O];return l.spliceRow(f,m,p,..._)},this.getSelected=function(){if(L.isSelected())return Mi(L.getSelectedRange(),f=>{let{from:m,to:p}=f;return[m.row,m.col,p.row,p.col]})},this.getSelectedLast=function(){const f=this.getSelected();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedActive=function(){const f=this.getSelectedRangeActive();if(!f)return;const{from:m,to:p}=f;return[m.row,m.col,p.row,p.col]},this.getSelectedRange=function(){if(L.isSelected())return Array.from(L.getSelectedRange())},this.getSelectedRangeLast=function(){const f=this.getSelectedRange();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedRangeActive=function(){return L.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return L.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(f){if(!L.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];z(L.getSelectedRange(),p=>{if(p.isSingleHeader())return;const C=p.getTopStartCorner(),_=p.getBottomEndCorner();Rt(C.row,_.row,O=>{Rt(C.col,_.col,I=>{this.getCellMeta(O,I).readOnly||m.push([O,I,null])})})}),m.length>0&&this.setDataAtCell(m,f)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const f=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(f,0),!this.isRenderSuspended()&&f===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(f){this.suspendRender();const m=f();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||f)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=f();return this.resumeExecution(m),p},this.batch=function(f){this.suspendRender(),this.suspendExecution();const m=f();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const f=s.view,{width:m,height:p}=f.getLastSize(),{width:C,height:_}=s.rootElement.getBoundingClientRect(),O=C!==m||_!==p;s.runHooks("beforeRefreshDimensions",{width:m,height:p},{width:C,height:_},O)!==!1&&((O||f._wt.wtOverlays.scrollableElement===s.rootWindow)&&(f.setLastSize(C,_),f.adjustElementsSize(),s.render()),s.runHooks("afterRefreshDimensions",{width:m,height:p},{width:C,height:_},O))},this.updateData=function(f,m){bR(f,p=>{l=p},p=>{l=p,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),L.refresh()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:T,firstRun:w})},this.loadData=function(f,m){bR(f,p=>{l=p},()=>{T.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),L.refresh(),w&&(w=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:T,firstRun:w})},this.getInitialColumnCount=function(){const f=y.columns;let m=0;if(Array.isArray(f))m=f.length;else if(Se(f))if(s.dataType==="array"){const p=this.countSourceCols();for(let C=0;C<p;C+=1)f(C)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=l.colToPropCache.length);else if(ue(y.dataSchema)){const p=l.getSchema();m=Array.isArray(p)?p.length:cp(p)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(f,m,p,C){return $t(f)?l.getAll():l.getRange(s._createCellCoords(f,m),s._createCellCoords(p,C),l.DESTINATION_RENDERER)},this.getCopyableText=function(f,m,p,C){return l.getCopyableText(s._createCellCoords(f,m),s._createCellCoords(p,C))},this.getCopyableData=function(f,m){return l.getCopyable(f,l.colToProp(m))},this.getCopyableSourceData=function(f,m){return u.getCopyable(f,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(w?s.loadData:s.updateData).bind(this);let C=!1,_,O;if(ue(f.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ue(f.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ue(f.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(_ in f)if(!(_==="data"||_==="language"))if(_==="className")J("className",f.className);else if(_==="tableClassName"&&s.table)J("tableClassName",f.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(we.getSingleton().isRegistered(_)||we.getSingleton().isDeprecated(_)){const H=f[_];Se(H)?(we.getSingleton().addAsFixed(_,H,s),y[_]=H):Array.isArray(H)&&(we.getSingleton().add(_,H,s),y[_]=H)}else!m&&Fr(f,_)&&(M[_]=f[_]);if(m)s.useTheme(y.themeName||_R(s.rootContainer));else{const H=s.getCurrentThemeName();Fr(f,"themeName")&&H!==f.themeName&&s.useTheme(f.themeName)}$l.has(s)&&s.stylesHandler.getThemeName()!==void 0&&$l.delete(s),eo(s)&&!$l.has(s)&&s.stylesHandler.isClassicTheme()&&(AD("Handsontable classic theme is a legacy theme and will be removed in version 17.0. Please update your theme settings to ensure compatibility with future versions."),$l.add(s)),f.data===void 0&&y.data===void 0?p(null,"updateSettings"):f.data!==void 0?p(f.data,"updateSettings"):f.columns!==void 0&&(l.createMap(),s.initIndexMappers()),!w&&f.language&&G(f.language);const I=s.countCols(),A=y.columns;if(A&&Se(A)&&(C=!0),(f.cell!==void 0||f.cells!==void 0||f.columns!==void 0)&&T.clearCache(),I>0)for(_=0,O=0;_<I;_++){if(A){const H=C?A(_):A[O];H&&T.updateColumnMeta(O,H)}O+=1}ue(f.cell)&&Me(f.cell,H=>{s.setCellMetaObject(H.row,H.col,H)}),s.runHooks("afterCellMetaReset");let j=s.rootElement.style.height;j!==""&&(j=parseInt(s.rootElement.style.height,10)),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style"));let B=f.height;if(typeof f.height<"u")if(Se(B)&&(B=B()),B=s.runHooks("beforeHeightChange",B),B===null){const H=s.rootElement.getAttribute("data-initialstyle");H&&(H.indexOf("height")>-1||H.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",H):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else B!==void 0&&(s.rootElement.style.height=isNaN(B)?`${B}`:`${B}px`,s.rootElement.style.overflow="hidden");if(typeof f.width<"u"){let H=f.width;Se(H)&&(H=H()),H=s.runHooks("beforeWidthChange",H),s.rootElement.style.width=isNaN(H)?`${H}`:`${H}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",f)),c.adjustRowsAndCols(),s.view&&!w&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!m&&s.view&&(j===""||B===""||B===void 0)&&j!==B&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const f=s.getSelectedRangeActive();if(y.getValue){if(Se(y.getValue))return y.getValue.call(s);if(f)return s.getData()[f.highlight.row][y.getValue]}else if(f)return s.getDataAtCell(f.highlight.row,f.highlight.col);return null},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(f,m,p,C,_){c.alter(f,m,p,C,_)},this.getCell=function(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,C=m,_=f;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;C=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(f>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(f)))return null;_=this.rowIndexMapper.getRenderableFromVisualIndex(f)}return _===null||C===null||_===void 0||C===void 0?null:s.view.getCellAtCoords(s._createCellCoords(_,C),p)},this.getCoords=function(f){const m=this.view._wt.wtTable.getCoords(f);if(m===null)return null;const{row:p,col:C}=m;let _=p,O=C;return p>=0&&(_=this.rowIndexMapper.getVisualFromRenderableIndex(p)),C>=0&&(O=this.columnIndexMapper.getVisualFromRenderableIndex(C)),s._createCellCoords(_,O)},this.colToProp=function(f){return l.colToProp(f)},this.propToCol=function(f){return l.propToCol(f)},this.toVisualRow=f=>this.rowIndexMapper.getVisualFromPhysicalIndex(f),this.toVisualColumn=f=>this.columnIndexMapper.getVisualFromPhysicalIndex(f),this.toPhysicalRow=f=>this.rowIndexMapper.getPhysicalFromVisualIndex(f),this.toPhysicalColumn=f=>this.columnIndexMapper.getPhysicalFromVisualIndex(f),this.getDataAtCell=function(f,m){return l.get(f,l.colToProp(m))},this.getDataAtRowProp=function(f,m){return l.get(f,m)},this.getDataAtCol=function(f){const m=[],p=l.getRange(s._createCellCoords(0,f),s._createCellCoords(y.data.length-1,f),l.DESTINATION_RENDERER);for(let C=0;C<p.length;C+=1)for(let _=0;_<p[C].length;_+=1)m.push(p[C][_]);return m},this.getDataAtProp=function(f){const m=[],p=l.getRange(s._createCellCoords(0,l.propToCol(f)),s._createCellCoords(y.data.length-1,l.propToCol(f)),l.DESTINATION_RENDERER);for(let C=0;C<p.length;C+=1)for(let _=0;_<p[C].length;_+=1)m.push(p[C][_]);return m},this.getSourceData=function(f,m,p,C){let _;return f===void 0?_=u.getData():_=u.getByRange(s._createCellCoords(f,m),s._createCellCoords(p,C)),_},this.getSourceDataArray=function(f,m,p,C){let _;return f===void 0?_=u.getData(!0):_=u.getByRange(s._createCellCoords(f,m),s._createCellCoords(p,C),!0),_},this.getSourceDataAtCol=function(f){return u.getAtColumn(f)},this.setSourceDataAtCell=function(f,m,p,C){const _=Be(f,m,p),O=this.hasHook("afterSetSourceDataAtCell"),I=[],A=(B,H)=>{const ee=this.toVisualRow(B),ne=this.toVisualColumn(H);return Number.isInteger(ne)?this.getCellMeta(ee,ne):{...Object.getPrototypeOf(y),...y}};O&&z(_,B=>{let[H,ee,ne]=B;const ce=sg(ne,A(H,ee));I.push([H,ee,u.getAtCell(H,ee),ce])}),z(_,B=>{let[H,ee,ne]=B;const ce=sg(ne,A(H,ee));u.setAtCell(H,ee,ce)}),O&&this.runHooks("afterSetSourceDataAtCell",I,C),this.render();const j=s.getActiveEditor();j&&ue(j.refreshValue)&&j.refreshValue()},this.getSourceDataAtRow=function(f){return u.getAtRow(f)},this.getSourceDataAtCell=function(f,m){return u.getAtCell(f,m)},this.getDataAtRow=function(f){return l.getRange(s._createCellCoords(f,0),s._createCellCoords(f,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(f,m,p,C){const _=f===void 0?[0,0,this.countRows(),this.countCols()]:[f,m,p,C],[O,I]=_;let[,,A,j]=_,B=null,H=null;A===void 0&&(A=O),j===void 0&&(j=I);let ee="mixed";return Rt(Math.max(Math.min(O,A),0),Math.max(O,A),ne=>{let ce=!0;return Rt(Math.max(Math.min(I,j),0),Math.max(I,j),Ge=>(H=this.getCellMeta(ne,Ge).type,B?ce=B===H:B=H,ce)),ee=ce?H:"mixed",ce}),ee},this.removeCellMeta=function(f,m,p){const[C,_]=[this.toPhysicalRow(f),this.toPhysicalColumn(m)];let O=T.getCellMetaKeyValue(C,_,p);s.runHooks("beforeRemoveCellMeta",f,m,p,O)!==!1&&(T.removeCellMeta(C,_,p),s.runHooks("afterRemoveCellMeta",f,m,p,O)),O=null},this.spliceCellsMeta=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,C=new Array(p>2?p-2:0),_=2;_<p;_++)C[_-2]=arguments[_];if(C.length>0&&!Array.isArray(C[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&T.removeRow(this.toPhysicalRow(f),m),C.length>0&&z(C.reverse(),O=>{T.createRow(this.toPhysicalRow(f)),z(O,(I,A)=>this.setCellMetaObject(f,A,I))}),s.render()},this.setCellMetaObject=function(f,m,p){typeof p=="object"&&Me(p,(C,_)=>{this.setCellMeta(f,m,_,C)})},this.setCellMeta=function(f,m,p,C){if(s.runHooks("beforeSetCellMeta",f,m,p,C)===!1)return;let O=f,I=m;f<this.countRows()&&(O=this.toPhysicalRow(f)),m<this.countCols()&&(I=this.toPhysicalColumn(m)),T.setCellMeta(O,I,p,C),s.runHooks("afterSetCellMeta",f,m,p,C)},this.getCellsMeta=function(){return T.getCellsMeta()},this.getCellMeta=function(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},C=this.toPhysicalRow(f),_=this.toPhysicalColumn(m);return C===null&&(C=f),_===null&&(_=m),T.getCellMeta(C,_,{visualRow:f,visualColumn:m,...p})},this.getColumnMeta=function(f){return T.getColumnMeta(this.toPhysicalColumn(f))},this.getCellMetaAtRow=function(f){return T.getCellsMetaAtRow(f)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||y.columns)},this.getCellRenderer=function(f,m){const p=typeof f=="number"?s.getCellMeta(f,m).renderer:f.renderer;return typeof p=="string"?fS(p):$t(p)?fS("text"):p},this.getCellEditor=function(f,m){const p=typeof f=="number"?s.getCellMeta(f,m).editor:f.editor;return typeof p=="string"?ZC(p):$t(p)?ZC("text"):p},this.getCellValidator=function(f,m){const p=typeof f=="number"?s.getCellMeta(f,m).validator:f.validator;return typeof p=="string"?Fk(p):p},this.validateCells=function(f){this._validateCells(f)},this.validateRows=function(f,m){if(!Array.isArray(f))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,f)},this.validateColumns=function(f,m){if(!Array.isArray(f))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,f)},this._validateCells=function(f,m,p){const C=new tt;f&&(C.onQueueEmpty=f);let _=s.countRows()-1;for(;_>=0;){if(m!==void 0&&m.indexOf(_)===-1){_-=1;continue}let O=s.countCols()-1;for(;O>=0;){if(p!==void 0&&p.indexOf(O)===-1){O-=1;continue}C.addValidatorToQueue(),s.validateCell(s.getDataAtCell(_,O),s.getCellMeta(_,O),I=>{if(typeof I!="boolean")throw new Error("Validation error: result is not boolean");I===!1&&(C.valid=!1),C.removeValidatorFormQueue()},"validateCells"),O-=1}_-=1}C.checkIfQueueIsEmpty()},this.getRowHeader=function(f){let m=y.rowHeaders,p=f;return p!==void 0&&(p=s.runHooks("modifyRowHeader",p)),p===void 0?(m=[],Rt(s.countRows()-1,C=>{m.push(s.getRowHeader(C))})):Array.isArray(m)&&m[p]!==void 0?m=m[p]:Se(m)?m=m(p):m&&typeof m!="string"&&typeof m!="number"&&(m=p+1),m},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let f=0,m=s.countCols();f<m;f++)if(s.getColHeader(f))return!0;return!1},this.getColHeader=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=s.runHooks("modifyColHeader",f);if(p===void 0){const A=[],j=s.countCols();for(let B=0;B<j;B++)A.push(s.getColHeader(B));return A}let C=y.colHeaders;const _=function(A){const j=[],B=s.countCols();let H=0;for(;H<B;H++)Se(y.columns)&&y.columns(H)&&j.push(H);return j[A]},O=s.toPhysicalColumn(p),I=_(O);return y.colHeaders===!1?C=null:y.columns&&Se(y.columns)&&y.columns(I)&&y.columns(I).title?C=y.columns(I).title:y.columns&&y.columns[O]&&y.columns[O].title?C=y.columns[O].title:Array.isArray(y.colHeaders)&&y.colHeaders[O]!==void 0?C=y.colHeaders[O]:Se(y.colHeaders)?C=y.colHeaders(O):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(C=BV(p)),C=s.runHooks("modifyColumnHeaderValue",C,f,m),C},this._getColWidthFromSettings=function(f){let m;if(f>=0&&(m=s.getCellMeta(0,f).width),(m===void 0||m===y.width)&&(m=y.colWidths),m!=null){switch(typeof m){case"object":m=m[f];break;case"function":m=m(f);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(f,m){let p=s._getColWidthFromSettings(f);return p=s.runHooks("modifyColWidth",p,f,m),p===void 0&&(p=yp),p},this._getRowHeightFromSettings=function(f){const m=s.stylesHandler.getDefaultRowHeight();let p=y.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[f];break;case"function":p=p(f);break}typeof p=="string"&&(p=parseInt(p,10))}return p!=null&&p<m?m:p},this.getRowHeight=function(f,m){let p=s._getRowHeightFromSettings(f);return p=s.runHooks("modifyRowHeight",p,f,m),p},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const f=y.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(f,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return hS(s.countRows()-1,p=>{if(s.isEmptyRow(p))m+=1;else if(f===!0)return!1}),m},this.countEmptyCols=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return hS(s.countCols()-1,p=>{if(s.isEmptyCol(p))m+=1;else if(f===!0)return!1}),m},this.isEmptyRow=function(f){return y.isEmptyRow.call(s,f)},this.isEmptyCol=function(f){return y.isEmptyCol.call(s,f)},this.selectCell=function(f,m,p,C){let _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return $t(f)||$t(m)?!1:this.selectCells([[f,m,p,C]],_,O)},this.selectCells=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&g.suspend();const C=L.selectCells(f);return C&&p&&s.listen(),g.resume(),C},this.selectColumns=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;return L.selectColumns(f,m,p)},this.selectRows=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;return L.selectRows(f,m,p)},this.deselectCell=function(){L.deselect()},this.selectAll=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;g.skipNextScrollCycle(),L.selectAll(f,m,p)};const Ie=(f,m)=>f.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(f,m){if(typeof f=="number"){var p;f={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(p=arguments[4])!==null&&p!==void 0?p:!0}}const{row:C,col:_,considerHiddenIndexes:O}=f??{};let I=C,A=_;if(Se(m)&&this.addHookOnce("afterScroll",m),O===void 0||O){const ee=Number.isInteger(C)&&C>=0,ne=Number.isInteger(_)&&_>=0,ce=ee?Ie(this.rowIndexMapper,C):void 0,Ge=ne?Ie(this.columnIndexMapper,_):void 0;if(ce===null||Ge===null)return!1;I=ee?s.rowIndexMapper.getRenderableFromVisualIndex(ce):C,A=ne?s.columnIndexMapper.getRenderableFromVisualIndex(Ge):_}const j=Number.isInteger(I),B=Number.isInteger(A);let H=!1;return j&&I>=0&&B&&A>=0?H=s.view.scrollViewport(s._createCellCoords(I,A),f.horizontalSnap,f.verticalSnap):j&&I>=0&&(B&&A<0||!B)?H=s.view.scrollViewportVertically(I,f.verticalSnap):B&&A>=0&&(j&&I<0||!j)&&(H=s.view.scrollViewportHorizontally(A,f.horizontalSnap)),Se(m)&&(H?this.view.render():(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m()))),H},this.scrollToFocusedCell=function(f){if(!this.selection.isSelected())return!1;Se(f)&&this.addHookOnce("afterScroll",f);const{highlight:m}=this.getSelectedRangeActive(),p=this.scrollViewportTo(m.toObject());return p?this.view.render():Se(f)&&(this.removeHook("afterScroll",f),this._registerMicrotask(()=>f())),p},this.destroy=function(){s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,eo(this)&&fj(),this.getShortcutManager().destroy(),P.clear(),T.clearCache(),hg.delete(this.guid),a.destroy(),h&&h.destroy(),s.rootContainer&&Cs(s.rootContainer),s.rootPortalElement&&s.rootPortalElement.remove(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),x.getItems().forEach(f=>{let[,m]=f;m.destroy()}),x.clear(),s.runHooks("afterDestroy")},!0),we.getSingleton().destroy(s),Me(s,(f,m,p)=>{Se(f)?p[m]=zr(m):m!=="guid"&&(p[m]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,L=null,h=null,s=null};function zr(f){return()=>{throw new Error(`The "${f}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(f){return x.getItem(lc(f))},this.getPluginName=function(f){return f===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:x.getId(f)},this.getInstance=function(){return s},this.addHook=function(f,m,p){we.getSingleton().add(f,m,s,p)},this.hasHook=function(f){return we.getSingleton().has(f,s)||we.getSingleton().has(f)},this.addHookOnce=function(f,m,p){we.getSingleton().once(f,m,s,p)},this.removeHook=function(f,m){we.getSingleton().remove(f,m,s)},this.runHooks=function(f,m,p,C,_,O,I){return we.getSingleton().run(s,f,m,p,C,_,O,I)},this.getTranslatedPhrase=function(f,m){return FO(y.language,f,m)},this.toHTML=()=>lS(this),this.toTableElement=()=>{const f=this.rootDocument.createElement("div");return f.insertAdjacentHTML("afterbegin",lS(this)),f.firstElementChild},this.timeouts=[],this.useTheme=f=>{const m=!!w;this.stylesHandler.useTheme(f);const p=this.stylesHandler.getThemeName();m||(s.render(),s.scrollViewportTo(0,0),_R(this.rootContainer)&&(Oe(this.rootContainer,/ht-theme-.*/g),p&&K(this.rootContainer,p))),this.runHooks("afterSetTheme",p,m)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=f;typeof p=="function"&&(p=setTimeout(p,m)),this.timeouts.push(p)},this._clearTimeouts=function(){z(this.timeouts,f=>{clearTimeout(f)})},this.immediates=[],this._registerImmediate=function(f){this.immediates.push(setImmediate(f))},this._clearImmediates=function(){z(this.immediates,f=>{clearImmediate(f)})},this._registerMicrotask=function(f){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||f()})},this._getEditorManager=function(){return h};const be=nj({handleEvent(){return s.isListening()},beforeKeyDown:f=>this.runHooks("beforeKeyDown",f),afterKeyDown:f=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",f)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",f=>{f.ctrlKey===!1&&f.metaKey===!1&&be.releasePressedKeys()}),this.getShortcutManager=function(){return be},this.getFocusManager=function(){return d},W_().forEach(f=>{const m=vp(f);x.addItem(f,new m(this))}),W$(s),be.setActiveContextName("grid"),we.getSingleton().run(s,"construct")}function AR(t,e,r){t.addEventListener(e,r,!1)}function NR(t,e,r){t.removeEventListener(e,r,!1)}function jl(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function gj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},n=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=r.textContent(s),o.style.position="absolute",o.style.fontSize=jl(s).fontSize,o.style.fontFamily=jl(s).fontFamily,o.style.whiteSpace="pre",n.appendChild(o);const g=parseInt(((h=jl(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),w=parseInt(((d=jl(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),v=o.clientWidth+g+w+1;n.removeChild(o);const b=s.style;b.height=`${r.minHeight}px`,r.minWidth>v?b.width=`${r.minWidth}px`:v>r.maxWidth?b.width=`${r.maxWidth}px`:b.width=`${v}px`;const E=s.scrollHeight?s.scrollHeight-1:0;r.minHeight>E?b.height=`${r.minHeight}px`:r.maxHeight<E?(b.height=`${r.maxHeight}px`,b.overflowY="visible"):b.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")r.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(r.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")r.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(r.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")r.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(r.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")r.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(r.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${r.minHeight}px`,s.style.minWidth=`${r.minWidth}px`,s.style.maxWidth=`${r.maxWidth}px`,s.style.overflowY="hidden"),g&&(AR(s,"input",a),AR(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){NR(s,"input",a),NR(s,"keydown",l)}}}function DR(t,e){const r=SD(e),n=e.value.split(`
`);let i=r,o=0;for(let s=0;s<n.length;s++){const a=n[s];s!==0&&(o+=n[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),r<=l)break}__(e,i)}function Gi(t,e,r){return(e=mj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mj(t){var e=pj(t,"string");return typeof e=="symbol"?e:e+""}function pj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const wj="ht_editor_visible",zl="ht_editor_hidden",kR="textEditor",vj="text";class yj extends hw{static get EDITOR_TYPE(){return vj}constructor(e){super(e),Gi(this,"eventManager",new Pi(this)),Gi(this,"autoResize",gj(this.hot.rootDocument)),Gi(this,"TEXTAREA",void 0),Gi(this,"textareaStyle",void 0),Gi(this,"TEXTAREA_PARENT",void 0),Gi(this,"textareaParentStyle",void 0),Gi(this,"layerClass",void 0),this.eventManager=new Pi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),au(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,o,s){const a=this.state;if(super.prepare(e,r,n,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==ot.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===ot.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),__(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Re(this.TEXTAREA,[["data-hot-input",""],Po(-1)]),K(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),K(this.TEXTAREA_PARENT,"handsontableInputHolder"),me(this.TEXTAREA_PARENT,this.layerClass)&&Oe(this.TEXTAREA_PARENT,this.layerClass),K(this.TEXTAREA_PARENT,zl),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){fD()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Oe(this.TEXTAREA_PARENT,this.layerClass),K(this.TEXTAREA_PARENT,zl)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;Rt(e.length-1,n=>{const i=e[n];if(me(i,"handsontableEditor"))return r=!0,!1}),me(this.TEXTAREA_PARENT,zl)&&Oe(this.TEXTAREA_PARENT,zl),r?(this.layerClass=wj,K(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),K(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==ot.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){p_()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===ot.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===ot.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>ue(this.hot.getSelected()),group:kR},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;DR(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;DR(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(kR)}}const bj="base",Cj="htTextEllipsis";function tM(t,e,r,n,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&K(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(IC())):a&&c.push(IC()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(HC())):(u.push(s.invalidCellClassName),a&&c.push(HC()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(Cj),Oe(e,u),K(e,l),tl(e,c),Re(e,h)}tM.RENDERER_TYPE=bj;const Sj="text";function rM(t,e,r,n,i,o,s){tM.apply(this,[t,e,r,n,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=lp(a),s.trimWhitespace&&(a=a.trim()),rl(e,a)}rM.RENDERER_TYPE=Sj;const Rj="text",Ej={CELL_TYPE:Rj,editor:yj,renderer:rM};fB(Ej);ln.editors={BaseEditor:hw};function ln(t,e){const r=new eM(t,e||{},Np);return r.init(),r}ln.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new eM(t,e,Np)};ln.DefaultSettings=zO();ln.hooks=we.getSingleton();ln.CellCoords=mo;ln.CellRange=nl;ln.packageName="handsontable";ln.buildDate="15/09/2025 10:06:12";ln.version="16.1.0";ln.languages={dictionaryKeys:CW,getLanguageDictionary:LO,getLanguagesDictionaries:_W,registerLanguageDictionary:kO,getTranslatedPhrase:FO};function Tj(t,e){nM(t,e),e.add(t)}function qo(t,e,r){return(e=_j(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _j(t){var e=Oj(t,"string");return typeof e=="symbol"?e:e+""}function Oj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function LR(t,e,r){nM(t,e),e.set(t,r)}function nM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ul(t,e,r){return t.set(fw(t,e),r),r}function ze(t,e){return t.get(fw(t,e))}function fw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const FR=new Map([["plugin",Hk],["cell-type",jO],["editor",N_],["renderer",B_],["validator",$_]]),Mj=Symbol("mainSetting"),Ij="base",Yl=[];let Ki=null;var Xe=new WeakMap,Xi=new WeakMap,VR=new WeakSet;class gw{static get PLUGIN_KEY(){return Ij}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(e){Tj(this,VR),LR(this,Xe,null),qo(this,"eventManager",new Pi(this)),qo(this,"pluginName",null),qo(this,"pluginsInitializedCallbacks",[]),qo(this,"isPluginsReady",!1),qo(this,"enabled",!1),qo(this,"initialized",!1),LR(this,Xi,{}),Jn(this,"hot",e,{writable:!1}),Ki=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(o=>{const[s,a]=o.split(":");if(!FR.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);FR.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Yl.push(o)}}if(Ki||(Ki=W_()),Ki.indexOf(this.pluginName)>=0&&Ki.splice(Ki.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Ki.length===0){if(Yl.length>0){const i=[`${Yl.join(`
`)}
`,"You have to import and register them manually."].join("");throw Yl.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const r=this.constructor.DEFAULT_SETTINGS;if(e===void 0)return Qe(ze(Xe,this))?su(ze(Xe,this),r):ze(Xe,this);if((Array.isArray(ze(Xe,this))||Qe(ze(Xe,this)))&&r[Mj]===e){var n;return Array.isArray(ze(Xe,this))?ze(Xe,this):(n=ze(Xe,this)[e])!==null&&n!==void 0?n:r[e]}if(e.includes(".")){const i=Yg(ze(Xe,this),e),o=Yg(r,e);return Qe(i)?su(i,o):i!==void 0?i:o}return Qe(ze(Xe,this))?su(ze(Xe,this),r)[e]:r[e]}updatePluginSettings(e){const r=this.constructor.SETTINGS_VALIDATORS;if(r&&typeof r=="function"&&typeof e!="object"){if(r(e)===!1){on(`${this.pluginName} Plugin: option is not valid and it will be ignored.`);return}return Ul(Xe,this,e),ze(Xe,this)}return r&&typeof r=="object"&&typeof e=="object"?((ze(Xe,this)===null||typeof ze(Xe,this)!="object")&&Ul(Xe,this,{...this.constructor.DEFAULT_SETTINGS}),Object.keys(r).forEach(n=>{if(!(n in e))return;const i=r[n];if((i?i(e[n]):!0)===!1){on(`${this.pluginName} Plugin: "${n}" option is not valid and it will be ignored.`);return}ze(Xe,this)[n]=e[n]}),ze(Xe,this)):(Ul(Xe,this,e),e)}addHook(e,r,n){ze(Xi,this)[e]=ze(Xi,this)[e]||[];const i=ze(Xi,this)[e];this.hot.addHook(e,r,n),i.push(r),ze(Xi,this)[e]=i}removeHooks(e){z(ze(Xi,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=ze(Xi,this);Me(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){z(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=fw(VR,this,Hj).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&(this.updatePluginSettings(e[this.constructor.PLUGIN_KEY]),this.updatePlugin(e)))}updatePlugin(){}destroy(){var e;Ul(Xe,this,null),(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Me(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function Hj(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function Zi(t,e,r){return(e=Pj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pj(t){var e=xj(t,"string");return typeof e=="symbol"?e:e+""}function xj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Aj{constructor(e){Zi(this,"hot",null),Zi(this,"container",null),Zi(this,"injected",!1),Zi(this,"rows",[]),Zi(this,"columns",[]),Zi(this,"samples",null),Zi(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&K(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),z(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),z(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{z(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(o=>{z(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=r.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),n.appendChild(c)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{z(i.strings,o=>{const s=o.col,a=e.createElement("th");n.push([s,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),z(n,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{z(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=r.createElement("td"),c=r.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),n.appendChild(c)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return n.style.width=`${o}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),o=r.createElement("thead"),s=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),u=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),K(i,e),n.appendChild(i),{fragment:n,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return K(i,o),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}function la(t,e,r){return(e=Nj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nj(t){var e=Dj(t,"string");return typeof e=="symbol"?e:e+""}function Dj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mw{static get SAMPLE_COUNT(){return 3}constructor(e){la(this,"samples",null),la(this,"dataFactory",null),la(this,"customSampleCount",null),la(this,"allowDuplicates",!1),la(this,"includeHidden",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:mw.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}setIncludeHidden(e){this.includeHidden=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:o,to:s}=typeof n=="number"?{from:n,to:n}:n;return Rt(o,s,a=>{const l=this.generateSample(e,r,a);i.set(a,l)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return Rt(r.from,r.to,a=>{const l=e==="row"?this.dataFactory(n,a,this):this.dataFactory(a,n,this);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Qe(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${lp(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const g=i.get(d);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}function kj(t,e){iM(t,e),e.add(t)}function dg(t,e,r){iM(t,e),e.set(t,r)}function iM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ua(t,e,r){return(e=Lj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lj(t){var e=Fj(t,"string");return typeof e=="symbol"?e:e+""}function Fj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Si(t,e){return t.get(tr(t,e))}function Lu(t,e,r){return t.set(tr(t,e),r),r}function tr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}we.getSingleton().register("modifyAutoColumnSizeSeed");const fg="autoColumnSize",Vj=10,Wj="autoColumnSize";var pw=new WeakMap,ns=new WeakMap,Rs=new WeakMap,fr=new WeakSet;class Ha extends gw{static get PLUGIN_KEY(){return fg}static get PLUGIN_PRIORITY(){return Vj}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),kj(this,fr),ua(this,"ghostTable",new Aj(this.hot)),ua(this,"samplesGenerator",new mw((r,n)=>{const i=this.hot.toPhysicalRow(r),o=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(r,n);let a="";s.spanned||(a=this.hot.getDataAtCell(r,n));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),ua(this,"inProgress",!1),ua(this,"measuredColumns",0),ua(this,"columnWidthsMap",new mc),dg(this,pw,!1),dg(this,ns,[]),dg(this,Rs,[]),this.hot.columnIndexMapper.registerMap(Wj,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>tr(fr,this,WR).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[fg]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return tr(fr,e,jj).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return tr(fr,e,zj).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return tr(fr,e,Yj).call(e,...i)}),this.addHook("beforeRender",()=>tr(fr,this,$j).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>tr(fr,this,Uj).call(this)),super.enablePlugin()}updatePlugin(){Lu(Rs,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>tr(fr,this,WR).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof r=="number"?{from:r,to:r}:r;Rt(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&tr(fr,this,oM).call(this,s,o)}),this.ghostTable.columns.length&&(tr(fr,this,sM).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){NC(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+Ha.CALCULATION_STEP,i)},e,r),n=n+Ha.CALCULATION_STEP+1,n<i?o=qg(s):(NC(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),n=a+1),n<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[fg];let r=Ha.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return Qe(e)&&(r=e.syncLimit,$N(r)?r=bk(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,yp))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,o)=>{const s=Si(ns,this).length;return(s-1<o||Si(ns,this)[o]!==i)&&n.push(this.hot.toVisualColumn(o)),s-1<o?Si(ns,this).push(i):Si(ns,this)[o]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Bj(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||tr(fr,this,oM).call(this,r,e))}),this.ghostTable.columns.length&&(tr(fr,this,sM).call(this),this.ghostTable.clean())}function oM(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((n,i)=>this.ghostTable.addColumn(i,n))}function sM(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0)}function $j(){this.calculateVisibleColumnsWidth(),this.inProgress||(tr(fr,this,Bj).call(this,Si(Rs,this)),Lu(Rs,this,[]))}function jj(t,e){e||this.recalculateAllColumnsWidth()}function zj(t){const e=t.reduce((r,n)=>{let[,i]=n;const o=this.hot.propToCol(i);return Number.isInteger(o)&&r.indexOf(o)===-1&&r.push(o),r},[]);Si(Rs,this).push(...e)}function WR(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function Uj(){Lu(ns,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Lu(pw,this,!0)}function Yj(t){if(!Si(pw,this))return;const e=t.reduce((r,n)=>{var i;const o=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);r.indexOf(s)===-1&&r.push(s)}return r},[]);Si(Rs,this).push(...e)}function qj(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Gj(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Qi(t,e){const r={};return z(t,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&(r[i]||(r[i]=[]),r[i][o]=e(i,o))})}),r}function Ji(t,e,r,n,i){z(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Kj(s,a,e,r,n,i)})})}function Kj(t,e,r,n,i,o){const s=i(t,e);let a=n;s.className&&(r==="vertical"?a=qj(s.className,n):a=Gj(s.className,n)),o(t,e,"className",a)}function Xj(t){return`<span class="selected">✓</span>${t}`}function gg(t,e){let r=!1;return Array.isArray(t)&&z(t,n=>(n.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return r=!0,!1}),r)),r}function aM(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:o}=n.getBoundingClientRect();r.top=i,r.left=o}return r}const Et="---------";function Zj(){return{name:Et}}const Jr="alignment";function Qj(){return{key:Jr,name(){return this.getTranslatedPhrase(Zp)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeActive();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Jr}:left`,name(){return this.getTranslatedPhrase(Qp)},callback(){const t=this.getSelectedRange(),e=Qi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),Ji(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Jr}:center`,name(){return this.getTranslatedPhrase(Jp)},callback(){const t=this.getSelectedRange(),e=Qi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),Ji(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Jr}:right`,name(){return this.getTranslatedPhrase(ew)},callback(){const t=this.getSelectedRange(),e=Qi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),Ji(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Jr}:justify`,name(){return this.getTranslatedPhrase(tw)},callback(){const t=this.getSelectedRange(),e=Qi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),Ji(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Et},{key:`${Jr}:top`,name(){return this.getTranslatedPhrase(rw)},callback(){const t=this.getSelectedRange(),e=Qi(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),Ji(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Jr}:middle`,name(){return this.getTranslatedPhrase(nw)},callback(){const t=this.getSelectedRange(),e=Qi(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),Ji(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Jr}:bottom`,name(){return this.getTranslatedPhrase(iw)},callback(){const t=this.getSelectedRange(),e=Qi(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),Ji(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const ww="clear_column";function Jj(){return{key:ww,name(){return this.getTranslatedPhrase(Up)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((r,n)=>{if(r<0||n<0)return!0;const{readOnly:i}=this.getCellMeta(r,n);return i?!0:(e=!0,!1)}),!e}}}const Cc="col_left";function ez(){return{key:Cc,name(){return this.getTranslatedPhrase(Vp)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Sc="col_right";function tz(){return{key:Sc,name(){return this.getTranslatedPhrase(Wp)},callback(){const t=this.getSelectedRangeActive().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Rc="make_read_only";function rz(){return{key:Rc,checkable:!0,ariaChecked(){return gg(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Au)},name(){let t=this.getTranslatedPhrase(Au);return gg(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=Xj(t)),t},callback(){const t=this.getSelectedRange(),e=gg(t,(r,n)=>this.getCellMeta(r,n).readOnly);z(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeActive();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Ec="redo";function nz(){return{key:Ec,name(){return this.getTranslatedPhrase(zp)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Tc="remove_col";function iz(){return{key:Tc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase($p,e)},callback(){this.alter("remove_col",eB(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const _c="remove_row";function oz(){return{key:_c,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(Bp,e)},callback(){this.alter("remove_row",tB(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Oc="row_above";function sz(){return{key:Oc,name(){return this.getTranslatedPhrase(Lp)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const Mc="row_below";function az(){return{key:Mc,name(){return this.getTranslatedPhrase(Fp)},callback(){const t=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Wa="no_items";function lz(){return{key:Wa,name(){return this.getTranslatedPhrase(kp)},disabled:!0,isCommand:!1}}const Ic="undo";function uz(){return{key:Ic,name(){return this.getTranslatedPhrase(jp)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const cz=[Oc,Mc,Cc,Sc,ww,_c,Tc,Ic,Ec,Rc,Jr,Et,Wa],hz={[Et]:Zj,[Wa]:lz,[Oc]:sz,[Mc]:az,[Cc]:ez,[Sc]:tz,[ww]:Jj,[_c]:oz,[Tc]:iz,[Ic]:uz,[Ec]:nz,[Rc]:rz,[Jr]:Qj};function lM(){const t={};return Me(hz,(e,r)=>{t[r]=e()}),t}function mg(t,e,r){return(e=dz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dz(t){var e=fz(t,"string");return typeof e=="symbol"?e:e+""}function fz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gz{constructor(e){mg(this,"hot",void 0),mg(this,"commands",{}),mg(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=mz(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Fr(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),n.unshift(o.join(":")),z(u,c=>c.apply(this.hot,n))}}function mz(t,e){let r;return z(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function pg(t,e,r){return(e=pz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pz(t){var e=wz(t,"string");return typeof e=="symbol"?e:e+""}function wz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vz{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;pg(this,"hot",void 0),pg(this,"predefinedItems",lM()),pg(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,Me(e,(n,i)=>{let o="";n.name===Et?(r[Et]=n,o=Et):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,o=n.key):(r[n.key]=n,o=n.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return yz(e,this.defaultOrderPattern,this.predefinedItems)}}function yz(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Qe(i)?Me(i,(o,s)=>{let a=r[typeof o=="string"?o:s];a||(a=o),Qe(o)?Ii(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),n.push(a)}):z(i,(o,s)=>{let a=r[o];!a&&cz.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Qe(o)&&Ii(a,o),a.key===void 0&&(a.key=s),n.push(a))}),n}function ci(t,e,r){return(e=bz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bz(t){var e=Cz(t,"string");return typeof e=="symbol"?e:e+""}function Cz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sz{constructor(e,r){ci(this,"top",void 0),ci(this,"topRelative",void 0),ci(this,"left",void 0),ci(this,"leftRelative",void 0),ci(this,"scrollTop",void 0),ci(this,"scrollLeft",void 0),ci(this,"cellHeight",void 0),ci(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let o,s,a,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=n,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-n,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function ca(t,e,r){Rz(t,e),e.set(t,r)}function Rz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function re(t,e){return t.get(uM(t,e))}function ql(t,e,r){return t.set(uM(t,e),r),r}function uM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ft=new WeakMap,Xt=new WeakMap,Zt=new WeakMap,wg=new WeakMap,Go=new WeakMap;class Ez{constructor(e){ca(this,Ft,void 0),ca(this,Xt,void 0),ca(this,Zt,void 0),ca(this,wg,!1),ca(this,Go,{above:0,below:0,left:0,right:0}),ql(wg,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return re(Go,this)[e]=r,this}setElement(e){return ql(Ft,this,e),this}setParentElement(e){return ql(Xt,this,e),this}updatePosition(e){ql(Zt,this,new Sz(e,re(Ft,this).ownerDocument.defaultView)),re(wg,this)?(re(Zt,this).fitsBelow(re(Ft,this))?this.setPositionBelowCursor():re(Zt,this).fitsAbove(re(Ft,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){re(Ft,this).dir==="rtl"?re(Zt,this).fitsOnLeft(re(Ft,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():re(Zt,this).fitsOnRight(re(Ft,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=re(Go,this).above+re(Zt,this).top-re(Ft,this).offsetHeight;if(re(Xt,this)){const n=re(Xt,this).ownerDocument.defaultView.getComputedStyle(re(Xt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=re(Zt,this).top+re(Zt,this).cellHeight-re(Ft,this).scrollHeight+i+o}re(Ft,this).style.top=`${e}px`}setPositionBelowCursor(){let e=re(Go,this).below+re(Zt,this).top+1;if(re(Xt,this)){const n=re(Xt,this).ownerDocument.defaultView.getComputedStyle(re(Xt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=re(Zt,this).top-i-o}re(Ft,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=re(Zt,this).left;if(re(Xt,this)){const r=re(Xt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(re(Xt,this).querySelector(".htCore")).borderRightWidth,10);e+=re(Zt,this).cellWidth+n}else e+=re(Go,this).right;re(Ft,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=re(Go,this).left+re(Zt,this).left-re(Ft,this).offsetWidth;if(re(Xt,this)){const r=re(Xt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(re(Xt,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}re(Ft,this).style.left=`${e}px`}}function Tz(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=He(e,-1,v()-1);function a(E,R){const T=v()-1;return E<0&&(E=T),E>T&&(E=0),o.has(E)?-1:(o.add(E),n(E,!1)===!1&&(E=a(R===1?++E:--E,R)),E)}function l(E){E>-1&&E<v()&&n(E,!0)!==!1&&(s=E)}function u(E){E>-1&&E<v()&&(s=E)}function c(){return s}function h(){v()>0&&(o.clear(),s=a(0,1))}function d(){v()>0&&(o.clear(),s=a(v()-1,-1))}function g(){v()>0&&(o.clear(),s=a(++s,1))}function w(){v()>0&&(o.clear(),s=a(--s,-1))}function v(){return Math.max(r(),0)}function b(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:g,toPreviousItem:w,getSize:v,clear:b}}function _z(t){return Mi(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function am(t){return Fr(t,"submenu")}function lm(t){return new RegExp(Et,"i").test(t.name)}function fu(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function BR(t){return Fr(t,"disableSelection")}function Oz(t){return me(t,"htSeparator")}function Mz(t){return me(t,"htSubmenu")}function Iz(t){return me(t,"htDisabled")}function Hz(t){return me(t,"htSelectionDisabled")}function Pz(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function cM(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function xz(t,e){let r=t.slice(0);return r.reverse(),r=cM(r,e),r.reverse(),r}function Az(t){const e=[];return z(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function Nz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Et,r=t.slice(0);return r=cM(r,e),r=xz(r,e),r=Az(r),r}function Dz(t){return t.checkable===!0}function kz(t){return Tz({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||Oz(n)||Iz(n)||Hz(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Lz(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(n):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const n=r.getSelectedActive();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{r.getSelectedActive()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedActive();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedActive()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedActive()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const hM="menu",$R=hM;function Fz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(Lz(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function n(u,c){a(c).addShortcuts(u,{group:hM})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:g}=d;g.forEach(w=>h.removeShortcutsByKeys(w))}),r.push({shortcuts:u,contextName:c}),n(u,c)}function o(){return[...r]}function s(u){return u?`${$R}:${u}`:$R}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function Vz(t){return(e,r,n,i,o,s)=>{const a=e.getSourceDataAtRow(n),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Cs(r),K(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!fu(a,t)&&!BR(a)&&!lm(a);Re(r,[...Dz(a)?[XN(),_u(c),rD(h)]:[KN(),_u(u)],...d?[Po(-1)]:[],...fu(a,t)?[eD()]:[],...am(a)?[ou(!1)]:[]])}r.className="",r.appendChild(l),lm(a)?K(r,"htSeparator"):typeof a.renderer=="function"?(K(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,n,i,o,u))):S_(l,u),fu(a,t)?K(r,"htDisabled"):BR(a)?K(r,"htSelectionDisabled"):am(a)&&K(r,"htSubmenu")}}function vg(t,e,r){Wz(t,e),e.set(t,r)}function Wz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wn(t,e,r){return(e=Bz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bz(t){var e=$z(t,"string");return typeof e=="symbol"?e:e+""}function $z(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yg(t,e,r){return t.set(dM(t,e),r),r}function hi(t,e){return t.get(dM(t,e))}function dM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const jR=215;var Ko=new WeakMap,Gl=new WeakMap,Kl=new WeakMap;class Hc{get tableBorderWidth(){return hi(Kl,this)===void 0&&this.hotMenu&&yg(Kl,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),hi(Kl,this)}constructor(e,r){var n=this;wn(this,"hot",void 0),wn(this,"options",void 0),wn(this,"eventManager",new Pi(this)),wn(this,"container",void 0),wn(this,"positioner",void 0),wn(this,"hotMenu",null),wn(this,"hotSubMenus",{}),wn(this,"parentMenu",void 0),wn(this,"menuItems",null),wn(this,"origOutsideClickDeselects",null),vg(this,Ko,void 0),vg(this,Gl,void 0),vg(this,Kl,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:jR,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new Ez(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(Oe(this.options.container,/ht-theme-.*/g),K(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=La(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return hi(Ko,this)}getKeyboardShortcutsCtrl(){return hi(Gl,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=H_(a=>this.openSubMenu(a),300),r=this.options.minWidth||jR;let n=!1,i=ap(this.menuItems,a=>(a.key===Wa&&(n=!0),Pz(a,this.hot)));if(i.length<1&&!n)i.push(lM()[Wa]);else if(i.length===0)return;i=Nz(i,Et);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ue(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Vz(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?hi(Ko,this).setCurrentPage(l.row):hi(Ko,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),DC()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!DC()||!Iu(a))&&o&&this.hasSelectedItem()&&(Ci()||w_()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),yg(Ko,this,kz(this.hotMenu)),yg(Gl,this,Fz(this)),hi(Gl,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(hi(Ko,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedActive();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);Re(n,[ou(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!Mz(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new Hc(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&Re(r,[ou(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Re(i,[ou(!1)])}}closeAllSubMenus(){z(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?_z(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||lm(e)||fu(e,this.hot)||am(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,o=parseInt(n.width,10),s=Ho(r,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?ir(this.hotMenu.getCell(u,0)):0;return a+(l.name===Et?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),n.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(Se(n)&&(n=n.call(this.hot),n===null||$t(n)?n="":n=n.toString()),n=n.replace(/[^A-Za-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),K(i,`htMenu handsontable ${this.options.className}`),n&&K(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Re(this.hotMenu.rootElement,[GN(),Po(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ms(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ms(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&me(e.target,"htCore")&&ms(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Ye(Hc,On);function jz(t,e){zz(t,e),e.add(t)}function zz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bg(t,e,r){return(e=Uz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uz(t){var e=Yz(t,"string");return typeof e=="symbol"?e:e+""}function Yz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Ca="contextMenu",qz=70,zR=Ca;we.getSingleton().register("afterContextMenuDefaultOptions");we.getSingleton().register("beforeContextMenuShow");we.getSingleton().register("afterContextMenuShow");we.getSingleton().register("afterContextMenuHide");we.getSingleton().register("afterContextMenuExecute");var ha=new WeakSet;class Pc extends gw{constructor(){super(...arguments),jz(this,ha),bg(this,"commandExecutor",new gz(this.hot)),bg(this,"itemsFactory",null),bg(this,"menu",null)}static get PLUGIN_KEY(){return Ca}static get PLUGIN_PRIORITY(){return qz}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Oc,Mc,Et,Cc,Sc,Et,_c,Tc,Et,Ic,Ec,Et,Rc,Et,Jr]}isEnabled(){return!!this.hot.getSettings()[Ca]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[Ca];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new Hc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>Xl(ha,this,Kz).call(this)),this.menu.addLocalHook("afterOpen",()=>Xl(ha,this,Xz).call(this)),this.menu.addLocalHook("afterClose",()=>Xl(ha,this,Zz).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>Xl(ha,this,Gz).call(this,n)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=aM(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:zR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zR)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.prepareMenuItems(),this.menu.open(),Me(n,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new vz(this.hot,Pc.DEFAULT_ITEMS);const e=this.hot.getSettings()[Ca],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),z(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Gz(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),me(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(o)&&!(me(o,"current")&&me(o,"wtBorder"))))return;const s=aM(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Kz(){this.hot.runHooks("beforeContextMenuShow",this)}function Xz(){this.hot.runHooks("afterContextMenuShow",this)}function Zz(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Pc.SEPARATOR={name:Et};function Qz(t){return{key:"copy",name(){return this.getTranslatedPhrase(Yp)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Jz(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeActive(),r=e?He(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Kp,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function eU(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeActive(),r=e?He(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Gp,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function tU(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeActive(),r=e?He(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(qp,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function rU(t){return{key:"cut",name(){return this.getTranslatedPhrase(Xp)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class nU{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class iU{constructor(){this.clipboardData=new nU}preventDefault(){}composedPath(){return[]}}function oU(t,e){fM(t,e),e.add(t)}function Xo(t,e,r){fM(t,e),e.set(t,r)}function fM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vt(t,e){return t.get(ls(t,e))}function Zo(t,e,r){return t.set(ls(t,e),r),r}function ls(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var di=new WeakMap,Cg=new WeakMap,da=new WeakMap,um=new WeakMap,cm=new WeakMap,fa=new WeakMap,ga=new WeakSet;class sU{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;oU(this,ga),Xo(this,di,void 0),Xo(this,Cg,void 0),Xo(this,da,void 0),Xo(this,um,void 0),Xo(this,cm,void 0),Xo(this,fa,void 0),Zo(Cg,this,r),Zo(da,this,n),Zo(um,this,i),Zo(cm,this,o),Zo(fa,this,s)}setSelectedRange(e){Zo(di,this,e)}getCellsRange(){if(Vt(Cg,this).call(this)===0||Vt(da,this).call(this)===0)return null;const{row:e,col:r}=Vt(di,this).getTopStartCorner(),{row:n,col:i}=Vt(di,this).getBottomEndCorner(),o=ls(ga,this,aU).call(this,e,n),s=ls(ga,this,Sg).call(this,r,i);return{isRangeTrimmed:n!==o||i!==s,startRow:e,startCol:r,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Vt(da,this).call(this)===0||Vt(fa,this).call(this)===0)return null;const{col:e}=Vt(di,this).getTopStartCorner(),{col:r}=Vt(di,this).getBottomEndCorner(),n=ls(ga,this,Sg).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(Vt(da,this).call(this)===0||Vt(fa,this).call(this)===0)return null;const{col:e}=Vt(di,this).getTopStartCorner(),{col:r}=Vt(di,this).getBottomEndCorner(),n=ls(ga,this,Sg).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-Vt(fa,this).call(this),startCol:e,endRow:-1,endCol:n}}}function Sg(t,e){return Math.min(e,Math.max(t+Vt(cm,this).call(this)-1,t))}function aU(t,e){return Math.min(e,Math.max(t+Vt(um,this).call(this)-1,t))}function gM(t){const e=[],r=[];return z(t,n=>{const i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);Rt(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);Rt(s,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function lU(t,e){mM(t,e),e.add(t)}function fi(t,e,r){mM(t,e),e.set(t,r)}function mM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ma(t,e,r){return(e=uU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uU(t){var e=cU(t,"string");return typeof e=="symbol"?e:e+""}function cU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function er(t,e){return t.get(Pt(t,e))}function Zr(t,e,r){return t.set(Pt(t,e),r),r}function Pt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}we.getSingleton().register("afterCopyLimit");we.getSingleton().register("modifyCopyableRange");we.getSingleton().register("beforeCut");we.getSingleton().register("afterCut");we.getSingleton().register("beforePaste");we.getSingleton().register("afterPaste");we.getSingleton().register("beforeCopy");we.getSingleton().register("afterCopy");const Rg="copyPaste",hU=80,dU=["fragmentSelection"],pM="application/ht-source-data-json-html",UR=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var hm=new WeakMap,dm=new WeakMap,fm=new WeakMap,Qo=new WeakMap,Zl=new WeakMap,Ql=new WeakMap,Jo=new WeakMap,Fu=new WeakMap,Wt=new WeakSet;class fU extends gw{constructor(){super(...arguments),lU(this,Wt),ma(this,"columnsLimit",1/0),ma(this,"rowsLimit",1/0),ma(this,"pasteMode","overwrite"),ma(this,"uiContainer",this.hot.rootDocument.body),fi(this,hm,!1),fi(this,dm,!1),fi(this,fm,!1),fi(this,Qo,"cells-only"),fi(this,Zl,!1),fi(this,Ql,!1),fi(this,Jo,new sU({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),fi(this,Fu,!1),ma(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Rg}static get SETTING_KEYS(){return[Rg,...dU]}static get PLUGIN_PRIORITY(){return hU}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Rg]}enablePlugin(){var e,r,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Zr(hm,this,this.getSetting("copyColumnHeaders")),Zr(dm,this,this.getSetting("copyColumnGroupHeaders")),Zr(fm,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Pt(Wt,this,pU).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Pt(Wt,n,wU).call(n,...o)}),this.addHook("afterSelectionEnd",()=>Pt(Wt,this,vU).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),hp()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Pt(Wt,n,yU).call(n,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Pt(Wt,n,bU).call(n,...o)}),this.addHook("afterSelection",()=>Pt(Wt,this,CU).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Zr(Qo,this,e),Zr(Zl,this,!0),Pt(Wt,this,YR).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Zr(Ql,this,!0),Pt(Wt,this,YR).call(this,"cut")}getRangedCopyableData(e){return Nu(this.getRangedData(e))}getRangedData(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=[],{rows:i,columns:o}=gM(e);return z(i,s=>{const a=[];z(o,l=>{if(s<0)a.push(this.hot.getColHeader(l,s));else{let u=r?this.hot.getCopyableSourceData(s,l):this.hot.getCopyableData(s,l);r&&Qe(u)&&(u=JSON.stringify(u)),a.push(u)}}),n.push(a)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new iU;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeActive();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}er(Jo,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);er(Qo,this)==="column-headers-only"?r.set("headers",er(Jo,this).getMostBottomColumnHeadersRange()):(er(Qo,this)==="with-column-headers"?r.set("headers",er(Jo,this).getMostBottomColumnHeadersRange()):er(Qo,this)==="with-column-group-headers"&&r.set("headers",er(Jo,this).getAllColumnHeadersRange()),r.set("cells",er(Jo,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=n;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getSelectedRangeActive();if(!e.length)return[null,null,null,null];const i=e.length,o=e[0].length,s=[],{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner();let h=a,d=l,g=a,w=l;for(;s.length<i||h<=u;){const{skipRowOnPaste:b,visualRow:E}=this.hot.getCellMeta(h,l);if(h=E+1,b===!0)continue;g=E,d=l;const R=[],T=s.length%i;for(;R.length<o||d<=c;){var v;const{skipColumnOnPaste:y,visualCol:M}=this.hot.getCellMeta(E,d),x=this.hot.getSourceDataAtCell(E,d),P=R.length%o;if(d=M+1,y===!0)continue;w=M;const D=r==null||(v=r[T])===null||v===void 0?void 0:v[P];let F=e[T][P];if(r&&BN(D)){const W=JSON.parse(D);(Qe(x)||x===null)&&(F=W)}R.push(F)}s.push(R)}return Zr(Fu,this,!0),this.hot.populateFromArray(a,l,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,g,w]}onCopy(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!er(Zl,this)||this.isEditorOpened()||co(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!au(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Zr(Zl,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0),a=Pt(Wt,this,gU).call(this,this.copyableRanges);!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a)&&(Pt(Wt,this,qR).call(this,e,o,s),this.hot.runHooks("afterCopy",o,this.copyableRanges,a)),Zr(Qo,this,"cells-only")}onCut(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!er(Ql,this)||this.isEditorOpened()||co(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!au(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Zr(Ql,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0);!!this.hot.runHooks("beforeCut",o,this.copyableRanges)&&(Pt(Wt,this,qR).call(this,e,o,s),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges))}onPaste(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||co(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!au(r,this.hot.rootElement)))return;e.preventDefault();let o,s;if(e&&typeof e.clipboardData<"u"){const h=e.clipboardData.getData(pM);h&&(s=cS(h,this.hot.rootDocument).data);const d=l_(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});d&&/(<table)|(<TABLE)/g.test(d)?o=cS(d,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=sB(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[a,l,u,c]=this.populateValues(o,s);a!==null&&l!==null&&this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function YR(t){if(hp()){const e=this.hot.getSelectedRangeActive();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&OD(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function gU(t){const{rows:e}=gM(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function mU(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&M_(n)}}}function wM(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&I_(n)}}}function qR(t,e,r){const n=Nu(e);if(t&&t.clipboardData){const i=uS(e),o=uS(r);t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",[UR,i].join("")),t.clipboardData.setData(pM,[UR,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",n)}function pU(t){t.items.push({name:"---------"},Qz(this)),er(hm,this)&&t.items.push(tU(this)),er(dm,this)&&t.items.push(eU(this)),er(fm,this)&&t.items.push(Jz(this)),t.items.push(rU(this))}function wU(t,e,r,n,i){er(Fu,this)&&(i.value=!0),Zr(Fu,this,!1)}function vU(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function yU(){Pt(Wt,this,wM).call(this)}function bU(){Pt(Wt,this,mU).call(this)}function CU(){Pt(Wt,this,wM).call(this)}var SU=(t,e,r)=>{e()===""?r(!1):r()||r(!0)},RU=Uu('<div class="row align-items-center pb-1"><div class="col-4"><div class="form-check"><input class="form-check-input svelte-10olx4a" type="checkbox"/> <label class="form-check-label"> </label></div></div> <div class="col"><label class="visually-hidden"> </label> <input type="text" class="form-control form-control-sm svelte-10olx4a"/></div></div>'),EU=Uu('<div class="form-check"><input class="form-check-input svelte-10olx4a" type="checkbox"/> <label class="form-check-label"> </label></div>');function es(t,e){bm(e,!0);let r=Wc(e,"placeholder",3,""),n=Wc(e,"checked",15),i=Wc(e,"optional",15,null);var o=FI(),s=Ig(o);{var a=u=>{var c=RU(),h=mr(c),d=mr(h),g=mr(d),w=St(g,2),v=mr(w),b=St(h,2),E=mr(b),R=mr(E),T=St(E,2);T.__input=[SU,i,n],Hg(()=>{Fi(g,"id",e.id),g.disabled=i()==="",Fi(w,"for",e.id),Lc(v,e.id),Fi(E,"for",e.id+r()),Lc(R,r()),Fi(T,"id",e.id+r()),Fi(T,"placeholder",r())}),$w(g,n),YI(T,i),Ra(u,c)},l=u=>{var c=EU(),h=mr(c),d=St(h,2),g=mr(d);Hg(()=>{Fi(h,"id",e.id),Fi(d,"for",e.id),Lc(g,e.id)}),$w(h,n),Ra(u,c)};$I(s,u=>{i()!==null?u(a):u(l,!1)})}Ra(t,o),Cm()}PE(["input"]);class vM{tasks;constructor(...e){this.tasks=e}append(...e){this.tasks.push(...e)}process(e){let r=e,n=!0;for(;;){for(const i of this.tasks)(n||!i.once())&&(e=i.process(e));if(e===r)return r;r=e,n&&(n=!1)}}processAll(e){const r=[];for(const n of e){const i=this.process(n);r.push(i)}return r}}class gm{re;constructor(e){e.global||(e=new RegExp(e,"g")),this.re=e}once(){return!1}process(e){return e.replaceAll(this.re,"")}}class TU{sep;constructor(e){this.sep=e}once(){return!0}process(e){const r=e.indexOf(this.sep);return r===-1?e:e.substring(0,r)}}class _U{cutset;constructor(e){this.cutset=e}once(){return!1}process(e){return e.replaceAll(new RegExp(`^[${this.cutset}]+|[${this.cutset}]+$`,"g"),"")}}class Vu{isOnce;fn;constructor(e,r){this.isOnce=e,this.fn=r}once(){return this.isOnce}process(e){return this.fn(e)}}const OU=new Vu(!1,t=>t.trim()),MU=new Vu(!0,t=>{const e=t.match(/\S+/g);return e?e[0]:""}),IU=new vM(new gm(/\([^)]*\)/),new gm(/（[^）]*）/));var HU=kI(Uu(`<script src="https://cdn.jsdelivr.net/npm/opencc-js@1/dist/umd/full.min.js">
  <\/script><!>`,1)),PU=(t,e,r)=>{de(e,!le(e)),le(e)&&de(r,!1)},xU=(t,e,r)=>{de(e,!le(e)),le(e)&&de(r,!1)},AU=Uu('<header class="navbar navbar-expand navbar-light flex-column flex-md-row svelte-1n46o8q"><a class="navbar-brand text-primary m-0 mr-md-3" href="/" style="font-size:24px">Simple Text Processing</a></header> <div class="container-fluid svelte-1n46o8q"><div class="row h-100"><div id="input" class="col-5"></div> <div class="col-2 p-0 pt-5"><!> <!> <!> <br/> <div class="form-check"><input class="form-check-input" type="checkbox" id="t2s"/> <label class="form-check-label" for="t2s">繁 → 简</label></div> <div class="form-check"><input class="form-check-input" type="checkbox" id="s2t"/> <label class="form-check-label" for="s2t">简 → 繁</label></div> <br/> <!> <!> <!> <br/> <button type="button" class="btn btn-primary w-100">Process</button> <br/> <br/> <button type="button" class="btn btn-primary w-100">Copy Result</button> <br/> <br/> <button type="button" class="btn btn-danger w-100">Clear</button></div> <div id="result" class="col-5"></div></div></div>',1);function NU(t,e){bm(e,!0),Wf(Ha),Wf(Pc),Wf(fU);const r=64;let n=st(!1),i=st(!1),o=st(!1),s=st(!1),a=st(""),l=st(!1),u=st(""),c=st(!1),h=st(""),d=st(!0),g=st(!1),w=st(!1),v,b,E,R;const T=()=>{E=new Vu(!0,OpenCC.Converter({from:"cn",to:"t"})),R=new Vu(!0,OpenCC.Converter({from:"t",to:"cn"})),de(d,!1)},y=(p,C,_,O)=>{const I={autoColumnSize:!1,colHeaders:[C],colWidths(){return Math.round(window.innerWidth*.4166666667-r-24)},height(){return window.innerHeight-80-16},maxCols:1,rowHeaders:!0,rowHeaderWidth:r,startRows:1,tabMoves:{row:1,col:0},themeName:"ht-theme-main",licenseKey:"non-commercial-and-evaluation"};if(O)I.readOnly=!0,I.readOnlyCellClassName="",I.contextMenu=["copy"];else{try{I.data=JSON.parse(localStorage.getItem(_)||"")}catch{I.data=void 0}I.minSpareRows=1,I.contextMenu=["row_above","row_below","---------","remove_row","---------","undo","redo","---------","copy","cut"]}const A=new ln(document.getElementById(p),I);return O||(A.addHook("beforePaste",()=>A.updateSettings({readOnly:!0})),A.addHook("afterPaste",j=>{A.updateSettings({readOnly:!1}),A.deselectCell();for(let B=j.length-1;B>=0;B--)if(j[B][0]!==""){A.loadData(j.slice(0,B+1));return}A.loadData([[""]])})),A};GI(()=>{v=y("input","Data","data"),b=y("result","Result","",!0)});const M=p=>p.getDataAtCol(0).filter(C=>C!==null),x=()=>{const p=new vM;if(le(n)&&p.append(OU),le(i)&&p.append(MU),le(o)&&p.append(...IU.tasks),le(s)&&p.append(new _U(le(a))),le(l)&&p.append(new TU(le(u))),le(c)&&p.append(new gm(new RegExp(le(h)))),le(g)?p.append(E):le(w)&&p.append(R),!p.tasks.length){alert("No option selected.");return}de(d,!0);const C=p.processAll(M(v));b.loadData(C.map(_=>[_])),de(d,!1)},P=()=>{confirm("Clear all data and options?")&&(v.loadData([[""]]),b.loadData([[""]]),de(n,!1),de(i,!1),de(o,!1),de(s,!1),de(a,""),de(l,!1),de(u,""),de(c,!1),de(h,""),de(g,!1),de(w,!1),localStorage.clear())},D=async()=>{const p=M(b).join(`
`);p.trim()!==""&&(navigator.clipboard?(await navigator.clipboard.writeText(p.trimEnd()),alert("Text has been copied to clipboard.")):alert("This function requires a secure origin. (HTTPS or localhost)"))};var F=AU();Fw("beforeunload",Mg,()=>localStorage.setItem("data",JSON.stringify(v.getData()))),NI(p=>{var C=HU(),_=Ig(C);St(_),Fw("load",_,T),Ra(p,C)});var W=St(Ig(F),2),q=mr(W),L=St(mr(q),2),oe=mr(L);es(oe,{id:"TrimSpace",get checked(){return le(n)},set checked(p){de(n,p,!0)}});var G=St(oe,2);es(G,{id:"CutSpace",get checked(){return le(i)},set checked(p){de(i,p,!0)}});var J=St(G,2);es(J,{id:"RemoveParentheses",get checked(){return le(o)},set checked(p){de(o,p,!0)}});var tt=St(J,4),Ee=mr(tt);Ee.__click=[PU,w,g];var Te=St(tt,2),Be=mr(Te);Be.__click=[xU,g,w];var Le=St(Te,4);es(Le,{id:"Trim",placeholder:"Cutset",get checked(){return le(s)},set checked(p){de(s,p,!0)},get optional(){return le(a)},set optional(p){de(a,p,!0)}});var Ie=St(Le,2);es(Ie,{id:"Cut",placeholder:"Sep",get checked(){return le(l)},set checked(p){de(l,p,!0)},get optional(){return le(u)},set optional(p){de(u,p,!0)}});var zr=St(Ie,2);es(zr,{id:"Remove",placeholder:"RegExp",get checked(){return le(c)},set checked(p){de(c,p,!0)},get optional(){return le(h)},set optional(p){de(h,p,!0)}});var be=St(zr,4);be.__click=x;var f=St(be,6);f.__click=D;var m=St(f,6);m.__click=P,Hg(()=>{Ww(Ee,le(w)),Ww(Be,le(g)),be.disabled=le(d),f.disabled=le(d),m.disabled=le(d)}),Ra(t,F),Cm()}PE(["click"]);VI(NU,{target:document.body})});export default DU();
